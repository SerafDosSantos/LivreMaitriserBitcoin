<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Minage et Consensus</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-2">
<h2 id="mining">Minage et Consensus</h2>
<div class="sectionbody">
<div class="sect2 data-line-5">
<h3 id="_présentation">Présentation</h3>
<div class="paragraph data-line-7">
<p>Le mot "exploitation minière" ou "minage" est quelque peu trompeur. En évoquant l&#8217;extraction de métaux précieux, il focalise notre attention sur la récompense du minage, le nouveau bitcoin créé dans chaque bloc. Bien que l&#8217;exploitation minière soit incitée par cette récompense, l&#8217;objectif principal de l&#8217;exploitation minière n&#8217;est pas la récompense ou la génération de nouvelles pièces. Si vous considérez l&#8217;exploitation minière uniquement comme le processus par lequel les pièces sont créées, vous confondez les moyens (incitations) avec le but du processus. Le minage est le mécanisme qui sous-tend la chambre de compensation décentralisée, par laquelle les transactions sont validées et compensées. Le minage est l&#8217;invention qui rend le bitcoin spécial, un mécanisme de sécurité décentralisé qui est à la base de l&#8217;argent numérique P2P.</p>
</div>
<div class="paragraph data-line-9">
<p>L&#8217;exploitation minière <em>sécurise le système Bitcoin</em> et permet l&#8217;émergence d&#8217;un <em>consensus à l&#8217;échelle du réseau sans autorité centrale</em>. La récompense des pièces nouvellement frappées et des frais de transaction est un système d&#8217;incitation qui aligne les actions des mineurs sur la sécurité du réseau, tout en mettant en œuvre simultanément l&#8217;offre monétaire.</p>
</div>
<div class="admonitionblock tip data-line-12">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-13">
<p>Le but du minage n&#8217;est pas la création de nouveaux bitcoins. C&#8217;est le système d&#8217;incitation. Le minage est le mécanisme par lequel la <em>sécurité</em> du bitcoin est <em>décentralisée</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-16">
<p>Les mineurs valident les nouvelles transactions et les enregistrent dans le grand livre mondial. Un nouveau bloc, contenant les transactions qui se sont produites depuis le dernier bloc, est "miné" toutes les 10 minutes en moyenne, ajoutant ainsi ces transactions à la chaîne de blocs. Les transactions qui font partie d&#8217;un bloc et ajoutées à la chaîne de blocs sont considérées comme "confirmées", ce qui permet aux nouveaux propriétaires de bitcoin de dépenser le bitcoin qu&#8217;ils ont reçu dans ces transactions.</p>
</div>
<div class="paragraph data-line-18">
<p>Les mineurs reçoivent deux types de récompenses en échange de la sécurité fournie par le minage : de nouvelles pièces créées avec chaque nouveau bloc, également appelées <em>récompense de bloc</em> ou <em>récompense de coinbase</em>, et les frais de transaction de toutes les transactions incluses dans le bloc. Pour gagner cette récompense, les mineurs s&#8217;affrontent pour résoudre un problème mathématique difficile basé sur un algorithme de hachage cryptographique. La solution au problème, appelée Proof-of-Work (ou preuve de travail), est incluse dans le nouveau bloc et agit comme preuve que le mineur a déployé des efforts informatiques importants. La compétition pour résoudre l&#8217;algorithme de preuve de travail pour gagner la récompense et le droit d&#8217;enregistrer les transactions sur la chaîne de blocs est la base du modèle de sécurité de Bitcoin.</p>
</div>
<div class="paragraph data-line-20">
<p>Le processus est appelé minage parce que la récompense (nouvelle génération de pièces) est conçue pour simuler des rendements décroissants, tout comme le minage de métaux précieux. La masse monétaire de Bitcoin est créée par l&#8217;exploitation minière, de la même manière qu&#8217;une banque centrale émet de la nouvelle monnaie en imprimant des billets de banque. La quantité maximale de bitcoins nouvellement créés qu&#8217;un mineur peut ajouter à un bloc diminue environ tous les quatre ans (ou précisément tous les 210 000 blocs). Il a commencé à 50 bitcoins par bloc en janvier 2009 et a été réduit de moitié à 25 bitcoins par bloc en novembre 2012. Il a été réduit de moitié à 12,5 bitcoins en juillet 2016 et de nouveau à 6,25 bitcoins en mai 2020. Sur la base de cette formule, les récompenses de minage de bitcoins diminuent de façon exponentielle. jusqu&#8217;à environ l&#8217;an 2140, lorsque tous les bitcoins (20,99999998 millions) auront été émis. Après 2140, aucun nouveau bitcoin ne sera émis.</p>
</div>
<div class="paragraph data-line-22">
<p>Les mineurs de Bitcoin gagnent également des frais sur les transactions. Chaque transaction comprend généralement des frais de transaction, sous la forme d&#8217;un surplus de bitcoin entre les entrées et les sorties de la transaction. Le mineur de bitcoin gagnant peut "garder la monnaie" sur les transactions incluses dans le bloc gagnant. Aujourd&#8217;hui, les frais représentent 0,5% ou moins des revenus d&#8217;un mineur de bitcoin, la grande majorité provenant du bitcoin nouvellement créé. Cependant, à mesure que la récompense de bloc diminue avec le temps et que le nombre de transactions par bloc augmente, une plus grande proportion des revenus de minage de bitcoins proviendra des frais. Progressivement, la récompense minière sera dominée par les frais de transaction, qui constitueront la principale incitation pour les mineurs. Après 2140, la quantité de nouveaux bitcoins dans chaque bloc tombe à zéro et l&#8217;extraction de bitcoins ne sera encouragée que par les frais de transaction.</p>
</div>
<div class="paragraph data-line-24">
<p>Dans ce chapitre, nous examinerons d&#8217;abord l&#8217;exploitation minière en tant que mécanisme d&#8217;approvisionnement monétaire, puis nous examinerons la fonction la plus importante de l&#8217;exploitation minière : le mécanisme de consensus décentralisé qui sous-tend la sécurité du bitcoin.</p>
</div>
<div class="paragraph data-line-26">
<p>Pour comprendre l&#8217;exploitation minière et le consensus, nous suivrons la transaction d&#8217;Alice telle qu&#8217;elle est reçue et ajoutée à un bloc par l&#8217;équipement minier de Jing. Ensuite, nous suivrons le bloc tel qu&#8217;il est extrait, ajouté à la chaîne de blocs et accepté par le réseau Bitcoin à travers le processus de consensus émergent.</p>
</div>
<div class="sect3 data-line-28">
<h4 id="_économie_bitcoin_et_création_de_devises">Économie Bitcoin et création de devises</h4>
<div class="paragraph data-line-30">
<p>Les Bitcoins sont "frappés" lors de la création de chaque bloc à un taux fixe et décroissant. Chaque bloc, généré en moyenne toutes les 10 minutes, contient des bitcoins entièrement nouveaux, créés à partir de rien. Tous les 210 000 blocs, soit environ tous les quatre ans, le taux d&#8217;émission des devises est diminué de 50 %. Pendant les quatre premières années de fonctionnement du réseau, chaque bloc contenait 50 nouveaux bitcoins.</p>
</div>
<div class="paragraph data-line-32">
<p>En novembre 2012, le nouveau taux d&#8217;émission de bitcoins a été réduit à 25 bitcoins par bloc. En juillet 2016, il a été réduit à 12,5 bitcoins par bloc, et en mai 2020, il a de nouveau été réduit à 6,25 bitcoins par bloc. Le taux de nouvelles pièces diminue ainsi de manière exponentielle sur 32 "halvings" (ou "réductions de moitié") jusqu&#8217;au bloc 6 720 000 (miné environ en 2137), lorsqu&#8217;il atteint l&#8217;unité monétaire minimale de 1 satoshi. Enfin, après 6,93 millions de blocs, en 2140 environ, près de 2 099 999 997 690 000 satoshis, soit près de 21 millions de bitcoins, seront émis. Par la suite, les blocs ne contiendront plus de nouveaux bitcoins et les mineurs seront récompensés uniquement par les frais de transaction. <a href="#bitcoin_money_supply">Offre de monnaie bitcoin au fil du temps basée sur un taux d&#8217;émission géométriquement décroissant</a> montre le bitcoin total en circulation au fil du temps, à mesure que l&#8217;émission de devises diminue.</p>
</div>
<div id="bitcoin_money_supply" class="imageblock data-line-36">
<div class="content">
<img src="images/mbc2_1001.png" alt="Masse monétaire Bitcoin">
</div>
<div class="title">Figure 1. Offre de monnaie bitcoin au fil du temps basée sur un taux d&#8217;émission géométriquement décroissant</div>
</div>
<div class="admonitionblock note data-line-39">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-40">
<p>Le nombre maximum de pièces minées est la <em>limite supérieure</em> des récompenses minières possibles pour le bitcoin. En pratique, un mineur peut intentionnellement exploiter un bloc en prenant moins que la récompense complète. Ces blocs ont déjà été extraits et d&#8217;autres pourraient l&#8217;être à l&#8217;avenir, ce qui entraînerait une émission totale inférieure de la monnaie.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-43">
<p>Dans l&#8217;exemple de code dans <a href="#max_money">Un script pour calculer la quantité totale de bitcoins qui sera émise</a>, nous calculons le montant total de bitcoin qui sera émis.</p>
</div>
<div id="max_money" class="exampleblock data-line-47">
<div class="title">Example 1. Un script pour calculer la quantité totale de bitcoins qui sera émise</div>
<div class="content">
<div class="listingblock data-line-49">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Original block reward for miners was 50 BTC
start_block_reward = 50
# 210000 is around every 4 years with a 10 minute block interval
reward_interval = 210000

def max_money():
    # 50 BTC = 50 0000 0000 Satoshis
    current_reward = 50 * 10**8
    total = 0
    while current_reward &gt; 0:
        total += reward_interval * current_reward
        current_reward /= 2
    return total

print "Total BTC to ever be created:", max_money(), "Satoshis"</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-54">
<p><a href="#max_money_run">Exécuter le script max_money.py</a> affiche la sortie produite en exécutant ce script.</p>
</div>
<div id="max_money_run" class="exampleblock data-line-58">
<div class="title">Example 2. Exécuter le script max_money.py</div>
<div class="content">
<div class="listingblock data-line-60">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python max_money.py
Total BTC to ever be created: 2100000000000000.0 Satoshis</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-66">
<p>L&#8217;émission finie et décroissante crée une masse monétaire fixe qui résiste à l&#8217;inflation. Contrairement à une monnaie fiduciaire, qui peut être imprimée en nombre infini par une banque centrale, le bitcoin ne peut jamais être gonflé par l&#8217;impression.</p>
</div>
<div class="sidebarblock data-line-69">
<div class="content">
<div class="title">Argent déflationniste</div>
<div class="paragraph data-line-70">
<p>La conséquence la plus importante et la plus débattue d&#8217;une émission monétaire fixe et décroissante est que la monnaie a tendance à être intrinsèquement déflationniste. La déflation est le phénomène d&#8217;appréciation de la valeur due à une inadéquation entre l&#8217;offre et la demande qui fait monter la valeur (et le taux de change) d&#8217;une monnaie. Le contraire de l&#8217;inflation, la déflation des prix, signifie que l&#8217;argent a plus de pouvoir d&#8217;achat au fil du temps.</p>
</div>
<div class="paragraph data-line-72">
<p>De nombreux économistes soutiennent qu&#8217;une économie déflationniste est une catastrophe qu&#8217;il faut éviter à tout prix. En effet, en période de déflation rapide, les gens ont tendance à accumuler de l&#8217;argent au lieu de le dépenser, en espérant que les prix chuteront. Un tel phénomène s&#8217;est déroulé au cours de la « décennie perdue » du Japon, lorsqu&#8217;un effondrement complet de la demande a poussé la monnaie dans une spirale déflationniste.</p>
</div>
<div class="paragraph data-line-74">
<p>Les experts du Bitcoin affirment que la déflation n&#8217;est pas mauvaise en soi. La déflation est plutôt associée à un effondrement de la demande car c&#8217;est le seul exemple de déflation que nous ayons à étudier. Dans une monnaie fiduciaire avec possibilité d&#8217;impression illimitée, il est très difficile d&#8217;entrer dans une spirale déflationniste à moins qu&#8217;il n&#8217;y ait un effondrement complet de la demande et une réticence à imprimer de l&#8217;argent. La déflation du bitcoin n&#8217;est pas causée par un effondrement de la demande, mais par une offre limitée de manière prévisible.</p>
</div>
<div class="paragraph data-line-76">
<p>L&#8217;aspect positif de la déflation, bien sûr, c&#8217;est qu&#8217;elle est le contraire de l&#8217;inflation. L&#8217;inflation provoque une dépréciation lente mais inévitable de la monnaie, se traduisant par une forme de taxation cachée qui punit les épargnants afin de renflouer les débiteurs (y compris les plus gros débiteurs, les gouvernements eux-mêmes). Les monnaies sous contrôle gouvernemental souffrent de l&#8217;aléa moral d&#8217;une émission facile de dette qui peut ensuite être effacée par la dépréciation aux dépens des épargnants.</p>
</div>
<div class="paragraph data-line-78">
<p>Il reste à voir si l&#8217;aspect déflationniste de la monnaie est un problème lorsqu&#8217;il n&#8217;est pas entraîné par une rétraction économique rapide, ou un avantage parce que la protection contre l&#8217;inflation et l&#8217;avilissement l&#8217;emporte largement sur les risques de déflation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-81">
<h3 id="_consensus_décentralisé">Consensus décentralisé</h3>
<div class="paragraph data-line-83">
<p>Dans le chapitre précédent, nous avons examiné la chaîne de blocs, le registre public mondial (liste) de tous transactions, que tout le monde dans le réseau Bitcoin accepte comme enregistrement de propriété faisant autorité.</p>
</div>
<div class="paragraph data-line-85">
<p>Mais comment tout le monde dans le réseau peut-il s&#8217;entendre sur une seule « vérité » universelle sur qui possède quoi, sans avoir à faire confiance à personne ? Tous les systèmes de paiement traditionnels dépendent d&#8217;un modèle de confiance qui a une autorité centrale fournissant un service de chambre de compensation, vérifiant et compensant essentiellement toutes les transactions. Bitcoin n&#8217;a pas d&#8217;autorité centrale, mais d&#8217;une manière ou d&#8217;une autre, chaque nœud complet possède une copie complète d&#8217;un grand livre public auquel il peut faire confiance en tant qu&#8217;enregistrement faisant autorité. La chaîne de blocs n&#8217;est pas créée par une autorité centrale, mais est assemblée indépendamment par chaque nœud du réseau. D&#8217;une manière ou d&#8217;une autre, chaque nœud du réseau, agissant sur les informations transmises via des connexions réseau non sécurisées, peut arriver à la même conclusion et assembler une copie du même registre public que tout le monde. Ce chapitre examine le processus par lequel le réseau Bitcoin parvient à un consensus mondial sans autorité centrale.</p>
</div>
<div class="paragraph data-line-87">
<p>La principale invention de Satoshi Nakamoto est le mécanisme décentralisé de <em>consensus émergent</em>. Emergent, parce que le consensus n&#8217;est pas atteint explicitement - il n&#8217;y a pas d&#8217;élection ou de moment fixe où le consensus se produit. Au lieu de cela, le consensus est un artefact émergent de l&#8217;interaction asynchrone de milliers de nœuds indépendants, qui suivent tous des règles simples. Toutes les propriétés du bitcoin, y compris la monnaie, les transactions, les paiements et le modèle de sécurité qui ne dépend pas de l&#8217;autorité centrale ou de la confiance, découlent de cette invention.</p>
</div>
<div class="paragraph data-line-89">
<p>Le consensus décentralisé de Bitcoin émerge de l&#8217;interaction de quatre processus qui se produisent indépendamment sur les nœuds du réseau :</p>
</div>
<div class="ulist pagebreak-before data-line-92">
<ul>
<li class="data-line-92">
<p>Vérification indépendante de chaque transaction, par chaque nœud complet, sur la base d&#8217;une liste complète de critères</p>
</li>
<li class="data-line-93">
<p>Agrégation indépendante de ces transactions dans de nouveaux blocs par des nœuds de minage, associée à un calcul démontré via un algorithme de preuve de travail</p>
</li>
<li class="data-line-94">
<p>Vérification indépendante des nouveaux blocs par chaque nœud et assemblage dans une chaîne</p>
</li>
<li class="data-line-95">
<p>Sélection indépendante, par chaque nœud, de la chaîne avec le calcul le plus cumulatif démontré par la preuve de travail</p>
</li>
</ul>
</div>
<div class="paragraph data-line-97">
<p>Dans les prochaines sections, nous examinerons ces processus et la manière dont ils interagissent pour créer la propriété émergente du consensus à l&#8217;échelle du réseau qui permet à n&#8217;importe quel nœud Bitcoin d&#8217;assembler sa propre copie du grand livre public mondial faisant autorité.</p>
</div>
</div>
<div class="sect2 data-line-100">
<h3 id="tx_verification">Vérification indépendante des transactions</h3>
<div class="paragraph data-line-102">
<p>Dans <a href="#transactions">[transactions]</a>, nous avons vu comment un logiciel de portefeuille crée des transactions en collectant des UTXO, en fournissant les scripts de déverrouillage appropriés, puis en construisant de nouvelles sorties attribuées à un nouveau propriétaire. La transaction résultante est ensuite envoyée aux nœuds voisins du réseau Bitcoin afin qu&#8217;elle puisse être propagée sur l&#8217;ensemble du réseau Bitcoin.</p>
</div>
<div class="paragraph data-line-104">
<p>Cependant, avant de transmettre les transactions à ses voisins, chaque nœud Bitcoin qui reçoit une transaction vérifiera d&#8217;abord la transaction. Cela garantit que seules les transactions valides sont propagées sur le réseau, tandis que les transactions non valides sont rejetées au premier nœud qui les rencontre.</p>
</div>
<div class="paragraph data-line-106">
<p>Chaque nœud vérifie chaque transaction par rapport à une longue liste de critères :</p>
</div>
<div class="ulist data-line-108">
<ul>
<li class="data-line-108">
<p>La syntaxe et la structure des données de la transaction doivent être correctes.</p>
</li>
<li class="data-line-109">
<p>Ni les listes d&#8217;entrées ni de sorties ne sont vides.</p>
</li>
<li class="data-line-110">
<p>La taille de la transaction est inférieure à la taille maximale autorisée pour un bloc excluant les données témoins, comme indiqué dans <a href="https://bit.ly/3t623VL" data-href="https://bit.ly/3t623VL"><em>tx_check.cpp</em></a>.</p>
</li>
<li class="data-line-111">
<p>Chaque valeur de sortie, ainsi que le total, doit être dans la plage de valeurs autorisée (moins de 21 millions de pièces, plus que le seuil de <em>poussière</em>).</p>
</li>
<li class="data-line-112">
<p>Aucune des entrées n&#8217;a hash=0, N=–1 (les transactions coinbase ne doivent pas être relayées).</p>
</li>
<li class="data-line-113">
<p>nLocktime est égal à INT_MAX, ou les valeurs nLocktime et nSequence sont satisfaites selon MedianTimePast.</p>
</li>
<li class="data-line-114">
<p>La taille de la transaction en octets est supérieure ou égale à 82.</p>
</li>
<li class="data-line-115">
<p>Le nombre d&#8217;opérations de signature (SIGOPS) contenues dans la transaction est inférieur à la limite d&#8217;opérations de signature.</p>
</li>
<li class="data-line-116">
<p>Le script de déverrouillage (scriptSig) ne peut pousser que des nombres sur la pile, et le script de verrouillage (scriptPubkey) doit correspondre aux formes IsStandard (cela rejette les transactions "non standard").</p>
</li>
<li class="data-line-117">
<p>Une transaction correspondante dans le bassin ou dans un bloc de la branche principale doit exister.</p>
</li>
<li class="data-line-118">
<p>Pour chaque entrée, si la sortie référencée existe dans une autre transaction du bassin, la transaction doit être rejetée.</p>
</li>
<li class="data-line-119">
<p>Pour chaque entrée, regardez dans la branche principale et le bassin de transactions pour trouver sa transaction parente. Si la transaction parent est manquante pour une entrée, il s&#8217;agira d&#8217;une transaction orpheline. Ajouter au bassin de transactions orphelines, si une transaction correspondante n&#8217;est pas déjà dans le bassin.</p>
</li>
<li class="data-line-120">
<p>Pour chaque entrée, si sa transaction parente est une transaction coinbase, elle doit avoir au moins COINBASE_MATURITY (100) confirmations.</p>
</li>
<li class="data-line-121">
<p>Pour chaque entrée, la sortie référencée doit exister et ne peut pas déjà être dépensée.</p>
</li>
<li class="data-line-122">
<p>En utilisant les transactions parentes pour obtenir les valeurs d&#8217;entrée, vérifiez que chaque valeur d&#8217;entrée, ainsi que la somme, se situent dans la plage de valeurs autorisée (moins de 21 millions de pièces, plus de 0).</p>
</li>
<li class="data-line-123">
<p>Rejeter si la somme des valeurs d&#8217;entrée est inférieure à la somme des valeurs de sortie.</p>
</li>
<li class="data-line-124">
<p>Rejeter si les frais de transaction seraient trop bas (minRelayTxFee) pour entrer dans un bloc vide.</p>
</li>
<li class="data-line-125">
<p>Les scripts de déverrouillage pour chaque entrée doivent être validés par rapport aux scripts de verrouillage de sortie correspondants.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-127">
<p>Ces conditions peuvent être vues en détail dans les fonctions AcceptToMemoryPool, CheckTransaction et CheckInputs dans Bitcoin Core. Notez que les conditions changent avec le temps, pour faire face à de nouveaux types d&#8217;attaques par déni de service ou parfois pour assouplir les règles afin d&#8217;inclure davantage de types de transactions.</p>
</div>
<div class="paragraph data-line-129">
<p>En vérifiant indépendamment chaque transaction lors de sa réception et avant de la propager, chaque nœud crée un bassin de transactions valides (mais non confirmées) connu sous le nom de <em>bassin de transaction</em>, <em>bassin de mémoire</em> ou <em>mempool</em>.</p>
</div>
</div>
<div class="sect2 data-line-131">
<h3 id="_nœuds_miniers">Nœuds miniers</h3>
<div class="paragraph data-line-133">
<p>Certains des nœuds du réseau Bitcoin sont des nœuds spécialisés appelés <em>mineurs</em>. Dans <a href="#ch01_intro_what_is_bitcoin">[ch01_intro_what_is_bitcoin]</a> nous avons présenté Jing, un étudiant en génie informatique à Shanghai, en Chine, est un mineur de bitcoin. Jing gagne du bitcoin en exécutant une "plate-forme minière", qui est un système informatique spécialisé conçu pour exploiter le bitcoin. Le matériel minier spécialisé de Jing est connecté à un serveur exécutant un nœud Bitcoin complet. Contrairement à Jing, certains mineurs minent sans nœud complet, comme nous le verrons dans <a href="#mining_pools">Groupes miniers</a>. Comme tous les autres nœuds complets, le nœud de Jing reçoit et propage les transactions non confirmées sur le réseau Bitcoin. Le nœud de Jing, cependant, agrège également ces transactions dans de nouveaux blocs.</p>
</div>
<div class="paragraph data-line-135">
<p>Le nœud de Jing est à l&#8217;écoute de nouveaux blocs, propagés sur le réseau Bitcoin, comme tous les nœuds. Cependant, l&#8217;arrivée d&#8217;un nouveau bloc a une signification particulière pour un nœud minier. La compétition entre mineurs se termine effectivement par la propagation d&#8217;un nouveau bloc qui fait office d&#8217;annonce d&#8217;un gagnant. Pour les mineurs, recevoir un nouveau bloc valide signifie que quelqu&#8217;un d&#8217;autre a gagné la compétition et qu&#8217;il (on) a perdu. Cependant, la fin d&#8217;un tour d&#8217;une compétition est aussi le début du tour suivant. Le nouveau bloc n&#8217;est pas seulement un drapeau à damier, marquant la fin de la course; c&#8217;est aussi le pistolet de départ dans la course pour le bloc suivant.</p>
</div>
</div>
<div class="sect2 data-line-137">
<h3 id="_agréger_les_transactions_en_blocs">Agréger les transactions en blocs</h3>
<div class="paragraph data-line-139">
<p>Après avoir validé les transactions, un nœud Bitcoin les ajoutera au <em>bassin de mémoire</em>, ou <em>bassin de transaction</em>, où les transactions attendent jusqu&#8217;à ce qu&#8217;elles puissent être incluses (exploitées) dans un bloc. Le nœud de Jing collecte, valide et relaie les nouvelles transactions comme n&#8217;importe quel autre nœud. Contrairement aux autres nœuds, cependant, le nœud de Jing regroupera ensuite ces transactions dans un <em>bloc candidat</em>.</p>
</div>
<div class="paragraph data-line-141">
<p>Suivons les blocs qui ont été créés à l&#8217;époque où Alice achetait une tasse de café au Bob&#8217;s Cafe (voir <a href="#cup_of_coffee">[cup_of_coffee]</a>). La transaction d&#8217;Alice a été incluse dans le bloc 277 316. Dans le but de démontrer les concepts de ce chapitre, supposons que ce bloc a été miné par le système de minage de Jing et suivons la transaction d&#8217;Alice au fur et à mesure qu&#8217;elle fait partie de ce nouveau bloc.</p>
</div>
<div class="paragraph data-line-143">
<p>Le nœud minier de Jing maintient une copie locale de la chaîne de blocs. Au moment où Alice achète la tasse de café, le nœud de Jing a assemblé une chaîne jusqu&#8217;au bloc 277 314. Le nœud de Jing écoute les transactions, essaie d&#8217;extraire un nouveau bloc et écoute également les blocs découverts par d&#8217;autres nœuds. Comme le nœud de Jing est en train d&#8217;exploiter, il reçoit le bloc 277 315 via le réseau Bitcoin. L&#8217;arrivée de ce bloc signifie la fin de la compétition pour le bloc 277 315 et le début de la compétition pour créer le bloc 277 316.</p>
</div>
<div class="paragraph data-line-145">
<p>Au cours des 10 minutes précédentes, alors que le nœud de Jing cherchait une solution au bloc 277 315, il collectait également des transactions en vue du bloc suivant. À ce jour, il a collecté quelques centaines de transactions dans le bassin de mémoire. Lors de la réception du bloc 277 315 et de sa validation, le nœud de Jing le comparera également à toutes les transactions du pool de mémoire et supprimera celles qui étaient incluses dans le bloc 277 315. Quelles que soient les transactions restantes dans le bassin de mémoire, elles ne sont pas confirmées et attendent d&#8217;être enregistrées dans un nouveau bloc.</p>
</div>
<div class="paragraph data-line-147">
<p>Le nœud de Jing construit immédiatement un nouveau bloc vide, un candidat pour le bloc 277 316. Ce bloc est appelé <em>bloc candidat</em> car ce n&#8217;est pas encore un bloc valide, car il ne contient pas de preuve de travail valide. Le bloc ne devient valide que si le mineur réussit à trouver une solution à l&#8217;algorithme de preuve de travail.</p>
</div>
<div class="paragraph data-line-149">
<p>Lorsque le nœud de Jing regroupe toutes les transactions du bassin de mémoire, le nouveau bloc candidat contient 418 transactions avec des frais de transaction totaux de 0,09094928 bitcoin. Vous pouvez voir ce bloc dans la chaîne de blocs à l&#8217;aide de l&#8217;interface de ligne de commande du client Bitcoin Core, comme indiqué dans <a href="#block277316">Utiliser la ligne de commande pour récupérer le bloc 277,316</a>.</p>
</div>
<div id="block277316" class="exampleblock data-line-153">
<div class="title">Example 3. Utiliser la ligne de commande pour récupérer le bloc 277,316</div>
<div class="content">
<div class="listingblock data-line-155">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ bitcoin-cli getblockhash 277316

0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4

$ bitcoin-cli getblock 0000000000000001b6b9a13b095e96db41c4a928b97ef2d9\
44a9b31b2cc7bdc4</code></pre>
</div>
</div>
<div class="listingblock data-line-166">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "hash" : "0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4",
    "confirmations" : 35561,
    "size" : 218629,
    "height" : 277316,
    "version" : 2,
    "merkleroot" : "c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e",
    "tx" : [
        "d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f",
        "b268b45c59b39d759614757718b9918caf0ba9d97c56f3b91956ff877c503fbe",

        ... 417 more transactions ...

       ],
    "time" : 1388185914,
    "nonce" : 924591752,
    "bits" : "1903a30c",
    "difficulty" : 1180923195.25802612,
    "chainwork" : "000000000000000000000000000000000000000000000934695e92aaf53afa1a",
    "previousblockhash" : "0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 data-line-191">
<h4 id="_la_transaction_coinbase">La transaction Coinbase</h4>
<div class="paragraph data-line-193">
<p>La première transaction d&#8217;un bloc est une transaction spéciale, appelée <em>transaction coinbase</em>. Cette transaction est construite par le nœud de Jing et contient sa <em>récompense</em> pour l&#8217;effort de minage.</p>
</div>
<div class="admonitionblock note data-line-196">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-197">
<p>Lorsque le bloc 277 316 a été miné, la récompense était de 25 bitcoins par bloc. Depuis, deux périodes de "halving" (ou "réduction de moitié") se sont écoulées. La récompense globale est passée à 12,5 bitcoins en juillet 2016 et à 6,25 bitcoins en mai 2020.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-200">
<p>Le nœud de Jing crée la transaction coinbase en tant que paiement sur son propre portefeuille : "Pay Jing&#8217;s address 25.09094928 bitcoin." Le montant total de la récompense que Jing collecte pour l&#8217;extraction d&#8217;un bloc est la somme de la récompense coinbase (25 nouveaux bitcoins) et des frais de transaction (0,09094928) de toutes les transactions incluses dans le bloc, comme indiqué dans <a href="#generation_tx_example">Transaction coinbase</a>.</p>
</div>
<div id="generation_tx_example" class="exampleblock data-line-205">
<div class="title">Example 4. Transaction coinbase</div>
<div class="content">
<div class="listingblock data-line-206">
<div class="content">
<pre>$ bitcoin-cli getrawtransaction d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f 1</pre>
</div>
</div>
<div class="listingblock c_less_space data-line-212">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "hex" : "01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0f03443b0403858402062f503253482fffffffff0110c08d9500000000232102aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21ac00000000",
    "txid" : "d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f",
    "version" : 1,
    "locktime" : 0,
    "vin" : [
        {
            "coinbase" : "03443b0403858402062f503253482f",
            "sequence" : 4294967295
        }
    ],
    "vout" : [
        {
            "value" : 25.09094928,
            "n" : 0,
            "scriptPubKey" : {
                "asm" : "02aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21OP_CHECKSIG",
                "hex" : "2102aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21ac",
                "reqSigs" : 1,
                "type" : "pubkey",
                "addresses" : [
                    "1MxTkeEP2PmHSMze5tUZ1hAV3YTKu2Gh1N"
                ]
            }
        }
    ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-243">
<p>Contrairement aux transactions régulières, la transaction coinbase ne consomme pas (ne dépense pas) d&#8217;UTXO comme entrées. Au lieu de cela, il n&#8217;a qu&#8217;une seule entrée, appelée <em>coinbase</em>, qui crée du bitcoin à partir de rien. La transaction coinbase a une sortie, payable à la propre adresse Bitcoin du mineur. La sortie de la transaction coinbase envoie la valeur de 25,09094928 bitcoin à l&#8217;adresse Bitcoin du mineur ; dans ce cas c&#8217;est 1MxTkeEP2PmHSMze5tUZ1hAV3YTKu2Gh1N.</p>
</div>
</div>
<div class="sect3 data-line-245">
<h4 id="_récompense_et_frais_coinbase">Récompense et frais coinbase</h4>
<div class="paragraph data-line-247">
<p>Pour construire la transaction coinbase, le nœud de Jing calcule d&#8217;abord le montant total des frais de transaction en ajoutant toutes les entrées et sorties des 418 transactions qui ont été ajoutées au bloc. Les frais sont calculés comme suit :</p>
</div>
<div class="listingblock data-line-249">
<div class="content">
<pre>Frais totaux = Somme(entrées) - Somme(sorties)</pre>
</div>
</div>
<div class="paragraph data-line-253">
<p>Dans le bloc 277 316, le total des frais de transaction est de 0,09094928 bitcoin.</p>
</div>
<div class="paragraph data-line-255">
<p>Ensuite, le nœud de Jing calcule la récompense correcte pour le nouveau bloc. La récompense est calculée en fonction de la hauteur du bloc, à partir de 50 bitcoins par bloc et réduite de moitié tous les 210 000 blocs. Parce que ce bloc est à la hauteur 277 316, la récompense correcte est de 25 bitcoins.</p>
</div>
<div class="paragraph data-line-257">
<p>Le calcul peut être vu dans la fonction GetBlockSubsidy dans le client Bitcoin Core, comme indiqué dans <a href="#getblocksubsidy_source">Calcul de la récompense de bloc—Fonction GetBlockSubsidy, Client Bitcoin Core, main.cpp</a>.</p>
</div>
<div id="getblocksubsidy_source" class="exampleblock data-line-261">
<div class="title">Example 5. Calcul de la récompense de bloc—Fonction GetBlockSubsidy, Client Bitcoin Core, main.cpp</div>
<div class="content">
<div class="listingblock c_less_space data-line-264">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">CAmount GetBlockSubsidy(int nHeight, const Consensus::Params&amp; consensusParams)
{
    int halvings = nHeight / consensusParams.nSubsidyHalvingInterval;
    // Force la récompense du bloc à zéro lorsque le décalage vers la droite n'est pas défini.
    if (halvings &gt;= 64)
        return 0;

    CAmount nSubsidy = 50 * COIN;
    // La subvention est réduite de moitié tous les 210 000 blocs, ce qui se produira environ tous les 4 ans.
    nSubsidy &gt;&gt;= halvings;
    return nSubsidy;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-280">
<p>La subvention initiale est calculée en satoshis en multipliant 50 par la constante COIN (100 000 000 satoshis). Cela fixe la récompense initiale (nSubsidy) à 5 milliards de satoshis.</p>
</div>
<div class="paragraph data-line-282">
<p>Ensuite, la fonction calcule le nombre de halvings qui se sont produits en divisant la hauteur actuelle du bloc par l&#8217;intervalle de halving (ou réduction de moitié) (SubsidyHalvingInterval). Dans le cas du bloc 277 316, avec un intervalle de moitié tous les 210 000 blocs, le résultat est 1 moitié.</p>
</div>
<div class="paragraph data-line-284">
<p>Le nombre maximum de moitiés autorisé est de 64, donc le code impose une récompense nulle (ne renvoie que les frais) si les 64 moitiés sont dépassées.</p>
</div>
<div class="paragraph data-line-286">
<p>Ensuite, la fonction utilise l&#8217;opérateur binaire de décalage vers la droite pour diviser la récompense (nSubsidy) par deux pour chaque cycle de réduction de moitié. Dans le cas du bloc 277 316, cela entraînerait un décalage binaire vers la droite de la récompense de 5 milliards de satoshis une fois (une réduction de moitié) et donnerait 2,5 milliards de satoshis, soit 25 bitcoins. L&#8217;opérateur de décalage binaire vers la droite est utilisé car il est plus efficace que plusieurs divisions répétées. Pour éviter un bogue potentiel, l&#8217;opération de décalage est ignorée après 63 moitiés et la subvention est définie sur 0.</p>
</div>
<div class="paragraph data-line-288">
<p>Enfin, la récompense coinbase (nSubsidy) est ajoutée aux frais de transaction (nFees), et la somme est restituée.</p>
</div>
<div class="admonitionblock tip data-line-291">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-292">
<p>Si le nœud minier de Jing écrit la transaction coinbase, qu&#8217;est-ce qui empêche Jing de se "récompenser" lui-même 100 ou 1000 bitcoins ? La réponse est qu&#8217;une récompense incorrecte aurait pour conséquence que le bloc serait considéré comme invalide par tout le monde, gaspillant l&#8217;électricité de Jing utilisée pour la preuve de travail. Jing ne peut dépenser la récompense que si le bloc est accepté par tout le monde.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-295">
<h4 id="_structure_de_la_transaction_coinbase">Structure de la transaction coinbase</h4>
<div class="paragraph data-line-297">
<p>Avec ces calculs, le nœud de Jing construit ensuite la transaction coinbase pour se payer 25,09094928 bitcoins.</p>
</div>
<div class="paragraph data-line-299">
<p>Comme vous pouvez le voir dans <a href="#generation_tx_example">Transaction coinbase</a>, la transaction coinbase a un format spécial. Au lieu d&#8217;une entrée de transaction spécifiant un UTXO précédent à dépenser, il a une entrée "coinbase". Nous avons examiné les entrées de transaction dans <a href="#tx_in_structure">[tx_in_structure]</a>. Comparons une entrée de transaction régulière avec une entrée de transaction coinbase. <a href="#table_8-1">La structure d&#8217;une entrée de transaction "normale"</a> montre la structure d&#8217;une entrée de transaction normale, tandis que <a href="#table_8-2">La structure d&#8217;une entrée de transaction coinbase</a> montre la structure de l&#8217;entrée de la transaction coinbase.</p>
</div>
<table id="table_8-1" class="tableblock frame-all grid-all stretch data-line-304">
<caption class="title">Table 1. La structure d&#8217;une entrée de transaction "normale"</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pointeur vers la transaction contenant l&#8217;UTXO à dépenser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indice de sortie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le numéro d&#8217;index de l&#8217;UTXO à dépenser, le premier est 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1–9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille du script de déverrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur du script de déverrouillage en octets, à suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Déverrouillage-Script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un script remplissant les conditions du script de verrouillage UTXO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numéro de séquence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Généralement défini sur 0xFFFFFFFF pour désactiver BIP 125 et BIP 68</p></td>
</tr>
</tbody>
</table>
<table id="table_8-2" class="tableblock frame-all grid-all stretch data-line-316">
<caption class="title">Table 2. La structure d&#8217;une entrée de transaction coinbase</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tous les bits sont à zéro : pas une référence de hachage de transaction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indice de sortie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tous les bits sont des uns : 0xFFFFFFFF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1–9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille des données coinbase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur des données coinbase, de 2 à 100 octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Données coinbase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Données arbitraires utilisées pour les nonce supplémentaires et les balises minières. Dans les blocs v2 ; doit commencer par la hauteur du bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numéro de séquence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Réglé sur 0xFFFFFFFF</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-325">
<p>Dans une transaction coinbase, les deux premiers champs sont définis sur des valeurs qui ne représentent pas une référence UTXO. Au lieu d&#8217;un "hachage de transaction", le premier champ est rempli de 32 octets tous mis à zéro. "L&#8217;index de sortie" est rempli de 4 octets tous mis à 0xFF (255 décimal). Le "script de déverrouillage" (scriptSig) est remplacé par les données coinbase, un champ de données utilisé par les mineurs, comme nous le verrons ensuite.</p>
</div>
</div>
<div class="sect3 data-line-327">
<h4 id="_données_coinbase">Données coinbase</h4>
<div class="paragraph data-line-329">
<p>Les transactions coinbase n&#8217;ont pas de champ de script de déverrouillage (aka, scriptSig). Au lieu de cela, ce champ est remplacé par des données coinbase, qui doivent être comprises entre 2 et 100 octets. À l&#8217;exception des premiers octets, le reste des données de coinbase peut être utilisé par les mineurs comme ils le souhaitent ; ce sont des données arbitraires.</p>
</div>
<div class="paragraph data-line-331">
<p>Dans le bloc de genèse, par exemple, Satoshi Nakamoto a ajouté le texte "The Times 03/Jan/2009 Chancellor on bound of second bailout for banks" dans les données coinbase, l&#8217;utilisant comme preuve de la date et pour transmettre un message. Actuellement, les mineurs utilisent les données coinbase pour inclure des valeurs nonce supplémentaires et des chaînes identifiant le bassin de minage.</p>
</div>
<div class="paragraph data-line-333">
<p>Les premiers octets de la coinbase étaient auparavant arbitraires, mais ce n&#8217;est plus le cas. Conformément à BIP-34, les blocs de version 2 (blocs avec le champ de version défini sur 2) doivent contenir l&#8217;index de hauteur de bloc en tant qu&#8217;opération "push" (pousser) de script au début du champ coinbase.</p>
</div>
<div class="paragraph data-line-335">
<p>Dans le bloc 277 316, nous voyons que le coinbase (voir <a href="#generation_tx_example">Transaction coinbase</a>), qui se trouve dans le script de déverrouillage ou le champ scriptSig de l&#8217;entrée de transaction, contient la valeur hexadécimale 03443b0403858402062f503253482f. Décodons cette valeur.</p>
</div>
<div class="paragraph data-line-337">
<p>Le premier octet, 03, indique au moteur d&#8217;exécution de script de pousser les trois octets suivants sur la pile de script (voir <a href="#tx_script_ops_table_pushdata">[tx_script_ops_table_pushdata]</a>). Les trois octets suivants, 0x443b04, sont la hauteur de bloc encodée au format little-endian (petit-boutiste, octet le moins significatif en premier). Inversez l&#8217;ordre des octets et le résultat est 0x043b44, soit 277 316 en décimal.</p>
</div>
<div class="paragraph data-line-339">
<p>Les quelques chiffres hexadécimaux suivants (0385840206) sont utilisés pour coder un <em>nonce</em> supplémentaire (voir <a href="#extra_nonce">La solution nonce (nombre aléatoire) supplémentaire</a>), ou valeur aléatoire, utilisée pour trouver une solution de preuve de travail appropriée.</p>
</div>
<div class="paragraph data-line-341">
<p>La partie finale de la donnée coinbase (2f503253482f) est une chaîne de caractères ASCII encodées <span class="keep-together"><code>/P2SH/</code></span>, ce qui indique que le nœud de minage qui a miné ce bloc prend en charge l&#8217;amélioration P2SH définie dans BIP-16. L&#8217;introduction de la capacité P2SH a nécessité une signalisation par les mineurs pour approuver le BIP-16 ou le BIP-17. Ceux qui approuvaient la mise en œuvre du BIP-16 devaient inclure la chaîne /P2SH/ dans leurs données coinbase. Ceux qui approuvaient l&#8217;implémentation BIP-17 de P2SH devaient inclure la chaîne p2sh/CHV dans leurs données coinbase. Enfin, le BIP-16 a été élu vainqueur, et de nombreux mineurs ont continué à inclure la chaîne /P2SH/ dans leur coinbase pour indiquer qu&#8217;ils prennent en charge cette fonctionnalité.</p>
</div>
<div class="paragraph data-line-343">
<p><a href="#satoshi_words">Extraire les données coinbase du bloc genesis</a> utilise la bibliothèque libbitcoin introduite dans <a href="#alt_libraries">[alt_libraries]</a> pour extraire les données coinbase du bloc de genèse, affichant le message de Satoshi. Notez que la bibliothèque libbitcoin contient une copie statique du bloc de genèse, de sorte que l&#8217;exemple de code peut récupérer le bloc de genèse directement à partir de la bibliothèque.</p>
</div>
<div id="satoshi_words" class="exampleblock data-line-347">
<div class="title">Example 6. Extraire les données coinbase du bloc genesis</div>
<div class="content">
<div class="listingblock data-line-349">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">/*
  Display the genesis block message by Satoshi.
*/
#include &lt;iostream&gt;
#include &lt;bitcoin/bitcoin.hpp&gt;

int main()
{
    // Create genesis block.
    bc::chain::block block = bc::chain::block::genesis_mainnet();
    // Genesis block contains a single coinbase transaction.
    assert(block.transactions().size() == 1);
    // Get first transaction in block (coinbase).
    const bc::chain::transaction&amp; coinbase_tx = block.transactions()[0];
    // Coinbase tx has a single input.
    assert(coinbase_tx.inputs().size() == 1);
    const bc::chain::input&amp; coinbase_input = coinbase_tx.inputs()[0];
    // Convert the input script to its raw format.
    const auto prefix = false;
    const bc::data_chunk&amp; raw_message = coinbase_input.script().to_data(prefix);
    // Convert this to a std::string.
    std::string message(raw_message.begin(), raw_message.end());
    // Display the genesis block message.
    std::cout &lt;&lt; message &lt;&lt; std::endl;
    return 0;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-354">
<p>Nous compilons le code avec le compilateur GNU C++ et exécutons l&#8217;exécutable résultant, comme indiqué dans <a href="#satoshi_words_run">Compilation et exécution de l&#8217;exemple de code satoshi-words</a>.</p>
</div>
<div id="satoshi_words_run" class="exampleblock data-line-358">
<div class="title">Example 7. Compilation et exécution de l&#8217;exemple de code satoshi-words</div>
<div class="content">
<div class="listingblock data-line-360">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Compiler le code
$  g++ -o satoshi-words satoshi-words.cpp $(pkg-config --cflags --libs libbitcoin)
# Lancer l'exécutable
$ ./satoshi-words
^D��&lt;GS&gt;^A^DEThe Times 03/Jan/2009 Chancellor on brink of second bailout for banks</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-369">
<h3 id="_construction_de_len_tête_de_bloc">Construction de l&#8217;en-tête de bloc</h3>
<div class="paragraph data-line-371">
<p> Pour construire l&#8217;en-tête de bloc, le nœud d&#8217;exploration de données doit remplir six champs, comme indiqué dans <a href="#block_header_structure_ch10">La structure de l&#8217;entête du bloc</a>.</p>
</div>
<table id="block_header_structure_ch10" class="tableblock frame-all grid-all stretch data-line-376">
<caption class="title">Table 3. La structure de l&#8217;entête du bloc</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un numéro de version pour suivre les mises à niveau du logiciel/protocole</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de bloc précédent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Une référence au hachage du bloc précédent (parent) dans la chaîne</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Racine de Merkle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un hachage de la racine de l&#8217;arbre de Merkle des transactions de ce bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Horodatage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le temps de création approximatif de ce bloc (secondes à partir d&#8217;Unix Epoch)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La cible de l&#8217;algorithme de preuve de travail pour ce bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un compteur utilisé pour l&#8217;algorithme de preuve de travail</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-386">
<p>Au moment où le bloc 277 316 a été miné, le numéro de version décrivant la structure du bloc est la version 2, qui est codée au format petit-boutiste sur 4 octets sous la forme 0x02000000.</p>
</div>
<div class="paragraph data-line-388">
<p>Ensuite, le nœud de minage doit ajouter le "Previous Block Hash" (hachage de bloc précédent, également appelé prevhash). C&#8217;est le hachage de l&#8217;en-tête de bloc du bloc 277,315, le bloc précédent reçu du réseau, que le nœud de Jing a accepté et sélectionné comme <em>parent</em> du bloc candidat 277,316. Le hachage d&#8217;en-tête de bloc pour le bloc 277 315 est :</p>
</div>
<div class="listingblock data-line-390">
<div class="content">
<pre>0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569</pre>
</div>
</div>
<div class="admonitionblock tip data-line-395">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-396">
<p>En sélectionnant le bloc <em>parent</em> spécifique, indiqué par le champ Hash du bloc précédent dans l&#8217;en-tête du bloc candidat, Jing engage sa puissance minière à étendre la chaîne qui se termine dans ce bloc spécifique. En substance, c&#8217;est ainsi que Jing "vote" avec son pouvoir minier pour la chaîne valide la plus longue.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-399">
<p>L&#8217;étape suivante consiste à résumer toutes les transactions avec un arbre de Merkle, afin d&#8217;ajouter la racine de Merkle à la en-tête de bloc. La transaction coinbase est répertoriée comme la première transaction du bloc. Ensuite, 418 transactions supplémentaires sont ajoutées après, pour un total de 419 transactions dans le bloc. Comme nous l&#8217;avons vu dans le <a href="#merkle_trees">[merkle_trees]</a>, il doit y avoir un nombre pair de nœuds "feuilles" dans l&#8217;arbre, donc la dernière transaction est dupliquée, créant 420 nœuds, chacun contenant le hachage d&#8217;une transaction. Les hachages de transaction sont ensuite combinés, par paires, créant chaque niveau de l&#8217;arbre, jusqu&#8217;à ce que toutes les transactions soient résumées en un nœud à la "racine" de l&#8217;arbre. La racine de l&#8217;arborescence de Merkle résume toutes les transactions en une seule valeur de 32 octets, que vous pouvez voir répertoriée comme "racine de Merkle" dans <a href="#block277316">Utiliser la ligne de commande pour récupérer le bloc 277,316</a>, et ici :</p>
</div>
<div class="listingblock data-line-401">
<div class="content">
<pre>c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e</pre>
</div>
</div>
<div class="paragraph data-line-405">
<p>Le nœud minier de Jing ajoutera alors un horodatage de 4 octets, codé comme un horodatage "d&#8217;époque" Unix, qui est basé sur le nombre de secondes écoulées depuis minuit UTC, le jeudi 1er janvier 1970. L&#8217;heure 1388185914 est égale à vendredi , 27 décembre 2013, 23:11:54 UTC.</p>
</div>
<div class="paragraph data-line-407">
<p>Le nœud de Jing remplit ensuite la cible, qui définit la preuve de travail requise pour en faire un bloc valide. La cible est stockée dans le bloc en tant que métrique de "bits cibles", qui est un codage d&#8217;exposant de mantisse de la cible. Le codage a un exposant de 1 octet, suivi d&#8217;une mantisse de 3 octets (coefficient). Dans le bloc 277 316, par exemple, la valeur des bits cibles est 0x1903a30c. La première partie 0x19 est un exposant hexadécimal, tandis que la partie suivante, 0x03a30c, est le coefficient. Le concept de cible est expliqué dans <a href="#target">Reciblage pour ajuster la difficulté</a> et la représentation des "bits cibles" est expliquée dans <a href="#target_bits">Représentation cible</a>.</p>
</div>
<div class="paragraph data-line-409">
<p>Le dernier champ est le nonce, qui est initialisé à zéro.</p>
</div>
<div class="paragraph data-line-411">
<p>Une fois tous les autres champs remplis, l&#8217;en-tête du bloc est maintenant terminé et le processus d&#8217;extraction peut commencer. L&#8217;objectif est maintenant de trouver une valeur pour le nonce qui se traduit par un hachage d&#8217;en-tête de bloc égal ou inférieur à la cible. Le nœud de minage devra tester des milliards ou des billions de valeurs de nonce avant de trouver un nonce qui réponde à l&#8217;exigence.</p>
</div>
</div>
<div class="sect2 data-line-413">
<h3 id="_miner_le_bloc">Miner le bloc</h3>
<div class="paragraph data-line-415">
<p>Maintenant qu&#8217;un bloc candidat a été construit par le nœud de Jing, il est temps pour la plate-forme de minage matériel de Jing de "miner" le bloc, pour trouver une solution à l&#8217;algorithme de preuve de travail qui rend le bloc valide. Tout au long de ce livre, nous avons étudié les fonctions de hachage cryptographique utilisées dans divers aspects du système Bitcoin. La fonction de hachage SHA256 est la fonction utilisée dans le processus d&#8217;extraction de bitcoin.</p>
</div>
<div class="paragraph data-line-417">
<p> Dans les termes les plus simples, le minage est le processus de hachage répété de l&#8217;en-tête de bloc, en modifiant un paramètre, jusqu&#8217;à ce que le hachage résultant corresponde à une cible spécifique. Le résultat de la fonction de hachage ne peut pas être déterminé à l&#8217;avance, pas plus qu&#8217;un modèle ne peut être créé qui produira une valeur de hachage spécifique. Cette caractéristique des fonctions de hachage signifie que la seule façon de produire un résultat de hachage correspondant à une cible spécifique est d&#8217;essayer encore et encore, en modifiant de manière aléatoire l&#8217;entrée jusqu&#8217;à ce que le résultat de hachage souhaité apparaisse par hasard.</p>
</div>
<div class="sect3 data-line-419">
<h4 id="_algorithme_de_preuve_de_travail">Algorithme de preuve de travail</h4>
<div class="paragraph data-line-421">
<p>Un algorithme de hachage prend une entrée de données de longueur arbitraire et produit un résultat déterministe de longueur fixe, c-à-d une empreinte numérique de l&#8217;entrée. Pour toute entrée spécifique, le hachage résultant sera toujours le même et peut être facilement calculé et vérifié par toute personne mettant en œuvre le même algorithme de hachage. La principale caractéristique d&#8217;un algorithme de hachage cryptographique est qu&#8217;il est impossible de trouver deux entrées différentes qui produisent la même empreinte digitale (appelée <em>collision</em>). En corollaire, il est également pratiquement impossible de sélectionner une entrée de manière à produire une empreinte digitale souhaitée, autrement qu&#8217;en essayant des entrées aléatoires.</p>
</div>
<div class="paragraph data-line-423">
<p>Avec SHA256, la sortie a toujours une longueur de 256 bits, quelle que soit la taille de l&#8217;entrée. Dans <a href="#sha256_example1">Exemple SHA256</a>, nous utiliserons l&#8217;interpréteur Python pour calculer le hachage SHA256 de la phrase "Je suis Satoshi Nakamoto".</p>
</div>
<div id="sha256_example1" class="exampleblock data-line-427">
<div class="title">Example 8. Exemple SHA256</div>
<div class="content">
<div class="listingblock data-line-429">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python</code></pre>
</div>
</div>
<div class="listingblock data-line-433">
<div class="content">
<pre class="highlight"><code class="language-pycon" data-lang="pycon">Python 3.7.3
&gt;&gt;&gt; import hashlib
&gt;&gt;&gt; hashlib.sha256(b"I am Satoshi Nakamoto").hexdigest()
'5d7c7ba21cbbcd75d14800b100252d5b428e5b1213d27c385bc141ca6b47989e'</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-441">
<p><a href="#sha256_example1">Exemple SHA256</a> montre le résultat du calcul du hachage de "Je suis Satoshi Nakamoto" : 5d7c7ba21cbbcd75d14800b100252d5b428e5b1213d27c385bc141ca6b47989e. Ce nombre de 256 bits est le résultat de <em>hachage</em> ou <em>prétraitement</em> de la phrase et dépend de chaque partie de la phrase. L&#8217;ajout d&#8217;une seule lettre, d&#8217;un signe de ponctuation ou de tout autre caractère produira un hachage différent.</p>
</div>
<div class="paragraph data-line-443">
<p>Maintenant, si nous changeons la phrase, nous devrions nous attendre à voir des hachages complètement différents. Essayons cela en ajoutant un nombre à la fin de notre phrase, en utilisant le script Python simple dans <a href="#sha256_example_generator">Script SHA256 pour générer de nombreux hachages en itérant sur un nonce</a>.</p>
</div>
<div id="sha256_example_generator" class="exampleblock data-line-447">
<div class="title">Example 9. Script SHA256 pour générer de nombreux hachages en itérant sur un nonce</div>
<div class="content">
<div class="listingblock c_less_space data-line-450">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># example of iterating a nonce in a hashing algorithm's input

import hashlib
    
text = "I am Satoshi Nakamoto"

# iterate nonce from 0 to 19
for nonce in xrange(20): 
    
    # add the nonce to the end of the text
    input = text + str(nonce) 
     
    # calculate the SHA-256 hash of the input (text+nonce)
    hash = hashlib.sha256(input).hexdigest() 
    
    # show the input and hash result
    print input, '=&gt;',  hash </code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-455">
<p>L&#8217;exécution de ceci produira les hachages de plusieurs phrases, rendues différentes en ajoutant un nombre à la fin du texte. En incrémentant le nombre, nous pouvons obtenir différents hachages, comme indiqué dans <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour générer de nombreux hachages en itérant sur un nombre aléatoire</a>.</p>
</div>
<div id="sha256_example_generator_output" class="exampleblock data-line-459">
<div class="title">Example 10. Sortie SHA256 d&#8217;un script pour générer de nombreux hachages en itérant sur un nombre aléatoire</div>
<div class="content">
<div class="listingblock data-line-461">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python hash_example.py</code></pre>
</div>
</div>
<div class="listingblock data-line-465">
<div class="content">
<pre>I am Satoshi Nakamoto0 =&gt; a80a81401765c8eddee25df36728d732...
I am Satoshi Nakamoto1 =&gt; f7bc9a6304a4647bb41241a677b5345f...
I am Satoshi Nakamoto2 =&gt; ea758a8134b115298a1583ffb80ae629...
I am Satoshi Nakamoto3 =&gt; bfa9779618ff072c903d773de30c99bd...
I am Satoshi Nakamoto4 =&gt; bce8564de9a83c18c31944a66bde992f...
I am Satoshi Nakamoto5 =&gt; eb362c3cf3479be0a97a20163589038e...
I am Satoshi Nakamoto6 =&gt; 4a2fd48e3be420d0d28e202360cfbaba...
I am Satoshi Nakamoto7 =&gt; 790b5a1349a5f2b909bf74d0d166b17a...
I am Satoshi Nakamoto8 =&gt; 702c45e5b15aa54b625d68dd947f1597...
I am Satoshi Nakamoto9 =&gt; 7007cf7dd40f5e933cd89fff5b791ff0...
I am Satoshi Nakamoto10 =&gt; c2f38c81992f4614206a21537bd634a...
I am Satoshi Nakamoto11 =&gt; 7045da6ed8a914690f087690e1e8d66...
I am Satoshi Nakamoto12 =&gt; 60f01db30c1a0d4cbce2b4b22e88b9b...
I am Satoshi Nakamoto13 =&gt; 0ebc56d59a34f5082aaef3d66b37a66...
I am Satoshi Nakamoto14 =&gt; 27ead1ca85da66981fd9da01a8c6816...
I am Satoshi Nakamoto15 =&gt; 394809fb809c5f83ce97ab554a2812c...
I am Satoshi Nakamoto16 =&gt; 8fa4992219df33f50834465d3047429...
I am Satoshi Nakamoto17 =&gt; dca9b8b4f8d8e1521fa4eaa46f4f0cd...
I am Satoshi Nakamoto18 =&gt; 9989a401b2a3a318b01e9ca9a22b0f3...
I am Satoshi Nakamoto19 =&gt; cda56022ecb5b67b2bc93a2d764e75f...</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-489">
<p>Chaque phrase produit un résultat de hachage complètement différent. Ils semblent complètement aléatoires, mais vous pouvez reproduire les résultats exacts de cet exemple sur n&#8217;importe quel ordinateur avec Python et voir les mêmes hachages exacts.</p>
</div>
<div class="paragraph data-line-491">
<p>Le nombre utilisé comme variable dans un tel scénario est appelé un <em>nonce</em> (ou nombre aléatoire). Le nonce est utilisé pour faire varier la sortie d&#8217;une fonction cryptographique, dans ce cas pour faire varier l&#8217;empreinte SHA256 de la phrase.</p>
</div>
<div class="paragraph data-line-493">
<p>Pour relever le défi de cet algorithme, fixons-nous un objectif : trouver une phrase qui produit un hachage hexadécimal commençant par un zéro. Heureusement, ce n&#8217;est pas difficile ! <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour générer de nombreux hachages en itérant sur un nombre aléatoire</a> montre que la phrase "I am Satoshi Nakamoto13" produit le hash 0ebc56d59a34f5082aaef3d66b37a661696c2b618e62432727216ba9531041a5, ce qui correspond à nos critères. Il a fallu 13 tentatives pour le trouver. En termes de probabilités, si la sortie de la fonction de hachage est uniformément distribuée, nous nous attendrions à trouver un résultat avec un 0 comme préfixe hexadécimal une fois tous les 16 hachages (un sur 16 chiffres hexadécimaux de 0 à F). En termes numériques, cela signifie trouver une valeur de hachage inférieure à 0x100000000000000000000000000000000000000000000000000000000000. Nous appelons ce seuil la <em>cible</em> et le but est de trouver un hachage qui est numériquement égal ou inférieur à la cible. Si nous diminuons la cible, la tâche de trouver un hachage inférieur à la cible devient de plus en plus difficile.</p>
</div>
<div class="paragraph data-line-495">
<p>Pour donner une analogie simple, imaginez un jeu où les joueurs lancent une paire de dés à plusieurs reprises, en essayant de lancer autant ou moins qu&#8217;une cible spécifiée. Au premier tour, l&#8217;objectif est de 11. À moins que vous ne lanciez un double-six, vous gagnez. Au tour suivant, l&#8217;objectif est de 10. Les joueurs doivent lancer 10 ou moins pour gagner, encore une fois une tâche facile. Disons que quelques tours plus tard, l&#8217;objectif est tombé à 5. Maintenant, plus de la moitié des lancers de dés dépasseront l&#8217;objectif et seront donc invalides. Il faut exponentiellement plus de lancers de dés pour gagner, plus la cible est basse. Finalement, lorsque l&#8217;objectif est de 2 (le minimum possible), un seul lancer sur 36, soit 2 % d&#8217;entre eux, produira un résultat gagnant.</p>
</div>
<div class="paragraph data-line-497">
<p>Du point de vue d&#8217;un observateur qui sait que la cible du jeu de dés est 2, si quelqu&#8217;un a réussi à lancer un lancer gagnant, on peut supposer qu&#8217;il a tenté, en moyenne, 36 lancers. En d&#8217;autres termes, on peut estimer la quantité de travail nécessaire pour réussir à partir de la difficulté imposée par la cible. Lorsque l&#8217;algorithme est basé sur une fonction déterministe telle que SHA256, l&#8217;entrée elle-même constitue la <em>preuve</em> qu&#8217;une certaine quantité de <em>travail</em> a été effectuée pour produire un résultat égal ou inférieur à la cible. Par conséquent, la <em>Preuve de travail</em>.</p>
</div>
<div class="admonitionblock tip data-line-500">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-501">
<p>Même si chaque tentative produit un résultat aléatoire, la probabilité de tout résultat possible peut être calculée à l&#8217;avance. Par conséquent, un résultat d&#8217;une difficulté spécifiée constitue la preuve d&#8217;une quantité de travail spécifique.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-504">
<p>Dans <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour générer de nombreux hachages en itérant sur un nombre aléatoire</a>, le "nonce" gagnant est 13 et ce résultat peut être confirmé par n&#8217;importe qui indépendamment. N&#8217;importe qui peut ajouter le nombre 13 comme suffixe à la phrase "Je suis Satoshi Nakamoto" et calculer le hachage, en vérifiant qu&#8217;il est inférieur à la cible. Le résultat réussi est également une preuve de travail, car cela prouve que nous avons fait le travail pour trouver ce nonce. Alors qu&#8217;il ne faut qu&#8217;un seul calcul de hachage pour vérifier, il nous a fallu 13 calculs de hachage pour trouver un nonce qui a fonctionné. Si nous avions une cible inférieure (difficulté plus élevée), il faudrait beaucoup plus de calculs de hachage pour trouver un nonce approprié, mais un seul calcul de hachage pour que quiconque puisse le vérifier. De plus, en connaissant la cible, n&#8217;importe qui peut estimer la difficulté à l&#8217;aide de statistiques et donc savoir combien de travail a été nécessaire pour trouver un tel nonce.</p>
</div>
<div class="admonitionblock tip data-line-507">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-508">
<p>La preuve de travail doit produire un hachage qui est <em>égal ou inférieur à</em> la cible. Une cible plus élevée signifie qu&#8217;il est moins difficile de trouver un hachage égal ou inférieur à la cible. Une cible inférieure signifie qu&#8217;il est plus difficile de trouver un hachage égal ou inférieur à la cible. La cible et la difficulté sont inversement liées.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-512">
<p> La preuve de travail de Bitcoin est très similaire au défi présenté dans <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour générer de nombreux hachages en itérant sur un nombre aléatoire</a>. Le mineur construit un bloc candidat rempli de transactions. Ensuite, le mineur calcule le hachage de l&#8217;en-tête de ce bloc et voit s&#8217;il est égal ou inférieur à la <em>cible</em> actuelle. Si le hachage est supérieur à la cible, le mineur modifiera le nonce (généralement en l&#8217;incrémentant simplement de un) et réessayera. À la difficulté actuelle du réseau Bitcoin, les mineurs doivent essayer des quadrillions de fois avant de trouver un nonce qui se traduit par un hachage d&#8217;en-tête de bloc suffisamment bas.</p>
</div>
<div class="paragraph data-line-514">
<p>Un algorithme de preuve de travail très simplifié est implémenté en Python dans <a href="#pow_example1">Mise en œuvre simplifiée de la preuve de travail</a>.</p>
</div>
<div id="pow_example1" class="exampleblock data-line-518">
<div class="title">Example 11. Mise en œuvre simplifiée de la preuve de travail</div>
<div class="content">
<div class="listingblock data-line-520">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# example of proof-of-work algorithm

import hashlib
import time

max_nonce = 2 ** 32 # 4 billion

def proof_of_work(header, difficulty_bits):
    
    # calculate the difficulty target
    target = 2 ** (256-difficulty_bits)
    
    for nonce in xrange(max_nonce):
        hash_result = hashlib.sha256(str(header)+str(nonce)).hexdigest()
        
        # check if this is a valid result, below the target
        if long(hash_result, 16) &lt; target:
            print "Success with nonce %d" % nonce
            print "Hash is %s" % hash_result
            return (hash_result,nonce)
            
    print "Failed after %d (max_nonce) tries" % nonce
    return nonce

    
if __name__ == '__main__':
    
    nonce = 0
    hash_result = ''
     
    # difficulty from 0 to 31 bits  
    for difficulty_bits in xrange(32):
        
        difficulty = 2 ** difficulty_bits
        print "Difficulty: %ld (%d bits)" % (difficulty, difficulty_bits)
    
        print "Starting search..."
        
        # checkpoint the current time
        start_time = time.time()
        
        # make a new block which includes the hash from the previous block
        # we fake a block of transactions - just a string
        new_block = 'test block with transactions' + hash_result 
        
        # find a valid nonce for the new block
        (hash_result, nonce) = proof_of_work(new_block, difficulty_bits) 
        
        # checkpoint how long it took to find a result
        end_time = time.time()
        
        elapsed_time = end_time - start_time
        print "Elapsed Time: %.4f seconds" % elapsed_time
    
        if elapsed_time &gt; 0:
            
            # estimate the hashes per second
            hash_power = float(long(nonce)/elapsed_time)
            print "Hashing Power: %ld hashes per second" % hash_power</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-525">
<p>En exécutant ce code, vous pouvez définir la difficulté souhaitée (en bits, combien de bits de tête doivent être nuls) et voir combien de temps il faut à votre ordinateur pour trouver une solution. Dans <a href="#pow_example_outputs">Exécution de l&#8217;exemple de preuve de travail pour diverses difficultés</a>, vous pouvez voir comment cela fonctionne sur un ordinateur portable moyen.</p>
</div>
<div id="pow_example_outputs" class="exampleblock data-line-529">
<div class="title">Example 12. Exécution de l&#8217;exemple de preuve de travail pour diverses difficultés</div>
<div class="content">
<div class="listingblock data-line-531">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python proof-of-work-example.py*</code></pre>
</div>
</div>
<div class="listingblock data-line-535">
<div class="content">
<pre>Difficulty: 1 (0 bits)

[...]

Difficulty: 8 (3 bits)
Starting search...
Success with nonce 9
Hash is 1c1c105e65b47142f028a8f93ddf3dabb9260491bc64474738133ce5256cb3c1
Elapsed Time: 0.0004 seconds
Hashing Power: 25065 hashes per second
Difficulty: 16 (4 bits)
Starting search...
Success with nonce 25
Hash is 0f7becfd3bcd1a82e06663c97176add89e7cae0268de46f94e7e11bc3863e148
Elapsed Time: 0.0005 seconds
Hashing Power: 52507 hashes per second
Difficulty: 32 (5 bits)
Starting search...
Success with nonce 36
Hash is 029ae6e5004302a120630adcbb808452346ab1cf0b94c5189ba8bac1d47e7903
Elapsed Time: 0.0006 seconds
Hashing Power: 58164 hashes per second

[...]

Difficulty: 4194304 (22 bits)
Starting search...
Success with nonce 1759164
Hash is 0000008bb8f0e731f0496b8e530da984e85fb3cd2bd81882fe8ba3610b6cefc3
Elapsed Time: 13.3201 seconds
Hashing Power: 132068 hashes per second
Difficulty: 8388608 (23 bits)
Starting search...
Success with nonce 14214729
Hash is 000001408cf12dbd20fcba6372a223e098d58786c6ff93488a9f74f5df4df0a3
Elapsed Time: 110.1507 seconds
Hashing Power: 129048 hashes per second
Difficulty: 16777216 (24 bits)
Starting search...
Success with nonce 24586379
Hash is 0000002c3d6b370fccd699708d1b7cb4a94388595171366b944d68b2acce8b95
Elapsed Time: 195.2991 seconds
Hashing Power: 125890 hashes per second

[...]

Difficulty: 67108864 (26 bits)
Starting search...
Success with nonce 84561291
Hash is 0000001f0ea21e676b6dde5ad429b9d131a9f2b000802ab2f169cbca22b1e21a
Elapsed Time: 665.0949 seconds
Hashing Power: 127141 hashes per second</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-591">
<p>Comme vous pouvez le constater, augmenter la difficulté de 1 bit entraîne un doublement du temps nécessaire pour trouver une solution. Si vous pensez à l&#8217;ensemble de l&#8217;espace numérique de 256 bits, chaque fois que vous contraignez un bit de plus à zéro, vous réduisez l&#8217;espace de recherche de moitié. Dans <a href="#pow_example_outputs">Exécution de l&#8217;exemple de preuve de travail pour diverses difficultés</a>, il faut 84 millions de tentatives de hachage pour trouver un nonce qui produit un hachage avec 26 bits de tête en zéro. Même à une vitesse de plus de 120 000 hachages par seconde, il faut tout de même 10 minutes sur un portable pour trouver cette solution.</p>
</div>
<div class="paragraph data-line-593">
<p>Au moment de la rédaction, le réseau tente de trouver un bloc dont le hachage d&#8217;en-tête est égal ou inférieur à :</p>
</div>
<div class="listingblock data-line-595">
<div class="content">
<pre>0000000000000000029AB900000000000000000000000000000000000000000</pre>
</div>
</div>
<div class="paragraph data-line-599">
<p>Comme vous pouvez le voir, il y a beaucoup de zéros au début de cette cible, ce qui signifie que la plage acceptable de hachages est beaucoup plus petite, il est donc plus difficile de trouver un hachage valide. Il faudra en moyenne plus de 1,8 zêta de hachages (mille milliards de milliards de hachages) pour que le réseau découvre le bloc suivant. Cela semble être une tâche impossible, mais heureusement, le réseau apporte 3 exa-hachages par seconde (EH/sec) de puissance de traitement, ce qui permettra de trouver un bloc en environ 10 minutes en moyenne.</p>
</div>
</div>
<div class="sect3 data-line-602">
<h4 id="target_bits">Représentation cible</h4>
<div class="paragraph data-line-604">
<p>Dans <a href="#block277316">Utiliser la ligne de commande pour récupérer le bloc 277,316</a>, nous avons vu que le bloc contient la cible, dans une notation appelée "bits cible" ou simplement "bits", qui dans le bloc 277 316 a la valeur 0x1903a30c. Cette notation exprime la cible de preuve de travail sous la forme d&#8217;un format coefficient/exposant, avec les deux premiers chiffres hexadécimaux pour l&#8217;exposant et les six chiffres hexadécimaux suivants pour le coefficient. Dans ce bloc, par conséquent, l&#8217;exposant est 0x19 et le coefficient est 0x03a30c.</p>
</div>
<div class="paragraph data-line-606">
<p>La formule pour calculer la cible de difficulté à partir de cette représentation est :</p>
</div>
<ul class="simplelist">
  <li>cible = coefficient * 2 <sup>(8*(exposant–3))</sup></li>
</ul>
<div class="paragraph data-line-614">
<p>En utilisant cette formule et la valeur des bits de difficulté 0x1903a30c, nous obtenons :</p>
</div>
<ul class="simplelist">
  <li>cible = 0x03a30c * 2 <sup>0x08*(0x19-0x03)</sup></li>
  <li>=&gt; cible = 0x03a30c * 2 <sup>(0x08*0x16)</sup></li>
  <li>=&gt; cible = 0x03a30c * 2 <sup>0xB0</sup></li>
</ul>
<div class="paragraph data-line-624">
<p>qui en décimal est :</p>
</div>
<ul class="simplelist">
  <li>=&gt; cible = 238 348 * 2 <sup>176</sup></li>
  <li>=&gt; cible =<br/> 22 829 202 948 393 929 850 749 706 076 701 368 331 072 452 018 388 575 715 328</li>
</ul>
<div class="paragraph data-line-633">
<p>retour en hexadécimal :</p>
</div>
<ul class="simplelist">
  <li>=&gt; cible =<br/> 0x0000000000000003A30C000000000000000000000000000000000000000000</li>
</ul>
<div class="paragraph data-line-641">
<p>Cela signifie qu&#8217;un bloc valide pour la hauteur 277 316 est celui qui a un hachage d&#8217;en-tête de bloc inférieur à cette cible. En binaire, ce nombre doit avoir plus de 60 bits de tête mis à zéro. Avec ce niveau de difficulté, un seul mineur traitant 1 billion de hachages par seconde (1 terahash par seconde ou 1 TH/sec) ne trouverait une solution qu&#8217;une fois tous les 8 496 blocs ou une fois tous les 59 jours, en moyenne.</p>
</div>
</div>
<div class="sect3 data-line-644">
<h4 id="target">Reciblage pour ajuster la difficulté</h4>
<div class="paragraph data-line-646">
<p> Comme nous l&#8217;avons vu, la cible détermine la difficulté et affecte donc le temps qu&#8217;il faut pour trouver une solution à l&#8217;algorithme de preuve de travail. Cela conduit à des questions évidentes : pourquoi la difficulté est-elle ajustable, qui l&#8217;ajuste et comment ?</p>
</div>
<div class="paragraph data-line-648">
<p>Les blocs de Bitcoin sont générés toutes les 10 minutes, en moyenne. C&#8217;est le battement de cœur de bitcoin et sous-tend la fréquence d&#8217;émission de devises et la rapidité de règlement des transactions. Il doit rester constant non seulement à court terme, mais sur une période de plusieurs décennies. Au cours de cette période, on s&#8217;attend à ce que la puissance des ordinateurs continue d&#8217;augmenter à un rythme rapide. De plus, le nombre de participants à l&#8217;exploitation minière et les ordinateurs qu&#8217;ils utilisent changeront également constamment. Pour maintenir le temps de génération de bloc à 10 minutes, la difficulté de minage doit être ajustée pour tenir compte de ces changements. En fait, la cible de preuve de travail est un paramètre dynamique qui est périodiquement ajusté pour atteindre un objectif d&#8217;intervalle de bloc de 10 minutes. En termes simples, l&#8217;objectif est défini de sorte que la puissance minière actuelle se traduise par un intervalle de bloc de 10 minutes.</p>
</div>
<div class="paragraph data-line-650">
<p>Comment, alors, un tel ajustement s&#8217;effectue-t-il dans un réseau totalement décentralisé ? Le reciblage se produit automatiquement et sur chaque nœud indépendamment. Tous les 2 016 blocs, tous les nœuds reciblent la preuve de travail. L&#8217;équation de reciblage mesure le temps qu&#8217;il a fallu pour trouver les 2 016 derniers blocs et le compare au temps prévu de 20 160 minutes (2 016 blocs multipliés par l&#8217;intervalle de bloc de 10 minutes souhaité). Le rapport entre la durée réelle et la durée souhaitée est calculé et un ajustement proportionnel (à la hausse ou à la baisse) est apporté à la cible. En termes simples : si le réseau trouve des blocs plus rapidement que toutes les 10 minutes, la difficulté augmente (la cible diminue). Si la découverte de blocs est plus lente que prévu, la difficulté diminue (la cible augmente).</p>
</div>
<div class="paragraph data-line-652">
<p>L&#8217;équation peut se résumer ainsi :</p>
</div>
<div class="listingblock data-line-654">
<div class="content">
<pre>Nouvel objectif = Ancien objectif * (Heure réelle des 2016 derniers blocs / 20160 minutes)</pre>
</div>
</div>
<div class="paragraph data-line-658">
<p><a href="#retarget_code">Reciblage de la preuve de travail avec CalculateNextWorkRequired() dans pow.cpp</a> montre le code utilisé dans le client Bitcoin Core.</p>
</div>
<div id="retarget_code" class="exampleblock data-line-662">
<div class="title">Example 13. Reciblage de la preuve de travail avec CalculateNextWorkRequired() dans pow.cpp</div>
<div class="content">
<div class="listingblock data-line-664">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">   // Limiter le pas de réglage
    int64_t nActualTimespan = pindexLast-&gt;GetBlockTime() - nFirstBlockTime;
    LogPrintf("  nActualTimespan = %d  before bounds\n", nActualTimespan);
    if (nActualTimespan &lt; params.nPowTargetTimespan/4)
        nActualTimespan = params.nPowTargetTimespan/4;
    if (nActualTimespan &gt; params.nPowTargetTimespan*4)
        nActualTimespan = params.nPowTargetTimespan*4;

    // Recibler
    const arith_uint256 bnPowLimit = UintToArith256(params.powLimit);
    arith_uint256 bnNew;
    arith_uint256 bnOld;
    bnNew.SetCompact(pindexLast-&gt;nBits);
    bnOld = bnNew;
    bnNew *= nActualTimespan;
    bnNew /= params.nPowTargetTimespan;

    if (bnNew &gt; bnPowLimit)
        bnNew = bnPowLimit;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note data-line-690">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-691">
<p>Bien que l&#8217;étalonnage cible se produise tous les 2 016 blocs, en raison d&#8217;une erreur de un par un dans le client Bitcoin Core d&#8217;origine, il est basé sur le temps total des 2 015 blocs précédents (et non 2 016 comme il se doit), ce qui entraîne un biais de reciblage vers une difficulté plus élevée de 0,05 %.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-695">
<p>Les paramètres Interval (2 016 blocs) et TargetTimespan (deux semaines en 1 209 600 secondes) sont définis dans <em>chainparams.cpp</em>.</p>
</div>
<div class="paragraph data-line-697">
<p>Pour éviter une volatilité extrême de la difficulté, l&#8217;ajustement de reciblage doit être inférieur à un facteur quatre (4) par cycle. Si l&#8217;ajustement cible requis est supérieur à un facteur de quatre, il sera ajusté d&#8217;un facteur de 4 et pas plus. Tout autre ajustement sera effectué au cours de la prochaine période de reciblage, car le déséquilibre persistera au cours des 2 016 prochains blocs. Par conséquent, des écarts importants entre la puissance de hachage et la difficulté peuvent nécessiter plusieurs cycles de blocs de 2 016 pour s&#8217;équilibrer.</p>
</div>
<div class="admonitionblock tip data-line-700">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-701">
<p>La difficulté d&#8217;extraction d&#8217;un bloc de bitcoins est d&#8217;environ '10 minutes de traitement' pour l&#8217;ensemble du réseau, sur la base du temps qu&#8217;il a fallu pour extraire les 2 016 blocs précédents, ajusté tous les 2 016 blocs. Ceci est réalisé en abaissant ou en élevant la cible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-704">
<p>Notez que la cible est indépendante du nombre de transactions ou de la valeur des transactions. Cela signifie que la quantité de puissance de hachage et donc d&#8217;électricité dépensée pour sécuriser le bitcoin est également entièrement indépendante du nombre de transactions. Bitcoin peut évoluer et parvenir à une adoption plus large et rester sécurisé sans aucune augmentation de la puissance de hachage par rapport au niveau actuel. L&#8217;augmentation de la puissance de hachage représente les forces du marché alors que de nouveaux mineurs entrent sur le marché pour concourir pour la récompense. Tant qu&#8217;une puissance de hachage suffisante est sous le contrôle des mineurs agissant honnêtement à la recherche de la récompense, cela suffit pour empêcher les attaques de "prise de contrôle" et, par conséquent, il en est suffisant pour sécuriser le bitcoin.</p>
</div>
<div class="paragraph data-line-706">
<p>La difficulté du minage est étroitement liée au coût de l&#8217;électricité et au taux de change du bitcoin vis-à-vis de la monnaie utilisée pour payer l&#8217;électricité. Les systèmes de minage hautes performances sont à peu près aussi efficaces que possible avec la génération actuelle de fabrication de silicium, convertissant l&#8217;électricité en calcul de hachage au taux le plus élevé possible. La principale influence sur le marché minier est le prix d&#8217;un kilowattheure d&#8217;électricité en bitcoin, car cela détermine la rentabilité du minage et donc les incitations à entrer ou à sortir du marché minier.</p>
</div>
</div>
</div>
<div class="sect2 data-line-708">
<h3 id="_réussir_à_miner_le_bloc">Réussir à miner le bloc</h3>
<div class="paragraph data-line-710">
<p>Comme nous l&#8217;avons vu précédemment, le nœud de Jing a construit un bloc candidat et l&#8217;a préparé pour le minage. Jing possède plusieurs plates-formes de minage matériel avec des circuits intégrés spécifiques à l&#8217;application, où des centaines de milliers de circuits intégrés exécutent l&#8217;algorithme SHA256 en parallèle à des vitesses incroyables. Beaucoup de ces machines spécialisées sont connectées à son nœud minier via USB ou un réseau local. Ensuite, le nœud de minage exécuté sur le bureau de Jing transmet l&#8217;en-tête de bloc à son matériel de minage, qui commence à tester des milliards de nonces par seconde. Parce que le nonce n&#8217;est que de 32 bits, après avoir épuisé toutes les possibilités de nonce (environ 4 milliards), le matériel de minage modifie l&#8217;en-tête de bloc (en ajustant l&#8217;espace ou l&#8217;horodatage supplémentaire du nonce coinbase) et réinitialise le compteur de nonce, en testant de nouvelles combinaisons.</p>
</div>
<div class="paragraph data-line-712">
<p>Près de 11 minutes après avoir commencé à miner le bloc 277 316, l&#8217;une des machines de minage de matériel trouve une solution et la renvoie au nœud de minage.</p>
</div>
<div class="paragraph data-line-714">
<p>Lorsqu&#8217;il est inséré dans l&#8217;en-tête de bloc, le nonce 924 591 752 produit un hachage de bloc de :</p>
</div>
<div class="listingblock data-line-716">
<div class="content">
<pre>0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4</pre>
</div>
</div>
<div class="paragraph data-line-720">
<p>qui est inférieur à la cible :</p>
</div>
<div class="listingblock data-line-722">
<div class="content">
<pre>0000000000000003A30C000000000000000000000000000000000000000000</pre>
</div>
</div>
<div class="paragraph data-line-726">
<p>Immédiatement, le nœud minier de Jing transmet le bloc à tous ses pairs. Ils reçoivent, valident puis propagent le nouveau bloc. Au fur et à mesure que le bloc se répand sur le réseau, chaque nœud l&#8217;ajoute à sa propre copie de la chaîne de blocs, l&#8217;étendant à une nouvelle hauteur de 277 316 blocs. Au fur et à mesure que les nœuds miniers reçoivent et valident le bloc, ils abandonnent leurs efforts pour trouver un bloc à la même hauteur et commencent immédiatement à calculer le bloc suivant dans la chaîne, en utilisant le bloc de Jing comme "parent". En construisant sur le bloc nouvellement découvert de Jing, les autres mineurs "votent" essentiellement avec leur puissance minière et approuvent le bloc de Jing et la chaîne qu&#8217;il prolonge.</p>
</div>
<div class="paragraph data-line-728">
<p>Dans la section suivante, nous examinerons le processus utilisé par chaque nœud pour valider un bloc et sélectionner la chaîne la plus longue, créant ainsi le consensus qui forme la chaîne de blocs décentralisée.</p>
</div>
</div>
<div class="sect2 data-line-730">
<h3 id="_validation_dun_nouveau_bloc">Validation d&#8217;un nouveau bloc</h3>
<div class="paragraph data-line-732">
<p>La troisième étape du mécanisme de consensus de bitcoin est l&#8217;indépendante validation de chaque nouveau bloc par chaque nœud du réseau. Au fur et à mesure que le bloc nouvellement résolu se déplace sur le réseau, chaque nœud effectue une série de tests pour le valider avant de le propager à ses pairs. Cela garantit que seuls les blocs valides sont propagés sur le réseau. La validation indépendante garantit également que les mineurs qui agissent honnêtement obtiennent leurs blocs incorporés dans la chaîne de blocs, gagnant ainsi la récompense. Les mineurs qui agissent de manière malhonnête voient leurs blocs rejetés et non seulement perdent la récompense, mais gaspillent également les efforts déployés pour trouver une solution de preuve de travail, encourant ainsi le coût de l&#8217;électricité sans compensation.</p>
</div>
<div class="paragraph data-line-734">
<p>Lorsqu&#8217;un nœud reçoit un nouveau bloc, il valide le bloc en le comparant à une longue liste de critères qui doivent tous être remplis ; sinon, le bloc est rejeté. Ces critères peuvent être vus dans le client Bitcoin Core dans les fonctions CheckBlock et CheckBlockHeader et incluent :</p>
</div>
<div class="ulist data-line-736">
<ul>
<li class="data-line-736">
<p>La structure de données du bloc est syntaxiquement valide</p>
</li>
<li class="data-line-737">
<p>Le hachage de l&#8217;en-tête de bloc est égal ou inférieur à la cible (applique la preuve de travail)</p>
</li>
<li class="data-line-738">
<p>L&#8217;horodatage du bloc est inférieur à deux heures dans le futur (en tenant compte des erreurs de temps)</p>
</li>
<li class="data-line-739">
<p>La taille du bloc est dans les limites acceptables</p>
</li>
<li class="data-line-740">
<p>La première transaction (et seulement la première) est une transaction coinbase</p>
</li>
<li class="data-line-741">
<p>Toutes les transactions dans le bloc sont valides en utilisant la liste de contrôle des transactions décrite dans <a href="#tx_verification">Vérification indépendante des transactions</a></p>
</li>
</ul>
</div>
<div class="paragraph data-line-743">
<p>La validation indépendante de chaque nouveau bloc par chaque nœud du réseau garantit que les mineurs ne peuvent pas tricher. Dans les sections précédentes, nous avons vu comment les mineurs peuvent écrire une transaction qui leur attribue le nouveau bitcoin créé dans le bloc et réclamer les frais de transaction. Pourquoi les mineurs n&#8217;écrivent-ils pas eux-mêmes une transaction pour mille bitcoins au lieu de la bonne récompense ? Parce que chaque nœud valide les blocs selon les mêmes règles. Une transaction coinbase invalide rendrait l&#8217;ensemble du bloc invalide, ce qui entraînerait le rejet du bloc et, par conséquent, cette transaction ne ferait jamais partie du grand livre. Les mineurs doivent construire un bloc parfait, basé sur les règles partagées que tous les nœuds suivent, et l&#8217;exploiter avec une solution correcte à la preuve de travail. Pour ce faire, ils dépensent beaucoup d&#8217;électricité dans l&#8217;exploitation minière, et s&#8217;ils trichent, toute l&#8217;électricité et les efforts sont gaspillés. C&#8217;est pourquoi la validation indépendante est un élément clé du consensus décentralisé.</p>
</div>
</div>
<div class="sect2 data-line-745">
<h3 id="_assemblage_et_sélection_de_chaînes_de_blocs">Assemblage et sélection de chaînes de blocs</h3>
<div class="paragraph data-line-747">
<p>La dernière étape du mécanisme de consensus décentralisé de Bitcoin est l&#8217;assemblage de blocs en chaînes et la sélection de la chaîne avec le plus de preuves de travail. Une fois qu&#8217;un nœud a validé un nouveau bloc, il tentera alors d&#8217;assembler une chaîne en connectant le bloc à la chaîne de blocs existante.</p>
</div>
<div class="paragraph data-line-749">
<p>Les nœuds maintiennent trois ensembles de blocs : ceux connectés à la chaîne de blocs principale, ceux qui forment des branches de la chaîne de blocs principale (chaînes secondaires) et enfin, les blocs qui n&#8217;ont pas de parent connu dans les chaînes connues (orphelins). Les blocs invalides sont rejetés dès que l&#8217;un des critères de validation échoue et ne sont donc inclus dans aucune chaîne.</p>
</div>
<div class="paragraph data-line-751">
<p>La "chaîne principale" à tout moment est la chaîne de blocs <em>valide</em> à laquelle est associée la preuve de travail la plus cumulative. Dans la plupart des cas, il s&#8217;agit également de la chaîne contenant le plus de blocs, à moins qu&#8217;il n&#8217;y ait deux chaînes de longueur égale et que l&#8217;une ait plus de preuve de travail. La chaîne principale aura également des branches avec des blocs qui sont des "frères et sœurs" des blocs de la chaîne principale. Ces blocs sont valides mais ne font pas partie de la chaîne principale. Elles sont conservées pour référence future, au cas où l&#8217;une de ces chaînes serait étendue au-delà de la chaîne principale en cours. Dans la section suivante (<a href="#forks">Fourches de chaîne de blocs</a>), nous verrons comment des chaînes secondaires se produisent à la suite d&#8217;une extraction quasi simultanée de blocs à la même hauteur.</p>
</div>
<div class="paragraph data-line-753">
<p>Lorsqu&#8217;un nouveau bloc est reçu, un nœud essaie de l&#8217;insérer dans la chaîne de blocs existante. Le nœud examinera le champ "hachage du bloc précédent" du bloc, qui est la référence au parent du bloc. Ensuite, le nœud tentera de trouver ce parent dans la chaîne de blocs existante. La plupart du temps, le parent sera la "pointe" de la chaîne principale, ce qui signifie que ce nouveau bloc étend la chaîne principale. Par exemple, le nouveau bloc 277,316 a une référence au hachage de son bloc parent 277,315. La plupart des nœuds qui reçoivent 277 316 auront déjà le bloc 277 315 comme pointe de leur chaîne principale et relieront donc le nouveau bloc et étendront cette chaîne.</p>
</div>
<div class="paragraph data-line-755">
<p>Parfois, comme nous le verrons dans <a href="#forks">Fourches de chaîne de blocs</a>, le nouveau bloc prolonge une chaîne qui n&#8217;est pas la chaîne principale. Dans ce cas, le nœud attachera le nouveau bloc à la chaîne secondaire qu&#8217;il prolonge, puis comparera le travail de la chaîne secondaire à la chaîne principale. Si la chaîne secondaire a plus de travail cumulé que la chaîne principale, le nœud <em>reconvergera</em> sur la chaîne secondaire, ce qui signifie qu&#8217;il sélectionnera la chaîne secondaire comme sa nouvelle chaîne principale, faisant de l&#8217;ancienne chaîne principale une chaîne secondaire. Si le nœud est un mineur, il construira maintenant un bloc étendant cette nouvelle chaîne plus longue.</p>
</div>
<div class="paragraph data-line-757">
<p>Si un bloc valide est reçu et qu&#8217;aucun parent n&#8217;est trouvé dans les chaînes existantes, ce bloc est considéré comme "orphelin". Les blocs orphelins sont enregistrés dans le bassin de blocs orphelins où ils resteront jusqu&#8217;à ce que leur parent soit reçu. Une fois que le parent est reçu et lié aux chaînes existantes, l&#8217;orphelin peut être retiré du bassin d&#8217;orphelins et lié au parent, ce qui en fait une partie d&#8217;une chaîne. Les blocs orphelins se produisent généralement lorsque deux blocs extraits dans un court laps de temps sont reçus dans l&#8217;ordre inverse (enfant avant parent).</p>
</div>
<div class="paragraph data-line-759">
<p>En sélectionnant la chaîne valide de plus grand travail cumulé, tous les nœuds finissent par parvenir à un consensus à l&#8217;échelle du réseau. Les divergences temporaires entre les chaînes sont finalement résolues au fur et à mesure que du travail est ajouté, étendant l&#8217;une des chaînes possibles. Les nœuds de minage « votent » avec leur puissance de minage en choisissant quelle chaîne étendre en minant le bloc suivant. Lorsqu&#8217;ils exploitent un nouveau bloc et étendent la chaîne, le nouveau bloc lui-même représente leur vote.</p>
</div>
<div class="paragraph data-line-761">
<p>Dans la section suivante, nous verrons comment les divergences entre les chaînes concurrentes (les fourches) sont résolues par la sélection indépendante de la chaîne de plus grand travail cumulatif.</p>
</div>
<div class="sect3 data-line-764">
<h4 id="forks">Fourches de chaîne de blocs</h4>
<div class="paragraph data-line-766">
<p>Parce que la chaîne de blocs est une structure de données décentralisée, différentes copies de celle-ci ne sont pas toujours cohérentes. Les blocs peuvent arriver à différents nœuds à des moments différents, ce qui amène les nœuds à avoir différentes perspectives de la chaîne de blocs. Pour résoudre ce problème, chaque nœud sélectionne et tente toujours d&#8217;étendre la chaîne de blocs qui représente le plus de preuve de travail, également connue sous le nom de chaîne la plus longue ou de chaîne de travail cumulative la plus importante. En additionnant le travail enregistré dans chaque bloc d&#8217;une chaîne, un nœud peut calculer la quantité totale de travail qui a été dépensée pour créer cette chaîne. Tant que tous les nœuds sélectionnent la plus grande chaîne de travail cumulatif, le réseau mondial Bitcoin finit par converger vers un état cohérent. Les fourches se produisent sous forme d&#8217;incohérences temporaires entre les versions de la chaîne de blocs, qui sont résolues par une éventuelle reconvergence à mesure que d&#8217;autres blocs sont ajoutés à l&#8217;une des fourches.</p>
</div>
<div class="admonitionblock tip data-line-769">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-770">
<p>Les fourches de chaîne de blocs décrites dans cette section se produisent naturellement (accidentellement) en raison de retards de transmission dans le réseau mondial. Plus loin dans ce chapitre, nous verrons également les fourches délibérément induites (embranchements divergents et embranchements convergents), qui sont utilisés pour modifier les règles de consensus.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-773">
<p>Dans les quelques diagrammes suivants, nous suivons la progression d&#8217;un événement d'"embranchement" (ou de fourche) à travers le réseau. Le diagramme est une représentation simplifiée du réseau Bitcoin. À des fins d&#8217;illustration, différents blocs sont représentés sous différentes formes (étoile, triangle, triangle inversé, losange), répartis sur le réseau. Chaque nœud du réseau est représenté par un cercle.</p>
</div>
<div class="paragraph data-line-775">
<p>Chaque nœud a sa propre perspective de la chaîne de blocs mondiale. Au fur et à mesure que chaque nœud reçoit des blocs de ses voisins, il met à jour sa propre copie de la chaîne de blocs, en sélectionnant la plus grande chaîne de travail cumulée. À des fins d&#8217;illustration, chaque nœud contient une forme qui représente le bloc qui, selon lui, est actuellement la pointe de la chaîne principale. Donc, si vous voyez une forme d&#8217;étoile dans le nœud, cela signifie que le bloc en étoile est la pointe de la chaîne principale, en ce qui concerne ce nœud.</p>
</div>
<div class="paragraph data-line-777">
<p>Dans le premier diagramme (<a href="#fork1">Avant la bifurcation, tous les nœuds ont la même perspective</a>), le réseau a une perspective unifiée de la chaîne de blocs, avec le bloc étoile comme pointe de la chaîne principale.</p>
</div>
<div id="fork1" class="imageblock smallereighty data-line-782">
<div class="content">
<img src="images/mbc2_1002.png" alt="Avant la bifurcation - tous les nœuds ont la même perspective">
</div>
<div class="title">Figure 2. Avant la bifurcation, tous les nœuds ont la même perspective</div>
</div>
<div class="paragraph data-line-784">
<p>Un "embranchement" (ou une "fourche") se produit chaque fois qu&#8217;il y a deux blocs valides différents à la même hauteur de bloc en compétition pour former la chaîne de blocs la plus longue. Cela se produit dans des conditions normales chaque fois que deux mineurs résolvent l&#8217;algorithme de preuve de travail dans un court laps de temps l&#8217;un de l&#8217;autre. Alors que les deux mineurs découvrent une solution pour leurs blocs candidats respectifs, ils diffusent immédiatement leur propre bloc "gagnant" à leurs voisins immédiats qui commencent à propager le bloc sur le réseau. Chaque nœud qui reçoit un bloc valide l&#8217;incorpore dans sa chaîne de blocs, étendant la chaîne de blocs d&#8217;un bloc. Si ce nœud voit plus tard un autre bloc valide étendre le même parent (à la même hauteur de bloc), il connecte le deuxième bloc sur une chaîne secondaire, bifurquant sa chaîne principale. En conséquence, certains nœuds "verront" un bloc gagnant en premier, tandis que d&#8217;autres nœuds verront l&#8217;autre bloc gagnant en premier, et deux versions concurrentes de la chaîne de blocs émergeront.</p>
</div>
<div class="paragraph data-line-786">
<p>Dans <a href="#fork2">Visualisation d&#8217;un événement d&#8217;embranchement (fourche) de la chaîne de blocs: deux blocs trouvés simultanément</a>, on voit deux mineurs (Nœud X et Nœud Y) qui minent deux blocs différents presque simultanément. Ces deux blocs sont des enfants du bloc étoile et étendent la chaîne en s&#8217;appuyant sur le bloc étoile. Pour nous aider à le suivre, l&#8217;un est visualisé comme un bloc triangulaire provenant du nœud X, et l&#8217;autre est représenté comme un bloc triangulaire inversé provenant du nœud Y.</p>
</div>
<div id="fork2" class="imageblock smallersixty data-line-791">
<div class="content">
<img src="images/mbc2_1003.png" alt="Visualisation d&#8217;un événement d&#8217;embranchement (fourche) de la chaîne de blocs: deux blocs trouvés simultanément">
</div>
<div class="title">Figure 3. Visualisation d&#8217;un événement d&#8217;embranchement (fourche) de la chaîne de blocs: deux blocs trouvés simultanément</div>
</div>
<div class="paragraph data-line-793">
<p>Supposons, par exemple, que le mineur Nœud X trouve une solution de preuve de travail pour un bloc "triangle" qui étend la chaîne de blocs, en s&#8217;appuyant sur le bloc parent "étoile". Presque simultanément, le mineur Nœud Y qui étendait également la chaîne du bloc "étoile" trouve une solution pour le bloc "triangle inversé", son bloc candidat. Maintenant, il y a deux blocs possibles ; un que nous appelons "triangle", originaire du Nœud X ; et un que nous appelons "triangle inversé", originaire du nœud Y. Les deux blocs ont été extraits avec succès, les deux blocs sont valides (contiennent une solution valide à la preuve de travail), et les deux blocs étendent le même parent (bloc "étoile"). Les deux blocs contiennent probablement la plupart des mêmes transactions, avec seulement peut-être quelques différences dans l&#8217;ordre des transactions.</p>
</div>
<div class="paragraph data-line-795">
<p>Au fur et à mesure que les deux blocs se propagent, certains nœuds reçoivent d&#8217;abord le bloc "triangle" et d&#8217;autres reçoivent le bloc "triangle inversé" en premier. Comme indiqué dans <a href="#fork3">Visualisation d&#8217;un événement d&#8217;embranchement de la chaîne de blocs: deux blocs se propagent, divisant le réseau</a>, le réseau se scinde en deux perspectives différentes de la chaîne de blocs; un côté surmonté du bloc triangle, l&#8217;autre du bloc triangle renversé.</p>
</div>
<div id="fork3" class="imageblock smallersixty data-line-800">
<div class="content">
<img src="images/mbc2_1004.png" alt="Visualisation d&#8217;un événement d&#8217;embranchement de la chaîne de blocs: deux blocs se propagent, divisant le réseau">
</div>
<div class="title">Figure 4. Visualisation d&#8217;un événement d&#8217;embranchement de la chaîne de blocs: deux blocs se propagent, divisant le réseau</div>
</div>
<div class="paragraph data-line-802">
<p>Dans <a href="#fork3">Visualisation d&#8217;un événement d&#8217;embranchement de la chaîne de blocs: deux blocs se propagent, divisant le réseau</a>, le mineur Nœud X a extrait (créé) le bloc triangulaire et a étendu la chaîne d&#8217;étoiles avec. Par conséquent, le Nœud X considère initialement la chaîne avec le bloc "triangle" comme la chaîne principale. Plus tard, le Nœud X a également reçu le bloc "triangle inversé" qui a été extrait par le Nœud Y. Puisqu&#8217;il a été reçu en deuxième, il est supposé avoir "perdu" la course. Pourtant, le bloc "triangle inversé" n&#8217;est pas écarté. Il est lié au bloc parent "étoile" et forme une chaîne secondaire. Alors que le Nœud X suppose que sa chaîne principale est la chaîne gagnante, il conserve la chaîne "perdante" afin qu&#8217;il dispose des informations nécessaires pour reconverger si la chaîne "perdante" finit par "gagner".</p>
</div>
<div class="paragraph data-line-804">
<p>De l&#8217;autre côté du réseau, le mineur Nœud Y construit une chaîne de blocs basée sur sa propre perspective de la séquence des événements. Le mineur Nœud Y a extrait (créé) le "triangle inversé" et considère initialement cette chaîne comme la chaîne principale (la chaîne "gagnante"). Lorsqu&#8217;il a ensuite reçu le bloc "triangle" extrait par le Nœud X, il l&#8217;a connecté au parent du bloc "étoile" en tant que chaîne secondaire.</p>
</div>
<div class="paragraph data-line-806">
<p>Aucun des deux côtés n&#8217;est "correct" ou "incorrect". Les deux sont des perspectives valables de la chaîne de blocs. Ce n&#8217;est qu&#8217;avec le recul qu&#8217;une seule l&#8217;emportera, en fonction de la façon dont ces deux chaînes concurrentes sont prolongées par des travaux supplémentaires.</p>
</div>
<div class="paragraph data-line-808">
<p>Chaque nœud de minage dont la perspective ressemble au Nœud X commencera immédiatement à miner un bloc candidat qui étend la chaîne avec un "triangle" comme pointe. En liant "triangle" en tant que parent de leurs blocs de candidats, ils votent avec leur pouvoir de hachage. Leur vote soutient la chaîne qu&#8217;ils ont élue comme chaîne principale.</p>
</div>
<div class="paragraph data-line-810">
<p>Tout nœud minier dont la perspective ressemble au Nœud Y commencera à construire un bloc candidat avec un "triangle inversé" comme parent, étendant la chaîne qu&#8217;ils croient être la chaîne principale. Et voilà, la course recommence.</p>
</div>
<div class="paragraph data-line-812">
<p>Les fourches sont presque toujours résolues en un bloc de temps (10 minutes en moyenne). Alors qu&#8217;une partie de la puissance de hachage du réseau est dédiée à la construction au-dessus du "triangle" en tant que parent, une autre partie de la puissance de hachage est concentrée sur la construction au-dessus du "triangle inversé". Même si la puissance de hachage est presque également répartie, il est probable qu&#8217;un groupe de mineurs trouvera une solution et la propagera avant que l&#8217;autre groupe de mineurs ait trouvé des solutions. Disons, par exemple, que les mineurs construisant au-dessus du "triangle" trouvent un nouveau bloc "losange" qui prolonge la chaîne (par exemple, étoile-triangle-losange). Ils propagent immédiatement ce nouveau bloc et l&#8217;ensemble du réseau le considère comme une solution valide, comme indiqué dans <a href="#fork4">Visualisation d&#8217;un événement d&#8217;un embranchement de la chaîne de blocs: un nouveau bloc étend une fourche, reconvergeant le réseau. Le Nœud X et le Nœud Y considèrent maintenant le bloc "triangle inversé" comme un bloc obsolète.</a>.</p>
</div>
<div class="paragraph data-line-814">
<p>Tous les nœuds qui avaient choisi "triangle" comme vainqueur au tour précédent étendront simplement la chaîne d&#8217;un bloc supplémentaire. Cependant, les nœuds qui ont choisi "triangle inversé" comme gagnant verront désormais deux chaînes : étoile-triangle-losange et étoile-triangle inversé. La chaîne étoile-triangle-losange est maintenant plus longue (plus de travail cumulé) que l&#8217;autre chaîne. En conséquence, ces nœuds définiront la chaîne étoile-triangle-losange comme chaîne principale et transformeront la chaîne étoile-triangle inversé en une chaîne secondaire, comme indiqué dans <a href="#fork5">Visualisation d&#8217;un événement d&#8217;embranchement de la chaîne de blocs: le réseau reconverge sur une nouvelle chaîne la plus longue</a>. Il s&#8217;agit d&#8217;une reconvergence en chaîne, car ces nœuds sont obligés de revoir leur vision de la chaîne de blocs pour intégrer les nouvelles preuves d&#8217;une chaîne plus longue. Tous les mineurs travaillant à l&#8217;extension de la chaîne étoile-inversée-triangle arrêteront désormais ce travail car leur bloc candidat est désormais considéré comme un enfant d&#8217;un bloc périmé, car son parent "triangle-inversé" n&#8217;est plus sur la chaîne la plus longue . Étant donné que le bloc triangle inversé est désormais obsolète, le mineur Nœud Y (qui a miné ce bloc) ne pourra pas dépenser la récompense de minage pour ce bloc, même si ce bloc était valide et a été miné avec succès. Les transactions dans le "triangle inversé" qui ne sont pas dans le "triangle" sont réinsérées dans le mempool pour être incluses dans le bloc suivant pour devenir une partie de la chaîne principale. L&#8217;ensemble du réseau reconverge sur une seule chaîne de blocs étoile-triangle-losange, avec "losange" comme dernier bloc de la chaîne. Tous les mineurs commencent immédiatement à travailler sur des blocs candidats qui font référence à "losange" comme parent pour étendre la chaîne étoile-triangle-losange.</p>
</div>
<div id="fork4" class="imageblock smallereighty data-line-819">
<div class="content">
<img src="images/mbc2_1005.png" alt="Visualisation d&#8217;un événement d&#8217;un embranchement de la chaîne de blocs: un nouveau bloc étend une fourche">
</div>
<div class="title">Figure 5. Visualisation d&#8217;un événement d&#8217;un embranchement de la chaîne de blocs: un nouveau bloc étend une fourche, reconvergeant le réseau. Le Nœud X et le Nœud Y considèrent maintenant le bloc "triangle inversé" comme un bloc obsolète.</div>
</div>
<div id="fork5" class="imageblock smallereighty data-line-824">
<div class="content">
<img src="images/mbc2_1006.png" alt="Visualisation d&#8217;un événement d&#8217;un embranchement de la chaîne de blocs: le réseau reconverge sur la nouvelle chaîne la plus longue">
</div>
<div class="title">Figure 6. Visualisation d&#8217;un événement d&#8217;embranchement de la chaîne de blocs: le réseau reconverge sur une nouvelle chaîne la plus longue</div>
</div>
<div class="paragraph data-line-826">
<p>Il est théoriquement possible qu&#8217;une fourche s&#8217;étende à deux blocs, si deux blocs sont trouvés presque simultanément par des mineurs sur les "côtés" opposés d&#8217;une fourche précédente. Cependant, la probabilité que cela se produise est très faible. Alors qu&#8217;une fourche à un bloc peut se produire tous les jours, une fourche à deux blocs se produit au plus une fois toutes les quelques semaines.</p>
</div>
<div class="paragraph data-line-828">
<p>L&#8217;intervalle de bloc de Bitcoin de 10 minutes est un compromis de conception entre des temps de confirmation rapides (règlement des transactions) et la probabilité d&#8217;une fourche. Un temps de bloc plus rapide rendrait les transactions plus rapides mais conduirait à des fourches de chaîne de blocs plus fréquentes, tandis qu&#8217;un temps de bloc plus lent réduirait le nombre de fourches mais ralentirait le règlement.</p>
</div>
</div>
</div>
<div class="sect2 data-line-830">
<h3 id="_lexploitation_minière_et_la_course_au_hachage">L&#8217;exploitation minière et la course au hachage</h3>
<div class="paragraph data-line-832">
<p>L&#8217;exploitation minière de Bitcoin est une industrie extrêmement compétitive. La puissance de hachage a augmenté de façon exponentielle chaque année d&#8217;existence du bitcoin. Certaines années, la croissance a reflété un changement complet de technologie, comme en 2010 et 2011, lorsque de nombreux mineurs sont passés de l&#8217;exploitation de processeurs CPU à l&#8217;exploitation de GPU et à l&#8217;exploitation de réseau prédiffusé programmable par l&#8217;utilisateur (FPGA). En 2013, l&#8217;introduction de l&#8217;exploitation minière ASIC a conduit à un autre bond de géant dans la puissance minière, en plaçant la fonction SHA256 directement sur des puces de silicium spécialisées à des fins d&#8217;exploitation minière. Les premières puces de ce type pourraient fournir plus de puissance de minage dans une seule boîte que l&#8217;ensemble du réseau Bitcoin en 2010.</p>
</div>
<div class="paragraph data-line-834">
<p>La liste suivante montre la puissance de hachage totale du réseau Bitcoin en terahachages/sec (TH/sec), depuis sa création en 2009 (source : Blockchain.com) :</p>
</div>
<div class="dlist data-line-836">
<dl>
<dt class="hdlist1">2009 </dt>
<dd>
<p>0,000004 – 0,00001 TH/sec (croissance 2,40×)</p>
</dd>
<dt class="hdlist1">2010 </dt>
<dd>
<p>0,00001 – 0,14 TH/sec (14 247× croissance)</p>
</dd>
<dt class="hdlist1">2011 </dt>
<dd>
<p>0,14 – 9,49 TH/sec (croissance de 63,92×)</p>
</dd>
<dt class="hdlist1">2012 </dt>
<dd>
<p>9,49 – 22 TH/sec (croissance 2,32×)</p>
</dd>
<dt class="hdlist1">2013 </dt>
<dd>
<p>22.04 – 15 942 TH/sec (croissance de 723,32×)</p>
</dd>
<dt class="hdlist1">2014 </dt>
<dd>
<p>15 942 – 306 333 TH/sec (croissance de 19,21×)</p>
</dd>
<dt class="hdlist1">2015 </dt>
<dd>
<p>306 333 – 881 232 TH/sec (croissance de 2,87×)</p>
</dd>
<dt class="hdlist1">2016 </dt>
<dd>
<p>881 232 – 2 807 540 TH/sec (croissance 3,18×)</p>
</dd>
<dt class="hdlist1">2017 </dt>
<dd>
<p>2 807 540 – 18 206 558 TH/sec (6,48× croissance)</p>
</dd>
<dt class="hdlist1">2018 </dt>
<dd>
<p>18 206 558 – 41 801 528 TH/sec (croissance de 2,29×)</p>
</dd>
<dt class="hdlist1">2019 </dt>
<dd>
<p>41 801 528 – 109 757 127 TH/sec (croissance de 2,62×)</p>
</dd>
<dt class="hdlist1">2020 </dt>
<dd>
<p>109 757 127 – 149 064 869 TH/sec (croissance de 1,35×)</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-849">
<p>Dans le graphique en <a href="#network_hashing_power">Puissance de hachage totale, terahachages par seconde (TH/sec) (graphique sur une échelle linéaire)</a>, nous pouvons voir que la puissance de hachage du réseau Bitcoin a augmenté au cours des deux dernières années. Comme vous pouvez le constater, la concurrence entre les mineurs et la croissance du bitcoin ont entraîné une augmentation exponentielle de la puissance de hachage (total des hachages par seconde sur le réseau).</p>
</div>
<div id="network_hashing_power" class="imageblock data-line-853">
<div class="content">
<img src="images/mbc2_1007.png" alt="Taux de hachage du réseau">
</div>
<div class="title">Figure 7. Puissance de hachage totale, terahachages par seconde (TH/sec) (graphique sur une échelle linéaire)</div>
</div>
<div class="paragraph data-line-855">
<p>Alors que la quantité de puissance de hachage appliquée à l&#8217;extraction de bitcoins a explosé, la difficulté a augmenté pour l&#8217;égaler. La métrique de difficulté dans le graphique affiché dans <a href="#bitcoin_difficulty">Métrique de la difficulté de minage de Bitcoin (graphique sur une échelle logarithmique)</a> est mesuré comme un rapport de la difficulté actuelle sur la difficulté minimale (la difficulté du premier bloc).</p>
</div>
<div id="bitcoin_difficulty" class="imageblock data-line-859">
<div class="content">
<img src="images/mbc2_1008.png" alt="Difficulté Bitcoin">
</div>
<div class="title">Figure 8. Métrique de la difficulté de minage de Bitcoin (graphique sur une échelle logarithmique)</div>
</div>
<div class="paragraph data-line-861">
<p>Au cours des deux dernières années, les puces minières ASIC sont devenues de plus en plus denses, se rapprochant de la pointe de la fabrication de silicium avec une taille de caractéristique (résolution) de 7 nanomètres (nm). Actuellement, les fabricants d&#8217;ASIC visent à dépasser les fabricants de puces CPU à usage général, en concevant des puces avec une taille de fonctionnalité de 5 nm, car la rentabilité de l&#8217;exploitation minière fait avancer cette industrie encore plus rapidement que l&#8217;informatique générale. Il n&#8217;y a plus de pas de géant dans l&#8217;extraction de bitcoins, car l&#8217;industrie a atteint l&#8217;avant-garde de la loi de Moore, qui stipule que la densité de calcul doublera environ tous les 18 mois. Pourtant, la puissance minière du réseau continue de progresser à un rythme exponentiel alors que la course aux puces à plus haute densité s&#8217;accompagne d&#8217;une course aux centres de données à plus haute densité où des milliers de ces puces peuvent être déployées. Il ne s&#8217;agit plus de savoir combien d&#8217;extraction peut être effectuée avec une seule puce, mais combien de puces peuvent être insérées dans un bâtiment, tout en dissipant la chaleur et en fournissant une puissance adéquate.</p>
</div>
<div class="sect3 data-line-864">
<h4 id="extra_nonce">La solution nonce (nombre aléatoire) supplémentaire</h4>
<div class="paragraph data-line-866">
<p>Depuis 2012, l&#8217;extraction de bitcoins a évolué pour résoudre une limitation fondamentale dans la structure de l&#8217;en-tête de bloc. Au début du bitcoin, un mineur pouvait trouver un bloc en parcourant le nonce jusqu&#8217;à ce que le hachage résultant soit égal ou inférieur à la cible. Au fur et à mesure que la difficulté augmentait, les mineurs parcouraient souvent les 4 milliards de valeurs du nonce sans trouver de bloc. Cependant, cela a été facilement résolu en mettant à jour l&#8217;horodatage du bloc pour tenir compte du temps écoulé. Étant donné que l&#8217;horodatage fait partie de l&#8217;en-tête, la modification permettrait aux mineurs de parcourir à nouveau les valeurs du nonce avec des résultats différents. Cependant, une fois que le matériel de minage a dépassé 4 GH/sec, cette approche est devenue de plus en plus difficile car les valeurs nonce ont été épuisées en moins d&#8217;une seconde. Alors que l&#8217;équipement de minage ASIC commençait à pousser puis à dépasser le taux de hachage TH/sec, le logiciel de minage avait besoin de plus d&#8217;espace pour les valeurs nonce afin de trouver des blocs valides. L&#8217;horodatage pourrait être un peu étiré, mais le déplacer trop loin dans le futur rendrait le bloc invalide. Une nouvelle source de "changement" était nécessaire dans l&#8217;en-tête du bloc. La solution consistait à utiliser la transaction coinbase comme source de valeurs nonce supplémentaires. Étant donné que le script coinbase peut stocker entre 2 et 100 octets de données, les mineurs ont commencé à utiliser cet espace comme espace nonce supplémentaire, leur permettant d&#8217;explorer une gamme beaucoup plus large de valeurs d&#8217;en-tête de bloc pour trouver des blocs valides. La transaction coinbase est incluse dans l&#8217;arborescence de Merkle, ce qui signifie que tout changement dans le script coinbase entraîne la modification de la racine de Merkle. Huit octets de nonce supplémentaires, plus les 4 octets de nonce "standard" permettent aux mineurs d&#8217;explorer un total de 2<sup>96</sup> (8 suivis de 28 zéros) possibilités <em>par seconde</em> sans avoir à modifier l&#8217;horodatage. Si, à l&#8217;avenir, les mineurs pouvaient parcourir toutes ces possibilités, ils pourraient alors modifier l&#8217;horodatage. Il y a également plus d&#8217;espace dans le script coinbase pour l&#8217;expansion future de l&#8217;espace nonce supplémentaire.</p>
</div>
</div>
<div class="sect3 data-line-869">
<h4 id="mining_pools">Groupes miniers</h4>
<div class="paragraph data-line-871">
<p>Dans cet environnement hautement concurrentiel, les mineurs travaillant seuls (également appelés mineurs solo) n&#8217;ont aucune chance. La probabilité qu&#8217;ils trouvent un bloc pour compenser leurs coûts d&#8217;électricité et de matériel est si faible que cela représente un pari, comme jouer à la loterie. Même le système minier ASIC grand public le plus rapide ne peut pas suivre les systèmes commerciaux qui empilent des dizaines de milliers de ces puces dans des entrepôts géants à proximité de centrales hydroélectriques. Les mineurs collaborent désormais pour former des groupes de minage, mettant en commun leur pouvoir de hachage et partageant la récompense entre des milliers de participants. En participant à un groupe, les mineurs obtiennent une plus petite part de la récompense globale, mais sont généralement récompensés tous les jours, ce qui réduit l&#8217;incertitude.</p>
</div>
<div class="paragraph data-line-873">
<p>Prenons un exemple précis. Supposons qu&#8217;un mineur ait acheté du matériel de minage avec un taux de hachage combiné de 14 000 gigahachages par seconde (GH/s), soit 14 TH/s. En 2017, cet équipement coûte environ 2 500 $ US. Le matériel consomme 1375 watts (1,3 kW) d&#8217;électricité lorsqu&#8217;il fonctionne, 33 kW-heures par jour, à un coût de 1 $ à 2 $ par jour à des tarifs d&#8217;électricité très bas. À la difficulté actuelle du bitcoin, le mineur pourra extraire un bloc en solo environ une fois tous les 4 ans. Comment calcule-t-on cette probabilité ? Il est basé sur un taux de hachage à l&#8217;échelle du réseau de 3 EH/sec (en 2017) et le taux du mineur de 14 TH/sec :</p>
</div>
<ul class="simplelist">
  <li>P = (14 * 10<sup>12</sup> / 3 * 10<sup>18</sup> ) * 210 240 = 0,98</li>
</ul>
<div class="paragraph data-line-881">
<p>&#8230;&#8203;où 210 240 est le nombre de blocs en quatre ans. Le mineur a une probabilité de 98 % de trouver un bloc sur quatre ans, sur la base du taux de hachage global au début de la période.</p>
</div>
<div class="paragraph data-line-883">
<p>Si le mineur trouve un seul bloc dans ce délai, le paiement de 6,25 bitcoins, à environ 1 000 $ par bitcoin, se traduira par un paiement unique de 6 250 $, ce qui produira un bénéfice net d&#8217;environ 750 $. Cependant, la chance de trouver un bloc dans une période de 4 ans dépend de la chance du mineur. Il pourrait trouver deux blocs en 4 ans et faire un profit plus important. Ou il pourrait ne pas trouver de bloc pendant 5 ans et subir une grosse perte financière. Pire encore, la difficulté de l&#8217;algorithme Bitcoin de preuve de travail est susceptible d&#8217;augmenter considérablement au cours de cette période, au rythme actuel de croissance de la puissance de hachage, ce qui signifie que le mineur a au plus un an pour atteindre le seuil de rentabilité avant que le matériel soit effectivement obsolète et que ce dernier soit remplacé par du matériel de minage plus puissant. Financièrement, cela n&#8217;a de sens qu&#8217;à très faible coût d&#8217;électricité (moins de 1 cent par kWh) et uniquement à très grande échelle.</p>
</div>
<div class="paragraph data-line-885">
<p>Les "pools" ou groupes de minage coordonnent plusieurs centaines ou milliers de mineurs, sur des protocoles de minage de groupe spécialisés. Les mineurs individuels configurent leur équipement minier pour se connecter à un serveur de pool et spécifient une adresse Bitcoin, qui recevra leur part des récompenses. Leur matériel de minage reste connecté au serveur du pool pendant le minage, synchronisant leurs efforts avec les autres mineurs. Ainsi, les mineurs du pool partagent l&#8217;effort d&#8217;extraction d&#8217;un bloc, puis partagent les récompenses.</p>
</div>
<div class="paragraph data-line-887">
<p>Les blocs réussis paient la récompense à une adresse Bitcoin de groupe, plutôt qu&#8217;à des mineurs individuels. Le serveur de groupe effectuera périodiquement des paiements aux adresses Bitcoin des mineurs, une fois que leur part des récompenses aura atteint un certain seuil. En règle générale, le serveur de groupe facture un pourcentage des récompenses pour la fourniture du service de minage de groupe.</p>
</div>
<div class="paragraph data-line-889">
<p>Les mineurs participant à un groupe se partagent le travail de recherche d&#8217;une solution à un bloc candidat, gagnant des "actions" pour leur contribution minière. Le groupe de minage fixe un objectif plus élevé (difficulté moindre) pour gagner une part, généralement plus de 1 000 fois plus facile que l&#8217;objectif du réseau Bitcoin. Lorsqu&#8217;un membre du groupe exploite avec succès un bloc, la récompense est gagnée par le groupe, puis partagée avec tous les mineurs proportionnellement au nombre d&#8217;actions qu&#8217;ils ont contribué à l&#8217;effort.</p>
</div>
<div class="paragraph data-line-891">
<p>Les groupes sont ouvertes à tout mineur, grand ou petit, professionnel ou amateur. Un groupe aura donc certains participants avec une seule petite machine de minage, et d&#8217;autres avec un garage rempli de matériel de minage haut de gamme. Certains exploiteront quelques dizaines de kilowatts d&#8217;électricité, d&#8217;autres exploiteront un centre de données consommant un mégawatt d&#8217;électricité. Comment un groupe de minage mesure-t-il les contributions individuelles, de manière à répartir équitablement les récompenses, sans possibilité de tricherie ? La réponse est d&#8217;utiliser l&#8217;algorithme de preuve de travail de Bitcoin pour mesurer la contribution de chaque mineur du groupe, mais avec une difficulté inférieure afin que même les plus petits mineurs du groupe gagnent une part suffisamment fréquemment pour qu&#8217;il soit intéressant de contribuer au groupe. En fixant une difficulté inférieure pour gagner des actions, le groupe mesure la quantité de travail effectué par chaque mineur. Chaque fois qu&#8217;un mineur de groupe trouve un hachage d&#8217;en-tête de bloc égal ou inférieur à la cible du groupe, il prouve qu&#8217;il a effectué le travail de hachage pour trouver ce résultat. Plus important encore, le travail de recherche de parts contribue, de manière statistiquement mesurable, à l&#8217;effort global pour trouver un hachage égal ou inférieur à la cible du réseau Bitcoin. Des milliers de mineurs essayant de trouver des hachages de faible valeur finiront par en trouver un suffisamment bas pour satisfaire la cible du réseau Bitcoin.</p>
</div>
<div class="paragraph data-line-893">
<p>Revenons à l&#8217;analogie d&#8217;un jeu de dés. Si les joueurs de dés lancent des dés avec un objectif de lancer égal ou inférieur à quatre (la difficulté globale du réseau), un groupe fixerait un objectif plus facile, en comptant combien de fois les joueurs du groupe ont réussi à lancer égal ou inférieur à huit. Lorsque les joueurs du pool lancent un nombre égal ou inférieur à huit (l&#8217;objectif de partage du groupe) mais supérieur à quatre (supérieur à la difficulté globale du réseau), ils gagnent des parts, mais ni eux ni le groupe ne gagnent la partie car ils n&#8217;y parviennent pas à atteindre la cible (égale ou inférieure à quatre). Les joueurs de groupe atteindront beaucoup plus souvent l&#8217;objectif de groupe le plus facile, leur faisant gagner des parts très régulièrement, même s&#8217;ils n&#8217;atteignent pas l&#8217;objectif plus difficile de gagner la partie. De temps en temps, l&#8217;un des joueurs du groupe lancera les dés combinés égal ou inférieur à quatre, le joueur du groupe gagne une part et l&#8217;ensemble du groupe gagne la partie. Ensuite, les gains peuvent être distribués aux joueurs du groupe en fonction du nombre de parts que chacun a gagné. Même si l&#8217;objectif de huit ou moins n&#8217;était pas gagnant, c&#8217;était un moyen juste de mesurer les lancers de dés pour les joueurs, et cela produit parfois un lancer de quatre ou moins.</p>
</div>
<div class="paragraph data-line-895">
<p>De même, un groupe de minage définira une cible de groupe (plus élevée et plus facile) qui garantira qu&#8217;un mineur de groupe individuel peut trouver des hachages d&#8217;en-tête de bloc qui sont souvent égaux ou inférieurs à la cible du pool, gagnant ainsi des actions. De temps en temps, l&#8217;une de ces tentatives produira un hachage d&#8217;en-tête de bloc égal ou inférieur à la cible du réseau Bitcoin, ce qui en fait un bloc valide et l&#8217;ensemble du groupe gagne.</p>
</div>
<div class="sect4 data-line-897">
<h5 id="_groupes_gérées">Groupes gérées</h5>
<div class="paragraph data-line-899">
<p> La plupart des groupes de minage sont "gérés", ce qui signifie qu&#8217;une entreprise ou un individu gère un serveur de groupe. Le propriétaire du serveur de groupe est appelé <em>opérateur de pool</em> (ou <em>opérateur de groupe</em>), et il facture aux mineurs du groupe un pourcentage des gains.</p>
</div>
<div class="paragraph data-line-901">
<p>Le serveur de groupe exécute un logiciel spécialisé et un protocole de minage en groupe qui coordonnent les activités des mineurs en groupe. Le serveur de groupe est également connecté à un ou plusieurs nœuds Bitcoin complets et a un accès direct à une copie complète de la base de données, c-à-d la chaîne de blocs. Cela permet au serveur de groupe de valider les blocs et les transactions au nom des mineurs en groupe, les soulageant ainsi du fardeau d&#8217;exécuter un nœud complet. Pour les mineurs en groupe, il s&#8217;agit d&#8217;une considération importante, car un nœud complet nécessite un ordinateur dédié avec au moins 300 à 350 Go de stockage persistant (disque) et au moins 2 à 4 Go de mémoire (RAM). De plus, le logiciel bitcoin exécuté sur le nœud complet doit être surveillé, entretenu et mis à jour fréquemment. Tout temps d&#8217;arrêt causé par un manque d&#8217;entretien ou un manque de ressources nuira à la rentabilité du mineur. Pour de nombreux mineurs, la possibilité d&#8217;exploiter sans exécuter un nœud complet est un autre grand avantage de rejoindre un groupe géré.</p>
</div>
<div class="paragraph data-line-903">
<p>Les mineurs en groupe se connectent au serveur de groupe à l&#8217;aide d&#8217;un protocole de minage tel que Stratum (STM) ou GetBlockTemplate (GBT). Une norme plus ancienne appelée GetWork (GWK) est pour la plupart obsolète depuis fin 2012, car elle ne prend pas facilement en charge l&#8217;extraction à des taux de hachage supérieurs à 4 GH/s. Les protocoles STM et GBT créent des blocs <em>modèles</em> qui contiennent un modèle d&#8217;en-tête de bloc candidat. Le serveur de groupe construit un bloc candidat en agrégeant les transactions, en ajoutant une transaction coinbase (avec un espace nonce supplémentaire), en calculant la racine de Merkle et en se liant au hachage de bloc précédent. L&#8217;en-tête du bloc candidat est ensuite envoyé à chacun des mineurs du groupe en tant que modèle. Chaque mineur du groupe exploite ensuite le modèle de bloc, à une cible plus élevée (plus facile) que la cible du réseau Bitcoin, et renvoie tous les résultats réussis au serveur du groupe pour gagner des parts.</p>
</div>
</div>
<div class="sect4 data-line-905">
<h5 id="_groupe_de_minage_pair_à_pair_p2pool">Groupe de minage pair à pair (P2Pool)</h5>
<div class="paragraph data-line-907">
<p>Les groupes gérés créent la possibilité de tricherie par l&#8217;opérateur du groupe, qui pourrait diriger l&#8217;effort du groupe pour doubler les transactions ou invalider les blocs (voir <a href="#consensus_attacks">Attaques par consensus</a>). De plus, les serveurs de groupe centralisés représentent un point de défaillance unique. Si le serveur du groupe est en panne ou est ralenti par une attaque par déni de service, les mineurs du groupe ne peuvent pas exploiter. En 2011, pour résoudre ces problèmes de centralisation, une nouvelle méthode de minage en groupe a été proposée et mise en place: P2Pool, un pool de minage pair à pair sans opérateur central.</p>
</div>
<div class="paragraph data-line-909">
<p>P2Pool fonctionne en décentralisant les fonctions du serveur de groupe, en implémentant un système parallèle de type chaîne de blocs appelé <em>chaîne de partage</em>. Une chaîne de partage est une chaîne de blocs fonctionnant à une difficulté inférieure à la chaîne de blocs Bitcoin. La chaîne de partage permet aux mineurs en groupe de collaborer dans un groupe décentralisé en extrayant des parts sur la chaîne de partage à raison d&#8217;un bloc de partage toutes les 30 secondes. Chacun des blocs de la chaîne de partage enregistre une récompense de part proportionnelle pour les mineurs du groupe qui contribuent au travail, se reportant aux parts du bloc de partage précédent. Lorsque l&#8217;un des blocs de partage atteint également l&#8217;objectif du réseau Bitcoin, il est propagé et inclus dans la chaîne de blocs Bitcoin, récompensant tous les mineurs du groupe qui ont contribué à toutes les parts qui ont précédé le bloc de partage gagnant. Essentiellement, au lieu qu&#8217;un serveur de groupe garde une trace des actions et des récompenses des mineurs en groupe, la chaîne de partage permet à tous les mineurs en groupe de suivre toutes les actions en utilisant un mécanisme de consensus décentralisé comme le mécanisme de consensus de chaîne de blocs de Bitcoin.</p>
</div>
<div class="paragraph data-line-911">
<p>L&#8217;extraction de P2Pool est plus complexe que l&#8217;extraction de groupe car elle nécessite que les mineurs en groupe exécutent un ordinateur dédié avec suffisamment d&#8217;espace disque, de mémoire et de bande passante Internet pour prendre en charge un nœud Bitcoin complet et le logiciel de nœud P2Pool. Les mineurs P2Pool connectent leur matériel de minage à leur nœud P2Pool local, qui simule les fonctions d&#8217;un serveur de pool en envoyant des modèles de bloc au matériel de minage. Sur P2Pool, les mineurs de pool individuels construisent leurs propres blocs candidats, agrégeant les transactions un peu comme les mineurs en solo, mais exploitent ensuite en collaboration sur la chaîne de partage. P2Pool est une approche hybride qui présente l&#8217;avantage de paiements beaucoup plus granulaires que le minage en solo, mais sans donner trop de contrôle à un opérateur de pool comme les groupes gérés.</p>
</div>
<div class="paragraph data-line-914">
<p>Même si P2Pool réduit la concentration du pouvoir par les opérateurs de groupes de minage, il est concevable qu&#8217;il soit vulnérable à 51 % des attaques contre la chaîne de partage elle-même. Une adoption beaucoup plus large de P2Pool ne résout pas le problème d&#8217;attaque de 51% pour le bitcoin lui-même. Au contraire, P2Pool rend le bitcoin plus robuste dans l&#8217;ensemble, dans le cadre d&#8217;un écosystème minier diversifié.</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-917">
<h3 id="consensus_attacks">Attaques par consensus</h3>
<div class="paragraph data-line-919">
<p>Le mécanisme de consensus de Bitcoin est, du moins théoriquement, vulnérable aux attaques des mineurs (ou les groupes) qui tentent d&#8217;utiliser leur pouvoir de hachage à des fins malhonnêtes ou destructrices. Comme nous l&#8217;avons vu, le mécanisme de consensus dépend du fait qu&#8217;une majorité de mineurs agissent honnêtement dans leur propre intérêt. Cependant, si un mineur ou un groupe de mineurs peut atteindre une part importante de la puissance minière, il peut attaquer le mécanisme de consensus afin de perturber la sécurité et la disponibilité du réseau Bitcoin.</p>
</div>
<div class="paragraph data-line-921">
<p>Il est important de noter que les attaques de consensus ne peuvent affecter que le consensus futur, ou au mieux, le passé le plus récent (dizaines de blocs). Le registre de Bitcoin devient de plus en plus immuable au fil du temps. Alors qu&#8217;en théorie, une fourche peut être réalisé à n&#8217;importe quelle profondeur, en pratique, la puissance de calcul nécessaire pour forcer une fourche très profonde est immense, rendant les anciens blocs pratiquement immuables. Les attaques par consensus n&#8217;affectent pas non plus la sécurité des clés privées et de l&#8217;algorithme de signature (ECDSA). Une attaque par consensus ne peut pas voler des bitcoins, dépenser des bitcoins sans signatures, rediriger des bitcoins ou autrement modifier des transactions passées ou des enregistrements de propriété. Les attaques par consensus ne peuvent affecter que les blocs les plus récents et provoquer des interruptions par déni de service sur la création de futurs blocs.</p>
</div>
<div class="paragraph data-line-923">
<p>Un scénario d&#8217;attaque contre le mécanisme de consensus est appelé "l&#8217;attaque à 51 %". Dans ce scénario, un groupe de mineurs, contrôlant la majorité (51%) de la puissance de hachage totale du réseau, s&#8217;entend pour attaquer le bitcoin. Avec la capacité d&#8217;exploiter la majorité des blocs, les mineurs attaquants peuvent provoquer des "fourches" délibérés dans la chaîne de blocs et doubler les transactions ou exécuter des attaques par déni de service contre des transactions ou des adresses spécifiques. Une attaque fourche/double-dépense est l&#8217;endroit où l&#8217;attaquant provoque l&#8217;invalidation de blocs précédemment confirmés en forgeant en dessous d&#8217;eux et en reconvergeant sur une chaîne alternative. Avec une puissance suffisante, un attaquant peut invalider six blocs ou plus à la suite, provoquant l&#8217;invalidation de transactions considérées comme immuables (six confirmations). Notez qu&#8217;une double dépense ne peut être effectuée que sur les propres transactions de l&#8217;attaquant, pour lesquelles l&#8217;attaquant peut produire une signature valide. Dépenser deux fois ses propres transactions est rentable si, en invalidant une transaction, l&#8217;attaquant peut obtenir un paiement ou un produit d&#8217;échange irréversible sans le payer.</p>
</div>
<div class="paragraph data-line-925">
<p>Examinons un exemple pratique d&#8217;une attaque à 51 %. Dans le premier chapitre, nous avons examiné une transaction entre Alice et Bob pour une tasse de café. Bob, le propriétaire du café, est prêt à accepter le paiement pour des tasses de café sans attendre de confirmation (extraction en bloc), car le risque de double dépense pour une tasse de café est faible par rapport à la commodité d&#8217;un service client rapide . Ceci est similaire à la pratique des cafés qui acceptent les paiements par carte de crédit sans signature pour des montants inférieurs à 25 $, car le risque de rétrofacturation par carte de crédit est faible tandis que le coût de retarder la transaction pour obtenir une signature est comparativement plus élevé. En revanche, vendre un article plus cher pour du bitcoin présente le risque d&#8217;une attaque à double dépense, où l&#8217;acheteur diffuse une transaction concurrente qui dépense les mêmes intrants (UTXO) et annule le paiement au commerçant. Une attaque par double dépense peut se produire de deux manières : soit avant qu&#8217;une transaction ne soit confirmée, soit si l&#8217;attaquant profite d&#8217;une fourche de chaîne de blocs pour annuler plusieurs blocs. Une attaque à 51 % permet aux attaquants de doubler leurs propres transactions dans la nouvelle chaîne, annulant ainsi la transaction correspondante dans l&#8217;ancienne chaîne.</p>
</div>
<div class="paragraph data-line-927">
<p>Dans notre exemple, l&#8217;attaquant malveillant Mallory se rend dans la galerie de Carol et achète un magnifique triptyque représentant Satoshi Nakamoto en Prométhée. Carol vend les peintures "The Great Fire" pour 250 000 $ en bitcoins à Mallory. Au lieu d&#8217;attendre six confirmations ou plus sur la transaction, Carol emballe et remet les peintures à Mallory après une seule confirmation. Mallory travaille avec un complice, Paul, qui exploite un grand groupe minier, et le complice lance une attaque à 51% dès que la transaction de Mallory est incluse dans un bloc. Paul ordonne au groupe minier de reminer la même hauteur de bloc que le bloc contenant la transaction de Mallory, en remplaçant le paiement de Mallory à Carol par une transaction qui double la même entrée que le paiement de Mallory. La transaction à double dépense consomme le même UTXO et le rembourse au portefeuille de Mallory, au lieu de le payer à Carol, permettant essentiellement à Mallory de conserver le bitcoin. Paul dirige ensuite le groupe de minage pour exploiter un bloc supplémentaire, de manière à rendre la chaîne contenant la transaction à double dépense plus longue que la chaîne d&#8217;origine (provoquant une bifurcation sous le bloc contenant la transaction de Mallory). Lorsque la fourche de la chaîne de blocs se résout en faveur de la nouvelle chaîne (plus longue), la transaction à double dépense remplace le paiement initial à Carol. Carol manque maintenant les trois peintures et n&#8217;a pas non plus de paiement en bitcoin. Tout au long de cette activité, les participants au groupe de minage de Paul pourraient parfaitement ignorer la tentative de double dépense, car ils minent avec des mineurs automatisés et ne peuvent pas surveiller chaque transaction ou chaque bloc.</p>
</div>
<div class="paragraph data-line-929">
<p>Pour se protéger contre ce type d&#8217;attaque, un commerçant vendant des articles de grande valeur doit attendre au moins six confirmations avant remettre le produit à l&#8217;acheteur. Alternativement, le commerçant doit utiliser un compte multisignature à garantie bloqué, attendant à nouveau plusieurs confirmations après le financement du compte à garantie bloqué. Plus le nombre de confirmations s&#8217;écoule, plus il devient difficile d&#8217;invalider une transaction avec une attaque à 51 %. Pour les articles de grande valeur, le paiement par bitcoin sera toujours pratique et efficace même si l&#8217;acheteur doit attendre 24 heures pour la livraison, ce qui correspondrait à environ 144 confirmations.</p>
</div>
<div class="paragraph data-line-931">
<p>En plus d&#8217;une attaque à double dépense, l&#8217;autre scénario d&#8217;une attaque par consensus consiste à refuser le service à des participants Bitcoin spécifiques (adresses Bitcoin spécifiques). Un attaquant disposant de la majorité de la puissance minière peut simplement ignorer des transactions spécifiques. S&#8217;ils sont inclus dans un bloc miné par un autre mineur, l&#8217;attaquant peut délibérément bifurquer et réminer ce bloc, en excluant à nouveau les transactions spécifiques. Ce type d&#8217;attaque peut entraîner un déni de service prolongé contre une adresse spécifique ou un ensemble d&#8217;adresses aussi longtemps que l&#8217;attaquant contrôle la majorité de la puissance de minage.</p>
</div>
<div class="paragraph data-line-933">
<p>Malgré son nom, le scénario d&#8217;attaque à 51 % ne nécessite pas réellement 51 % de la puissance de hachage. En fait, une telle attaque peut être tentée avec un pourcentage plus faible de la puissance de hachage. Le seuil de 51% est simplement le niveau auquel une telle attaque est presque garantie de réussir. Une attaque consensuelle est essentiellement un bras de fer pour le bloc suivant et le groupe "le plus fort" a plus de chances de gagner. Avec moins de puissance de hachage, la probabilité de succès est réduite, car d&#8217;autres mineurs contrôlent la génération de certains blocs avec leur puissance de minage "honnête". Une façon de voir les choses est que plus un attaquant a de puissance de hachage, plus la fourche qu&#8217;il peut délibérément créer est long, plus il peut invalider de blocs dans le passé récent ou plus il peut contrôler de blocs dans le futur. Des groupes de recherche en sécurité ont utilisé la modélisation statistique pour affirmer que divers types d&#8217;attaques par consensus sont possibles avec aussi peu que 30 % de la puissance de hachage.</p>
</div>
<div class="paragraph data-line-935">
<p>L&#8217;augmentation massive de la puissance de hachage totale a sans doute rendu le bitcoin insensible aux attaques d&#8217;un seul mineur. Il n&#8217;y a aucun moyen pour un mineur solo de contrôler plus qu&#8217;un petit pourcentage de la puissance minière totale. Cependant, la centralisation du contrôle causée par les groupes de minage a introduit le risque d&#8217;attaques à but lucratif par un opérateur de groupe de minage. L&#8217;opérateur d&#8217;un groupe géré contrôle la construction des blocs candidats et contrôle également les transactions incluses. Cela donne à l&#8217;opérateur du groupe le pouvoir d&#8217;exclure des transactions ou d&#8217;introduire des transactions à double dépense. Si un tel abus de pouvoir est fait de manière limitée et subtile, un opérateur de groupe pourrait éventuellement profiter d&#8217;une attaque par consensus sans se faire remarquer.</p>
</div>
<div class="paragraph data-line-937">
<p>Cependant, tous les attaquants ne seront pas motivés par le profit. Un scénario d&#8217;attaque potentiel est celui où un attaquant a l&#8217;intention de perturber le réseau Bitcoin sans avoir la possibilité de profiter d&#8217;une telle perturbation. Une attaque malveillante visant à paralyser le bitcoin nécessiterait d&#8217;énormes investissements et une planification secrète, mais pourrait éventuellement être lancée par un attaquant bien financé, très probablement parrainé par l&#8217;État. Alternativement, un attaquant bien financé pourrait attaquer le consensus de bitcoin en amassant simultanément du matériel de minage, en compromettant les opérateurs de groupe et en attaquant d&#8217;autres groupes par déni de service. Tous ces scénarios sont théoriquement possibles, mais de plus en plus impraticables à mesure que la puissance de hachage globale du réseau Bitcoin continue de croître de façon exponentielle.</p>
</div>
<div class="paragraph data-line-939">
<p>Sans aucun doute, une attaque sérieuse du consensus éroderait la confiance dans le bitcoin à court terme, provoquant éventuellement une baisse significative des prix. Cependant, le réseau et les logiciels Bitcoin évoluent constamment, de sorte que les attaques par consensus se heurteraient à des contre-mesures immédiates de la part de la communauté bitcoin, rendant le bitcoin plus robuste.</p>
</div>
</div>
<div class="sect2 data-line-942">
<h3 id="consensus_changes">Modification des règles de consensus</h3>
<div class="paragraph data-line-944">
<p>Les règles de consensus déterminent la validité des transactions et des blocs. Ces règles constituent la base de la collaboration entre tous les nœuds Bitcoin et sont responsables de la convergence de toutes les perspectives locales en une seule chaîne de blocs cohérente sur l&#8217;ensemble du réseau.</p>
</div>
<div class="paragraph data-line-946">
<p>Alors que les règles de consensus sont invariables à court terme et doivent être cohérentes à travers tous les nœuds, elles ne sont pas invariables à long terme. Afin d&#8217;évoluer et de développer le système Bitcoin, les règles doivent changer de temps en temps pour s&#8217;adapter aux nouvelles fonctionnalités, améliorations ou corrections de bogues. Contrairement au développement de logiciels traditionnels, cependant, les mises à niveau vers un système de consensus sont beaucoup plus difficiles et nécessitent une coordination entre tous les participants.</p>
</div>
<div class="sect3 data-line-950">
<h4 id="hard_forks">Embranchements divergents</h4>
<div class="paragraph data-line-951">
<p>Dans <a href="#forks">Fourches de chaîne de blocs</a> nous avons examiné comment le réseau Bitcoin peut brièvement diverger, avec deux parties du réseau suivant deux branches différentes de la chaîne de blocs pendant une courte période. Nous avons vu comment ce processus se produit naturellement, dans le cadre du fonctionnement normal du réseau et comment le réseau reconverge sur une chaîne de blocs commune après le minage d&#8217;un ou plusieurs blocs.</p>
</div>
<div class="paragraph data-line-953">
<p>Il existe un autre scénario dans lequel le réseau peut diverger en deux chaînes suivantes : un changement dans les règles de consensus. Ce type de fourche ou embranchement est appelé <em>embranchement divergent</em> (<em>hard fork</em>), car après l&#8217;embranchement ou la fourche, le réseau ne reconverge pas sur une seule chaîne. Au lieu de cela, les deux chaînes évoluent indépendamment. Les embranchements divergents se produisent lorsqu&#8217;une partie du réseau fonctionne selon un ensemble de règles de consensus différent du reste du réseau. Cela peut se produire à cause d&#8217;un bogue ou à cause d&#8217;un changement délibéré dans l&#8217;implémentation des règles de consensus.</p>
</div>
<div class="paragraph data-line-955">
<p>Les embranchements divergents peuvent être utilisés pour modifier les règles du consensus, mais ils nécessitent une coordination entre tous les participants au système. Tous les nœuds qui ne se mettent pas à niveau vers les nouvelles règles de consensus ne peuvent pas participer au mécanisme de consensus et sont forcés à une chaîne distincte au moment de l&#8217;embranchement divergent. Ainsi, un changement introduit par un embranchement divergent peut être considéré comme non « compatible en aval », dans la mesure où les systèmes non mis à niveau ne peuvent pas traiter les nouvelles règles de consensus après l&#8217;événement d&#8217;embranchement divergent.</p>
</div>
<div class="paragraph data-line-957">
<p>Examinons les mécanismes d&#8217;un embranchement divergent avec un exemple spécifique.</p>
</div>
<div class="paragraph data-line-959">
<p><a href="#blockchainwithforks">Une chaîne de blocs avec des fourches</a> montre une chaîne de blocs avec deux fourches. À la hauteur de bloc 4, une fourche à un bloc se produit. C&#8217;est le type de fourche spontané que nous avons vu dans <a href="#forks">Fourches de chaîne de blocs</a>. Avec le minage du bloc 5, le réseau reconverge sur une chaîne et l&#8217;embranchement est résolu.</p>
</div>
<div id="blockchainwithforks" class="imageblock data-line-963">
<div class="content">
<img src="images/mbc2_1009.png" alt="Une chaîne de blocs avec des fourches">
</div>
<div class="title">Figure 9. Une chaîne de blocs avec des fourches</div>
</div>
<div class="paragraph data-line-965">
<p>Plus tard, cependant, à la hauteur de bloc 6, une bifurcation divergente se produit. Supposons qu&#8217;une nouvelle implémentation du client soit publiée avec un changement dans les règles de consensus. À partir de la hauteur de bloc 7, les mineurs exécutant cette nouvelle implémentation accepteront un nouveau type de signature numérique, appelons-le une signature "Smores", qui n&#8217;est pas basée sur ECDSA. Immédiatement après, un nœud exécutant la nouvelle implémentation crée une transaction qui contient une signature Smores et un mineur avec le logiciel mis à jour mine le bloc 7b contenant cette transaction.</p>
</div>
<div class="paragraph data-line-967">
<p>Tout nœud ou mineur qui n&#8217;a pas mis à jour le logiciel pour valider les signatures Smores est désormais incapable de traiter le bloc 7b. De leur point de vue, la transaction qui contenait une signature Smores et le bloc 7b qui contenait cette transaction sont invalides, car ils les évaluent sur la base des anciennes règles de consensus. Ces nœuds rejetteront la transaction et le bloc et ne les propageront pas. Tous les mineurs qui utilisent les anciennes règles n&#8217;accepteront pas le bloc 7b et continueront à exploiter un bloc candidat dont le parent est le bloc 6. En fait, les mineurs utilisant les anciennes règles peuvent même ne pas recevoir le bloc 7b si tous les nœuds auxquels ils sont connectés sont obéissant également aux anciennes règles et donc ne propageant pas le bloc. À terme, ils pourront exploiter le bloc 7a, qui est valide selon les anciennes règles et ne contient aucune transaction avec des signatures Smores.</p>
</div>
<div class="paragraph data-line-969">
<p>Les deux chaînes continuent de diverger à partir de ce point. Les mineurs de la chaîne "b" continueront d&#8217;accepter et d&#8217;exploiter les transactions contenant des signatures Smores, tandis que les mineurs de la chaîne "a" continueront d&#8217;ignorer ces transactions. Même si le bloc 8b ne contient aucune transaction signée Smores, les mineurs de la chaîne "a" ne peuvent pas le traiter. Pour eux, il semble être un bloc orphelin, car son parent "7b" n&#8217;est pas reconnu comme un bloc valide.</p>
</div>
</div>
<div class="sect3 data-line-971">
<h4 id="_embranchements_divergents_logiciel_réseau_exploitation_minière_et_chaîne">Embranchements divergents: logiciel, réseau, exploitation minière et chaîne</h4>
<div class="paragraph data-line-973">
<p>Pour les développeurs de logiciels, le terme "fourche" a une autre signification, ajoutant de la confusion au terme "fourche divergente". Dans les logiciels à source libre, une fourche se produit lorsqu&#8217;un groupe de développeurs choisit de suivre une feuille de route logicielle différente et démarre une implémentation concurrente d&#8217;un projet à source libre. Nous avons déjà discuté de deux circonstances qui conduiront à un embranchement divergent en Bitcoin: un bogue dans les règles de consensus et une modification délibérée des règles de consensus. Dans le cas d&#8217;une modification délibérée des règles de consensus, une fourche logicielle précède l&#8217;embranchement divergent. Cependant, pour que ce type d&#8217;embranchement divergent se produise, une nouvelle implémentation logicielle des règles de consensus doit être développée, adoptée et lancée.</p>
</div>
<div class="paragraph data-line-975">
<p>Des exemples de fourches logicielles qui ont tenté de modifier les règles de consensus incluent Bitcoin XT, Bitcoin Classic et, plus récemment, Bitcoin Unlimited. Cependant, aucun de ces fourches logiciels n&#8217;a abouti à un embranchement divergent. Bien qu&#8217;une fourche logicielle soit une condition préalable nécessaire, il n&#8217;est pas suffisant en soi pour qu&#8217;un embranchement divergent se produise. Pour qu&#8217;un embranchement divergent se produise, l&#8217;implémentation concurrente doit être adoptée et les nouvelles règles activées, par les mineurs, les portefeuilles et les nœuds intermédiaires. A l&#8217;inverse, il existe de nombreuses implémentations alternatives de Bitcoin Core, et même des fourches logiciels, qui ne changent pas les règles de consensus, et sauf par bogue, peuvent coexister sur le réseau et interagir sans provoquer d&#8217;embranchement divergent.</p>
</div>
<div class="paragraph data-line-977">
<p>Les règles de consensus peuvent différer de manière évidente et explicite, dans la validation des transactions ou des blocs. Les règles peuvent également différer de manière plus subtile, dans la mise en œuvre des règles de consensus telles qu&#8217;elles s&#8217;appliquent aux scripts bitcoin ou aux primitives cryptographiques telles que les signatures numériques. Enfin, les règles de consensus peuvent différer de manière imprévue en raison des contraintes de consensus implicites imposées par les limitations du système ou les détails de mise en œuvre. Un exemple de ce dernier a été vu dans l&#8217;embranchement divergent imprévu lors de la mise à niveau de Bitcoin Core 0.7 vers 0.8, qui a été causé par une limitation de l&#8217;implémentation de Berkeley DB utilisée pour stocker les blocs.</p>
</div>
<div class="paragraph data-line-979">
<p>Conceptuellement, nous pouvons considérer qu&#8217;un embranchement divergent se développe en quatre étapes : une fourche logiciel, une fourche du réseau, une fourche de minage et une fourche de chaîne.</p>
</div>
<div class="paragraph data-line-981">
<p>Le processus commence lorsqu&#8217;une implémentation alternative du client, avec des règles de consensus modifiées, est créée par les développeurs.</p>
</div>
<div class="paragraph data-line-983">
<p>Lorsque cette implémentation fourchée est déployée dans le réseau, un certain pourcentage de mineurs, d&#8217;utilisateurs de portefeuille et de nœuds intermédiaires peuvent adopter et exécuter cette implémentation. Une fourche résultante dépendra de l&#8217;application ou non des nouvelles règles de consensus aux blocs, aux transactions ou à tout autre aspect du système. Si les nouvelles règles de consensus concernent les transactions, un portefeuille créant une transaction selon les nouvelles règles peut précipiter une fourche réseau, suivi d&#8217;un embranchement divergent lorsque la transaction est extraite dans un bloc. Si les nouvelles règles concernent les blocs, le processus d&#8217;embranchement divergent commencera lorsqu&#8217;un bloc sera miné selon les nouvelles règles.</p>
</div>
<div class="paragraph data-line-985">
<p>Tout d&#8217;abord, le réseau bifurquera. Les nœuds basés sur l&#8217;implémentation d&#8217;origine des règles de consensus rejetteront toutes les transactions et tous les blocs créés selon les nouvelles règles. De plus, les nœuds qui suivent les règles de consensus d&#8217;origine seront temporairement bannis et déconnectés de tous les nœuds qui leur envoient ces transactions et blocs invalides. En conséquence, le réseau va se partitionner en deux : les anciens nœuds ne resteront connectés qu&#8217;aux anciens nœuds et les nouveaux nœuds ne seront connectés qu&#8217;aux nouveaux nœuds. Une transaction ou un bloc unique basé sur les nouvelles règles se répercutera sur le réseau et entraînera la partition en deux réseaux.</p>
</div>
<div class="paragraph data-line-987">
<p>Une fois qu&#8217;un mineur utilisant les nouvelles règles exploite un bloc, la puissance et la chaîne de minage bifurqueront également. Les nouveaux mineurs exploiteront le nouveau bloc, tandis que les anciens mineurs exploiteront une chaîne distincte basée sur les anciennes règles. Le réseau partitionné fera en sorte que les mineurs opérant selon des règles de consensus distinctes ne recevront probablement pas les blocs les uns des autres, car ils sont connectés à deux réseaux distincts.</p>
</div>
</div>
<div class="sect3 data-line-989">
<h4 id="_mineurs_divergents_et_difficulté">Mineurs divergents et difficulté</h4>
<div class="paragraph data-line-991">
<p>Alors que les mineurs divergent pour exploiter deux chaînes différentes, la puissance de hachage est répartie entre les chaînes. La puissance minière peut être répartie dans n&#8217;importe quelle proportion entre les deux chaînes. Les nouvelles règles ne peuvent être suivies que par une minorité, ou par la grande majorité de la puissance minière.</p>
</div>
<div class="paragraph data-line-993">
<p>Supposons, par exemple, une répartition de 80 % à 20 %, la majorité de la puissance minière utilisant les nouvelles règles de consensus. Supposons également que la fourche se produise immédiatement après une période de reciblage.</p>
</div>
<div class="paragraph data-line-995">
<p>Les deux chaînes hériteraient chacune de la difficulté de la période de reciblage. Les nouvelles règles consensuelles auraient 80% de la puissance minière précédemment disponible qui leur serait engagée. Du point de vue de cette chaîne, la puissance minière a subitement reculé de 20% par rapport à la période précédente. Des blocs seront trouvés en moyenne toutes les 12,5 minutes, ce qui représente la baisse de 20 % de la puissance minière disponible pour prolonger cette chaîne. Ce taux d&#8217;émission de blocs se poursuivra (sauf modification de la puissance de hachage) jusqu&#8217;à ce que les blocs de 2016 soient extraits, ce qui prendra environ 25 200 minutes (à 12,5 minutes par bloc), soit 17,5 jours. Après 17,5 jours, un reciblage se produira et la difficulté s&#8217;ajustera (réduite de 20%) pour produire à nouveau des blocs de 10 minutes, en fonction de la quantité réduite de puissance de hachage dans cette chaîne.</p>
</div>
<div class="paragraph data-line-997">
<p>La chaîne minoritaire, minant selon les anciennes règles avec seulement 20% de la puissance de hachage, sera confrontée à une tâche beaucoup plus difficile. Sur cette chaîne, les blocs seront désormais minés toutes les 50 minutes en moyenne. La difficulté ne sera pas ajustée pour les blocs de 2016, qui prendront 100 800 minutes, soit environ 10 semaines à miner. En supposant une capacité fixe par bloc, cela se traduira également par une réduction de la capacité de transaction par un facteur de 5, car il y a moins de blocs par heure disponibles pour enregistrer les transactions.</p>
</div>
</div>
<div class="sect3 data-line-999">
<h4 id="_embranchements_divergents_litigieux">Embranchements divergents litigieux</h4>
<div class="paragraph data-line-1001">
<p>C&#8217;est l&#8217;aube du développement de logiciels consensuels. Tout comme le développement à source libre a changé à la fois les méthodes et les produits des logiciels et a créé de nouvelles méthodologies, de nouveaux outils et de nouvelles communautés dans son sillage, le développement de logiciels consensuels représente également une nouvelle frontière en informatique. Des débats, des expériences et des tribulations de la feuille de route de développement du bitcoin, nous verrons émerger de nouveaux outils, pratiques, méthodologies et communautés de développement.</p>
</div>
<div class="paragraph data-line-1003">
<p>Les fourches dures sont considérées comme risquées car elles obligent une minorité à se mettre à niveau ou à rester sur une chaîne minoritaire. Le risque de scinder l&#8217;ensemble du système en deux systèmes concurrents est considéré par beaucoup comme un risque inacceptable. En conséquence, de nombreux développeurs hésitent à utiliser le mécanisme d&#8217;embranchement divergent pour mettre en œuvre des mises à niveau des règles de consensus, à moins qu&#8217;il n&#8217;y ait un soutien quasi unanime de l&#8217;ensemble du réseau. Toutes les propositions d&#8217;embranchement divergent qui ne bénéficient pas d&#8217;un soutien quasi unanime sont considérées comme trop "controversées" à tenter sans risquer une partition du système.</p>
</div>
<div class="paragraph data-line-1005">
<p>La question des embranchements divergents est très controversée dans la communauté du développement de Bitcoin, en particulier en ce qui concerne toute modification proposée aux règles de consensus contrôlant la limite de taille de bloc maximale. Certains développeurs sont opposés à toute forme d&#8217;embranchement divergent, le considérant comme trop risqué. D&#8217;autres considèrent le mécanisme d&#8217;embranchement divergent comme un outil essentiel pour mettre à niveau les règles de consensus d&#8217;une manière qui évite la "dette technique" et offre une rupture nette avec le passé. Enfin, certains développeurs voient les embranchements divergents comme un mécanisme qui devrait être utilisé rarement, avec beaucoup de planification préalable et uniquement sous un consensus quasi unanime.</p>
</div>
<div class="paragraph data-line-1007">
<p>Nous avons déjà vu l&#8217;émergence de nouvelles méthodologies pour faire face aux risques d&#8217;embranchements divergents. Dans la section suivante, nous examinerons les embranchements convergents et les méthodes BIP-34 et BIP-9 pour la signalisation et l&#8217;activation des modifications de consensus.</p>
</div>
</div>
<div class="sect3 data-line-1009">
<h4 id="_embranchements_convergents">Embranchements convergents</h4>
<div class="paragraph data-line-1011">
<p>Tous les changements de règles de consensus ne provoquent pas un embranchement divergent. Seuls les changements de consensus qui sont incompatibles en aval provoquent un embranchement ou fourche. Si la modification est implémentée de telle manière qu&#8217;un client non mis à niveau voit toujours la transaction ou le bloc comme valide selon les règles précédentes, la modification peut se produire sans fourche.</p>
</div>
<div class="paragraph data-line-1013">
<p>Le terme <em>embranchement convergent</em> (<em>soft fork</em>) a été introduit pour distinguer cette méthode de mise à niveau d&#8217;un "embranchement divergent" (hard fork). En pratique, un embranchement convergent n&#8217;est pas du tout un embranchement ou une fourche. Un embranchement convergent est une modification compatible avec les règles de consensus qui permet aux clients non mis à niveau de continuer à fonctionner en consensus avec les nouvelles règles.</p>
</div>
<div class="paragraph data-line-1015">
<p>Un aspect des embranchements convergents qui n&#8217;est pas immédiatement évident est que les mises à niveau d&#8217;embranchement convergent ne peuvent être utilisées que pour restreindre les règles de consensus, pas pour les étendre. Afin d&#8217;être compatibles en aval, les transactions et les blocs créés selon les nouvelles règles doivent également être valides selon les anciennes règles, mais pas l&#8217;inverse. Les nouvelles règles ne peuvent que limiter ce qui est valide; sinon, ils déclencheront un embranchement divergent s&#8217;ils sont rejetés selon les anciennes règles.</p>
</div>
<div class="paragraph data-line-1017">
<p>Les embranchements convergents peuvent être implémentés de plusieurs façons - le terme ne spécifie pas une méthode particulière, mais plutôt un ensemble de méthodes qui ont toutes une chose en commun : elles ne nécessitent pas la mise à niveau de tous les nœuds ou ne forcent pas les nœuds non mis à niveau hors de consensus.</p>
</div>
<div class="sect4 data-line-1019">
<h5 id="_embranchements_convergents_redéfinissant_les_opcodes_nop">Embranchements convergents redéfinissant les opcodes NOP</h5>
<div class="paragraph data-line-1021">
<p>Un certain nombre de embranchements convergents ont été implémentés dans bitcoin, sur la base de la réinterprétation d&#8217;opcodes NOP. Bitcoin Script avait dix opcodes réservés pour une utilisation future, NOP1 à NOP10. Selon les règles de consensus, la présence de ces opcodes dans un script est interprétée comme un opérateur nul, ce qui signifie qu&#8217;ils n&#8217;ont aucun effet. L&#8217;exécution continue après l&#8217;opcode NOP comme s&#8217;il n&#8217;était pas là.</p>
</div>
<div class="paragraph data-line-1023">
<p>Un embranchement convergent peut donc modifier la sémantique d&#8217;un code NOP pour lui donner un nouveau sens. Par exemple, BIP-65 (CHECKLOCKTIMEVERIFY) a réinterprété l&#8217;opcode NOP2. Les clients implémentant BIP-65 interprètent NOP2 comme OP_CHECKLOCKTIMEVERIFY et imposent une règle de consensus de verrouillage absolu sur UTXO qui contient cet opcode dans leurs scripts de verrouillage. Ce changement est un embranchement convergent car une transaction valide sous BIP-65 est également valide sur tout client qui n&#8217;implémente pas (ignore) BIP-65. Pour les anciens clients, le script contient un code NOP, qui est ignoré.</p>
</div>
</div>
<div class="sect4 data-line-1025">
<h5 id="_autres_façons_de_mettre_à_niveau_lembranchement_convergent">Autres façons de mettre à niveau l&#8217;embranchement convergent</h5>
<div class="paragraph data-line-1027">
<p>La réinterprétation des opcodes NOP était à la fois prévue et un mécanisme évident pour les mises à niveau consensuelles. Récemment, cependant, un autre mécanisme d&#8217;embranchement convergent a été introduit qui ne repose pas sur les opcodes NOP pour un type très spécifique de changement de consensus. Ceci est examiné plus en détail dans <a href="#segwit">[segwit]</a>. Segwit est une modification architecturale de la structure d&#8217;une transaction, qui déplace le script de déverrouillage (témoin) de l&#8217;intérieur de la transaction vers une structure de données externe (en la séparant). Segwit a été initialement envisagé comme une mise à niveau de embranchement divergent, car il modifiait une structure fondamentale (transaction). En novembre 2015, un développeur travaillant sur Bitcoin Core a proposé un mécanisme par lequel segwit pourrait être introduit en tant que embranchement convergent. Le mécanisme utilisé pour cela est une modification du script de verrouillage d&#8217;UTXO créé selon les règles segwit, de sorte que les clients non mis à niveau voient le script de verrouillage comme échangeable avec n&#8217;importe quel script de déverrouillage. En conséquence, segwit peut être introduit sans nécessiter que chaque nœud soit mis à niveau ou séparé de la chaîne : un embranchement convergent.</p>
</div>
<div class="paragraph data-line-1029">
<p>Il est probable qu&#8217;il existe d&#8217;autres mécanismes, encore à découvrir, par lesquels les mises à niveau peuvent être effectuées de manière compatible avec les versions ultérieures en tant qu&#8217;embranchement convergent.</p>
</div>
</div>
</div>
<div class="sect3 data-line-1031">
<h4 id="_critiques_dembranchements_convergents">Critiques d&#8217;embranchements convergents</h4>
<div class="paragraph data-line-1033">
<p>Les embranchements convergents basés sur les opcodes NOP sont relativement peu controversés. Les opcodes NOP ont été placés dans Bitcoin Script dans le but explicite de permettre des mises à niveau non perturbatrices.</p>
</div>
<div class="paragraph data-line-1035">
<p>Cependant, de nombreux développeurs craignent que d&#8217;autres méthodes de mises à niveau d&#8217;embranchements convergents ne fassent des compromis inacceptables. Les critiques courantes des changements d&#8217;embranchement convergent incluent:</p>
</div>
<div class="dlist data-line-1037">
<dl>
<dt class="hdlist1">Dette technique</dt>
<dd>
<p>Étant donné que les embranchements convergents sont plus complexes techniquement qu&#8217;une mise à niveau de embranchements divergents, ils introduisent la <em>dette technique</em>, un terme qui fait référence à l&#8217;augmentation du coût futur de la maintenance du code en raison des compromis de conception effectués dans le passé. La complexité du code augmente à son tour la probabilité de bogues et de failles de sécurité.</p>
</dd>
<dt class="hdlist1">Assouplissement de la validation</dt>
<dd>
<p>les clients non mis à niveau voient les transactions comme valides, sans évaluer les règles de consensus modifiées. En effet, les clients non mis à niveau ne valident pas en utilisant la gamme complète des règles de consensus, car ils sont aveugles aux nouvelles règles. Cela s&#8217;applique aux mises à niveau basées sur NOP, ainsi qu&#8217;aux autres mises à niveau d&#8217;embranchements convergents.</p>
</dd>
<dt class="hdlist1">Mises à niveau irréversibles</dt>
<dd>
<p>Étant donné que les embranchements convergents créent des transactions avec des contraintes de consensus supplémentaires, elles deviennent des mises à niveau irréversibles dans la pratique. Si une mise à niveau d&#8217;embranchement convergent devait être annulée après avoir été activée, toute transaction créée selon les nouvelles règles pourrait entraîner une perte de fonds selon les anciennes règles. Par exemple, si une transaction CLTV est évaluée selon les anciennes règles, il n&#8217;y a pas de contrainte de timelock et elle peut être dépensée à tout moment. Par conséquent, les critiques soutiennent qu&#8217;un embranchement convergent défaillant qui devait être annulé à cause d&#8217;un bogue entraînerait presque certainement une perte de fonds.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2 data-line-1044">
<h3 id="softforksignaling">Signalisation d&#8217;embranchement convergent avec la version du bloc</h3>
<div class="paragraph data-line-1046">
<p>Puisque les embranchements convergents permettent aux clients non mis à jour de continuer à fonctionner dans le cadre du consensus, le mécanisme pour « activer » un embranchement convergent consiste à signaler que les mineurs sont prêts : une majorité de mineurs doit convenir qu&#8217;ils sont prêts et disposés à appliquer les nouvelles règles consensuelles. Pour coordonner leurs actions, il existe un mécanisme de signalisation qui leur permet de montrer leur soutien à un changement de règle consensuel. Ce mécanisme a été introduit avec l&#8217;activation de BIP-34 en mars 2013 et remplacé par l&#8217;activation de BIP-9 en juillet 2016.</p>
</div>
<div class="sect3 data-line-1048">
<h4 id="_signalisation_et_activation_bip_34">Signalisation et activation BIP-34</h4>
<div class="paragraph data-line-1050">
<p> La première implémentation, dans BIP-34, utilisait le champ de version de bloc pour permettre aux mineurs de signaler qu&#8217;ils étaient prêts pour un changement de règle de consensus spécifique. Avant le BIP-34, la version du bloc était définie par la valeur "1" par <em>convention</em> non appliquée par <em>consensus</em>.</p>
</div>
<div class="paragraph data-line-1052">
<p>BIP-34 a défini un changement de règle de consensus qui exigeait que le champ de données coinbase d&#8217;une entrée de transaction coinbase contienne la hauteur du bloc. Avant le BIP-34, les données coinbase pouvaient contenir toutes les données arbitraires que les mineurs choisissaient d&#8217;inclure. Après l&#8217;activation de BIP-34, les blocs valides devaient contenir une hauteur de bloc spécifique au début des données coinbase et être identifiés par un numéro de version supérieur ou égal à "2".</p>
</div>
<div class="paragraph data-line-1054">
<p>Pour signaler le changement et l&#8217;activation de BIP-34, les mineurs ont défini la version du bloc à "2" au lieu de "1". Cela n&#8217;a pas immédiatement rendu les blocs de la version "1" invalides. Une fois activés, les blocs de la version "1" deviendraient invalides et tous les blocs de la version "2" devraient contenir la hauteur du bloc dans la coinbase pour être valides.</p>
</div>
<div class="paragraph data-line-1056">
<p>BIP-34 a défini un mécanisme d&#8217;activation en deux étapes, basé sur une fenêtre glissante de 1000 blocs. Un mineur signalerait sa préparation individuelle pour le BIP-34 en construisant des blocs avec "2" comme numéro de version. À proprement parler, ces blocs n&#8217;avaient pas encore à se conformer à la nouvelle règle de consensus consistant à inclure la hauteur de bloc dans la transaction coinbase car la règle de consensus n&#8217;avait pas encore été activée. Les règles de consensus activées en deux étapes :</p>
</div>
<div class="ulist data-line-1058">
<ul>
<li class="data-line-1058">
<p>Si 75% (750 des 1000 blocs les plus récents) sont marqués avec la version "2", alors les blocs de la version "2" doivent contenir la hauteur du bloc dans la transaction coinbase ou ils sont rejetés comme invalides. Les blocs de version "1" sont toujours acceptés par le réseau et n&#8217;ont pas besoin de contenir de hauteur de bloc. Les anciennes et les nouvelles règles de consensus coexistent pendant cette période.</p>
</li>
<li class="data-line-1060">
<p>Lorsque 95 % (950 des 1 000 blocs les plus récents) sont de version "2", les blocs de version "1" ne sont plus considérés comme valides. Les blocs de la version "2" ne sont valides que s&#8217;ils contiennent la hauteur de bloc dans le coinbase (selon le seuil précédent). Par la suite, tous les blocs doivent respecter les nouvelles règles de consensus et tous les blocs valides doivent contenir la hauteur de bloc dans la transaction coinbase.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-1062">
<p>Après une signalisation et une activation réussies selon les règles BIP-34, ce mécanisme a été utilisé deux fois de plus pour activer les embranchements convergents :</p>
</div>
<div class="ulist data-line-1064">
<ul>
<li class="data-line-1064">
<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0066.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0066.mediawiki">BIP-66</a> Le codage DER strict des signatures a été activé par une signalisation de style BIP-34 avec une version de bloc "3" et invalidant la version "2" des blocs.</p>
</li>
<li class="data-line-1066">
<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP-65</a> CHECKLOCKTIMEVERIFY a été activé par la signalisation de style BIP-34 avec une version de bloc "4" et invalidant la version "3" des blocs.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-1068">
<p>Après l&#8217;activation de BIP-65, le mécanisme de signalisation et d&#8217;activation de BIP-34 a été retiré et remplacé par le mécanisme de signalisation BIP-9 décrit ci-après.</p>
</div>
<div class="paragraph data-line-1070">
<p>La norme est définie dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki">BIP-34 (Block v2, Height in Coinbase)</a>.</p>
</div>
</div>
<div class="sect3 data-line-1072">
<h4 id="_signalisation_et_activation_bip_9">Signalisation et activation BIP-9</h4>
<div class="paragraph data-line-1074">
<p> Le mécanisme utilisé par BIP-34, BIP-66 et BIP-65 a réussi à activer trois embranchements convergents. Cependant, il a été remplacé car il présentait plusieurs limitations :</p>
</div>
<div class="ulist data-line-1076">
<ul>
<li class="data-line-1076">
<p>En utilisant la valeur entière de la version du bloc, un seul embranchement convergent pouvait être activé à la fois, il fallait donc une coordination entre les propositions d&#8217;embranchements convergents et un accord sur leur hiérarchisation et leur séquencement.</p>
</li>
<li class="data-line-1078">
<p>De plus, étant donné que la version de bloc était incrémentée, le mécanisme n&#8217;offrait pas de moyen simple de rejeter une modification et d&#8217;en proposer une autre. Si d&#8217;anciens clients étaient toujours en cours d&#8217;exécution, ils pourraient confondre la signalisation d&#8217;une nouvelle modification avec la signalisation de la modification précédemment rejetée.</p>
</li>
<li class="data-line-1080">
<p>Chaque nouveau changement réduit irrévocablement les versions de blocs disponibles pour les changements futurs.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-1082">
<p>Le BIP-9 a été proposé pour surmonter ces défis et améliorer le rythme et la facilité de mise en œuvre des changements futurs.</p>
</div>
<div class="paragraph data-line-1084">
<p>BIP-9 interprète la version de bloc comme un champ de bits au lieu d&#8217;un entier. Étant donné que la version de bloc était à l&#8217;origine utilisée comme entier, versions 1 à 4, seuls 29 bits restent disponibles pour être utilisés comme champ de bits. Cela laisse 29 bits qui peuvent être utilisés pour signaler indépendamment et simultanément la disponibilité sur 29 propositions différentes.</p>
</div>
<div class="paragraph data-line-1086">
<p>BIP-9 fixe également un temps maximum pour la signalisation et l&#8217;activation. De cette façon, les mineurs n&#8217;ont pas besoin de signaler indéfiniment. Si une proposition n&#8217;est pas activée dans le délai TIMEOUT (défini dans la proposition), la proposition est considérée comme rejetée. La proposition peut être soumise à nouveau pour signalisation avec un bit différent, renouvelant la période d&#8217;activation.</p>
</div>
<div class="paragraph data-line-1088">
<p>De plus, après que le TIMEOUT est passé et qu&#8217;une fonctionnalité a été activée ou rejetée, le bit de signalisation peut être réutilisé pour une autre fonctionnalité sans confusion. Ainsi, jusqu&#8217;à 29 changements peuvent être signalés en parallèle et après TIMEOUT les bits peuvent être "recyclés" pour proposer de nouveaux changements.</p>
</div>
<div class="admonitionblock note data-line-1091">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-1092">
<p>Alors que les bits de signalisation peuvent être réutilisés ou recyclés, tant que la période de vote ne se chevauche pas, les auteurs du BIP-9 recommandent que les bits ne soient réutilisés que lorsque cela est nécessaire ; un comportement inattendu peut se produire en raison de bogues dans des logiciels plus anciens. En bref, nous ne devrions pas nous attendre à voir une réutilisation tant que les 29 bits n&#8217;auront pas été utilisés une fois.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-1095">
<p>Les modifications proposées sont identifiées par une structure de données contenant les champs suivants :</p>
</div>
<div class="dlist data-line-1097">
<dl>
<dt class="hdlist1">name</dt>
<dd>
<p>Une brève description utilisée pour distinguer les propositions. Le plus souvent, le BIP décrivant la proposition, comme "bipN", où N est le numéro du BIP.</p>
</dd>
<dt class="hdlist1">bit</dt>
<dd>
<p>0 à 28, le bit dans la version de bloc que les mineurs utilisent pour signaler l&#8217;approbation de cette proposition.</p>
</dd>
<dt class="hdlist1">starttime</dt>
<dd>
<p>Le temps (basé sur le temps passé médian, ou MTP) auquel la signalisation commence après lequel la valeur du bit est interprétée comme signalant la préparation de la proposition.</p>
</dd>
<dt class="hdlist1">endtime</dt>
<dd>
<p>Le temps (basé sur MTP) après lequel le changement est considéré comme rejeté s&#8217;il n&#8217;a pas atteint le seuil d&#8217;activation.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-1105">
<p>Contrairement à BIP-34, BIP-9 compte la signalisation d&#8217;activation dans des intervalles entiers en fonction de la période de reciblage de difficulté de 2016 blocs. Pour chaque période de reciblage, si la somme des blocs signalant une proposition dépasse 95 % (1 916 sur 2016), la proposition sera activée une période de reciblage plus tard.</p>
</div>
<div class="paragraph data-line-1107">
<p>BIP-9 propose un diagramme d&#8217;état de proposition pour illustrer les différentes étapes et transitions d&#8217;une proposition, comme indiqué dans <a href="#bip9states">BIP-9 diagramme de transition d&#8217;état</a>.</p>
</div>
<div class="paragraph data-line-1109">
<p>Les propositions commencent dans l&#8217;état DEFINED, une fois que leurs paramètres sont connus (définis) dans le logiciel bitcoin. Pour les blocs avec MTP après l&#8217;heure de début, l&#8217;état de la proposition passe à STARTED. Si le seuil de vote est dépassé dans une période de reciblage et que le délai d&#8217;attente n&#8217;a pas été dépassé, l&#8217;état de la proposition passe à LOCKED_IN. Une période de reciblage plus tard, la proposition devient ACTIVE. Les propositions restent perpétuellement dans l&#8217;état ACTIVE une fois qu&#8217;elles atteignent cet état. Si le délai d&#8217;attente s&#8217;est écoulé avant que le seuil de vote n&#8217;ait été atteint, l&#8217;état de la proposition passe à FAILED, indiquant une proposition rejetée. Les propositions FAILED restent perpétuellement dans cet état.</p>
</div>
<div id="bip9states" class="imageblock data-line-1113">
<div class="content">
<img src="images/mbc2_1010.png" alt="Diagramme de transition d&#8217;état de la proposition BIP-9">
</div>
<div class="title">Figure 10. BIP-9 diagramme de transition d&#8217;état</div>
</div>
<div class="paragraph data-line-1115">
<p>BIP-9 a d&#8217;abord été implémenté pour l&#8217;activation de CHECKSEQUENCEVERIFY et des BIP associés (68, 112, 113). La proposition nommée "csv" a été activée avec succès en juillet 2016.</p>
</div>
<div class="paragraph data-line-1117">
<p>La norme est définie dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki">BIP-9 (Version bits with timeout and delay)</a>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-1119">
<h3 id="_développement_de_logiciel_de_consensus">Développement de logiciel de consensus</h3>
<div class="paragraph data-line-1121">
<p>Le logiciel de consensus continue d&#8217;évoluer et il y a beaucoup de discussions sur les divers mécanismes pour changer le règles consensuelles. De par sa nature même, le bitcoin place la barre très haute en matière de coordination et de consensus pour les changements. En tant que système décentralisé, il n&#8217;a pas d'"autorité" qui puisse imposer sa volonté aux participants du réseau. Le pouvoir est réparti entre plusieurs groupes tels que les mineurs, les développeurs principaux, les développeurs de portefeuilles, les échanges, les commerçants et les utilisateurs finaux. Les décisions ne peuvent être prises unilatéralement par aucun de ces groupes. Par exemple, alors que les mineurs peuvent théoriquement changer les règles à la majorité simple (51%), ils sont contraints par le consentement des autres circonscriptions. S&#8217;ils agissent unilatéralement, le reste des participants peut simplement refuser de les suivre, gardant l&#8217;activité économique sur une chaîne minoritaire. Sans activité économique (transactions, marchands, portefeuilles, échanges), les mineurs exploiteront une pièce sans valeur avec des blocs vides. Cette diffusion du pouvoir signifie que tous les participants doivent se coordonner, sinon aucun changement ne peut être apporté. Le statu quo est l&#8217;état stable de ce système avec seulement quelques changements possibles s&#8217;il y a un fort consensus à une très large majorité. Le seuil de 95% pour les embranchements convergents reflète cette réalité.</p>
</div>
<div class="paragraph data-line-1123">
<p>Il est important de reconnaître qu&#8217;il n&#8217;y a pas de solution parfaite pour le développement d&#8217;un consensus. Les embranchements divergents et les embranchements convergents impliquent des compromis. Pour certains types de changements, les embranchements convergents peuvent être un meilleur choix ; pour d&#8217;autres, les embranchements divergents peuvent être un meilleur choix. Il n&#8217;y a pas de choix parfait; les deux comportent des risques. La seule caractéristique constante du développement de logiciels consensuels est que le changement est difficile et que le consensus oblige à faire des compromis.</p>
</div>
<div class="paragraph data-line-1125">
<p>Certains y voient une faiblesse des systèmes de consensus. Avec le temps, vous finirez peut-être par le voir comme moi, comme la plus grande force du système.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-23 18:49:37 -0400
</div>
</div>
</body>
</html>