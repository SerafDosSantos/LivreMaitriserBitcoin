<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 10.1.4" />
<title></title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overridden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="ch03_bitcoin_client">Bitcoin Core : La référence d&#39;implémentation</h2>
<div class="sectionbody">
<div class="paragraph"><p>Bitcoin est un projet <em>source libre</em> et le code source est disponible sous une licence ouverte (MIT), téléchargeable et utilisable à n&#39;importe quelle fin. Source libre signifie plus que simplement libre d&#39;utilisation. Cela signifie également que le bitcoin est développé par une communauté ouverte de bénévoles. Au début, cette communauté se composait uniquement de Satoshi Nakamoto. En 2016, le code source de Bitcoin comptait plus de 400 contributeurs avec une douzaine de développeurs travaillant sur le code presque à temps plein et plusieurs dizaines d&#39;autres à temps partiel. Tout le monde peut contribuer au code, y compris vous !</p></div>
<div class="paragraph"><p>(((&quot;Bitcoin Core&quot;, &quot;implémentation de référence&quot;) ))Lorsque bitcoin a été créé par Satoshi Nakamoto, le logiciel était en fait terminé avant le livre blanc reproduit dans <a href="#satoshi_whitepaper">[satoshi_whitepaper]</a>. Satoshi voulait s&#39;assurer que cela fonctionnait avant d&#39;écrire à ce sujet. Cette première implémentation, alors simplement connue sous le nom de &quot;Bitcoin&quot; ou &quot;client Satoshi&quot;, a été fortement modifiée et améliorée. Il a évolué vers ce qu&#39;on appelle <em>Bitcoin Core</em>, pour le différencier des autres implémentations compatibles. Bitcoin Core est la <em>mise en œuvre de référence</em> du système Bitcoin, ce qui signifie qu&#39;il s&#39;agit de la référence faisant autorité sur la manière dont chaque partie de la technologie doit être mise en œuvre. Bitcoin Core implémente tous les aspects du bitcoin, y compris les portefeuilles, un moteur de validation des transactions et des blocs et un nœud de réseau complet dans le réseau Bitcoin pair à pair.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph"><p> Même si Bitcoin Core inclut une implémentation de référence d&#39;un portefeuille, celui-ci n&#39;est pas destiné à être utilisé comme portefeuille de production pour les utilisateurs ou pour les applications. Il est conseillé aux développeurs d&#39;applications de créer des portefeuilles en utilisant des normes modernes telles que BIP-39 et BIP-32 (voir <a href="#mnemonic_code_words">[mnemonic_code_words]</a> et <a href="#hd_wallets">[hd_wallets]</a>). BIP signifie <em>Bitcoin Improvement Proposal</em>.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p><a href="#bitcoin_core_architecture">[bitcoin_core_architecture]</a> montre l&#39;architecture de Bitcoin Core.</p></div>
<div class="dlist" id="bitcoin_core_architecture"><div class="title">Architecture Bitcoin Core (Source : Eric Lombrozo)</div><dl>
<dt class="hdlist1">
image 
</dt>
<dd>
<p>
images/mbc2_0301.png[&quot;Architecture de base Bitcoin&quot;]
</p>
</dd>
</dl></div>
<div class="sect2">
<h3 id="_environnement_de_développement_bitcoin">Environnement de développement Bitcoin</h3>
<div class="paragraph"><p> Si vous êtes un développeur, vous souhaiterez configurer un environnement de développement avec tous les outils, bibliothèques et logiciels de support pour le développement d&#8217;applications bitcoin. Dans ce chapitre très technique, nous allons parcourir ce processus étape par étape. Si le matériel devient trop dense (et que vous n&#39;êtes pas en train de mettre en place un environnement de développement), n&#39;hésitez pas à passer au chapitre suivant, qui est moins technique.</p></div>
</div>
<div class="sect2">
<h3 id="compiling_core">Compilation de Bitcoin Core à partir du code source</h3>
<div class="paragraph"><p>Le code source de Bitcoin Core peut être téléchargé sous forme d&#39;archive ou en clonant le référentiel source faisant autorité à partir de GitHub. Sur la <a href="https://bitcoincore.org/bin/">page de téléchargement de Bitcoin Core</a>, sélectionnez la version la plus récente et téléchargez l&#39;archive compressée du code source, par exemple, <code>bitcoin-0.15.0.2.tar.gz</code>. Vous pouvez également utiliser la ligne de commande git pour créer une copie locale du code source à partir de la <a href="https://github.com/bitcoin/bitcoin">page GitHub de bitcoin</a>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph"><p>Dans de nombreux exemples de ce chapitre, nous utiliserons l&#39;interface de de commande du système d&#39;exploitation ( également appelé &quot;shell&quot; ou &quot;interface système&quot; ou &quot;coque logicielle&quot;), accessible via une application &quot;terminal&quot;. L&#8217;interface système affichera une invite; vous tapez une commande; et l&#8217;interface système répond avec du texte et une nouvelle invite pour votre prochaine commande. L&#39;invite peut sembler différente sur votre système, mais dans les exemples suivants, elle est indiquée par un symbole <code>$</code>. Dans les exemples, lorsque vous voyez du texte après un symbole <code>$</code>, ne tapez pas le symbole <code>$</code> mais tapez la commande qui le suit immédiatement, puis appuyez sur Entrée pour exécuter la commande. Dans les exemples, les lignes sous chaque commande sont les réponses du système d&#39;exploitation à cette commande. Lorsque vous verrez le prochain préfixe <code>$</code>, vous saurez qu&#39;il s&#39;agit d&#39;une nouvelle commande et vous devrez répéter le processus.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p> Dans cet exemple, nous utilisons la commande <code>git</code> pour créer une copie locale (un &quot;clone&quot;) du code source :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git clone https://github.com/bitcoin/bitcoin.git
Cloning into 'bitcoin'...
remote: Counting objects: 102071, done.
remote: Compressing objects: 100% (10/10), done.
Receiving objects: 100% (102071/102071), 86.38 MiB | 730.00 KiB/s, done.
remote: Total 102071 (delta 4), reused 5 (delta 1), pack-reused 102060
Resolving deltas: 100% (76168/76168), done.
Checking connectivity... done.
$</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph"><p>Git est le système de contrôle de version distribué le plus largement utilisé et un élément essentiel de la boîte à outils de tout développeur de logiciels. Vous devrez peut-être installer la commande <code>git</code>, ou une interface utilisateur graphique pour git, sur votre système d&#39;exploitation si vous ne l&#39;avez pas déjà.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>Une fois l&#39;opération de clonage git terminée, vous aurez une copie locale complète du référentiel de code source dans le répertoire <em>bitcoin</em>. Accédez à ce répertoire en tapant <code><strong>cd bitcoin</strong></code> à l&#39;invite :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ cd bitcoin</code></pre>
</div></div>
<div class="sect3">
<h4 id="_sélection_d_39_une_version_de_bitcoin_core">Sélection d&#39;une version de Bitcoin Core</h4>
<div class="paragraph"><p>Par défaut, la copie locale sera synchronisée avec le code le plus récent, qui peut être une version instable ou bêta de bitcoin. Avant de compiler le code, sélectionnez une version spécifique en consultant une version avec la commande Git <em>tag</em>. Cela synchronisera la copie locale avec un instantané (snapshot) spécifique du référentiel de code identifié par une balise de mot-clé (le <em>tag</em>.) Les balises sont utilisées par les développeurs pour marquer des versions spécifiques du code par numéro de version. Tout d&#39;abord, pour trouver les balises disponibles, nous utilisons la commande <code>git tag</code> :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git tag
v0.1.5
v0.1.6test1
v0.10.0
...
v0.11.2
v0.11.2rc1
v0.12.0rc1
v0.12.0rc2
...</code></pre>
</div></div>
<div class="paragraph"><p>La liste des balises montre toutes les versions publiées de bitcoin. Par convention, les <em>release candidates</em> (ou <em>versions d&#8217;évaluations</em>), qui sont destinées aux tests, ont le suffixe &quot;rc&quot;. Les versions stables pouvant être exécutées sur des systèmes de production n&#39;ont pas de suffixe. Dans la liste précédente, sélectionnez la version la plus élevée, qui au moment de la rédaction était v0.15.0. Pour synchroniser le code local avec cette version, utilisez la commande <code>git checkout</code> :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git checkout v0.15.0
HEAD is now at 3751912... Merge #11295: doc: Old fee_estimates.dat are discarded by 0.15.0</code></pre>
</div></div>
<div class="paragraph"><p>Vous pouvez confirmer que vous avez la version souhaitée &quot;extraite&quot; en lançant la commande <code>git status</code> :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git status
HEAD detached at v0.15.0
nothing to commit, working directory clean</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_configuration_de_la_construction_de_bitcoin_core">Configuration de la construction de Bitcoin Core</h4>
<div class="paragraph"><p>Le code source inclut la documentation, qui peut être trouvée dans un certain nombre de fichiers. Passez en revue la documentation principale située dans <em>README.md</em> dans le répertoire <em>bitcoin</em> en tapant <code><strong>more README.md</strong></code> à l&#39;invite et en utilisant la barre d&#39;espace pour passer à la page suivante. Dans ce chapitre, nous allons construire le client Bitcoin en ligne de commande, également connu sous le nom de <code>bitcoind</code> sous Linux. Passez en revue les instructions pour compiler le client de ligne de commande <code>bitcoind</code> sur votre plate-forme en tapant <code><strong>more doc/build-unix.md</strong></code>. Des instructions alternatives pour macOS et Windows peuvent être trouvées dans le répertoire <em>doc</em>, comme <em>build-osx.md</em> ou <em>build-windows.md</em>, respectivement.</p></div>
<div class="paragraph"><p>Examinez attentivement les prérequis de construction, qui se trouvent dans la première partie de la documentation de construction. Ce sont des bibliothèques qui doivent être présentes sur votre système avant de pouvoir commencer à compiler Bitcoin. Si ces conditions préalables sont manquantes, le processus de génération échouera avec une erreur. Si cela se produit parce que vous avez manqué une condition préalable, vous pouvez l&#39;installer, puis reprendre le processus de génération là où vous l&#39;avez laissé. En supposant que les prérequis sont installés, vous démarrez le processus de génération en générant un ensemble de scripts de génération à l&#39;aide du script <em>autogen.sh</em>.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ ./autogen.sh
...
glibtoolize: copying file 'build-aux/m4/libtool.m4'
glibtoolize: copying file 'build-aux/m4/ltoptions.m4'
glibtoolize: copying file 'build-aux/m4/ltsugar.m4'
glibtoolize: copying file 'build-aux/m4/ltversion.m4'
...
configure.ac:10: installing 'build-aux/compile'
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:9: installing 'build-aux/install-sh'
configure.ac:9: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
...</code></pre>
</div></div>
<div class="paragraph"><p>Le script <em>autogen.sh</em> crée un ensemble de scripts de configuration automatique qui interrogeront votre système pour découvrir les paramètres corrects et s&#39;assurer que vous disposez de toutes les bibliothèques nécessaires pour compiler le code. Le plus important d&#39;entre eux est le script <code>configure</code> qui offre un certain nombre d&#39;options différentes pour personnaliser le processus de construction. Tapez <code><strong>./configure --help</strong></code> pour voir les différentes options:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ ./configure --help
`configure' configures Bitcoin Core 0.15.0 to adapt to many kinds of systems.

Usage: ./configure [OPTION]... [VAR=VALUE]...

...
Optional Features:
  --disable-option-checking  ignore unrecognized --enable/--with options
  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]

  --enable-wallet         enable wallet (default is yes)

  --with-gui[=no|qt4|qt5|auto]
...</code></pre>
</div></div>
<div class="paragraph"><p>Le script <code>configure</code> vous permet d&#39;activer ou de désactiver certaines fonctionnalités de <code>bitcoind</code> grâce à l&#39;utilisation des drapeaux <code>--enable-FEATURE</code> et <code>--disable-FEATURE</code>, où <span class="keep-together"><code>FEATURE</code></span> est remplacé par le nom de la fonctionnalité, comme indiqué dans la sortie d&#39;aide. Dans ce chapitre, nous allons construire le client <code>bitcoind</code> avec toutes les fonctionnalités par défaut. Nous n&#39;utiliserons pas les indicateurs de configuration, mais vous devriez les consulter pour comprendre quelles fonctionnalités facultatives font partie du client. Si vous êtes dans un environnement universitaire, les restrictions du laboratoire informatique peuvent vous obliger à installer des applications dans votre répertoire personnel (par exemple, en utilisant <code>--prefix=$HOME</code>).</p></div>
<div class="paragraph"><p>Voici quelques options utiles qui remplacent le comportement par défaut du script configure:</p></div>
<dl>
<dt><code>--prefix=$HOME</code></dt>
<dd><p>Cela remplace l&#39;emplacement d&#39;installation par défaut (qui est <em>/usr/local/</em> ) pour l&#39;exécutable résultant. Utilisez <code>$HOME</code> pour tout mettre dans votre répertoire personnel, ou un chemin différent.</p></dd>

<dt><code>--disable-wallet</code></dt>
<dd><p>Ceci est utilisé pour désactiver l&#39;implémentation du portefeuille de référence.</p></dd>

<dt><code>--with-incompatible-bdb</code></dt>
<dd><p>Si vous construisez un portefeuille, autorisez l&#39;utilisation d&#39;une version incompatible de la bibliothèque Berkeley DB.</p></dd>

<dt><code>--with-gui=no</code></dt>
<dd><p>Ne construisez pas l&#39;interface utilisateur graphique, qui nécessite la bibliothèque Qt. Cela construit uniquement le bitcoin du serveur et de la ligne de commande.</p></dd>
</dl>
<div class="paragraph"><p>Ensuite, exécutez le script <code>configure</code> pour découvrir automatiquement toutes les bibliothèques nécessaires et créer un script de construction personnalisé pour votre système :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ ./configure
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
...
[de nombreuses pages de tests de configuration suivent]
...
$</code></pre>
</div></div>
<div class="paragraph"><p>Si tout s&#39;est bien passé, la commande <code>configure</code> se terminera par la création des scripts de construction personnalisés qui nous permettront de compiler <code>bitcoind</code>. S&#39;il y a des bibliothèques manquantes ou des erreurs, la commande <code>configure</code> se terminera par une erreur au lieu de créer les scripts de construction. Si une erreur se produit, elle est probablement due à une bibliothèque manquante ou incompatible. Relisez à nouveau la documentation de build et assurez-vous d&#39;installer les prérequis manquants. Ensuite, exécutez à nouveau <code>configure</code> et voyez si cela corrige l&#39;erreur.</p></div>
</div>
<div class="sect3">
<h4 id="_construire_les_exécutables_bitcoin_core">Construire les exécutables Bitcoin Core</h4>
<div class="paragraph"><p> Ensuite, vous allez compiler le code source, un processus qui peut prendre jusqu&#39;à une heure, en fonction de la vitesse de votre processeur et de la mémoire disponible. Pendant le processus de compilation, vous devriez voir une sortie toutes les quelques secondes ou toutes les quelques minutes, ou une erreur si quelque chose ne va pas. Si une erreur se produit ou si le processus de compilation est interrompu, il peut être repris à tout moment en tapant à nouveau <code>make</code>. Tapez <code><strong>make</strong></code> pour lancer la compilation de l&#39;application exécutable :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ make
Making all in src
  CXX      crypto/libbitcoinconsensus_la-hmac_sha512.lo
  CXX      crypto/libbitcoinconsensus_la-ripemd160.lo
  CXX      crypto/libbitcoinconsensus_la-sha1.lo
  CXX      crypto/libbitcoinconsensus_la-sha256.lo
  CXX      crypto/libbitcoinconsensus_la-sha512.lo
  CXX      libbitcoinconsensus_la-hash.lo
  CXX      primitives/libbitcoinconsensus_la-transaction.lo
  CXX      libbitcoinconsensus_la-pubkey.lo
  CXX      script/libbitcoinconsensus_la-bitcoinconsensus.lo
  CXX      script/libbitcoinconsensus_la-interpreter.lo

[... de nombreux autres messages de compilation suivent ...]

$</code></pre>
</div></div>
<div class="paragraph"><p>Sur un système rapide avec plusieurs processeurs, vous souhaiterez peut-être définir le nombre de tâches de compilation parallèles. Par exemple, <code>make -j 2</code> utilisera deux cœurs s&#39;ils sont disponibles. Si tout se passe bien, Bitcoin Core est maintenant compilé. Vous devez exécuter la suite de tests unitaires avec <code>make check</code> pour vous assurer que les bibliothèques liées ne sont pas cassées de manière évidente. La dernière étape consiste à installer les différents exécutables sur votre système à l&#39;aide de la commande <code>make install</code>. Vous serez peut-être invité à saisir votre mot de passe utilisateur, car cette étape nécessite des privilèges d&#39;administrateur:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ make check &amp;&amp; sudo make install
Password:
Making install in src
 ../build-aux/install-sh -c -d '/usr/local/lib'
libtool: install: /usr/bin/install -c bitcoind /usr/local/bin/bitcoind
libtool: install: /usr/bin/install -c bitcoin-cli /usr/local/bin/bitcoin-cli
libtool: install: /usr/bin/install -c bitcoin-tx /usr/local/bin/bitcoin-tx
...
$</code></pre>
</div></div>
<div class="paragraph"><p>L&#39;installation par défaut de <code>bitcoind</code> le place dans <em>/usr/local/bin</em>. Vous pouvez confirmer que Bitcoin Core est correctement installé en demandant au système le chemin des exécutables, comme suit:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ which bitcoind
/usr/local/bin/bitcoind

$ which bitcoin-cli
/usr/local/bin/bitcoin-cli</code></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="_exécution_d_39_un_nœud_bitcoin_core">Exécution d&#39;un nœud Bitcoin Core</h3>
<div class="paragraph"><p>Le réseau pair à pair de Bitcoin est composé de &quot;nœuds&quot; de réseau, gérés principalement par des bénévoles et certaines des entreprises qui créent des applications bitcoin. Ceux qui exécutent des nœuds Bitcoin ont une vue directe et faisant autorité sur la chaîne de blocs Bitcoin, avec une copie locale de toutes les transactions, validées indépendamment par leur propre système. En exécutant un nœud, vous n&#39;avez pas besoin de faire appel à un tiers pour valider une transaction. De plus, en exécutant un nœud Bitcoin, vous contribuez au réseau Bitcoin en le rendant plus robuste et sécuritaire.</p></div>
<div class="paragraph"><p>Cependant, l&#39;exécution d&#39;un nœud nécessite un système connecté en permanence avec suffisamment de ressources pour traiter toutes les transactions bitcoin. Selon que vous choisissez d&#39;indexer toutes les transactions et de conserver une copie complète de la chaîne de blocs, vous pouvez également avoir besoin de beaucoup d&#39;espace disque et de mémoire RAM. Au début de 2021, un nœud à index complet a besoin de 2 Go de RAM et d&#39;un minimum de 360 Go d&#39;espace disque (voir <a href="https://www.blockchain.com/charts/blocks-size">https://www.blockchain.com/charts/blocks-size</a>). Les nœuds Bitcoin transmettent et reçoivent également des transactions et des blocs Bitcoin, consommant de la bande passante Internet. Si votre connexion Internet est limitée, a un faible plafond de données ou est mesurée (facturée au gigabit), vous ne devriez probablement pas exécuter un nœud Bitcoin, ou l&#39;exécuter d&#39;une manière qui limite sa bande passante (voir <a href="#constrained_resources">[constrained_resources]</a>).</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph"><p>Bitcoin Core conserve une copie complète de la chaîne de blocs par défaut, avec chaque transaction qui s&#39;est déjà produite sur le Bitcoin réseau depuis sa création en 2009. Cet ensemble de données a une taille de dizaines de gigaoctets et est téléchargé de manière incrémentielle sur plusieurs jours ou semaines, en fonction de la vitesse de votre CPU et de votre connexion Internet. Bitcoin Core ne pourra pas traiter les transactions ou mettre à jour les soldes des comptes tant que l&#39;ensemble de données complet de la chaîne de blocs n&#39;aura pas été téléchargé. Assurez-vous que vous disposez de suffisamment d&#39;espace disque, de bande passante et de temps pour effectuer la synchronisation initiale. Vous pouvez configurer Bitcoin Core pour réduire la taille de la chaîne de blocs en supprimant les anciens blocs (voir <a href="#constrained_resources">[constrained_resources]</a>), mais il téléchargera tout de même l&#39;intégralité de l&#39;ensemble de données avant de les supprimer.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>Malgré ces besoins en ressources, des milliers de bénévoles gèrent des nœuds Bitcoin. Certains fonctionnent sur des systèmes aussi simples qu&#39;un Raspberry Pi (un ordinateur à 35$ US de la taille d&#39;un paquet de cartes). De nombreux volontaires exécutent également des nœuds Bitcoin sur des serveurs loués, généralement une variante de Linux. Une instance de <em>Virtual Private Server</em> (VPS ou serveur virtuel privé) ou <em>Cloud Computing Server</em> (ou serveur en infonuagique) peut être utilisée pour exécuter un nœud Bitcoin. Ces serveurs peuvent être loués pour 25$ à 50$ US par mois auprès de divers fournisseurs.</p></div>
<div class="paragraph"><p>Pourquoi voudriez-vous exécuter un nœud ? Voici quelques-unes des raisons les plus courantes :</p></div>
<div class="ulist"><ul>
<li>
<p>
Si vous développez un logiciel bitcoin et que vous devez vous fier à un nœud Bitcoin pour un accès programmable (API) au réseau et à la blockchain.
</p>
</li>
<li>
<p>
Si vous créez des applications qui doivent valider les transactions selon les règles de consensus de bitcoin. En règle générale, les éditeurs de logiciels Bitcoin exécutent plusieurs nœuds.
</p>
</li>
<li>
<p>
Si vous souhaitez prendre en charge le bitcoin. L&#39;exécution d&#39;un nœud rend le réseau plus robuste et capable de servir plus de portefeuilles, plus d&#39;utilisateurs et plus de transactions.
</p>
</li>
<li>
<p>
Si vous ne souhaitez pas vous fier à un tiers pour traiter ou valider vos transactions.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Si vous lisez ce livre et êtes intéressé par le développement d&#39;un logiciel Bitcoin, vous devriez exécuter votre propre nœud.</p></div>
<div class="sect3">
<h4 id="_configuration_du_nœud_bitcoin_core">Configuration du nœud Bitcoin Core</h4>
<div class="paragraph"><p>( &quot;sécurité&quot;Bitcoin Core recherchera un fichier de configuration dans son répertoire de données à chaque démarrage. Dans cette section, nous examinerons les différentes options de configuration et créerons un fichier de configuration. Pour localiser le fichier de configuration, exécutez <code>bitcoind -printtoconsole</code> dans votre terminal et recherchez les deux premières lignes.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ bitcoind -printtoconsole
Bitcoin version v0.15.0
Using the 'standard' SHA256 implementation
Using data directory /home/ubuntu/.bitcoin/
Using config file /home/ubuntu/.bitcoin/bitcoin.conf
...
[beaucoup plus de sortie de débogage]
...</code></pre>
</div></div>
<div class="paragraph"><p>Vous pouvez appuyer sur Ctrl-C pour fermer le nœud une fois que vous avez déterminé l&#39;emplacement du fichier de configuration. Habituellement, le fichier de configuration se trouve dans le répertoire de données <em>.bitcoin</em> sous le répertoire personnel de votre utilisateur. Il n&#39;est pas créé automatiquement, mais vous pouvez créer un fichier de configuration de démarrage en copiant et collant à partir de l&#39;exemple &lt;&lt;#full_index_node&gt;&gt; ci-dessous. Vous pouvez créer ou modifier le fichier de configuration dans votre éditeur préféré.</p></div>
<div class="paragraph"><p>Bitcoin Core propose plus de 100 options de configuration qui modifient le comportement du nœud de réseau, le stockage de la chaîne de blocs et de nombreux autres aspects de son fonctionnement. Pour voir une liste de ces options, exécutez <code>bitcoind --help</code> :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ bitcoind --help
Bitcoin Core Daemon version v0.15.0

Usage:
  bitcoind [options]                     Start Bitcoin Core Daemon

Options:

  -?
       Print this help message and exit

  -version
       Print version and exit

  -alertnotify=&lt;cmd&gt;
       Execute command when a relevant alert is received or we see a really
       long fork (%s in cmd is replaced by message)
...
[beaucoup plus d&amp;#39;options]
...

  -rpcthreads=&lt;n&gt;
       Set the number of threads to service RPC calls (default: 4)</code></pre>
</div></div>
<div class="paragraph"><p>Voici quelques-unes des options les plus importantes que vous pouvez définir dans le fichier de configuration, ou en tant que paramètres de ligne de commande pour <code>bitcoind</code> :</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
alertnotify
</dt>
<dd>
<p>
Exécute une commande ou un script spécifié pour envoyer des alertes d&#39;urgence au propriétaire de ce nœud, généralement par courriel.
</p>
</dd>
<dt class="hdlist1">
conf
</dt>
<dd>
<p>
Un emplacement alternatif pour le fichier de configuration. Cela n&#39;a de sens qu&#39;en tant que paramètre de ligne de commande pour <code>bitcoind</code>, car il ne peut pas se trouver dans le fichier de configuration auquel il se réfère.
</p>
</dd>
<dt class="hdlist1">
datadir
</dt>
<dd>
<p>
Sélectionnez le répertoire et le système de fichiers dans lesquels vous placer toutes les données de la chaîne de blocs. Par défaut, il s&#39;agit d&#8217;un sous-répertoire de <em>.bitcoin</em> de votre répertoire personnel. Assurez-vous que ce système de fichiers dispose de plusieurs gigaoctets d&#39;espace libre.
</p>
</dd>
<dt class="hdlist1">
prune
</dt>
<dd>
<p>
Réduisez les besoins en espace disque à ce nombre de mégaoctets, en supprimant les anciens blocs. Utilisez ceci sur un nœud à ressources limitées qui ne peut pas contenir la chaîne de blocs complète.
</p>
</dd>
<dt class="hdlist1">
txindex
</dt>
<dd>
<p>
Maintient un index de toutes les transactions. Cela signifie une copie complète de la chaîne de blocs. Cela vous permet de récupérer par programmation toute transaction par identifiant (ID).
</p>
</dd>
<dt class="hdlist1">
dbcache
</dt>
<dd>
<p>
La taille du cache UTXO. La valeur par défaut est 450 Mio. Augmentez cette valeur sur le matériel haut de gamme et réduisez la taille sur le matériel bas de gamme pour économiser de la mémoire au détriment des entrées-sorties des disques lents.
</p>
</dd>
<dt class="hdlist1">
maxconnections
</dt>
<dd>
<p>
Définissez le nombre maximal de nœuds à partir desquels accepter les connexions. Le réduire par défaut réduira votre consommation de bande passante. À utiliser si vous avez un plafond de données ou si vous payez au gigaoctet.
</p>
</dd>
<dt class="hdlist1">
maxmempool
</dt>
<dd>
<p>
Limite le bassin de mémoire de transaction à ce nombre de mégaoctets. Utilisez-le pour réduire l&#39;utilisation de la mémoire sur les nœuds à mémoire limitée.
</p>
</dd>
<dt class="hdlist1">
maxreceivebuffer/maxsendbuffer
</dt>
<dd>
<p>
Limite la mémoire tampon par connexion à ce nombre de multiples de 1000 octets. À utiliser sur les nœuds à mémoire limitée.
</p>
</dd>
<dt class="hdlist1">
minrelaytxfee
</dt>
<dd>
<p>
Définissez le taux de frais minimum pour la transaction que vous relayerez. En dessous de cette valeur, la transaction est traitée non standard, rejetée du bassin de transactions et non relayée.
</p>
</dd>
</dl></div>
<div class="sidebarblock" id="txindex">
<div class="content">
<div class="title">Index de la base de données des transactions et option txindex</div>
<div class="paragraph"><p>Par défaut, Bitcoin Core construit une base de données contenant <em>uniquement</em> les transactions liées au portefeuille de l&#39;utilisateur. Si vous voulez pouvoir accéder à <em>n&#39;importe quelle</em> transaction avec des commandes comme <code>getrawtransaction</code> (voir <a href="#exploring_and_decoding_transanctions">[exploring_and_decoding_transanctions]</a>), vous devez configurer Bitcoin Core pour créer un index de transaction complet, ce qui peut être réalisé avec l&#39;option <code>txindex</code>. Définissez <code>txindex=1</code> dans le fichier de configuration de Bitcoin Core. Si vous ne définissez pas cette option au début et que vous la réglez ensuite sur l&#39;indexation complète, vous devez redémarrer <code>bitcoind</code> avec l&#39;option <code>-reindex</code> et attendre qu&#39;elle reconstruise l&#39;index.</p></div>
</div></div>
<div class="paragraph"><p><a href="#full_index_node">[full_index_node]</a> montre comment vous pouvez combiner les options précédentes, avec un nœud entièrement indexé, fonctionnant comme un backend API pour une application bitcoin.</p></div>
<div class="exampleblock" id="full_index_node">
<div class="title">Example 1. Exemple de configuration d&#39;un nœud à index complet</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre><code>alertnotify=myemailscript.sh &amp;quot;Alerte : %s&amp;quot;
datadir=/lotsofspace/bitcoin
index_tx=1</code></pre>
</div></div>
</div></div>
<div class="paragraph"><p><a href="#constrained_resources">[constrained_resources]</a> montre un nœud à ressources limitées s&#39;exécutant sur un serveur plus petit.</p></div>
<div class="exampleblock" id="constrained_resources">
<div class="title">Example 2. Exemple de configuration d&#39;un système à ressources limitées</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre><code>alertnotify=myemailscript.sh &amp;quot;Alerte : %s&amp;quot;
maxconnexions=15
prune=5000
dbcache=150
maxmempool=150
maxreceivebuffer=2500
maxsendbuffer=500</code></pre>
</div></div>
</div></div>
<div class="paragraph"><p>Une fois que vous avez modifié le fichier de configuration et défini les options qui représentent le mieux vos besoins, vous pouvez tester <code>bitcoind</code> avec cette configuration. Exécutez Bitcoin Core avec l&#39;option <code>printtoconsole</code> pour s&#39;exécuter au premier plan avec une sortie vers la console :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ bitcoind -printtoconsole

Bitcoin version v0.15.0
InitParameterInteraction: parameter interaction: -whitelistforcerelay=1 -&gt; setting -whitelistrelay=1
Assuming ancestors of block 0000000000000000003b9ce759c2a087d52abc4266f8f4ebd6d768b89defa50a have valid signatures.
Using the 'standard' SHA256 implementation
Default data directory /home/ubuntu/.bitcoin
Using data directory /lotsofspace/.bitcoin
Using config file /home/ubuntu/.bitcoin/bitcoin.conf
Using at most 125 automatic connections (1048576 file descriptors available)
Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements
Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements
Using 2 threads for script verification
HTTP: creating work queue of depth 16
No rpcpassword set - using random cookie authentication
Generated RPC authentication cookie /lotsofspace/.bitcoin/.cookie
HTTP: starting 4 worker threads
init message: Verifying wallet(s)...
Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)
Using wallet wallet.dat
CDBEnv::Open: LogDir=/lotsofspace/.bitcoin/database ErrorFile=/lotsofspace/.bitcoin/db.log
scheduler thread start
Cache configuration:
* Using 250.0MiB for block index database
* Using 8.0MiB for chain state database
* Using 1742.0MiB for in-memory UTXO set (plus up to 286.1MiB of unused mempool space)
init message: Loading block index...
Opening LevelDB in /lotsofspace/.bitcoin/blocks/index
Opened LevelDB successfully

[... plus de messages de démarrage ...]</code></pre>
</div></div>
<div class="paragraph"><p>Vous pouvez appuyer sur Ctrl-C pour interrompre le processus une fois que vous êtes convaincu qu&#39;il charge les paramètres correctement et s&#39;exécute comme prévu.</p></div>
<div class="paragraph"><p>Pour exécuter Bitcoin Core en arrière-plan en tant que processus, démarrez-le avec l&#39;option <code>daemon</code>, en tant que <code>bitcoind -daemon</code>.</p></div>
<div class="paragraph"><p>Pour surveiller la progression et l&#39;état d&#39;exécution de votre nœud Bitcoin, utilisez la commande <code>bitcoin-cli getblockchaininfo</code> :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ bitcoin-cli getblockchaininfo</code></pre>
</div></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">{</span>
  "chain": "<span style="color: #FF0000">main</span>"<span style="color: #990000">,</span>
  "blocks": <span style="color: #993399">0</span><span style="color: #990000">,</span>
  "headers": <span style="color: #993399">83999</span><span style="color: #990000">,</span>
  "bestblockhash": "<span style="color: #FF0000">000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</span>"<span style="color: #990000">,</span>
  "difficulty": <span style="color: #993399">1</span><span style="color: #990000">,</span>
  "mediantime": <span style="color: #993399">1231006505</span><span style="color: #990000">,</span>
  "verificationprogress": <span style="color: #993399">3.783041623201835e-09</span><span style="color: #990000">,</span>
  "chainwork": "<span style="color: #FF0000">0000000000000000000000000000000000000000000000000000000100010001</span>"<span style="color: #990000">,</span>
  "pruned": <span style="font-weight: bold"><span style="color: #0000FF">false</span></span><span style="color: #990000">,</span>
  <span style="color: #990000">[</span>...<span style="color: #990000">]</span>
<span style="color: #990000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Cela montre un nœud avec une hauteur de blockchain de 0 blocs et 83999 en-têtes. Le nœud récupère actuellement les en-têtes de bloc de la meilleure chaîne et continue ensuite à télécharger les blocs complets.</p></div>
<div class="paragraph"><p>Une fois que vous êtes satisfait des options de configuration que vous avez sélectionnées, vous devez ajouter <em>bitcoin</em> aux scripts de démarrage de votre système d&#39;exploitation, afin qu&#39;il s&#39;exécute en continu et au redémarrage du système d&#39;exploitation. Vous trouverez un certain nombre d&#39;exemples de scripts de démarrage pour différents systèmes d&#39;exploitation dans le répertoire source de bitcoin sous <em>contrib/init</em> et un fichier <em>README.md</em> indiquant quel système utilise quel script.(( (&quot;&quot;, startref=&quot;BNcore03&quot;)))</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_interface_de_programmation_d_39_application_api_de_base_bitcoin">Interface de programmation d&#39;application (API) de base Bitcoin</h3>
<div class="paragraph"><p>Le client Bitcoin Core implémente une interface JSON-RPC accessible également à l&#39;aide de l&#39;assistant de ligne de commande <code>bitcoin-cli</code>. La ligne de commande nous permet d&#39;expérimenter de manière interactive les fonctionnalités qui sont également disponibles par programmation via l&#39;API. Pour commencer, appelez la commande <code>help</code> pour voir une liste des commandes RPC bitcoin disponibles :</p></div>
<div class="listingblock" id="bitcoind_commands">
<div class="content">
<pre><code>$ bitcoin-cli help
addmultisigaddress nrequired ["key",...] ( "account" )
addnode "node" "add|remove|onetry"
backupwallet "destination"
createmultisig nrequired ["key",...]
createrawtransaction [{"txid":"id","vout":n},...] {"address":amount,...}
decoderawtransaction "hexstring"
...
...
verifymessage "bitcoinaddress" "signature" "message"
walletlock
walletpassphrase "passphrase" timeout
walletpassphrasechange "oldpassphrase" "newpassphrase"</code></pre>
</div></div>
<div class="paragraph"><p>Chacune de ces commandes peut prendre un certain nombre de paramètres. Pour obtenir une aide supplémentaire, une description détaillée et des informations sur les paramètres, ajoutez le nom de la commande après <code>help</code>. Par exemple, pour voir l&#39;aide sur la commande <code>getblockhash</code> RPC :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ bitcoin-cli help getblockhash
getblockhash height

Returns hash of block in best-block-chain at height provided.

Arguments:
1. height         (numeric, required) The height index

Result:
"hash"         (string) The block hash

Examples:
&gt; bitcoin-cli getblockhash 1000
&gt; curl --user myusername --data-binary '{"jsonrpc": "1.0", "id":"curltest", "method": "getblockhash", "params": [1000] }' -H 'content-type: text/plain;' http://127.0.0.1:8332/</code></pre>
</div></div>
<div class="paragraph"><p>À la fin des informations d&#39;aide, vous verrez deux exemples de la commande RPC, utilisant l&#39;assistant <code>bitcoin-cli</code> ou le client HTTP <code>curl</code>. Ces exemples montrent comment vous pouvez appeler la commande. Copiez le premier exemple et voyez le résultat :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ bitcoin-cli getblockhash 1000
00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09</code></pre>
</div></div>
<div class="paragraph"><p>Le résultat est un hachage de bloc, qui est décrit plus en détail dans les chapitres suivants. Mais pour l&#39;instant, cette commande devrait renvoyer le même résultat sur votre système, démontrant que votre nœud Bitcoin Core est en cours d&#39;exécution, accepte les commandes et dispose d&#39;informations sur le bloc 1000 à vous renvoyer.</p></div>
<div class="paragraph"><p>Dans les sections suivantes, nous allons démontrer quelques commandes RPC très utiles et leur sortie attendue.</p></div>
<div class="sect3">
<h4 id="_obtenir_des_informations_sur_l_39_état_du_client_bitcoin_core">Obtenir des informations sur l&#39;état du client Bitcoin Core</h4>
<div class="paragraph"><p>Bitcoin Core fournit des rapports d&#39;état sur différents modules via l&#39;interface JSON-RPC. Les commandes les plus importantes incluent <code>getblockchaininfo</code>, <code>getmempoolinfo</code>, <code>getnetworkinfo</code> et <code>getwalletinfo</code>.</p></div>
<div class="paragraph"><p>La commande <code>getblockchaininfo</code> RPC de Bitcoin a été introduite plus tôt. La commande <code>getnetworkinfo</code> affiche des informations de base sur l&#39;état du nœud de réseau Bitcoin. Utilisez <code>bitcoin-cli</code> pour l&#39;exécuter :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ bitcoin-cli getnetworkinfo</code></pre>
</div></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>  "version": <span style="color: #993399">150000</span><span style="color: #990000">,</span>
  "subversion": "<span style="color: #FF0000">/Satoshi:0.15.0/</span>"<span style="color: #990000">,</span>
  "protocolversion": <span style="color: #993399">70015</span><span style="color: #990000">,</span>
  "localservices": "<span style="color: #FF0000">000000000000000d</span>"<span style="color: #990000">,</span>
  "localrelay": <span style="font-weight: bold"><span style="color: #0000FF">true</span></span><span style="color: #990000">,</span>
  "timeoffset": <span style="color: #993399">0</span><span style="color: #990000">,</span>
  "networkactive": <span style="font-weight: bold"><span style="color: #0000FF">true</span></span><span style="color: #990000">,</span>
  "connections": <span style="color: #993399">8</span><span style="color: #990000">,</span>
  "networks": <span style="color: #990000">[</span>
    ...
    detailed information about all networks (ipv4<span style="color: #990000">,</span> ipv6 or onion)
    ...
  <span style="color: #990000">],</span>
  "relayfee": <span style="color: #993399">0.00001000</span><span style="color: #990000">,</span>
  "incrementalfee": <span style="color: #993399">0.00001000</span><span style="color: #990000">,</span>
  "localaddresses": <span style="color: #990000">[</span>
  <span style="color: #990000">],</span>
  "warnings": ""
<span style="color: #990000">}</span>
</tt></pre></div></div>
<div class="paragraph"><p>Les données sont renvoyées en JavaScript Object Notation (JSON), un format qui peut facilement être &quot;consommé&quot; par tous les langages de programmation mais qui est également assez lisible par l&#39;homme. Parmi ces données, nous voyons les numéros de version du client logiciel bitcoin (150000) et du protocole Bitcoin (70015). On y voit le nombre actuel de connexions (8) et diverses informations sur le réseau Bitcoin et les paramètres liés à ce client.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph"><p>Il faudra un certain temps, peut-être plus d&#39;une journée, pour que le client <code>bitcoind</code> &quot;rattrape&quot; la hauteur actuelle de la chaîne de blocs lorsqu&#39;il télécharge des blocs d&#39;autres clients Bitcoin. Vous pouvez vérifier sa progression en utilisant <code>getblockchaininfo</code> pour voir le nombre de blocs connus.</p></div>
</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="exploring_and_decoding_transanctions">Explorer et décoder les transactions</h4>
<div class="paragraph"><p>Commandes : <code>getrawtransaction</code>, <code>decoderawtransaction</code></p></div>
<div class="paragraph"><p>Dans <a href="#cup_of_coffee">[cup_of_coffee]</a>, Alice a acheté une tasse de café au Bob&#39;s Cafe. Sa transaction a été enregistrée sur la blockchain avec l&#39;identifiant de transaction (<code>txid</code>) <code>0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2</code>. Utilisons l&#39;API pour récupérer et examiner cette transaction en transmettant l&#39;identifiant de transaction en tant que paramètre :</p></div>
<pre data-type="programlisting">
$ bitcoin-cli getrawtransaction 0627052b6f28912f2703066a912ea577f2ce4da4caa5a&#x21b5;
5fbd8a57286c345c2f2

0100000001186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd734d2804fe65fa35779000&#x21b5;
000008b483045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4&#x21b5;
ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813014&#x21b5;
10484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc54123363767&#x21b5;
89d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adfffffffff0260e3160000000&#x21b5;
0001976a914ab68025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef8000000000001976a9&#x21b5;
147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac00000000
</pre>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph"><p>Un identifiant de transaction ne fait pas autorité tant qu&#39;une transaction n&#39;a pas été confirmée. L&#39;absence d&#39;un hachage de transaction dans la blockchain ne signifie pas que la transaction n&#39;a pas été traitée. C&#39;est ce qu&#39;on appelle la &quot;malléabilité des transactions&quot;, car les hachages de transaction peuvent être modifiés avant la confirmation dans un bloc. Après confirmation, le <code>txid</code> est immuable et fait autorité.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>La commande <code>getrawtransaction</code> renvoie une transaction sérialisée en notation hexadécimale. Pour décoder cela, nous utilisons la commande <code>decoderawtransaction</code>, en passant les données hexadécimales en paramètre. Vous pouvez copier l&#39;hex renvoyé par <code>getrawtransaction</code> et le coller en tant que paramètre dans <code>decoderawtransaction</code> :</p></div>
<pre data-type="programlisting">
$ bitcoin-cli decoderawtransaction 0100000001186f9f998a5aa6f048e51dd8419a14d8&#x21b5;
a0f1a8a2836dd734d2804fe65fa35779000000008b483045022100884d142d86652a3f47ba474&#x21b5;
6ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298&#x21b5;
cad530a863ea8f53982c09db8f6e381301410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fd&#x21b5;
e0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa&#x21b5;
336a8d752adfffffffff0260e31600000000001976a914ab68025513c3dbd2f7b92a94e0581f5&#x21b5;
d50f654e788acd0ef8000000000001976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8&#x21b5;
88ac00000000

</pre>
<pre data-type="programlisting" data-code-language="json">
{
  "txid": "0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2",
  "size": 258,
  "version": 1,
  "locktime": 0,
  "vin": [
    {
      "txid": "7957a35fe64f80d234d76d83a2...8149a41d81de548f0a65a8a999f6f18",
      "vout": 0,
      "scriptSig": {
        "asm":"3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1decc...",
        "hex":"483045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1de..."
      },
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 0.01500000,
      "n": 0,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 ab68...5f654e7 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a914ab68025513c3dbd2f7b92a94e0581f5d50f654e788ac",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": [
          "1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA"
        ]
      }
    },
    {
      "value": 0.08450000,
      "n": 1,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 7f9b1a...025a8 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": [
          "1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK"
        ]
      }
    }
  ]
}

</pre>
<div class="paragraph"><p>Le décodage de la transaction montre tous les composants de cette transaction, y compris les entrées et les sorties de la transaction. Dans ce cas, nous voyons que la transaction qui a crédité notre nouvelle adresse de 15 millibits a utilisé une entrée et généré deux sorties. L&#39;entrée de cette transaction était la sortie d&#39;une transaction précédemment confirmée (indiquée par <code>txid</code> commençant par <code>7957a35fe</code>). Les deux sorties correspondent au crédit de 15 millibits et une sortie avec retour à l&#39;expéditeur.</p></div>
<div class="paragraph"><p>Nous pouvons explorer davantage la chaîne de blocs en examinant la transaction précédente référencée par son <code>txid</code> dans cette transaction en utilisant les mêmes commandes (par exemple, <code>getrawtransaction</code>). En sautant d&#39;une transaction à l&#39;autre, nous pouvons suivre une chaîne de transactions à mesure que les pièces sont transmises d&#39;adresse de propriétaire à adresse de propriétaire.</p></div>
</div>
<div class="sect3">
<h4 id="_explorer_les_blocs">Explorer les blocs</h4>
<div class="paragraph"><p>Commandes : <code>getblock</code>, <code>getblockhash</code></p></div>
<div class="paragraph"><p>L&#39;exploration de blocs est similaire à l&#39;exploration de transactions. Cependant, les blocs peuvent être référencés soit par la <em>hauteur</em> du bloc (<em>height</em>), soit par le résultat de <em>hachage</em> (ou <em>hash</em>) du bloc. Tout d&#39;abord, trouvons un bloc par sa hauteur. Dans <a href="#cup_of_coffee">[cup_of_coffee]</a>, nous avons vu que la transaction d&#39;Alice était incluse dans le bloc 277316.</p></div>
<div class="paragraph"><p>Nous utilisons la commande <code>getblockhash</code>, qui prend la hauteur du bloc comme paramètre et renvoie le hachage pour ce bloc :</p></div>
<pre data-type="programlisting">
$ bitcoin-cli getblockhash 277316
0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4
</pre>
<div class="paragraph"><p>Maintenant que nous savons dans quel bloc la transaction d&#39;Alice était incluse, nous pouvons interroger ce bloc. Nous utilisons la commande <code>getblock</code> avec le hachage de bloc comme paramètre :</p></div>
<pre data-type="programlisting">
$ bitcoin-cli getblock 0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b3&#x21b5;
1b2cc7bdc4
</pre>
<pre data-type="programlisting" data-code-language="json">
{
  "hash": "0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4",
  "confirmations": 37371,
  "size": 218629,
  "height": 277316,
  "version": 2,
  "merkleroot": "c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e",
  "tx": [
    "d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f",
    "b268b45c59b39d759614757718b9918caf0ba9d97c56f3b91956ff877c503fbe",
    "04905ff987ddd4cfe603b03cfb7ca50ee81d89d1f8f5f265c38f763eea4a21fd",
    "32467aab5d04f51940075055c2f20bbd1195727c961431bf0aff8443f9710f81",
    "561c5216944e21fa29dd12aaa1a45e3397f9c0d888359cb05e1f79fe73da37bd",
[... des centaines de transactions ...]
    "78b300b2a1d2d9449b58db7bc71c3884d6e0579617e0da4991b9734cef7ab23a",
    "6c87130ec283ab4c2c493b190c20de4b28ff3caf72d16ffa1ce3e96f2069aca9",
    "6f423dbc3636ef193fd8898dfdf7621dcade1bbe509e963ffbff91f696d81a62",
    "802ba8b2adabc5796a9471f25b02ae6aeee2439c679a5c33c4bbcee97e081196",
    "eaaf6a048588d9ad4d1c092539bd571dd8af30635c152a3b0e8b611e67d1a1af",
    "e67abc6bd5e2cac169821afc51b207127f42b92a841e976f9b752157879ba8bd",
    "d38985a6a1bfd35037cb7776b2dc86797abbb7a06630f5d03df2785d50d5a2ac",
    "45ea0a3f6016d2bb90ab92c34a7aac9767671a8a84b9bcce6c019e60197c134b",
    "c098445d748ced5f178ef2ff96f2758cbec9eb32cb0fc65db313bcac1d3bc98f"
  ],
  "time": 1388185914,
  "mediantime": 1388183675,
  "nonce": 924591752,
  "bits": "1903a30c",
  "difficulty": 1180923195.258026,
  "chainwork": "000000000000000000000000000000000000000000000934695e92aaf53afa1a",
  "previousblockhash": "0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569",
  "nextblockhash": "000000000000000010236c269dd6ed714dd5db39d36b33959079d78dfd431ba7"
}
</pre>
<div class="paragraph"><p>Le bloc contient 419 transactions et la 64ème transaction répertoriée (<code>0627052b&#8230;</code>) est le paiement du café d&#39;Alice. L&#39;entrée + hauteur + nous indique qu&#39;il s&#39;agit du 277316e bloc de la blockchain.</p></div>
</div>
<div class="sect3">
<h4 id="_utilisation_de_l_39_interface_de_programmation_de_bitcoin_core">Utilisation de l&#39;interface de programmation de Bitcoin Core</h4>
<div class="paragraph"><p>L&#39;assistant <code>bitcoin-cli</code> est très utile pour explorer la bibliothèue (API) Bitcoin Core et les fonctions de test. Mais tout l&#39;intérêt d&#39;une interface de programmation d&#39;application est d&#39;accéder aux fonctions par programmation. Dans cette section, nous montrerons comment accéder à Bitcoin Core à partir d&#39;un autre programme.</p></div>
<div class="paragraph"><p>L&#39;API de Bitcoin Core est une interface JSON-RPC. JSON signifie JavaScript Object Notation et c&#39;est un moyen très pratique de présenter des données que les humains et les programmes peuvent facilement lire. RPC signifie Remote Procedure Call (ou appel de procédure à distance), ce qui signifie que nous appelons des procédures (fonctions) distantes (sur le nœud Bitcoin Core) via un protocole réseau. Dans ce cas, le protocole réseau est HTTP ou HTTPS (pour les connexions cryptées).</p></div>
<div class="paragraph"><p>Lorsque nous avons utilisé la commande <code>bitcoin-cli</code> pour obtenir de l&#39;aide sur une commande, elle nous a montré un exemple d&#39;utilisation de <code>curl</code>, le client HTTP polyvalent en ligne de commande pour construire l&#39;un de ces appels JSON-RPC :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ curl --user myusername --data-binary '{"jsonrpc": "1.0", "id":"curltest", "method": "getblockchaininfo", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:8332/</code></pre>
</div></div>
<div class="paragraph"><p>Cette commande montre que <code>curl</code> soumet une requête HTTP à l&#39;hôte local (127.0.0.1), se connecte au port bitcoin par défaut (8332) et soumet une requête <code>jsonrpc</code> pour la méthode <code>getblockchaininfo</code> en utilisant l&#39;encodage <code>text/plain</code>.</p></div>
<div class="paragraph"><p>Vous remarquerez peut-être que curl demandera que les informations d&#39;identification soient envoyées avec la demande. Bitcoin Core créera un mot de passe aléatoire à chaque démarrage et le placera dans le répertoire de données sous le nom <code>.cookie</code>. L&#39;assistant <code>bitcoin-cli</code> peut lire ce fichier de mots de passe étant donné le répertoire de données. De même, vous pouvez copier le mot de passe et le transmettre à curl (ou à tout wrapper Bitcoin Core RPC de niveau supérieur). Alternativement, vous pouvez créer un mot de passe statique avec le script d&#39;assistance fourni dans <em>./share/rpcauth/rpcauth.py</em> dans le répertoire source de Bitcoin Core.</p></div>
<div class="paragraph"><p>Si vous implémentez un appel JSON-RPC dans votre propre programme, vous pouvez utiliser une bibliothèque HTTP générique pour construire l&#39;appel, similaire à ce qui est montré dans l&#39;exemple <code>curl</code> précédent.</p></div>
<div class="paragraph"><p>Cependant, il existe des bibliothèques dans la plupart des langages de programmation qui &quot;enveloppent&quot; l&#39;API Bitcoin Core d&#39;une manière qui rend cela beaucoup plus simple. Nous utiliserons la bibliothèque <code>python-bitcoinlib</code> pour simplifier l&#39;accès à l&#39;API. N&#39;oubliez pas que cela nécessite que vous disposiez d&#39;une instance Bitcoin Core en cours d&#39;exécution, qui sera utilisée pour effectuer des appels JSON-RPC.</p></div>
<div class="paragraph"><p>Le script Python dans <a href="#rpc_example">[rpc_example]</a> effectue un simple appel <code>getblockchaininfo</code> et imprime le paramètre <code>blocks</code> à partir des données renvoyées par Bitcoin Core (nœud complet requis).</p></div>
<div class="exampleblock" id="rpc_example">
<div class="title">Example 3. Exécution de getblockchaininfo via l&#39;API JSON-RPC de Bitcoin Core</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">from</span></span> bitcoin<span style="color: #990000">.</span>rpc <span style="font-weight: bold"><span style="color: #000080">import</span></span> RawProxy

<span style="font-style: italic"><span style="color: #9A1900"># Create a connection to local Bitcoin Core node</span></span>
p <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">RawProxy</span></span><span style="color: #990000">()</span>

<span style="font-style: italic"><span style="color: #9A1900"># Run the getinfo command, store the resulting data in info</span></span>
info <span style="color: #990000">=</span> p<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">getinfo</span></span><span style="color: #990000">()</span>

<span style="font-style: italic"><span style="color: #9A1900"># Retrieve the 'blocks' element from the info</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">print</span></span><span style="color: #990000">(</span>info<span style="color: #990000">[</span><span style="color: #FF0000">'blocks'</span><span style="color: #990000">])</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>Son exécution nous donne le résultat suivant:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ python rpc_example.py
394075</code></pre>
</div></div>
<div class="paragraph"><p>Il nous indique que notre nœud local Bitcoin Core a 394075 blocs dans sa chaîne de blocs. Ce n&#39;est pas un résultat spectaculaire, mais cela démontre l&#39;utilisation de base de la bibliothèque en tant qu&#39;interface simplifiée avec l&#39;API JSON-RPC de Bitcoin Core.</p></div>
<div class="paragraph"><p>Ensuite, utilisons les appels <code>getrawtransaction</code> et <code>decodetransaction</code> pour récupérer les détails du paiement du café d&#39;Alice. Dans <a href="#rpc_transaction">[rpc_transaction]</a>, nous récupérons la transaction d&#39;Alice et listons les sorties de la transaction. Pour chaque sortie, nous affichons l&#39;adresse et la valeur du destinataire. Pour rappel, la transaction d&#39;Alice avait une sortie pour payer Bob&#39;s Cafe et une sortie pour rendre la monnaie à Alice.</p></div>
<div class="exampleblock" id="rpc_transaction">
<div class="title">Example 4. Récupérer une transaction et itérer ses sorties</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">from</span></span> bitcoin<span style="color: #990000">.</span>rpc <span style="font-weight: bold"><span style="color: #000080">import</span></span> RawProxy

p <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">RawProxy</span></span><span style="color: #990000">()</span>

<span style="font-style: italic"><span style="color: #9A1900"># Alice's transaction ID</span></span>
txid <span style="color: #990000">=</span> <span style="color: #FF0000">"0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2"</span>

<span style="font-style: italic"><span style="color: #9A1900"># First, retrieve the raw transaction in hex</span></span>
raw_tx <span style="color: #990000">=</span> p<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">getrawtransaction</span></span><span style="color: #990000">(</span>txid<span style="color: #990000">)</span>

<span style="font-style: italic"><span style="color: #9A1900"># Decode the transaction hex into a JSON object</span></span>
decoded_tx <span style="color: #990000">=</span> p<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">decoderawtransaction</span></span><span style="color: #990000">(</span>raw_tx<span style="color: #990000">)</span>

<span style="font-style: italic"><span style="color: #9A1900"># Retrieve each of the outputs from the transaction</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">for</span></span> output <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> decoded_tx<span style="color: #990000">[</span><span style="color: #FF0000">'vout'</span><span style="color: #990000">]:</span>
    <span style="font-weight: bold"><span style="color: #0000FF">print</span></span><span style="color: #990000">(</span>output<span style="color: #990000">[</span><span style="color: #FF0000">'scriptPubKey'</span><span style="color: #990000">][</span><span style="color: #FF0000">'addresses'</span><span style="color: #990000">],</span> output<span style="color: #990000">[</span><span style="color: #FF0000">'value'</span><span style="color: #990000">])</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>En exécutant ce code, nous obtenons :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ python rpc_transaction.py
([u'1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA'], Decimal('0.01500000'))
([u'1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK'], Decimal('0.08450000'))</code></pre>
</div></div>
<div class="paragraph"><p>Les deux exemples précédents sont assez simples. Vous n&#39;avez pas vraiment besoin d&#39;un programme pour les exécuter ; vous pouvez tout aussi bien utiliser l&#39;assistant <code>bitcoin-cli</code>. L&#39;exemple suivant, cependant, nécessite plusieurs centaines d&#39;appels RPC et démontre plus clairement l&#39;utilisation d&#39;une interface de programmation.</p></div>
<div class="paragraph"><p>Dans <a href="#rpc_block">[rpc_block]</a>, nous récupérons d&#39;abord le bloc 277316, puis récupérons chacune des 419 transactions en référence à chaque identifiant de transaction. Ensuite, nous parcourons chacune des sorties de la transaction et additionnons la valeur.</p></div>
<div class="exampleblock" id="rpc_block">
<div class="title">Example 5. Récupération d&#39;un bloc et ajout de toutes les sorties de transaction</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">from</span></span> bitcoin<span style="color: #990000">.</span>rpc <span style="font-weight: bold"><span style="color: #000080">import</span></span> RawProxy

p <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">RawProxy</span></span><span style="color: #990000">()</span>

<span style="font-style: italic"><span style="color: #9A1900"># The block height where Alice's transaction was recorded</span></span>
blockheight <span style="color: #990000">=</span> <span style="color: #993399">277316</span>

<span style="font-style: italic"><span style="color: #9A1900"># Get the block hash of block with height 277316</span></span>
blockhash <span style="color: #990000">=</span> p<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">getblockhash</span></span><span style="color: #990000">(</span>blockheight<span style="color: #990000">)</span>

<span style="font-style: italic"><span style="color: #9A1900"># Retrieve the block by its hash</span></span>
block <span style="color: #990000">=</span> p<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">getblock</span></span><span style="color: #990000">(</span>blockhash<span style="color: #990000">)</span>

<span style="font-style: italic"><span style="color: #9A1900"># Element tx contains the list of all transaction IDs in the block</span></span>
transactions <span style="color: #990000">=</span> block<span style="color: #990000">[</span><span style="color: #FF0000">'tx'</span><span style="color: #990000">]</span>

block_value <span style="color: #990000">=</span> <span style="color: #993399">0</span>

<span style="font-style: italic"><span style="color: #9A1900"># Iterate through each transaction ID in the block</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">for</span></span> txid <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> transactions<span style="color: #990000">:</span>
    tx_value <span style="color: #990000">=</span> <span style="color: #993399">0</span>
    <span style="font-style: italic"><span style="color: #9A1900"># Retrieve the raw transaction by ID</span></span>
    raw_tx <span style="color: #990000">=</span> p<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">getrawtransaction</span></span><span style="color: #990000">(</span>txid<span style="color: #990000">)</span>
    <span style="font-style: italic"><span style="color: #9A1900"># Decode the transaction</span></span>
    decoded_tx <span style="color: #990000">=</span> p<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">decoderawtransaction</span></span><span style="color: #990000">(</span>raw_tx<span style="color: #990000">)</span>
    <span style="font-style: italic"><span style="color: #9A1900"># Iterate through each output in the transaction</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> output <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> decoded_tx<span style="color: #990000">[</span><span style="color: #FF0000">'vout'</span><span style="color: #990000">]:</span>
        <span style="font-style: italic"><span style="color: #9A1900"># Add up the value of each output</span></span>
        tx_value <span style="color: #990000">=</span> tx_value <span style="color: #990000">+</span> output<span style="color: #990000">[</span><span style="color: #FF0000">'value'</span><span style="color: #990000">]</span>

    <span style="font-style: italic"><span style="color: #9A1900"># Add the value of this transaction to the total</span></span>
    block_value <span style="color: #990000">=</span> block_value <span style="color: #990000">+</span> tx_value

<span style="font-weight: bold"><span style="color: #0000FF">print</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Total value in block: "</span><span style="color: #990000">,</span> block_value<span style="color: #990000">)</span>


</tt></pre></div></div>
</div></div>
<div class="paragraph"><p>En exécutant ce code, nous obtenons :</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ python rpc_block.py

('Total value in block: ', Decimal('10322.07722534'))</code></pre>
</div></div>
<div class="paragraph"><p>Notre exemple de code calcule que la valeur totale des transactions dans ce bloc est de 10 322,07722534 BTC (dont 25 BTC de récompense et 0,0909 BTC de frais). Comparez cela au montant rapporté par un site d&#39;exploration de blocs en recherchant le hachage ou la hauteur du bloc. Certains explorateurs de blocs rapportent la valeur totale hors récompense et hors frais. Voyez si vous pouvez repérer la différence.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="alt_libraries">Clients, bibliothèques et boîtes à outils alternatifs</h3>
<div class="paragraph"><p> Il existe de nombreux clients alternatifs, bibliothèques, boîtes à outils et même des implémentations de nœuds complets dans l&#39;écosystème bitcoin. Ceux-ci sont implémentés dans une variété de langages de programmation, offrant aux programmeurs des interfaces natives dans leur langue préférée.</p></div>
<div class="paragraph"><p>Les sections suivantes répertorient certaines des meilleures bibliothèques, clients et kits d&#39;outils, organisés par langages de programmation.</p></div>
<div class="sect3">
<h4 id="_c_c">C/C++</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://github.com/bitcoin/bitcoin">Bitcoin Core</a>
</dt>
<dd>
<p>
L&#39;implémentation de référence de bitcoin
</p>
</dd>
<dt class="hdlist1">
<a href="https://github.com/libbitcoin/libbitcoin-system">libbitcoin</a>
</dt>
<dd>
<p>
Boîte à outils de développement C++ multiplateforme, nœud et bibliothèque de consensus
</p>
</dd>
<dt class="hdlist1">
<a href="https://github.com/libbitcoin/libbitcoin-explorer">bitcoin explorer</a>
</dt>
<dd>
<p>
L&#39;outil de ligne de commande de Libbitcoin
</p>
</dd>
<dt class="hdlist1">
<a href="https://github.com/jgarzik/picocoin">picocoin</a>
</dt>
<dd>
<p>
Bibliothèque cliente légère en langage C pour bitcoin par Jeff Garzik
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_javascript">JavaScript</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://bcoin.io/">bcoin</a>
</dt>
<dd>
<p>
Une implémentation modulaire et évolutive de nœud complet avec API
</p>
</dd>
<dt class="hdlist1">
<a href="https://bitcore.io/">Bitcore</a>
</dt>
<dd>
<p>
Noeud complet, API et bibliothèque par Bitpay
</p>
</dd>
<dt class="hdlist1">
<a href="https://github.com/bitcoinjs/bitcoinjs-lib">BitcoinJS</a>
</dt>
<dd>
<p>
Une pure bibliothèque Bitcoin en JavaScript pour node.js et les navigateurs
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_java">Java</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://bitcoinj.github.io">bitcoinj</a> 
</dt>
<dd>
<p>
Une bibliothèque client Java à nœud complet
</p>
</dd>
</dl></div>
<div class="paragraph"><p>====PHP
<a href="https://github.com/bit-wasp/bitcoin-php">bitwasp/bitcoin</a>:: Une bibliothèque Bitcoin en PHP et des projets associés</p></div>
<div class="paragraph"><p>====Python
<a href="https://github.com/petertodd/python-bitcoinlib">python-bitcoinlib</a>:: Une bibliothèque Bitcoin en Python dont une bibliothèque de consensus et un nœud par Peter Todd
<a href="https://github.com/richardkiss/pycoin">pycoin</a>:: Une bibliothèque Bitcoin en Python par Richard Kiss
<a href="https://github.com/primal100/pybitcointools">pybitcointools</a>:: Une fourche archivé de la bibliothèque Bitcoin en Python par Vitalik Buterin</p></div>
</div>
<div class="sect3">
<h4 id="_ruby">Ruby</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://github.com/sinisterchipmunk/bitcoin-client">bitcoin-client</a>
</dt>
<dd>
<p>
Un wrapper de bibliothèque Ruby pour l&#39;API JSON-RPC
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_go">Go</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://github.com/btcsuite/btcd">btcd</a>
</dt>
<dd>
<p>
Un client Bitcoin à nœud complet en langage Go
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_rust">Rust</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://github.com/rust-bitcoin/rust-bitcoin">rust-bitcoin</a>
</dt>
<dd>
<p>
Bibliothèque Bitcoin Rust pour la sérialisation, l&#39;analyse et les appels d&#39;API
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_c">C#</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://github.com/MetacoSA/NBitcoin">NBitcoin</a>
</dt>
<dd>
<p>
Bibliothèque Bitcoin complète pour le framework .NET
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_objective_c">Objective-C</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
<a href="https://github.com/oleganza/CoreBitcoin">CoreBitcoin</a> 
</dt>
<dd>
<p>
Boîte à outils Bitcoin pour ObjC et Swift
</p>
</dd>
</dl></div>
<div class="paragraph"><p>De nombreuses autres bibliothèques existent dans une variété d&#39;autres langages de programmation et d&#39;autres sont créées tout le temps.</p></div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2022-03-04 00:28:11 EST
</div>
</div>
</body>
</html>
