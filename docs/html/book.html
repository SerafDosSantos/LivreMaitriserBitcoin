<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Ma√Ætriser Bitcoin</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
<h1>Ma√Ætriser Bitcoin</h1>
</div>
<div id="content">
<div class="sect1 data-line-2">
<h2 id="_pr√©face">Pr√©face</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-4">
<h3 id="_√©crire_le_livre_bitcoin">√âcrire le livre Bitcoin</h3>
<div class="paragraph data-line-6">
<p>Je suis tomb√© sur bitcoin pour la premi√®re fois √† la mi-2011. Ma r√©action imm√©diate a √©t√© plus ou moins "Pfft ! Nerd money !" et je l&#8217;ai ignor√© pendant encore six mois, n&#8217;en saisissant pas l&#8217;importance. C&#8217;est une r√©action que j&#8217;ai vue se r√©p√©ter chez bon nombre des personnes les plus intelligentes que je connaisse, ce qui me r√©conforte un peu. La deuxi√®me fois que je suis tomb√© sur bitcoin, lors d&#8217;une discussion sur une liste de diffusion, j&#8217;ai d√©cid√© de lire le livre blanc √©crit par Satoshi Nakamoto pour √©tudier la source faisant autorit√© et voir de quoi il s&#8217;agissait. Je me souviens encore du moment o√π j&#8217;ai fini de lire ces neuf pages, quand j&#8217;ai r√©alis√© que le bitcoin n&#8217;√©tait pas simplement une monnaie num√©rique, mais un r√©seau de confiance qui pouvait aussi fournir la base de bien plus que de simples devises. La prise de conscience que "ce n&#8217;est pas de l&#8217;argent, c&#8217;est un r√©seau de confiance d√©centralis√©", m&#8217;a lanc√© dans un voyage de quatre mois pour d√©vorer toutes les informations sur le bitcoin que j&#8217;ai pu trouver. Je suis devenu obs√©d√© et captiv√©, passant 12 heures ou plus par jour coll√© √† un √©cran, lisant, √©crivant, codant et apprenant autant que possible. Je suis sorti de cet √©tat de fugue, plus de 20 livres en moins √† cause du manque de repas r√©guliers, d√©termin√© √† me consacrer au travail sur le bitcoin.</p>
</div>
<div class="paragraph data-line-8">
<p>Deux ans plus tard, apr√®s avoir cr√©√© un certain nombre de petites start-ups pour explorer divers services et produits li√©s au bitcoin, j&#8217;ai d√©cid√© qu&#8217;il √©tait temps d&#8217;√©crire mon premier livre. Bitcoin √©tait le sujet qui m&#8217;avait pouss√© dans une fr√©n√©sie de cr√©ativit√© et consomm√© mes pens√©es; c&#8217;√©tait la technologie la plus excitante que j&#8217;avais rencontr√©e depuis Internet. Il √©tait maintenant temps de partager ma passion pour cette technologie incroyable avec un public plus large.</p>
</div>
</div>
<div class="sect2 data-line-10">
<h3 id="_public_vis√©">Public vis√©</h3>
<div class="paragraph data-line-12">
<p>Ce livre est principalement destin√© aux codeurs. Si vous pouvez utiliser un langage de programmation, ce livre vous apprendra comment fonctionnent les monnaies cryptographiques, comment les utiliser et comment d√©velopper des logiciels qui fonctionnent avec elles. Les premiers chapitres conviennent √©galement comme une introduction approfondie au bitcoin pour les non-codeurs, tel ceux qui veulent comprendre le fonctionnement interne du bitcoin et des crypto-monnaies.</p>
</div>
</div>
<div class="sect2 data-line-14">
<h3 id="_les_conventions_utilis√©es_dans_ce_livre">Les conventions utilis√©es dans ce livre</h3>
<div class="paragraph data-line-16">
<p>Les conventions typographiques suivantes sont utilis√©es dans ce livre¬†:</p>
</div>
<div class="dlist data-line-18">
<dl>
<dt class="hdlist1"><em>Italique</em></dt>
<dd>
<p>Indique de nouveaux termes, URL, adresses e-mail, noms de fichiers et extensions de fichiers.</p>
</dd>
<dt class="hdlist1"><code>Largeur constante</code></dt>
<dd>
<p>Utilis√© pour les listes de programmes, ainsi que dans les paragraphes pour faire r√©f√©rence √† des √©l√©ments de programme tels que des noms de variables ou de fonctions, des bases de donn√©es, des types de donn√©es, des variables d&#8217;environnement, des instructions et des mots-cl√©s.</p>
</dd>
<dt class="hdlist1"><code><strong>Largeur constante en gras</strong></code></dt>
<dd>
<p>Affiche les commandes ou tout autre texte qui doit √™tre saisi litt√©ralement par l&#8217;utilisateur.</p>
</dd>
<dt class="hdlist1"><code><em>Largeur constante en italique</em></code></dt>
<dd>
<p>Affiche le texte qui doit √™tre remplac√© par des valeurs fournies par l&#8217;utilisateur ou par des valeurs d√©termin√©es par le contexte.</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip data-line-28">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-29">
<p>Cette ic√¥ne signifie un conseil ou une suggestion.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note data-line-33">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-34">
<p>Cette ic√¥ne signifie une note g√©n√©rale.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning data-line-38">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-39">
<p>Cette ic√¥ne indique un avertissement ou une mise en garde.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 data-line-42">
<h3 id="_exemples_de_codes">Exemples de codes</h3>
<div class="paragraph data-line-44">
<p>Les exemples sont illustr√©s en Python, C++, et en utilisant la ligne de commande d&#8217;un syst√®me d&#8217;exploitation de type Unix tel que Linux ou macOS. Tous les extraits de code sont disponibles dans le r√©f√©rentiel GitHub (<a href="https://github.com/bitcoinbook/bitcoinbook" data-href="https://github.com/bitcoinbook/bitcoinbook">https://github.com/bitcoinbook/bitcoinbook</a>) dans le sous-r√©pertoire <em>code</em> du r√©f√©rentiel principal. Fourchez le code du livre, essayez les exemples de code ou soumettez des corrections via GitHub.</p>
</div>
<div class="paragraph data-line-46">
<p>Tous les extraits de code peuvent √™tre r√©pliqu√©s sur la plupart des syst√®mes d&#8217;exploitation avec une installation minimale de compilateurs et d&#8217;interpr√©teurs pour les langages correspondants. Si n√©cessaire, nous fournissons des instructions d&#8217;installation de base et des exemples √©tape par √©tape de la sortie de ces instructions.</p>
</div>
<div class="paragraph data-line-48">
<p>Certains des extraits de code et des sorties de code ont √©t√© reformat√©s pour l&#8217;impression. Dans tous ces cas, les lignes ont √©t√© s√©par√©es par un caract√®re barre oblique inverse (\), suivi d&#8217;un caract√®re de saut de ligne. Lors de la transcription des exemples, supprimez ces deux caract√®res et rejoignez les lignes √† nouveau et vous devriez voir des r√©sultats identiques comme indiqu√© dans l&#8217;exemple.</p>
</div>
<div class="paragraph data-line-50">
<p>Tous les extraits de code utilisent des valeurs r√©elles et des calculs dans la mesure du possible, afin que vous puissiez construire d&#8217;exemple en exemple et voir les m√™mes r√©sultats dans n&#8217;importe quel code que vous √©crivez pour calculer les m√™mes valeurs. Par exemple, les cl√©s priv√©es et les cl√©s et adresses publiques correspondantes sont toutes r√©elles. Les exemples de transactions, de blocs et de r√©f√©rences de cha√Æne de blocs ont tous √©t√© introduits dans la cha√Æne de blocs bitcoin r√©elle et font partie du grand livre public, vous pouvez donc les consulter sur n&#8217;importe quel syst√®me bitcoin.</p>
</div>
</div>
<div class="sect2 data-line-52">
<h3 id="_adresses_et_transactions_bitcoin_dans_ce_livre">Adresses et transactions Bitcoin dans ce livre</h3>
<div class="paragraph data-line-54">
<p>Les adresses bitcoin, les transactions, les cl√©s, les codes QR et les donn√©es de cha√Æne de blocs utilis√©es dans ce livre sont, pour la plupart, r√©elles. Cela signifie que vous pouvez parcourir la cha√Æne de blocs, regarder les transactions propos√©es en exemple, les r√©cup√©rer avec vos propres scripts ou programmes, etc.</p>
</div>
<div class="paragraph data-line-56">
<p>Cependant, notez que les cl√©s priv√©es utilis√©es pour construire les adresses sont soit imprim√©es dans ce livre, soit ont √©t√© "radi√©es". Cela signifie que si vous envoyez de l&#8217;argent √† l&#8217;une de ces adresses, l&#8217;argent sera perdu pour toujours ou, dans certains cas, tous ceux qui peuvent lire ce livre peuvent le prendre en utilisant les cl√©s priv√©es imprim√©es dans celui-ci.</p>
</div>
<div class="admonitionblock warning data-line-59">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-60">
<p>N&#8217;ENVOYEZ PAS D&#8217;ARGENT AUX ADRESSES DANS CE LIVRE. Votre argent sera pris par un autre lecteur, ou perdu √† jamais.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 data-line-63">
<h3 id="_publication_par_oreilly_media">Publication par O&#8217;Reilly Media</h3>
<div class="paragraph data-line-65">
<p>Ce livre est d√©riv√© sous licence du livre "Mastering Bitcoin 2nd Edition", par O&#8217;Reilly Media.</p>
</div>
</div>
<div class="sect2 data-line-67">
<h3 id="_droit_dauteur_et_licence_de_livre">Droit d&#8217;auteur et licence de livre</h3>
<div class="paragraph data-line-69">
<p>Copyright (c) 2014 Andreas M. Antonopoulos LLC</p>
</div>
<div class="paragraph data-line-71">
<p>Ce travail est sous licence Creative Commons Attribution-ShareAlike 4.0 International License. Pour voir une copie de cette licence, visitez</p>
</div>
<div class="paragraph data-line-73">
<p><a href="http://creativecommons.org/licenses/by-sa/4.0/" class="undefined" data-href="http://creativecommons.org/licenses/by-sa/4.0/">http://creativecommons.org/licenses/by-sa/4.0/</a>.</p>
</div>
<div class="paragraph data-line-75">
<p>Pour fournir une attribution, veuillez cr√©er un lien vers le r√©f√©rentiel du livre¬†:</p>
</div>
<div class="paragraph data-line-77">
<p><a href="https://github.com/bitcoinbook/bitcoinbook" class="undefined" data-href="https://github.com/bitcoinbook/bitcoinbook">https://github.com/bitcoinbook/bitcoinbook</a></p>
</div>
<div class="paragraph data-line-79">
<p>et inclure cette licence ou une licence ouverte √©quivalente, pour satisfaire aux exigences ShareAlike.</p>
</div>
<div class="paragraph data-line-81">
<p>Cette licence conforme √† la "Culture libre" a √©t√© approuv√©e par mon √©diteur O&#8217;Reilly Media (<a href="http://oreilly.com" class="undefined" data-href="http://oreilly.com">http://oreilly.com</a>), qui comprend la valeur du mouvement de source ouverte. O&#8217;Reilly Media n&#8217;est pas seulement le meilleur √©diteur de livres techniques au monde, mais aussi un fervent partisan d&#8217;une culture ouverte et du partage des connaissances.</p>
</div>
<div class="paragraph data-line-83">
<p>Merci O&#8217;Reilly !</p>
</div>
</div>
<div class="sect2 pagebreak-before data-line-86">
<h3 id="_contacter_lauteur">Contacter l&#8217;auteur</h3>
<div class="paragraph data-line-88">
<p>Vous pouvez me contacter, Andreas M. Antonopoulos, sur mon site personnel :
<a href="https://aantonop.com/" class="undefined" data-href="https://aantonop.com/">https://aantonop.com/</a></p>
</div>
<div class="paragraph data-line-91">
<p>Des informations sur <em>Ma√Ætriser Bitcoin (Mastering Bitcoin en anglais)</em> ainsi que l&#8217;√âdition Ouverte et les traductions sont disponibles sur :
<a href="https://bitcoinbook.info/" class="undefined" data-href="https://bitcoinbook.info/">https://bitcoinbook.info/</a></p>
</div>
<div class="paragraph data-line-94">
<p>Suivez-moi sur Twitter:
<a href="https://twitter.com/aantonop" class="undefined" data-href="https://twitter.com/aantonop">https://twitter.com/aantonop</a></p>
</div>
<div class="paragraph data-line-97">
<p>Retrouvez plus de 500 vid√©os p√©dagogiques sur ma cha√Æne YouTube :
<a href="https://youtube.com/aantonop" class="undefined" data-href="https://youtube.com/aantonop">https://youtube.com/aantonop</a></p>
</div>
<div class="paragraph data-line-100">
<p>Un grand merci √† tous mes m√©c√®nes qui soutiennent mon travail par des dons mensuels. Vous pouvez suivre ma page Patreon ici :
<a href="https://patreon.com/aantonop" class="undefined" data-href="https://patreon.com/aantonop">https://patreon.com/aantonop</a></p>
</div>
</div>
<div class="sect2 data-line-103">
<h3 id="_remerciements">Remerciements</h3>
<div class="paragraph data-line-105">
<p>Ce livre repr√©sente les efforts et les contributions de nombreuses personnes. Je suis reconnaissant pour toute l&#8217;aide que j&#8217;ai re√ßue d&#8217;amis, de coll√®gues et m√™me de parfaits inconnus, qui m&#8217;ont rejoint dans cet effort pour √©crire le livre technique d√©finitif sur les crypto-monnaies et le bitcoin.</p>
</div>
<div class="paragraph data-line-107">
<p>Il est impossible de faire une distinction entre la technologie bitcoin et la communaut√© bitcoin, et ce livre est autant un produit de cette communaut√© qu&#8217;un livre sur la technologie. Mon travail sur ce livre a √©t√© encourag√©, applaudi, soutenu et r√©compens√© par toute la communaut√© bitcoin du tout d√©but jusqu&#8217;√† la toute fin. Plus que tout, ce livre m&#8217;a permis de faire partie d&#8217;une merveilleuse communaut√© pendant deux ans et je ne vous remercierai jamais assez de m&#8217;avoir accept√© dans cette communaut√©. Il y a beaucoup trop de personnes √† mentionner par leur nom - des personnes que j&#8217;ai rencontr√©es lors de conf√©rences, d&#8217;√©v√©nements, de s√©minaires, de rencontres, de pizzas et de petits rassemblements priv√©s, ainsi que beaucoup qui ont communiqu√© avec moi par Twitter, sur reddit, sur bitcointalk. org, et sur GitHub qui ont eu un impact sur ce livre. Chaque id√©e, analogie, question, r√©ponse et explication que vous trouverez dans ce livre a √©t√© √† un moment donn√© inspir√©e, test√©e ou am√©lior√©e gr√¢ce √† mes interactions avec la communaut√©. Merci √† tous pour votre soutien; sans vous ce livre n&#8217;aurait pas vu le jour. Je suis √©ternellement reconnaissant.</p>
</div>
<div class="paragraph data-line-109">
<p>Le voyage pour devenir auteur commence bien avant le premier livre, bien s√ªr. Ma premi√®re langue (et ma scolarit√©) √©tait le grec, j&#8217;ai donc d√ª suivre un cours de rattrapage en anglais √©crit lors de ma premi√®re ann√©e d&#8217;universit√©. Je dois remercier Diana Kordas, mon professeur d&#8217;√©criture d&#8217;anglais, qui m&#8217;a aid√© √† d√©velopper ma confiance et mes comp√©tences cette ann√©e-l√†. Plus tard, en tant que professionnel, j&#8217;ai d√©velopp√© mes comp√©tences en r√©daction technique sur le th√®me des centres de donn√©es, en √©crivant pour le magazine <em>Network World</em>. Je dois remercier John Dix et John Gallant, qui m&#8217;ont donn√© mon premier travail d&#8217;√©criture en tant que chroniqueur √† <em>Network World</em> et √† mon √©diteur Michael Cooney et mon coll√®gue Johna Till Johnson qui ont √©dit√© mes chroniques et les ont rendues aptes √† la publication. √âcrire 500 mots par semaine pendant quatre ans m&#8217;a donn√© suffisamment d&#8217;exp√©rience pour √©ventuellement envisager de devenir auteur.</p>
</div>
<div class="paragraph data-line-111">
<p>Merci √©galement √† ceux qui m&#8217;ont soutenu lorsque j&#8217;ai soumis ma proposition de livre √† O&#8217;Reilly, en fournissant des r√©f√©rences et en examinant la proposition. Plus pr√©cis√©ment, merci √† John Gallant, Gregory Ness, Richard Stiennon, Joel Snyder, Adam B. Levine, Sandra Gittlen, John Dix, Johna Till Johnson, Roger Ver et Jon Matonis. Remerciements particuliers √† Richard Kagan et Tymon Mattoszko, qui ont r√©vis√© les premi√®res versions de la proposition et √† Matthew Taylor, qui a r√©vis√© la proposition.</p>
</div>
<div class="paragraph data-line-113">
<p>Merci √† Cricket Liu, auteur du titre O&#8217;Reilly <em>DNS et BIND</em>, qui m&#8217;a pr√©sent√© O&#8217;Reilly. Merci √©galement √† Michael Loukides et Allyson MacDonald de O&#8217;Reilly, qui ont travaill√© pendant des mois pour aider √† la r√©alisation de ce livre. Allyson a √©t√© particuli√®rement patiente lorsque les d√©lais ont √©t√© manqu√©s et les livrables retard√©s alors que la vie intervenait dans notre √©ch√©ancier. Pour la deuxi√®me √©dition, je remercie Timothy McGovern d&#8217;avoir guid√© le processus, Kim Cofer d&#8217;avoir patiemment √©dit√© et Rebecca Panzer d&#8217;avoir illustr√© de nombreux nouveaux diagrammes.</p>
</div>
<div class="paragraph data-line-115">
<p>Les premi√®res √©bauches des premiers chapitres ont √©t√© les plus difficiles, car le bitcoin est un sujet difficile √† d√©m√™ler. Chaque fois que je tirais sur un fil de la technologie bitcoin, je devais tirer sur le tout. Je me suis retrouv√© coinc√© √† plusieurs reprises et un peu d√©courag√© alors que je luttais pour rendre le sujet facile √† comprendre et cr√©er un r√©cit autour d&#8217;un sujet technique aussi dense. Finalement, j&#8217;ai d√©cid√© de raconter l&#8217;histoire du bitcoin √† travers les histoires des personnes utilisant le bitcoin et tout le livre est devenu beaucoup plus facile √† √©crire. Je dois remercier mon ami et mentor, Richard Kagan, qui m&#8217;a aid√© √† d√©m√™ler l&#8217;histoire et √† surmonter les moments de blocage de l&#8217;√©crivain. Je remercie Pamela Morgan, qui a r√©vis√© les premi√®res √©bauches de chaque chapitre de la premi√®re et de la deuxi√®me √©dition du livre, et a pos√© les questions difficiles pour les am√©liorer. Merci √©galement aux d√©veloppeurs du groupe San Francisco Bitcoin Developers Meetup ainsi qu&#8217;√† Taariq Lewis et Denise Terry pour avoir aid√© √† tester le premier mat√©riel. Merci √©galement √† Andrew Naugler pour la conception infographique.</p>
</div>
<div class="paragraph data-line-117">
<p>Pendant le d√©veloppement du livre, j&#8217;ai rendu les premi√®res √©bauches disponibles sur GitHub et j&#8217;ai invit√© les commentaires du public. Plus d&#8217;une centaine de commentaires, suggestions, corrections et contributions ont √©t√© soumis en r√©ponse. Ces contributions sont explicitement reconnues, avec mes remerciements, dans <a href="#github_contrib">Version pr√©liminaire (contributions GitHub)</a>. Surtout, mes sinc√®res remerciements √† mes √©diteurs b√©n√©voles de GitHub, Ming T. Nguyen (1√®re √©dition) et Will Binns (2e √©dition), qui ont travaill√© sans rel√¢che pour organiser, g√©rer et r√©soudre les demandes d&#8217;extraction, publier des rapports et effectuer des corrections de bogues sur GitHub.</p>
</div>
<div class="paragraph data-line-119">
<p>Une fois le livre r√©dig√©, il est pass√© par plusieurs s√©ries d&#8217;examens techniques. Merci √† Cricket Liu et Lorne Lantz pour leur examen approfondi, leurs commentaires et leur soutien.</p>
</div>
<div class="paragraph data-line-121">
<p>Plusieurs d√©veloppeurs de bitcoins ont fourni des √©chantillons de code, des critiques, des commentaires et des encouragements. Merci √† Amir Taaki et Eric Voskuil pour les extraits de code par exemple et de nombreux excellents commentaires¬†; Chris Kleeschulte pour sa contribution √† l&#8217;annexe Bitcore¬†; Vitalik Buterin et Richard Kiss pour leur aide avec les math√©matiques des courbes elliptiques et leurs contributions au code¬†; Gavin Andresen pour les corrections, les commentaires et les encouragements¬†; Michalis Kargakis pour les commentaires, les contributions et la r√©daction de btcd¬†; et Robin Inge pour les soumissions d&#8217;errata am√©liorant la deuxi√®me impression. Dans la deuxi√®me √©dition, j&#8217;ai de nouveau re√ßu beaucoup d&#8217;aide de la part de nombreux d√©veloppeurs de Bitcoin Core, dont Eric Lombrozo qui a d√©mystifi√© le T√©moin S√©par√©, Luke Dashjr qui a aid√© √† am√©liorer le chapitre sur les transactions, Johnson Lau qui a revu le T√©moin S√©par√© et d&#8217;autres chapitres, et bien d&#8217;autres. Je dois remercier Joseph Poon, Tadge Dryja et Olaoluwa Osuntokun qui ont expliqu√© le Lightning Network, revu mes √©crits et r√©pondu aux questions lorsque je suis rest√© bloqu√©.</p>
</div>
<div class="paragraph data-line-123">
<p>Je dois mon amour des mots et des livres √† ma m√®re, Theresa, qui m&#8217;a √©lev√© dans une maison avec des livres tapissant tous les murs. Ma m√®re m&#8217;a √©galement achet√© mon premier ordinateur en 1982, bien qu&#8217;elle se d√©crive comme une technophobe. Mon p√®re, Menelaos, un ing√©nieur civil qui vient de publier son premier livre √† 80 ans, est celui qui m&#8217;a enseign√© la pens√©e logique et analytique et l&#8217;amour de la science et de l&#8217;ing√©nierie.</p>
</div>
<div class="paragraph data-line-125">
<p>Merci √† tous de m&#8217;avoir soutenu tout au long de ce parcours.</p>
</div>
<div class="sect3 data-line-2">
<h4 id="github_contrib">Version pr√©liminaire (contributions GitHub)</h4>
<div class="paragraph data-line-4">
<p>De nombreux contributeurs ont propos√© des commentaires, des corrections et des ajouts √† la premi√®re version pr√©liminaire sur GitHub. Merci √† tous pour vos contributions √† ce livre.</p>
</div>
<div class="paragraph data-line-6">
<p>Voici une liste des contributeurs notables de GitHub¬†:</p>
</div>
<div class="ulist data-line-8">
<ul>
<li class="data-line-8">
<p>Abdussamad Abdurrazzaq (AbdussamadA)</p>
</li>
<li class="data-line-9">
<p>Ad√°n SDPC (aesedepece)</p>
</li>
<li class="data-line-10">
<p>Akira Chiku (achiku)</p>
</li>
<li class="data-line-11">
<p>Alex Waters (alexwaters)</p>
</li>
<li class="data-line-12">
<p>Andrew Donald Kennedy (grkvlt)</p>
</li>
<li class="data-line-13">
<p>Andrey Esaulov (andremaha)</p>
</li>
<li class="data-line-14">
<p>Arthur O&#8217;Dwyer (Quuxplusone)</p>
</li>
<li class="data-line-15">
<p>bargitta</p>
</li>
<li class="data-line-16">
<p>bisqfan</p>
</li>
<li class="data-line-17">
<p>bitcoinctf</p>
</li>
<li class="data-line-18">
<p>blip151</p>
</li>
<li class="data-line-19">
<p>Bryan Gmyrek (physicsdude)</p>
</li>
<li class="data-line-20">
<p>Casey Flynn (cflynn07)</p>
</li>
<li class="data-line-21">
<p>cclauss</p>
</li>
<li class="data-line-22">
<p>Chapman Shoop (belovachap)</p>
</li>
<li class="data-line-23">
<p>Christie D&#8217;Anna (avocadobreath)</p>
</li>
<li class="data-line-24">
<p>Cihat Imamoglu (cihati)</p>
</li>
<li class="data-line-25">
<p>Cody Scott (Siecje)</p>
</li>
<li class="data-line-26">
<p>coinradar</p>
</li>
<li class="data-line-27">
<p>Cragin Godley (cgodley)</p>
</li>
<li class="data-line-28">
<p>Craig Dodd (cdodd)</p>
</li>
<li class="data-line-29">
<p>dallyshalla</p>
</li>
<li class="data-line-30">
<p>Dan Nolan (Dan-Nolan)</p>
</li>
<li class="data-line-31">
<p>Dan Raviv (danra)</p>
</li>
<li class="data-line-32">
<p>Darius Kramer (dkrmr)</p>
</li>
<li class="data-line-33">
<p>Darko Jankoviƒá (trulex)</p>
</li>
<li class="data-line-34">
<p>David Huie (DavidHuie)</p>
</li>
<li class="data-line-35">
<p>didongke</p>
</li>
<li class="data-line-36">
<p>Diego Viola (diegoviola)</p>
</li>
<li class="data-line-37">
<p>Dimitris Tsapakidis (dimitris-t)</p>
</li>
<li class="data-line-38">
<p>Dirk J√§ckel (biafra23)</p>
</li>
<li class="data-line-39">
<p>Dmitry Marakasov (AMDmi3)</p>
</li>
<li class="data-line-40">
<p>drstrangeM</p>
</li>
<li class="data-line-41">
<p>Ed Eykholt (edeykholt)</p>
</li>
<li class="data-line-42">
<p>Ed Leafe (EdLeafe)</p>
</li>
<li class="data-line-43">
<p>Edward Posnak (edposnak)</p>
</li>
<li class="data-line-44">
<p>Elias Rodrigues (elias19r)</p>
</li>
<li class="data-line-45">
<p>Eric Voskuil (evoskuil)</p>
</li>
<li class="data-line-46">
<p>Eric Winchell (winchell)</p>
</li>
<li class="data-line-47">
<p>Erik Wahlstr√∂m (erikwam)</p>
</li>
<li class="data-line-48">
<p>effectsToCause (vericoin)</p>
</li>
<li class="data-line-49">
<p>Esteban Ordano (eordano)</p>
</li>
<li class="data-line-50">
<p>ethers</p>
</li>
<li class="data-line-51">
<p>Evlix</p>
</li>
<li class="data-line-52">
<p>fabienhinault</p>
</li>
<li class="data-line-53">
<p>Fan (whiteath)</p>
</li>
<li class="data-line-54">
<p>Francis Ballares (fballares)</p>
</li>
<li class="data-line-55">
<p>Fran√ßois Wirion (wirion)</p>
</li>
<li class="data-line-56">
<p>Frank H√∂ger (francyi)</p>
</li>
<li class="data-line-57">
<p>Gabriel Montes (gabmontes)</p>
</li>
<li class="data-line-58">
<p>Gaurav Rana (bitcoinsSG)</p>
</li>
<li class="data-line-59">
<p>genjix</p>
</li>
<li class="data-line-60">
<p>Geremia</p>
</li>
<li class="data-line-61">
<p>Gerry Smith (Hermetic)</p>
</li>
<li class="data-line-62">
<p>gmr81</p>
</li>
<li class="data-line-63">
<p>Gregory Trubetskoy (grisha)</p>
</li>
<li class="data-line-64">
<p>Gus (netpoe)</p>
</li>
<li class="data-line-65">
<p>halseth</p>
</li>
<li class="data-line-66">
<p>harelw</p>
</li>
<li class="data-line-67">
<p>Harry Moreno (morenoh149)</p>
</li>
<li class="data-line-68">
<p>Holger Schinzel (schinzelh)</p>
</li>
<li class="data-line-69">
<p>Ioannis Cherouvim (cherouvim)</p>
</li>
<li class="data-line-70">
<p>Ish Ot Jr. (ishotjr)</p>
</li>
<li class="data-line-71">
<p>ivangreene</p>
</li>
<li class="data-line-72">
<p>James Addison (jayaddison)</p>
</li>
<li class="data-line-73">
<p>Jameson Lopp (jlopp)</p>
</li>
<li class="data-line-74">
<p>Jason Bisterfeldt (jbisterfeldt)</p>
</li>
<li class="data-line-75">
<p>Javier Rojas (fjrojasgarcia)</p>
</li>
<li class="data-line-76">
<p>Jordan Baczuk (JBaczuk)</p>
</li>
<li class="data-line-77">
<p>Jeremy Bokobza (bokobza)</p>
</li>
<li class="data-line-78">
<p>JerJohn15</p>
</li>
<li class="data-line-79">
<p>Jimmy DeSilva (jimmydesilva)</p>
</li>
<li class="data-line-80">
<p>Jo Wo (jowo-io)</p>
</li>
<li class="data-line-81">
<p>Joe Bauers (joebauers)</p>
</li>
<li class="data-line-82">
<p>joflynn</p>
</li>
<li class="data-line-83">
<p>Johnson Lau (jl2012)</p>
</li>
<li class="data-line-84">
<p>Jonathan Cross (jonathancross)</p>
</li>
<li class="data-line-85">
<p>Jorgeminator</p>
</li>
<li class="data-line-86">
<p>jwbats</p>
</li>
<li class="data-line-87">
<p>Kai Bakker (kaibakker)</p>
</li>
<li class="data-line-88">
<p>kollokollo</p>
</li>
<li class="data-line-89">
<p>lightningnetworkstores</p>
</li>
<li class="data-line-90">
<p>lilianrambu</p>
</li>
<li class="data-line-91">
<p>Liu Yue (lyhistory)</p>
</li>
<li class="data-line-92">
<p>Lucas Betschart (lclc)</p>
</li>
<li class="data-line-93">
<p>Magomed Aliev (30mb1)</p>
</li>
<li class="data-line-94">
<p>Mai-Hsuan Chia (mhchia)</p>
</li>
<li class="data-line-95">
<p>Marco Falke (MarcoFalke)</p>
</li>
<li class="data-line-96">
<p>Mar√≠a Mart√≠n (mmartinbar)</p>
</li>
<li class="data-line-97">
<p>Mark Pors (pors)</p>
</li>
<li class="data-line-98">
<p>Martin Harrigan (harrigan)</p>
</li>
<li class="data-line-99">
<p>Martin Vseticka (MartyIX)</p>
</li>
<li class="data-line-100">
<p>Marzig (marzig76)</p>
</li>
<li class="data-line-101">
<p>Matt McGivney (mattmcgiv)</p>
</li>
<li class="data-line-102">
<p>Maximilian Reichel (phramz)</p>
</li>
<li class="data-line-103">
<p>Michalis Kargakis (kargakis)</p>
</li>
<li class="data-line-104">
<p>Michael C. Ippolito (michaelcippolito)</p>
</li>
<li class="data-line-105">
<p>Michael Galero (mikong)</p>
</li>
<li class="data-line-106">
<p>Michael Newman (michaelbnewman)</p>
</li>
<li class="data-line-107">
<p>Mihail Russu (MihailRussu)</p>
</li>
<li class="data-line-108">
<p>Minh T. Nguyen (enderminh)</p>
</li>
<li class="data-line-109">
<p>montvid</p>
</li>
<li class="data-line-110">
<p>Morfies (morfies)</p>
</li>
<li class="data-line-111">
<p>Nagaraj Hubli (nagarajhubli)</p>
</li>
<li class="data-line-112">
<p>Nekomata (nekomata-3)</p>
</li>
<li class="data-line-113">
<p>nekonenene</p>
</li>
<li class="data-line-114">
<p>Nhan Vu (jobnomade)</p>
</li>
<li class="data-line-115">
<p>Nicholas Chen (nickycutesc)</p>
</li>
<li class="data-line-116">
<p>Omar Boukli-Hacene (oboukli)</p>
</li>
<li class="data-line-117">
<p>Parzival (Parz-val)</p>
</li>
<li class="data-line-118">
<p>Philipp Gille (philippgille)</p>
</li>
<li class="data-line-119">
<p>ratijas</p>
</li>
<li class="data-line-120">
<p>Reproducibility Matters (TheCharlatan)</p>
</li>
<li class="data-line-121">
<p>Reuben Thomas (rrthomas)</p>
</li>
<li class="data-line-122">
<p>Robert Furse (Rfurse)</p>
</li>
<li class="data-line-123">
<p>Roberto Mannai (robermann)</p>
</li>
<li class="data-line-124">
<p>Richard Kiss (richardkiss)</p>
</li>
<li class="data-line-125">
<p>rszheng</p>
</li>
<li class="data-line-126">
<p>Ruben Alexander (hizzvizz)</p>
</li>
<li class="data-line-127">
<p>Sam Ritchie (sritchie)</p>
</li>
<li class="data-line-128">
<p>Sanjay Sanathanan (sanjays95)</p>
</li>
<li class="data-line-129">
<p>Sebastian Falbesoner (theStack)</p>
</li>
<li class="data-line-130">
<p>Sergej Kotliar (ziggamon)</p>
</li>
<li class="data-line-131">
<p>Seiichi Uchida (topecongiro)</p>
</li>
<li class="data-line-132">
<p>shaysw</p>
</li>
<li class="data-line-133">
<p>Simon de la Rouviere (simondlr)</p>
</li>
<li class="data-line-134">
<p>Stacie (staciewaleyko)</p>
</li>
<li class="data-line-135">
<p>Stephan Oeste (Emzy)</p>
</li>
<li class="data-line-136">
<p>St√©phane Roche (Janaka-Steph)</p>
</li>
<li class="data-line-137">
<p>takaya-imai</p>
</li>
<li class="data-line-138">
<p>Thiago Arrais (thiagoarrais)</p>
</li>
<li class="data-line-139">
<p>Thomas Kerin (afk11)</p>
</li>
<li class="data-line-140">
<p>Tochi Obudulu (tochicool)</p>
</li>
<li class="data-line-141">
<p>venzen</p>
</li>
<li class="data-line-142">
<p>Vlad Stan (motorina0)</p>
</li>
<li class="data-line-143">
<p>Vijay Chavda (VijayChavda)</p>
</li>
<li class="data-line-144">
<p>Vincent D√©niel (vincentdnl)</p>
</li>
<li class="data-line-145">
<p>weinim</p>
</li>
<li class="data-line-146">
<p>wenzhenxiang</p>
</li>
<li class="data-line-147">
<p>Will Binns (wbnns)</p>
</li>
<li class="data-line-148">
<p>wintercooled</p>
</li>
<li class="data-line-149">
<p>wjx</p>
</li>
<li class="data-line-150">
<p>Wojciech Langiewicz (wlk)</p>
</li>
<li class="data-line-151">
<p>Yancy Ribbens (yancyribbens)</p>
</li>
<li class="data-line-152">
<p>yjjnls</p>
</li>
<li class="data-line-153">
<p>Yoshimasa Tanabe (emag)</p>
</li>
<li class="data-line-154">
<p>yuntai</p>
</li>
<li class="data-line-155">
<p>yurigeorgiev4</p>
</li>
<li class="data-line-156">
<p>Zheng Jia (zhengjia)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="_glossaire_rapide">Glossaire rapide</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-4">
<p>Ce glossaire rapide contient de nombreux termes utilis√©s en relation avec le bitcoin. Ces termes sont utilis√©s tout au long du livre, alors mettez-les en signet pour une r√©f√©rence rapide.</p>
</div>
<div class="dlist data-line-6">
<dl>
<dt class="hdlist1">adresse</dt>
<dd>
<p>Une adresse Bitcoin ressemble √† <code>1DSrfJdB2AnWaFNgSbv3MZC2m74996JafV</code>. Il se compose d&#8217;une suite de lettres et de chiffres. Il s&#8217;agit en r√©alit√© d&#8217;une version cod√©e en base58check d&#8217;un r√©sultat de hachage √† cl√© publique de 160¬†bits. Tout comme vous demandez aux autres d&#8217;envoyer un courriel √† l&#8217;adresse de celle-ci, vous demanderez aux autres de vous envoyer des bitcoins √† l&#8217;une de vos adresses Bitcoin.</p>
</dd>
<dt class="hdlist1">adresse P2SH</dt>
<dd>
<p>Les adresses P2SH sont des encodages Base58Check du r√©sultat de hachage de 20 octets d&#8217;un script. Ils utilisent le pr√©fixe de version "5", ce qui donne des adresses encod√©es en Base58Check qui commencent par un "3". Les adresses P2SH cachent toute la complexit√©, de sorte que la personne effectuant un paiement ne voit pas le script.</p>
</dd>
<dt class="hdlist1">arbre de Merkle</dt>
<dd>
<p>Un arbre construit en hachant des donn√©es appari√©es (les feuilles), puis en appariant et en hachant les r√©sultats jusqu&#8217;√† ce qu&#8217;il ne reste qu&#8217;un seul r√©sultat de hachage, la racine de Merkle. En bitcoin, les feuilles sont presque toujours des transactions d&#8217;un seul bloc.</p>
</dd>
<dt class="hdlist1">bassin de transactions</dt>
<dd>
<p>Une collection non ordonn√©e de transactions qui ne sont pas en blocs dans la cha√Æne principale, mais pour lesquelles nous avons des transactions d&#8217;entr√©e.</p>
</dd>
<dt class="hdlist1">bip</dt>
<dd>
<p>Bitcoin Improvement Proposals (ou Propositions d&#8217;am√©lioration de Bitcoin). Un ensemble de propositions que les membres de la communaut√© Bitcoin ont soumises pour am√©liorer Bitcoin. Par exemple, BIP-21 est une proposition visant √† am√©liorer le sch√©ma d&#8217;identificateur de ressource uniforme (URI) bitcoin.</p>
</dd>
<dt class="hdlist1">bitcoin</dt>
<dd>
<p>Le nom de l&#8217;unit√© mon√©taire (unit√© de cryptomonnaie), du r√©seau et du logiciel.</p>
</dd>
<dt class="hdlist1">bloc</dt>
<dd>
<p>Regroupement de transactions, marqu√© d&#8217;un horodatage et d&#8217;une empreinte digitale du bloc pr√©c√©dent. L&#8217;en-t√™te du bloc est hach√© (c.-√†-d., on obtient un r√©sultat de hachage) pour produire une preuve de travail, validant ainsi les transactions. Les blocs valides sont ajout√©s √† la cha√Æne de blocs principale par consensus du r√©seau.</p>
</dd>
<dt class="hdlist1">bloc candidat</dt>
<dd>
<p>Un bloc qu&#8217;un mineur essaie toujours d&#8217;exploiter. Ce n&#8217;est pas encore un bloc valide, car il ne contient pas de Proof-of-Work (ou Preuve de travail) valide.</p>
</dd>
<dt class="hdlist1">bloc de gen√®se</dt>
<dd>
<p>Le premier bloc de la cha√Æne de blocs, utilis√© pour initialiser la cryptomonnaie (ou cybermonnaie).</p>
</dd>
<dt class="hdlist1">bloc orphelin</dt>
<dd>
<p>Les blocs dont le bloc parent n&#8217;a pas √©t√© trait√© par le n≈ìud local, ils ne peuvent donc pas encore √™tre enti√®rement valid√©s. √Ä ne pas confondre avec le bloc obsol√®te.</p>
</dd>
<dt class="hdlist1">bloc p√©rim√©</dt>
<dd>
<p>Un bloc valide qui a √©t√© extrait avec succ√®s mais qui n&#8217;est pas inclus dans la branche principale actuelle (avec la plupart des preuves de travail cumulatives), car un autre bloc valide qui a √©t√© extrait √† la m√™me hauteur a vu sa cha√Æne √©tendue en premier. Le mineur d&#8217;un bloc p√©rim√© ne re√ßoit pas la r√©compense du bloc ni les frais de transaction de ce bloc.
√Ä ne pas confondre avec le bloc orphelin ou le bloc candidat.</p>
</dd>
<dt class="hdlist1">canaux de paiement</dt>
<dd>
<p>Un canal de micropaiement ou canal de paiement est une classe de techniques con√ßues pour permettre aux utilisateurs d&#8217;effectuer plusieurs transactions bitcoin sans engager toutes les transactions dans la cha√Æne de blocs Bitcoin. Dans un canal de paiement typique, seules deux transactions sont ajout√©es √† la cha√Æne de blocs, mais un nombre illimit√© ou presque illimit√© de paiements peut √™tre effectu√© entre les participants.</p>
</dd>
<dt class="hdlist1">cha√Æne de blocs (ou blockchain)</dt>
<dd>
<p>Une liste de blocs valid√©s, chacun li√© √† son pr√©d√©cesseur jusqu&#8217;au bloc de gen√®se.</p>
</dd>
<dt class="hdlist1">cible de difficult√©</dt>
<dd>
<p>Une difficult√© pour le calcul dans tout le r√©seau et qui permet de solutionner et valider l&#8217;ajout d&#8217;un bloc environ toutes les 10 minutes.</p>
</dd>
<dt class="hdlist1">cl√© secr√®te (ou cl√© priv√©e)</dt>
<dd>
<p>Le num√©ro secret qui d√©verrouille le bitcoin envoy√© √† l&#8217;adresse correspondante. <span class="keep-together">Une cl√© secr√®te</span> ressemble √† ceci¬†:</p>
<div class="listingblock data-line-53">
<div class="content">
<pre>5J76sF8L5jTtzE96r66Sf8cka9y44wdpJjMwCxR3tzLh3ibVPxh</pre>
</div>
</div>
</dd>
<dt class="hdlist1">coinbase (ou unit√© de monnaie primaire du bloc) (alias donn√©e coinbase)</dt>
<dd>
<p>Un champ sp√©cial utilis√© comme seule entr√©e pour les transactions coinbase. Le champ de donn√©es coinbase permet de r√©clamer la r√©compense de bloc et fournit jusqu&#8217;√† 100 octets pour les donn√©es arbitraires.
√Ä ne pas confondre avec la "transaction coinbase" ou la "r√©compense coinbase".</p>
</dd>
<dt class="hdlist1">compl√©tude de Turing</dt>
<dd>
<p>Un langage de programmation est appel√© "Turing complet" s&#8217;il peut ex√©cuter n&#8217;importe quel programme qu&#8217;une machine de Turing peut ex√©cuter, avec suffisamment de temps et de m√©moire.</p>
</dd>
<dt class="hdlist1">confirmations</dt>
<dd>
<p>Une fois qu&#8217;une transaction est incluse dans un bloc, elle a une confirmation. D√®s qu&#8217;un autre bloc est min√© sur la m√™me cha√Æne de blocs, la transaction a deux confirmations, et ainsi de suite. Six confirmations ou plus sont consid√©r√©es comme une preuve suffisante qu&#8217;une transaction ne peut pas √™tre annul√©e.</p>
</dd>
<dt class="hdlist1">consensus</dt>
<dd>
<p>Lorsque plusieurs n≈ìuds, g√©n√©ralement la plupart des n≈ìuds du r√©seau, ont tous les m√™mes blocs dans leur meilleure cha√Æne de blocs valid√©e localement.
√Ä ne pas confondre avec les r√®gles de consensus.</p>
</dd>
<dt class="hdlist1">difficult√©</dt>
<dd>
<p>Un param√®tre √† l&#8217;√©chelle du r√©seau qui contr√¥le la quantit√© de calculs n√©cessaires pour produire une preuve de travail (ou le Proof-of-Work).</p>
</dd>
<dt class="hdlist1">double d√©pense</dt>
<dd>
<p>La double d√©pense est le r√©sultat d&#8217;avoir r√©ussi √† d√©penser de l&#8217;argent plus d&#8217;une fois. Bitcoin prot√®ge contre les doubles d√©penses en v√©rifiant chaque transaction ajout√©e √† la cha√Æne de blocs pour s&#8217;assurer que les entr√©es de la transaction n&#8217;avaient pas d√©j√† √©t√© d√©pens√©es auparavant.</p>
</dd>
<dt class="hdlist1">ECDSA</dt>
<dd>
<p>Elliptic Curve Digital Signature Algorithm ou ECDSA est un algorithme cryptographique utilis√© par bitcoin pour garantir que les fonds ne peuvent √™tre d√©pens√©s que par leurs propri√©taires l√©gitimes.</p>
</dd>
<dt class="hdlist1">embranchement convergent (ou soft fork)</dt>
<dd>
<p>L&#8217;embranchement convergent ou le Soft-Forking Change est un fourche temporaire dans la cha√Æne de blocs qui se produit g√©n√©ralement lorsque les mineurs utilisant des n≈ìuds non mis √† niveau ne suivent pas une nouvelle r√®gle de consensus que leurs n≈ìuds ne connaissent pas.
√Ä ne pas confondre avec fourche, embranchement divergent (hard fork), fourche logicielle ou fourche de Git.</p>
</dd>
<dt class="hdlist1">embranchement divergent (ou hard fork)</dt>
<dd>
<p>L&#8217;embranchement divergent, √©galement connu sous le nom de Hard-Forking Change, est une divergence permanente dans la cha√Æne de blocs, se produit g√©n√©ralement lorsque les n≈ìuds non mis √† niveau ne peuvent pas valider les blocs cr√©√©s par les n≈ìuds mis √† niveau qui suivent les nouvelles r√®gles de consensus.
√Ä ne pas confondre avec une fourche, une fourche molle, une fourche de code ou une fourche Git, mais tout de m√™me un nouvel embranchement d&#8217;une arborescence de donn√©es (avec une source parent unique).</p>
</dd>
<dt class="hdlist1">exploitation mini√®re group√©e</dt>
<dd>
<p>L&#8217;exploitation mini√®re en groupe est une approche d&#8217;exploitation mini√®re dans laquelle plusieurs clients g√©n√©rateurs contribuent √† la g√©n√©ration d&#8217;un bloc, puis divisent la r√©compense du bloc en fonction de la puissance de traitement apport√©e.</p>
</dd>
<dt class="hdlist1">extrant (ou output)</dt>
<dd>
<p>Le produit sorti ou l&#8217;extrant (ou output), la sortie de transaction ou TxOut est une sortie dans une transaction qui contient deux champs¬†: un champ de valeur pour transf√©rer z√©ro ou plusieurs satoshis et un script pubkey pour indiquer quelles conditions doivent √™tre remplies pour que ces satoshis soient d√©pens√©s davantage.</p>
</dd>
<dt class="hdlist1">format d&#8217;importation de portefeuille (WIF ou Wallet Import Format)</dt>
<dd>
<p>Le format d&#8217;importation de portefeuille (WIF ou Wallet Import Format) est un format d&#8217;√©change de donn√©es con√ßu pour permettre l&#8217;exportation et l&#8217;importation d&#8217;une seule cl√© priv√©e avec un indicateur indiquant s&#8217;il utilise ou non une cl√© publique compress√©e.</p>
</dd>
<dt class="hdlist1">fourche</dt>
<dd>
<p>La fourche, √©galement connue sous le nom de fourche accidentelle, se produit lorsque deux blocs ou plus ont la m√™me hauteur de bloc, for√ßant la cha√Æne de blocs √† se d√©doubler. Cela se produit g√©n√©ralement lorsque deux mineurs ou plus trouvent des blocs presque en m√™me temps. Peut √©galement se produire dans le cadre d&#8217;une attaque.</p>
</dd>
<dt class="hdlist1">frais</dt>
<dd>
<p>L&#8217;exp√©diteur d&#8217;une transaction inclut souvent une valeur de frais au r√©seau pour le traitement de la transaction demand√©e. La plupart des transactions n√©cessitent des frais minimum de 0,5 mBTC.</p>
</dd>
<dt class="hdlist1">HTLC</dt>
<dd>
<p>Un contrat Hashed TimeLock ou HTLC est une classe de paiements qui utilisent des hashlocks (ou serrures par empreintes num√©riques) et des timelocks (ou serrures par horodatage) pour exiger que le destinataire d&#8217;un paiement reconnaisse avoir re√ßu le paiement avant une date limite en g√©n√©rant une preuve cryptographique de paiement ou renonce √† la possibilit√© de r√©clamer le paiement, le retournant au payeur.</p>
</dd>
<dt class="hdlist1">KYC</dt>
<dd>
<p>Know Your Customer (ou Conna√Ætre son client) (KYC) est le processus d&#8217;une entreprise qui identifie et v√©rifie l&#8217;identit√© de ses clients. Le terme est √©galement utilis√© pour d√©signer la r√©glementation bancaire qui r√©git ces activit√©s.</p>
</dd>
<dt class="hdlist1">LevelDB</dt>
<dd>
<p>LevelDB est un moyen de stockage cl√©-valeur open source sur disque. LevelDB est une biblioth√®que l√©g√®re √† usage unique pour la persistance avec des liaisons sur de nombreuses plates-formes.</p>
</dd>
<dt class="hdlist1">Lightning Networks</dt>
<dd>
<p>Lightning Network est une impl√©mentation de Hashed Timelock Contracts (HTLC) avec des canaux de paiement bidirectionnels qui permettent aux paiements d&#8217;√™tre achemin√©s en toute s√©curit√© sur plusieurs canaux de paiement pair √† pair. Cela permet la formation d&#8217;un r√©seau o√π n&#8217;importe quel pair sur le r√©seau peut payer n&#8217;importe quel autre pair m√™me s&#8217;ils n&#8217;ont pas directement de canal ouvert entre eux.</p>
</dd>
<dt class="hdlist1">mempool</dt>
<dd>
<p>Le bitcoin Mempool (bassin de m√©moire) est une collection de toutes les donn√©es de transaction dans un bloc qui ont √©t√© v√©rifi√©es par les n≈ìuds Bitcoin, mais qui ne sont pas encore confirm√©es.</p>
</dd>
<dt class="hdlist1">mineur</dt>
<dd>
<p>Un n≈ìud de r√©seau qui trouve une preuve de travail valide pour les nouveaux blocs, par hachage r√©p√©t√©.</p>
</dd>
<dt class="hdlist1">multisignature</dt>
<dd>
<p>La multisignature (multisig) fait r√©f√©rence √† l&#8217;exigence d&#8217;un nombre minimum (M) de cl√©s (N) pour autoriser une transaction M-sur-N.</p>
</dd>
<dt class="hdlist1">nombre al√©atoire explicite (ou nonce)</dt>
<dd>
<p>Le "nombre al√©atoire explicite" (ou nonce) dans un bloc bitcoin est un champ de 32 bits (4 octets) dont la valeur est d√©finie de mani√®re √† ce que le r√©sultat de hachage du bloc contienne une s√©rie de z√©ros non significatifs. Les autres champs ne peuvent pas √™tre modifi√©s, car ils ont une signification d√©finie.</p>
</dd>
<dt class="hdlist1">nombre al√©atoire explicite suppl√©mentaire</dt>
<dd>
<p>Au fur et √† mesure que la difficult√© augmentait, les mineurs parcouraient souvent les 4 milliards de nombres al√©atoires explicites (nonce) sans trouver de bloc. √âtant donn√© que le script coinbase peut stocker entre 2 et 100 octets de donn√©es, les mineurs ont commenc√© √† utiliser cet espace comme espace pour un nombre al√©atoire explicite suppl√©mentaire, leur permettant d&#8217;explorer une gamme beaucoup plus large de valeurs d&#8217;en-t√™te de bloc pour trouver des blocs valides.</p>
</dd>
<dt class="hdlist1">opcode</dt>
<dd>
<p>Codes d&#8217;op√©ration du langage de script bitcoin qui poussent des donn√©es ou ex√©cutent des fonctions dans un script pubkey ou un script de signature.</p>
</dd>
<dt class="hdlist1">OP_RETURN</dt>
<dd>
<p>Un opcode (ou code d&#8217;op√©ration) utilis√© dans l&#8217;une des sorties d&#8217;une transaction OP_RETURN. A ne pas confondre avec la transaction OP_RETURN.</p>
</dd>
<dt class="hdlist1">phrase secr√®te</dt>
<dd>
<p>Une phrase secr√®te (ou phrase de passe) est une cha√Æne de caract√®res facultative cr√©√©e par l&#8217;utilisateur qui sert de facteur de s√©curit√© suppl√©mentaire prot√©geant la valeur d&#8217;amor√ßage, m√™me lorsque la valeur d&#8217;amor√ßage est compromise par un voleur. Il peut √©galement √™tre utilis√© comme une forme de pot de miel, o√π une phrase de passe choisie (une adresse bitcoin, un URL ou autre) m√®ne √† un portefeuille avec une petite quantit√© de fonds utilis√©e pour distraire un attaquant du "vrai" portefeuille qui contient la majorit√© des fonds.</p>
</dd>
<dt class="hdlist1">portefeuille</dt>
<dd>
<p>Logiciel qui contient toutes vos adresses Bitcoin et cl√©s secr√®tes. Utilisez-le pour envoyer, recevoir et stocker vos bitcoins.</p>
</dd>
<dt class="hdlist1">portefeuille d&#8217;amor√ßage HD</dt>
<dd>
<p>Le portefeuille d&#8217;amor√ßage HD ou la valeur d&#8217;amor√ßage est une valeur potentiellement courte utilis√©e comme valeur racine pour g√©n√©rer la cl√© priv√©e principale et le code de cha√Æne principal pour un portefeuille HD.</p>
</dd>
<dt class="hdlist1">portefeuille HD</dt>
<dd>
<p>Portefeuilles utilisant le protocole de cr√©ation et de transfert de cl√©s Hierarchical Deterministic (HD Protocol) (BIP-32).</p>
</dd>
<dt class="hdlist1">portefeuille mat√©riel (hardware)</dt>
<dd>
<p>Un portefeuille mat√©riel est un type sp√©cial de portefeuille bitcoin qui stocke les cl√©s priv√©es de l&#8217;utilisateur dans un p√©riph√©rique mat√©riel s√©curis√©.</p>
</dd>
<dt class="hdlist1">portefeuille papier</dt>
<dd>
<p>Dans le sens le plus sp√©cifique, un portefeuille papier est un document contenant toutes les donn√©es n√©cessaires pour g√©n√©rer un nombre quelconque de cl√©s priv√©es bitcoin, formant un portefeuille de cl√©s. Cependant, les gens utilisent souvent le terme pour d√©signer tout moyen de stocker des bitcoins hors ligne en tant que document physique. Cette deuxi√®me d√©finition comprend √©galement les cl√©s papier et les codes √©changeables.</p>
</dd>
<dt class="hdlist1">preuve d&#8217;enjeu (ou Proof-of-Stake)</dt>
<dd>
<p>La preuve d&#8217;enjeu (PoS) est une m√©thode par laquelle un r√©seau de cha√Æne de blocs de cryptomonnaie vise √† atteindre un consensus distribu√©. La preuve d&#8217;enjeu demande aux utilisateurs de prouver qu&#8217;ils sont propri√©taires d&#8217;un certain montant de devise (leur ¬´ enjeu ¬ª ou ¬´¬†participation¬†¬ª dans la devise).</p>
</dd>
<dt class="hdlist1">preuve de travail (ou Proof-of-Work)</dt>
<dd>
<p>Une donn√©e qui n√©cessite des calculs importants pour √™tre trouv√©e. Dans le bitcoin, les mineurs doivent trouver une solution num√©rique √† l&#8217;algorithme SHA256 qui r√©pond √† une cible √† l&#8217;√©chelle du r√©seau, la cible de difficult√©.</p>
</dd>
<dt class="hdlist1">probl√®me des g√©n√©raux Byzantins (ou Byzantine Generals Problem)</dt>
<dd>
<p>Un syst√®me informatique fiable doit pouvoir faire face √† la d√©faillance d&#8217;un ou plusieurs de ses composants. Un composant d√©faillant peut pr√©senter un type de comportement souvent n√©glig√©, √† savoir l&#8217;envoi d&#8217;informations contradictoires √† diff√©rentes parties du syst√®me. Le probl√®me de faire face √† ce type d&#8217;√©chec est exprim√© abstraitement comme le Byzantine Generals Problem (ou Probl√®me des g√©n√©raux byzantins) (voir <a href="https://fr.wikipedia.org/wiki/Probl%C3%A8me_des_g%C3%A9n%C3%A9raux_byzantins" class="undefined" data-href="https://fr.wikipedia.org/wiki/Probl%C3%A8me_des_g%C3%A9n%C3%A9raux_byzantins">https://fr.wikipedia.org/wiki/Probl%C3%A8me_des_g%C3%A9n%C3%A9raux_byzantins</a>).</p>
</dd>
<dt class="hdlist1">protocole d&#8217;actifs ouverts (ou Open Assets protocol)</dt>
<dd>
<p>Le protocole d&#8217;actifs ouverts (ou Open Assets protocol) est un protocole simple et puissant construit au-dessus de la cha√Æne de blocs Bitcoin. Il permet l&#8217;√©mission et le transfert d&#8217;actifs cr√©√©s par l&#8217;utilisateur.</p>
</dd>
<dt class="hdlist1">protocole HD</dt>
<dd>
<p>Le protocole de cr√©ation et de transfert de cl√©s Hierarchical Deterministic (HD) (BIP-32), qui permet de cr√©er des cl√©s enfants √† partir de cl√©s parents dans une hi√©rarchie.</p>
</dd>
<dt class="hdlist1">P2PKH</dt>
<dd>
<p>Les transactions qui paient une adresse Bitcoin contiennent des scripts P2PKH ou Pay To PubKey Hash. Une sortie verrouill√©e par un script P2PKH peut √™tre d√©verrouill√©e (d√©pens√©e) en pr√©sentant une cl√© publique et une signature num√©rique cr√©√©e par la cl√© priv√©e correspondante.</p>
</dd>
<dt class="hdlist1">P2SH</dt>
<dd>
<p>P2SH ou Pay-to-Script-Hash est un nouveau type de transaction puissant qui simplifie grandement l&#8217;utilisation de scripts de transaction complexes. Avec P2SH le script complexe qui d√©taille les conditions de d√©pense de la sortie (redeem script) n&#8217;est pas pr√©sent√© dans le script de verrouillage. Au lieu de cela, seul un r√©sultat de hachage de celui-ci se trouve dans le script de verrouillage.</p>
</dd>
<dt class="hdlist1">P2WPKH</dt>
<dd>
<p>La signature d&#8217;un P2WPKH (Pay-to-Witness-Public-Key-Hash) contient les m√™mes informations qu&#8217;une d√©pense P2PKH, mais se trouve dans le champ t√©moin au lieu du champ scriptSig. Le scriptPubKey est √©galement modifi√©.</p>
</dd>
<dt class="hdlist1">P2WSH</dt>
<dd>
<p>La diff√©rence entre P2SH et P2WSH (Pay-to-Witness-Script-Hash) concerne le changement d&#8217;emplacement de la preuve cryptographique du champ scriptSig au champ t√©moin et le scriptPubKey qui est √©galement modifi√©.</p>
</dd>
<dt class="hdlist1">racine de Merkle</dt>
<dd>
<p>Le n≈ìud racine d&#8217;un arbre de Merkle, un descendant de toutes les paires hach√©es de l&#8217;arbre. Les en-t√™tes de bloc doivent inclure une racine de Merkle valide issue de toutes les transactions de ce bloc.</p>
</dd>
<dt class="hdlist1">reciblage de difficult√©</dt>
<dd>
<p>Un recalcul √† l&#8217;√©chelle du r√©seau de la difficult√© qui se produit une fois tous les 2 016 blocs et prend en compte la puissance de hachage des 2 016 blocs pr√©c√©dents.</p>
</dd>
<dt class="hdlist1">r√©compense de bloc (alias r√©compense coinbase (ou unit√© de monnaie primaire du bloc)</dt>
<dd>
<p>Un montant inclus dans chaque nouveau bloc comme r√©compense par le r√©seau au mineur qui a trouv√© la solution Proof-of-Work (ou Preuve de travail)). Environ tous les quatre ans, ou plus pr√©cis√©ment tous les 210 000 blocs, la r√©compense de bloc globale est r√©duite de moiti√©. Il est actuellement de 6,25 BTC par bloc.</p>
</dd>
<dt class="hdlist1">r√©compense mini√®re</dt>
<dd>
<p>Les r√©compense que les mineurs re√ßoivent en √©change de la s√©curit√© fournie par l&#8217;exploitation mini√®re, comprend les nouvelles pi√®ces bitcoin cr√©√©es avec chaque nouveau bloc, √©galement appel√©es r√©compense de bloc ou r√©compense coinbase, et les frais de transaction de toutes les transactions incluses dans le bloc.</p>
</dd>
<dt class="hdlist1">r√©duction de moiti√© (ou halving)</dt>
<dd>
<p>Un √©v√©nement de r√©duction de moiti√© se produit lorsque la r√©compense de bloc est r√©duite de moiti√©, ce qui se produit environ tous les quatre ans (ou pr√©cis√©ment tous les 210 000 blocs). Bitcoin a d√©j√† connu trois √©v√©nements de r√©duction de moiti√©¬†: en 2012 (de 50 √† 25 BTC), en 2016 (de 25 √† 12,5 BTC) et en 2020 (de 12,5 √† 6,25 BTC).</p>
</dd>
<dt class="hdlist1">r√®gles de consensus</dt>
<dd>
<p>Les r√®gles de validation de bloc que les n≈ìuds complets suivent pour rester en consensus avec les autres n≈ìuds.
A ne pas confondre avec le consensus.</p>
</dd>
<dt class="hdlist1">r√©seau</dt>
<dd>
<p>Un r√©seau pair √† pair qui propage les transactions et les bloques √† chaque n≈ìud Bitcoin du r√©seau.</p>
</dd>
<dt class="hdlist1">r√©sultat de hachage (ou hash)</dt>
<dd>
<p>Une empreinte num√©rique d&#8217;une entr√©e binaire.</p>
</dd>
<dt class="hdlist1">RIPEMD-160</dt>
<dd>
<p>RIPEMD-160 est une fonction de hachage cryptographique 160 bits. RIPEMD-160 est une version renforc√©e de RIPEMD avec un r√©sultat de hachage de 160 bits, et devrait √™tre s√©curis√© pour les dix prochaines ann√©es ou plus.</p>
</dd>
<dt class="hdlist1">satoshi</dt>
<dd>
<p>Un satoshi est la plus petite d√©nomination de bitcoin pouvant √™tre enregistr√©e sur la cha√Æne de blocs. Il √©quivaut √† 0,00000001 bitcoin et porte le nom du cr√©ateur du bitcoin, Satoshi Nakamoto. </p>
</dd>
<dt class="hdlist1">Satoshi Nakamoto</dt>
<dd>
<p>Satoshi Nakamoto est le nom utilis√© par la ou les personnes qui ont con√ßu le bitcoin et cr√©√© son impl√©mentation de r√©f√©rence originale, Bitcoin Core. Dans le cadre de la mise en ≈ìuvre, ils ont √©galement con√ßu la premi√®re base de donn√©es cha√Æne de blocs. Dans le processus, ils ont √©t√© les premiers √† r√©soudre le probl√®me de la double d√©pense pour la monnaie num√©rique. Leur v√©ritable identit√© reste inconnue.</p>
</dd>
<dt class="hdlist1">Script</dt>
<dd>
<p>Bitcoin utilise un syst√®me de script pour les transactions. Comme Forth, Script est simple, bas√© sur une pile et trait√© de gauche √† droite. Il n&#8217;est d√©lib√©r√©ment pas complet de Turing et sans boucles.</p>
</dd>
<dt class="hdlist1">ScriptPubKey (alias script pubkey)</dt>
<dd>
<p>ScriptPubKey ou script pubkey, est un script inclus dans les sorties qui d√©finit les conditions qui doivent √™tre remplies pour que ces satoshis soient d√©pens√©s. Les donn√©es permettant de remplir les conditions peuvent √™tre fournies dans un script de signature.</p>
</dd>
<dt class="hdlist1">ScriptSig (ou Script de signature)</dt>
<dd>
<p>ScriptSig ou script de signature, sont les donn√©es g√©n√©r√©es par un d√©pensier qui sont presque toujours utilis√©es comme variables pour satisfaire un script pubkey.</p>
</dd>
<dt class="hdlist1">serrure par empreinte num√©rique (ou hashlocks)</dt>
<dd>
<p>Un serrure par empreinte num√©rique (ou hashlock) est un type de contrainte qui limite les d√©penses d&#8217;une sortie jusqu&#8217;√† ce qu&#8217;une donn√©e sp√©cifique soit r√©v√©l√©e publiquement. Les hashlocks ont la propri√©t√© utile qu&#8217;une fois qu&#8217;un hashlock est ouvert publiquement, tout autre hashlock s√©curis√© √† l&#8217;aide de la m√™me cl√© peut √©galement √™tre ouvert. Cela permet de cr√©er plusieurs sorties qui sont toutes encombr√©es par le m√™me hashlock et qui deviennent toutes d√©pensables en m√™me temps.</p>
</dd>
<dt class="hdlist1">SHA</dt>
<dd>
<p>Le Secure Hash Algorithm ou SHA est une famille de fonctions de hachage cryptographiques publi√©es par le National Institute of Standards and Technology (NIST).</p>
</dd>
<dt class="hdlist1">sortie de transaction non d√©pens√©e (UTXO ou unspent transaction output)</dt>
<dd>
<p>UTXO est une sortie de transaction non d√©pens√©e qui peut √™tre d√©pens√©e comme entr√©e dans une nouvelle transaction.</p>
</dd>
<dt class="hdlist1">stockage √† froid</dt>
<dd>
<p>Fait r√©f√©rence √† la conservation d&#8217;une r√©serve de bitcoins hors ligne. Le stockage √† froid est r√©alis√© lorsque les cl√©s priv√©es bitcoin sont cr√©√©es et stock√©es dans un environnement hors ligne s√©curis√©. Le stockage √† froid est important pour quiconque poss√®de des avoirs en bitcoins. Les ordinateurs en ligne sont vuln√©rables aux pirates et ne doivent pas √™tre utilis√©s pour stocker une quantit√© importante de bitcoins. (note du traducteur¬†: l&#8217;auteur est un peu parano√Øde; les n≈ìuds sont en ligne. Si les n≈ìuds sont ins√©cures, c&#8217;est la fin de ce syst√®me et de ce livre.) ;)</p>
</dd>
<dt class="hdlist1">t√©moin s√©par√©</dt>
<dd>
<p>Le t√©moin s√©par√© est une mise √† niveau du protocole Bitcoin dans laquelle les donn√©es de signature ("t√©moin") sont s√©par√©es des donn√©es de l&#8217;exp√©diteur/destinataire pour optimiser davantage la structure des transactions. Le t√©moin S√©par√© a √©t√© impl√©ment√© comme un embranchement convergent ; un changement qui rend techniquement les r√®gles du protocole de bitcoin plus restrictives.</p>
</dd>
<dt class="hdlist1">transaction</dt>
<dd>
<p>En termes simples, un transfert de bitcoin d&#8217;une adresse √† une autre. Plus pr√©cis√©ment, une transaction est une structure de donn√©es sign√©e exprimant un transfert de valeur. Les transactions sont transmises sur le r√©seau Bitcoin, collect√©es par les mineurs et incluses dans des blocs, rendus permanents sur la cha√Æne de blocs.</p>
</dd>
<dt class="hdlist1">transaction coinbase</dt>
<dd>
<p>La premi√®re transaction d&#8217;un bloc; toujours cr√©√© par un mineur. Le coinbase est unique dans le bloc.
√Ä ne pas confondre avec coinbase (donn√©es coinbase) ou "r√©compense coinbase".</p>
</dd>
<dt class="hdlist1">Transaction OP_RETURN</dt>
<dd>
<p>Un type de transaction qui ajoute des donn√©es arbitraires √† un script pubkey prouv√© que les n≈ìuds complets n&#8217;ont pas √† stocker dans leur base de donn√©es UTXO. A ne pas confondre avec l&#8217;opcode OP_RETURN.</p>
</dd>
<dt class="hdlist1">transactions hors cha√Æne</dt>
<dd>
<p>Une transaction hors cha√Æne est le mouvement de valeur en dehors de la cha√Æne de blocs, alors qu&#8217;une transaction en cha√Æne&amp;#x2014 est  simplement appel√©e <em>une transaction</em>&amp;#x2014. La transaction hors cha√Æne modifie la cha√Æne de blocs et d√©pend de cette derni√®re pour d√©terminer sa validit√©. Une transaction hors cha√Æne de blocs s&#8217;appuie sur d&#8217;autres m√©thodes pour enregistrer et valider la transaction.</p>
</dd>
<dt class="hdlist1">transactions orphelines</dt>
<dd>
<p>Transactions qui ne peuvent pas entrer dans le bassin de m√©moire (Mempool) en raison d&#8217;une ou plusieurs transactions d&#8217;entr√©e manquantes.</p>
</dd>
<dt class="hdlist1">valeur de rel√¢che de transaction (ou Locktime)</dt>
<dd>
<p>Locktime, ou plus techniquement nLockTime, est la partie d&#8217;une transaction qui indique la premi√®re heure o√π le premier bloc auquel cette transaction peut √™tre ajout√©e √† la cha√Æne de blocs. C&#8217;est une valeur horodat√©e servant de date ult√©rieur pour une transaction; comme un ch√®que postdat√©.</p>
</dd>
<dt class="hdlist1">v√©rification simplifi√©e des paiements (SPV ou Simplified Payment Verification)</dt>
<dd>
<p>La v√©rification simplifi√©e des paiements (SPV ou Simplified Payment Verification) est une m√©thode permettant de v√©rifier que des transactions particuli√®res ont √©t√© incluses dans un bloc, sans t√©l√©charger le bloc entier. Cette m√©thode de v√©rification est souvent utilis√©e par les clients Bitcoin l√©gers.</p>
</dd>
<dt class="hdlist1">verrou temporels (ou timelocks)</dt>
<dd>
<p>Un verrou temporel (ou timelock) est un type de contrainte qui limite la d√©pense de certains bitcoins jusqu&#8217;√† une heure future ou une hauteur de bloc sp√©cifi√©e. Les timelocks figurent en bonne place dans de nombreux contrats bitcoin, y compris les canaux de paiement et les contrats de timelock hach√©s.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-7">
<p>Certaines d√©finitions fournies ont √©t√© extraites sous une licence CC-BY de <a href="https://en.bitcoin.it/wiki/Main_Page" data-href="https://en.bitcoin.it/wiki/Main_Page">bitcoin Wiki</a> ou d&#8217;autres documentations √† source libre.</p>
</div>
</div>
</div>
<div class="sect1 pagenumrestart data-line-3">
<h2 id="ch01_intro_what_is_bitcoin">Pr√©sentation</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-5">
<h3 id="_quest_ce_que_bitcoin">Qu&#8217;est-ce que Bitcoin¬†?</h3>
<div class="paragraph data-line-7">
<p>Bitcoin est un ensemble de concepts et de technologies qui constituent la base d&#8217;un √©cosyst√®me de monnaie num√©rique. Les unit√©s mon√©taires appel√©es bitcoin sont utilis√©es pour stocker et transmettre de la valeur entre les participants au r√©seau Bitcoin. Les utilisateurs de Bitcoin communiquent entre eux en utilisant le protocole Bitcoin principalement via Internet, bien que d&#8217;autres r√©seaux de transport puissent √©galement √™tre utilis√©s. La pile de protocole Bitcoin, disponible en tant que logiciel √† source libre, peut √™tre ex√©cut√©e sur une large gamme d&#8217;appareils informatiques, y compris les ordinateurs portables et les smartphones, ce qui rend la technologie facilement accessible.</p>
</div>
<div class="admonitionblock tip data-line-10">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-11">
<p>Remarquez comment l&#8217;unit√© mon√©taire s&#8217;appelle "bitcoin" avec un petit <em>b</em>, et le syst√®me s&#8217;appelle "Bitcoin", avec un <em>B</em> majuscule.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-14">
<p>Les utilisateurs peuvent transf√©rer des bitcoins sur le r√©seau pour faire √† peu pr√®s tout ce qui peut √™tre fait avec des devises conventionnelles, y compris acheter et vendre des biens, envoyer de l&#8217;argent √† des personnes ou √† des organisations ou accorder un cr√©dit. Le bitcoin peut √™tre achet√©, vendu et √©chang√© contre d&#8217;autres devises dans des bureaux de change sp√©cialis√©s. Le bitcoin est en un sens la forme d&#8217;argent id√©ale pour Internet car il est rapide, s√©curis√© et sans fronti√®res.</p>
</div>
<div class="paragraph data-line-16">
<p>Contrairement aux monnaies traditionnelles, le bitcoin est enti√®rement virtuel. Il n&#8217;y a pas de pi√®ces physiques ni m√™me de pi√®ces num√©riques en soi. Les pi√®ces sont impliqu√©es dans des transactions qui transf√®rent de la valeur de l&#8217;exp√©diteur au destinataire. Les utilisateurs de Bitcoin poss√®dent des cl√©s qui leur permettent de prouver la propri√©t√© du bitcoin dans le r√©seau Bitcoin. Avec ces cl√©s, ils peuvent signer des transactions pour d√©bloquer la valeur et la d√©penser en la transf√©rant √† un nouveau propri√©taire. Les cl√©s sont souvent stock√©es dans un portefeuille num√©rique sur l&#8217;ordinateur ou le smartphone de chaque utilisateur. La possession de la cl√© qui peut signer une transaction est la seule condition pr√©alable pour d√©penser du bitcoin, mettant le contr√¥le enti√®rement entre les mains de chaque utilisateur.</p>
</div>
<div class="paragraph data-line-18">
<p>Bitcoin est un syst√®me distribu√© pair √† pair. En tant que tel, il n&#8217;y a pas de serveur "central" ou de point de contr√¥le. Les unit√©s de bitcoin sont cr√©√©s par un processus appel√© "minage", qui implique une comp√©tition pour trouver des solutions √† un probl√®me math√©matique lors du traitement des transactions Bitcoin. Tout participant au r√©seau Bitcoin (c&#8217;est-√†-dire toute personne utilisant un appareil ex√©cutant la pile compl√®te du protocole Bitcoin) peut op√©rer en tant que mineur, en utilisant la puissance de traitement de son ordinateur pour v√©rifier et enregistrer les transactions. Toutes les 10 minutes, en moyenne, un mineur de Bitcoin peut valider les transactions et est r√©compens√© par un tout nouveau bitcoin. Essentiellement, l&#8217;extraction de Bitcoin d√©centralise les fonctions d&#8217;√©mission et de compensation de devises d&#8217;une banque centrale et remplace le besoin de cette derni√®re.</p>
</div>
<div class="paragraph data-line-20">
<p>Le protocole Bitcoin comprend des algorithmes int√©gr√©s qui r√©gulent la fonction de minage sur le r√©seau. La difficult√© de la t√¢che de traitement que les mineurs doivent effectuer est ajust√©e dynamiquement de sorte qu&#8217;en moyenne, quelqu&#8217;un r√©ussisse toutes les 10 minutes, quel que soit le nombre de mineurs (et la quantit√© de traitement) en comp√©tition √† tout moment. Le protocole r√©duit √©galement de moiti√© le taux de cr√©ation de nouveaux bitcoins tous les 4 ans et limite le nombre total de bitcoins qui seront cr√©√©s √† un total fixe juste en dessous de 21 millions de pi√®ces. Le r√©sultat est que le nombre de bitcoins en circulation suit de pr√®s une courbe facilement pr√©visible qui approche les 21 millions d&#8217;ici 2140. En raison du taux d&#8217;√©mission d√©croissant du bitcoin, sur le long terme, la monnaie Bitcoin est d√©flationniste. De plus, le bitcoin ne peut pas √™tre gonfl√© en "imprimant" de la nouvelle monnaie au-del√† du taux d&#8217;√©mission pr√©vu.</p>
</div>
<div class="paragraph data-line-22">
<p>Dans les coulisses, Bitcoin est aussi le nom du protocole, un r√©seau pair √† pair et une innovation informatique distribu√©e. La monnaie bitcoin n&#8217;est vraiment que la premi√®re application de cette invention. Bitcoin repr√©sente l&#8217;aboutissement de d√©cennies de recherche en cryptographie et en syst√®mes distribu√©s et comprend quatre innovations cl√©s r√©unies dans une combinaison unique et puissante. Bitcoin se compose de :</p>
</div>
<div class="ulist data-line-24">
<ul>
<li class="data-line-24">
<p>Un r√©seau pair √† pair d√©centralis√© (le protocole Bitcoin)</p>
</li>
<li class="data-line-25">
<p>Un registre public des transactions (la cha√Æne de blocs)</p>
</li>
<li class="data-line-26">
<p>Un ensemble de r√®gles pour la validation ind√©pendante des transactions et l&#8217;√©mission de devises (r√®gles de consensus)</p>
</li>
<li class="data-line-27">
<p>Un m√©canisme pour parvenir √† un consensus mondial d√©centralis√© sur la cha√Æne de blocs valide (algorithme de Proof-of-Work (ou Preuve de travail))</p>
</li>
</ul>
</div>
<div class="paragraph data-line-29">
<p>En tant que d√©veloppeur, je vois Bitcoin comme un Internet de l&#8217;argent, un r√©seau pour propager la valeur et s√©curiser la propri√©t√© des actifs num√©riques via un calcul distribu√©. Il y a beaucoup plus √† Bitcoin qu&#8217;il n&#8217;y para√Æt √† premi√®re vue.</p>
</div>
<div class="paragraph data-line-31">
<p>Dans ce chapitre, nous commencerons par expliquer certains des concepts et termes principaux, et obtenir le logiciel n√©cessaire et utiliser Bitcoin pour des transactions simples. Dans les chapitres suivants, nous commencerons √† d√©baller les couches de technologie qui rendent Bitcoin possible et examinerons le fonctionnement interne du r√©seau et du protocole Bitcoin.</p>
</div>
<div class="sidebarblock pagebreak-before less_space data-line-35">
<div class="content">
<div class="title">Devises num√©riques avant Bitcoin</div>
<div class="paragraph data-line-37">
<p>L&#8217;√©mergence d&#8217;une monnaie num√©rique viable est √©troitement li√©e aux d√©veloppements de la cryptographie. Cela n&#8217;est pas surprenant si l&#8217;on consid√®re les d√©fis fondamentaux li√©s √† l&#8217;utilisation de bits pour repr√©senter la valeur qui peut √™tre √©chang√©e contre des biens et des services. Trois questions fondamentales pour quiconque accepte de l&#8217;argent num√©rique sont¬†:</p>
</div>
<div class="olist arabic data-line-39">
<ol class="arabic">
<li class="data-line-39">
<p>Puis-je avoir la certitude que l&#8217;argent est authentique et non contrefait¬†?</p>
</li>
<li class="data-line-40">
<p>Puis-je avoir confiance que l&#8217;argent num√©rique ne peut √™tre d√©pens√© qu&#8217;une seule fois (connu sous le nom de probl√®me de ¬´¬†double d√©pense¬†¬ª)¬†?</p>
</li>
<li class="data-line-41">
<p>Puis-je √™tre s√ªr que personne d&#8217;autre ne pourra pr√©tendre que cet argent lui appartient et pas √† moi ?</p>
</li>
</ol>
</div>
<div class="paragraph data-line-43">
<p>Les √©metteurs de papier-monnaie luttent constamment contre le probl√®me de la contrefa√ßon en utilisant des papiers et des technologies d&#8217;impression de plus en plus sophistiqu√©s. L&#8217;argent physique r√©sout facilement le probl√®me des doubles d√©penses, car le m√™me billet papier ne peut pas se trouver √† deux endroits √† la fois. Bien s√ªr, l&#8217;argent conventionnel est aussi souvent stock√© et transmis num√©riquement. Dans ces cas, les probl√®mes de contrefa√ßon et de double d√©pense sont trait√©s en compensant toutes les transactions √©lectroniques par des autorit√©s centrales qui ont une vue globale de la monnaie en circulation. Pour la monnaie num√©rique, qui ne peut tirer profit des encres √©sot√©riques ou des bandes holographiques, la cryptographie fournit la base pour faire confiance √† la l√©gitimit√© de la revendication de valeur d&#8217;un utilisateur. Plus pr√©cis√©ment, les signatures num√©riques cryptographiques permettent √† un utilisateur de signer un actif num√©rique ou une transaction prouvant la propri√©t√© de cet actif. Avec l&#8217;architecture appropri√©e, les signatures num√©riques peuvent √©galement √™tre utilis√©es pour r√©soudre le probl√®me des doubles d√©penses.</p>
</div>
<div class="paragraph data-line-45">
<p>Lorsque la cryptographie a commenc√© √† devenir plus largement disponible et comprise √† la fin des ann√©es 1980, de nombreux chercheurs ont commenc√© √† essayer d&#8217;utiliser la cryptographie pour cr√©er des monnaies num√©riques. Ces premiers projets de monnaie num√©rique √©mettaient de la monnaie num√©rique, g√©n√©ralement adoss√©e √† une monnaie nationale ou √† un m√©tal pr√©cieux comme l&#8217;or.</p>
</div>
<div class="paragraph data-line-47">
<p> Bien que ces anciennes monnaies num√©riques fonctionnaient, elles √©taient centralis√©es et, par cons√©quent, faciles √† attaquer par les gouvernements et les pirates. Les premi√®res monnaies num√©riques utilisaient une chambre de compensation centrale pour r√©gler toutes les transactions √† intervalles r√©guliers, tout comme un syst√®me bancaire traditionnel. Malheureusement, dans la plupart des cas, ces monnaies num√©riques naissantes ont √©t√© cibl√©es par des gouvernements inquiets et ont finalement √©t√© dissoutes. Certains ont √©chou√© dans des crashs spectaculaires lorsque la soci√©t√© m√®re a √©t√© liquid√©e brutalement. Pour √™tre robuste contre l&#8217;intervention d&#8217;antagonistes, qu&#8217;il s&#8217;agisse de gouvernements l√©gitimes ou d&#8217;√©l√©ments criminels, une monnaie num√©rique <em>d√©centralis√©e</em> √©tait n√©cessaire pour √©viter un seul point d&#8217;attaque. Bitcoin est un tel syst√®me, d√©centralis√© par conception, et libre de toute autorit√© centrale ou point de contr√¥le qui peut √™tre attaqu√© ou corrompu.</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-51">
<h3 id="_histoire_de_bitcoin">Histoire de Bitcoin</h3>
<div class="paragraph data-line-53">
<p>Bitcoin a √©t√© invent√© en 2008 avec la publication d&#8217;un article intitul√© "Bitcoin¬†: A Peer-to-Peer Electronic Cash System,"<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> √©crit sous l&#8217;alias de Satoshi Nakamoto (voir <a href="#satoshi_whitepaper">Le livre blanc Bitcoin de Satoshi Nakamoto</a>). Nakamoto a combin√© plusieurs inventions ant√©rieures telles que b-money et HashCash pour cr√©er un syst√®me de paiement √©lectronique enti√®rement d√©centralis√© qui ne repose pas sur une autorit√© centrale pour l&#8217;√©mission de devises ou le r√®glement et la validation des transactions. L&#8217;innovation cl√© consistait √† utiliser un syst√®me de calcul distribu√© (appel√© algorithme de ¬´ preuve de travail ¬ª) pour effectuer une ¬´ √©lection ¬ª globale toutes les 10 minutes, permettant au r√©seau d√©centralis√© d&#8217;arriver √† un <em>consensus</em> sur l&#8217;√©tat des transactions. Cela r√©sout √©l√©gamment le probl√®me de la double d√©pense o√π une seule unit√© mon√©taire peut √™tre d√©pens√©e deux fois. Auparavant, le probl√®me des doubles d√©penses √©tait une faiblesse de la monnaie num√©rique et √©tait r√©solu en compensant toutes les transactions via une chambre de compensation centrale.</p>
</div>
<div class="paragraph data-line-55">
<p>Le r√©seau Bitcoin a d√©marr√© en 2009, sur la base d&#8217;une r√©f√©rence d&#8217;impl√©mentation publi√©e par Nakamoto et r√©vis√©e depuis par de nombreux autres programmeurs. La mise en ≈ìuvre de l&#8217;algorithme Proof-of-Work (ou Preuve de travail ou minage) qui assure la s√©curit√© et la r√©silience de Bitcoin a augment√© de mani√®re exponentielle et d√©passe d√©sormais la puissance de traitement combin√©e des meilleurs supercalculateurs du monde. La valeur marchande totale de Bitcoin a parfois d√©pass√© 1 billion de dollars am√©ricains, selon le taux de change bitcoin-dollar. La transaction la plus importante trait√©e jusqu&#8217;√† pr√©sent par le r√©seau √©tait de 1,1 milliard de dollars am√©ricains, transmise instantan√©ment et trait√©e pour des frais de seulement 0,68 $.</p>
</div>
<div class="paragraph data-line-57">
<p>Satoshi Nakamoto s&#8217;est retir√© du public en avril 2011, laissant la responsabilit√© de d√©velopper le code et le r√©seau √† un groupe prosp√®re de b√©n√©voles. L&#8217;identit√© de la personne ou des personnes derri√®re Bitcoin est encore inconnue. Cependant, ni Satoshi Nakamoto ni personne d&#8217;autre n&#8217;exerce de contr√¥le individuel sur le syst√®me Bitcoin, qui fonctionne sur la base de principes math√©matiques totalement transparents, d&#8217;un code √† source libre et d&#8217;un consensus entre les participants. L&#8217;invention elle-m√™me est r√©volutionnaire et a d√©j√† engendr√© une nouvelle science dans les domaines de l&#8217;informatique distribu√©e, de l&#8217;√©conomie et de l&#8217;√©conom√©trie.</p>
</div>
<div class="sidebarblock data-line-61">
<div class="content">
<div class="title">Une solution √† un probl√®me de calcul distribu√©</div>
<div class="paragraph data-line-62">
<p>L&#8217;invention de Satoshi Nakamoto est √©galement une solution pratique et nouvelle √† un probl√®me d&#8217;informatique distribu√©e, connu sous le nom de "Probl√®me des g√©n√©raux byzantins". Bri√®vement, le probl√®me consiste √† essayer de s&#8217;entendre sur une ligne de conduite ou sur l&#8217;√©tat d&#8217;un syst√®me en √©changeant des informations sur un r√©seau peu fiable et potentiellement compromis. La solution de Satoshi Nakamoto, qui utilise le concept de preuve de travail pour parvenir √† un consensus <em>sans autorit√© centrale de confiance</em>, repr√©sente une perc√©e dans l&#8217;informatique distribu√©e et a une large applicabilit√© au-del√† de la monnaie. Il peut √™tre utilis√© pour parvenir √† un consensus sur les r√©seaux d√©centralis√©s afin de prouver l&#8217;√©quit√© des √©lections, des loteries, des registres d&#8217;actifs, de la notarisation num√©rique, etc.</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-67">
<h3 id="user-stories">Utilisations, utilisateurs et histoires de Bitcoin</h3>
<div class="paragraph data-line-69">
<p>Bitcoin est une innovation dans l&#8217;ancienne technologie de l&#8217;argent. √Ä la base, l&#8217;argent facilite simplement l&#8217;√©change de valeur entre les personnes. Par cons√©quent, afin de bien comprendre Bitcoin et ses utilisations, nous l&#8217;examinerons du point de vue des personnes qui l&#8217;utilisent. Chacune des personnes et de leurs histoires, telles qu&#8217;√©num√©r√©es ici, illustre un ou plusieurs cas d&#8217;utilisation sp√©cifiques. Nous les verrons tout au long du livre :</p>
</div>
<div class="dlist data-line-71">
<dl>
<dt class="hdlist1">Vente au d√©tail de faible valeur en Am√©rique du Nord</dt>
<dd>
<p>Alice vit dans la r√©gion de la baie de Californie du Nord. Elle a entendu parler de Bitcoin par ses amis technophiles et veut commencer √† l&#8217;utiliser. Nous suivrons son histoire au fur et √† mesure qu&#8217;elle d√©couvre le Bitcoin, en acquiert, puis d√©pense une partie de son bitcoin pour acheter une tasse de caf√© au Bob&#8217;s Cafe √† Palo Alto. Cette histoire nous pr√©sentera le logiciel, les √©changes et les transactions de base du point de vue d&#8217;un consommateur de d√©tail.</p>
</dd>
<dt class="hdlist1">Vente au d√©tail de grande valeur en Am√©rique du Nord</dt>
<dd>
<p>Carol est propri√©taire d&#8217;une galerie d&#8217;art √† San Francisco. Elle vend des peintures ch√®res pour Bitcoin. Cette histoire pr√©sentera les risques d&#8217;une attaque de consensus "51%" pour les d√©taillants d&#8217;articles de grande valeur.</p>
</dd>
<dt class="hdlist1">Services contractuels extraterritorial</dt>
<dd>
<p>Bob, le propri√©taire d&#8217;un caf√© √† Palo Alto, est en train de cr√©er un nouveau site Web. Il a pass√© un contrat avec un d√©veloppeur Web indien, Gopesh, qui vit √† Bangalore, en Inde. Gopesh a accept√© d&#8217;√™tre pay√© en bitcoin. Cette histoire examinera l&#8217;utilisation de Bitcoin pour l&#8217;externalisation, les services contractuels et les virements internationaux.</p>
</dd>
<dt class="hdlist1">Commerce en ligne</dt>
<dd>
<p>Gabriel est un jeune adolescent entreprenant √† Rio de Janeiro, qui dirige une petite boutique en ligne qui vend des t-shirts, des tasses √† caf√© et des autocollants de marque Bitcoin. Gabriel est trop jeune pour avoir un compte bancaire, mais ses parents encouragent son esprit d&#8217;entreprise.</p>
</dd>
<dt class="hdlist1">Dons caritatifs</dt>
<dd>
<p>Eugenia est directrice d&#8217;une association caritative pour enfants aux Philippines. R√©cemment, elle a d√©couvert Bitcoin et souhaite l&#8217;utiliser pour atteindre un tout nouveau groupe de donateurs √©trangers et nationaux afin de collecter des fonds pour son association caritative. Elle √©tudie √©galement les moyens d&#8217;utiliser Bitcoin pour distribuer rapidement des fonds aux zones qui en ont besoin. Cette histoire montrera l&#8217;utilisation de Bitcoin pour la collecte de fonds mondiale √† travers les devises et les fronti√®res et l&#8217;utilisation d&#8217;un registre ouvert pour la transparence dans les organisations caritatives.</p>
</dd>
<dt class="hdlist1">Importation/Exportation</dt>
<dd>
<p>Mohammed est un importateur d&#8217;√©lectronique √† Duba√Ø. Il essaie d&#8217;utiliser Bitcoin pour acheter des appareils √©lectroniques aux √âtats-Unis et en Chine pour les importer aux √âmirats arabes unis afin d&#8217;acc√©l√©rer le processus de paiement des importations. Cette histoire montrera comment Bitcoin peut √™tre utilis√© pour d&#8217;importants paiements internationaux interentreprises li√©s √† des biens physiques.</p>
</dd>
<dt class="hdlist1">Miner des bitcoins</dt>
<dd>
<p>Jing est un √©tudiant en g√©nie informatique √† Shanghai. Il a construit une plate-forme ¬´mini√®re¬ª pour exploiter le bitcoin en utilisant ses comp√©tences en ing√©nierie pour compl√©ter ses revenus. Cette histoire examinera la base "industrielle" de Bitcoin¬†: l&#8217;√©quipement sp√©cialis√© utilis√© pour s√©curiser le r√©seau Bitcoin et √©mettre de nouvelles devises.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-92">
<p>Chacune de ces histoires est bas√©e sur de vraies personnes et de vraies industries utilisant actuellement Bitcoin pour cr√©er de nouveaux march√©s, de nouvelles industries et des solutions innovantes aux probl√®mes √©conomiques mondiaux.</p>
</div>
</div>
<div class="sect2 data-line-94">
<h3 id="_mise_en_route">Mise en route</h3>
<div class="paragraph data-line-96">
<p>Bitcoin est un protocole accessible √† l&#8217;aide d&#8217;une application cliente qui parle le protocole. Un "portefeuille Bitcoin" est l&#8217;interface utilisateur la plus courante du syst√®me Bitcoin, tout comme un navigateur Web est l&#8217;interface utilisateur la plus courante pour le protocole HTTP. Il existe de nombreuses impl√©mentations et marques de portefeuilles Bitcoin, tout comme il existe de nombreuses marques de navigateurs Web (par exemple, Chrome, Safari, Firefox et Internet Explorer). Et tout comme nous avons tous nos navigateurs pr√©f√©r√©s (Mozilla Firefox, Y√© !) et nos m√©chants (Internet Explorer, Beurk !), les portefeuilles Bitcoin varient en termes de qualit√©, de performances, de s√©curit√©, de confidentialit√© et de fiabilit√©. Il existe √©galement une impl√©mentation de r√©f√©rence du protocole Bitcoin qui inclut un portefeuille, connu sous le nom de "Satoshi Client" ou "Bitcoin Core", qui est d√©riv√© de l&#8217;impl√©mentation originale √©crite par Satoshi Nakamoto.</p>
</div>
<div class="sect3 data-line-98">
<h4 id="_choisir_un_portefeuille_bitcoin">Choisir un portefeuille Bitcoin</h4>
<div class="paragraph data-line-100">
<p>Les portefeuilles Bitcoin sont l&#8217;une des applications les plus activement d√©velopp√©es dans l&#8217;√©cosyst√®me Bitcoin. La concurrence est intense et, bien qu&#8217;un nouveau portefeuille soit probablement en cours de d√©veloppement, plusieurs portefeuilles de l&#8217;ann√©e derni√®re ne sont plus activement maintenus. De nombreux portefeuilles se concentrent sur des plates-formes sp√©cifiques ou des utilisations sp√©cifiques et certains sont plus adapt√©s aux d√©butants tandis que d&#8217;autres sont remplis de fonctionnalit√©s pour les utilisateurs avanc√©s. Le choix d&#8217;un portefeuille est tr√®s subjectif et d√©pend de l&#8217;utilisation et de l&#8217;expertise de l&#8217;utilisateur. Par cons√©quent, il serait inutile de recommander une marque ou un portefeuille sp√©cifique. Cependant, nous pouvons classer les portefeuilles Bitcoin en fonction de leur plate-forme et de leur fonction et fournir des √©claircissements sur tous les diff√©rents types de portefeuilles qui existent. Mieux encore, d√©placer des cl√©s ou des valeurs d&#8217;amor√ßages (les "seeds") entre les portefeuilles Bitcoin est relativement facile, il vaut donc la peine d&#8217;essayer plusieurs portefeuilles diff√©rents jusqu&#8217;√† ce que vous en trouviez un qui corresponde √† vos besoins.</p>
</div>
<div class="paragraph pagebreak-before data-line-103">
<p>Les portefeuilles Bitcoin peuvent √™tre class√©s comme suit, selon la plateforme :</p>
</div>
<div class="dlist data-line-105">
<dl>
<dt class="hdlist1">Portefeuille de bureau</dt>
<dd>
<p>Un portefeuille de bureau a √©t√© le premier type de portefeuille Bitcoin cr√©√© comme impl√©mentation de r√©f√©rence et de nombreux utilisateurs utilisent des portefeuilles de bureau pour les fonctionnalit√©s, l&#8217;autonomie et le contr√¥le qu&#8217;ils offrent. L&#8217;ex√©cution sur des syst√®mes d&#8217;exploitation √† usage g√©n√©ral tels que Windows et Mac OS pr√©sente cependant certains inconv√©nients en mati√®re de s√©curit√©, car ces plates-formes sont souvent non s√©curis√©es et mal configur√©es.</p>
</dd>
<dt class="hdlist1">Portefeuille mobile</dt>
<dd>
<p>Un portefeuille mobile est le type le plus courant de portefeuille Bitcoin. Fonctionnant sur des syst√®mes d&#8217;exploitation de t√©l√©phones intelligents tels qu&#8217;Apple iOS et Android, ces portefeuilles sont souvent un excellent choix pour les nouveaux utilisateurs. Beaucoup sont con√ßus pour √™tre simples et faciles √† utiliser, mais il existe √©galement des portefeuilles mobiles complets pour les utilisateurs exp√©riment√©s.</p>
</dd>
<dt class="hdlist1">Portefeuille Web</dt>
<dd>
<p>Les portefeuilles Web sont accessibles via un navigateur Web et stockent le portefeuille de l&#8217;utilisateur sur un serveur appartenant √† un tiers. Ceci est similaire au webmail en ce sens qu&#8217;il repose enti√®rement sur un serveur tiers. Certains de ces services fonctionnent √† l&#8217;aide d&#8217;un code c√¥t√© client ex√©cut√© dans le navigateur web de l&#8217;utilisateur, qui garde le contr√¥le des cl√©s Bitcoin entre les mains de l&#8217;utilisateur. La plupart, cependant, pr√©sentent un compromis en prenant le contr√¥le des cl√©s Bitcoin des utilisateurs en √©change d&#8217;une facilit√© d&#8217;utilisation. Il est d√©conseill√© de stocker de grandes quantit√©s de bitcoins sur des syst√®mes tiers.</p>
</dd>
<dt class="hdlist1">Portefeuille mat√©riel (hardware)</dt>
<dd>
<p>Les portefeuilles mat√©riels sont des appareils qui exploitent un portefeuille Bitcoin autonome s√©curis√© sur du mat√©riel √† usage sp√©cial. Ils se connectent g√©n√©ralement √† un ordinateur de bureau ou √† un appareil mobile via un c√¢ble USB ou une communication en champ proche (NFC) et fonctionnent avec un navigateur Web ou un logiciel associ√©. En g√©rant toutes les op√©rations li√©es au Bitcoin sur le mat√©riel sp√©cialis√©, ces portefeuilles sont consid√©r√©s comme tr√®s s√©curis√©s et adapt√©s au stockage de grandes quantit√©s de Bitcoin.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-113">
<p>Une autre fa√ßon de cat√©goriser les portefeuilles bitcoin est leur degr√© d&#8217;autonomie et la fa√ßon dont ils interagissent avec le r√©seau Bitcoin :</p>
</div>
<div class="dlist data-line-115">
<dl>
<dt class="hdlist1">Client de n≈ìud complet</dt>
<dd>
<p> Un client complet, ou "n≈ìud complet", est un client qui stocke l&#8217;historique complet des transactions Bitcoin (chaque transaction par chaque utilisateur, toujours), g√®re les portefeuilles des utilisateurs et peuvent initier des transactions directement sur le r√©seau Bitcoin. Un n≈ìud complet g√®re tous les aspects du protocole et peut valider ind√©pendamment l&#8217;ensemble de la cha√Æne de blocs et toute transaction. Un client √† n≈ìud complet consomme des ressources informatiques importantes (par exemple, plus de 125 Go de disque, 2 Go de RAM) mais offre une autonomie compl√®te et une v√©rification ind√©pendante des transactions.</p>
</dd>
<dt class="hdlist1">Client l√©ger</dt>
<dd>
<p>Un client l√©ger, √©galement connu sous le nom de client de v√©rification de paiement simplifi√© (SPV ou  simplified-payment-verification), se connecte aux n≈ìuds complets Bitcoin (mentionn√©s pr√©c√©demment) pour l&#8217;acc√®s aux informations de transaction Bitcoin, mais stocke le portefeuille de l&#8217;utilisateur localement et cr√©e, valide et transmet ind√©pendamment les transactions. Les clients l√©gers interagissent directement avec le r√©seau Bitcoin, sans interm√©diaire.</p>
</dd>
<dt class="hdlist1">Client API tiers</dt>
<dd>
<p> Un client API tiers est un client qui interagit avec Bitcoin via un syst√®me tiers d&#8217;interfaces de programmation d&#8217;applications (API), plut√¥t qu&#8217;en se connectant directement au r√©seau Bitcoin. Le portefeuille peut √™tre stock√© par l&#8217;utilisateur ou par des serveurs tiers, mais toutes les transactions passent par un tiers.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-121">
<p>En combinant ces cat√©gorisations, de nombreux portefeuilles Bitcoin se r√©partissent en quelques groupes, les trois plus courants √©tant le client complet de bureau, le portefeuille l√©ger mobile et le portefeuille Web tiers. Les fronti√®res entre les diff√©rentes cat√©gories sont souvent floues, car de nombreux portefeuilles fonctionnent sur plusieurs plates-formes et peuvent interagir avec le r√©seau de diff√©rentes mani√®res.</p>
</div>
<div class="paragraph data-line-123">
<p>Pour les besoins de ce livre, nous d√©montrerons l&#8217;utilisation d&#8217;une vari√©t√© de clients Bitcoin t√©l√©chargeables, de l&#8217;impl√©mentation de r√©f√©rence (Bitcoin Core) aux portefeuilles mobiles et Web. Certains des exemples n√©cessiteront l&#8217;utilisation de Bitcoin Core, qui, en plus d&#8217;√™tre un client complet, expose √©galement les API au portefeuille, au r√©seau et aux services de transaction. Si vous envisagez d&#8217;explorer les interfaces de programmation dans le syst√®me Bitcoin, vous devrez ex√©cuter Bitcoin Core ou l&#8217;un des clients alternatifs.</p>
</div>
</div>
<div class="sect3 data-line-125">
<h4 id="_d√©marrage_rapide">D√©marrage rapide</h4>
<div class="paragraph data-line-127">
<p>Alice, que nous avons pr√©sent√© dans <a href="#user-stories">Utilisations, utilisateurs et histoires de Bitcoin</a>, n&#8217;est pas une utilisatrice technique et n&#8217;a entendu parler de Bitcoin que r√©cemment par son ami Joe. Lors d&#8217;une f√™te, Joe explique √† nouveau avec enthousiasme Bitcoin √† tout le monde et propose une d√©monstration. Intrigu√©e, Alice demande comment elle peut d√©marrer avec Bitcoin. Joe dit qu&#8217;un portefeuille mobile est ce qu&#8217;il y a de mieux pour les nouveaux utilisateurs et il recommande quelques-uns de ses portefeuilles pr√©f√©r√©s. Alice t√©l√©charge "Bluewallet" (disponible pour iOS et Android) et l&#8217;installe sur son t√©l√©phone.</p>
</div>
<div class="paragraph data-line-129">
<p>Quand Alice ex√©cute son application de portefeuille pour la premi√®re fois, elle choisit l&#8217;option de cr√©er un nouveau portefeuille Bitcoin et prend un moment <strong>loin de Joe et de toutes les autres parties</strong> pour √©crire une phrase mn√©monique secr√®te <em>dans l&#8217;ordre</em> sur un morceau de papier. Comme expliqu√© par le portefeuille mobile et par Joe plus t√¥t, la phrase mn√©motechnique permet √† Alice de restaurer son portefeuille au cas o√π elle perdrait son appareil mobile et lui donne acc√®s √† ses fonds sur un autre appareil. Apr√®s avoir cr√©√© son portefeuille et s√©curis√© sa phrase mn√©monique, Alice peut appuyer sur son portefeuille pour voir son montant en bitcoins, l&#8217;historique des transactions, ainsi que deux boutons qui lui permettent de <em>recevoir</em> ou <em>envoyer</em> des bitcoins, illustr√©s dans <a href="#bluewallet-welcome">Alice utilise l&#8217;√©cran de r√©ception sur son portefeuille Bitcoin mobile Bluewallet et affiche son adresse √† Bob au format de code QR</a>.</p>
</div>
</div>
<div class="sect3 data-line-131">
<h4 id="_mots_mn√©moniques">Mots Mn√©moniques</h4>
<div class="paragraph data-line-133">
<p>Un portefeuille Bitcoin moderne fournira une <em>phrase mn√©monique</em> (aussi parfois appel√©e "valeur d&#8217;amor√ßage" ou "phrase de r√©cup√©ration") qu&#8217;Alice pourra sauvegarder. La phrase mn√©monique se compose de 12 √† 24 mots anglais, s√©lectionn√©s au hasard par le logiciel, et utilis√©s comme base pour les cl√©s g√©n√©r√©es par le portefeuille. La phrase mn√©motechnique peut √™tre utilis√©e par Alice pour restaurer toutes les transactions et tous les fonds de son portefeuille en cas d&#8217;√©v√©nement tel qu&#8217;un appareil mobile perdu, un bogue logiciel ou une corruption de la m√©moire.</p>
</div>
<div class="admonitionblock tip data-line-136">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-137">
<p>Le terme correct pour ces mots de sauvegarde est "phrase mn√©monique". Nous √©vitons d&#8217;utiliser le terme "valeur d&#8217;amor√ßage" pour d√©signer une phrase mn√©motechnique, car m√™me si son utilisation est la m√™me, son usage initial est diff√©rent.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-141">
<h4 id="mnemonic-storage">Stocker le mn√©monique en toute s√©curit√©</h4>
<div class="paragraph data-line-143">
<p>Alice doit faire attention √† stocker la phrase mn√©monique d&#8217;une mani√®re qui √©quilibre la n√©cessit√© d&#8217;emp√™cher le vol et la perte accidentelle. Si elle ne le prot√®ge pas suffisamment, son mn√©monique risque de se faire voler. Si elle le prot√®ge trop, son mn√©monique risque d&#8217;√™tre d√©finitivement perdu. La m√©thode recommand√©e pour √©quilibrer correctement ces risques est d&#8217;√©crire deux copies de la phrase mn√©monique sur papier, avec chacun des mots num√©rot√©s selon l&#8217;ordre.</p>
</div>
<div class="paragraph data-line-145">
<p>Une fois qu&#8217;Alice a enregistr√© la phrase mn√©motechnique, elle doit pr√©voir de stocker chaque copie dans un endroit s√©curis√© s√©par√©, tel qu&#8217;un tiroir de bureau verrouill√© ou un coffre-fort ignifuge.</p>
</div>
<div class="admonitionblock warning data-line-148">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-149">
<p>N&#8217;essayez jamais un syst√®me de s√©curit√© "bricolage" qui s&#8217;√©carte de quelque mani√®re que ce soit de la recommandation des meilleures pratiques dans <a href="#mnemonic-storage">Stocker le mn√©monique en toute s√©curit√©</a>. Ne coupez pas votre mn√©monique en deux, ne faites pas de captures d&#8217;√©cran, ne stockez pas sur des cl√©s USB, des e-mails ou des lecteurs cloud, ne le cryptez pas ou n&#8217;essayez aucune autre m√©thode non standard. Vous ferez pencher la balance de mani√®re √† risquer une perte permanente ou un vol. De nombreuses personnes ont perdu de l&#8217;argent, non pas √† cause d&#8217;un vol, mais parce qu&#8217;elles ont essay√© une solution non standard sans avoir l&#8217;expertise pour √©quilibrer les risques encourus. La recommandation des meilleures pratiques est soigneusement √©quilibr√©e par des experts et adapt√©e √† la grande majorit√© des utilisateurs.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="bluewallet-welcome" class="imageblock data-line-153">
<div class="content">
<img src="images/mbc2_0101.png" alt="√âcran de bienvenue Bluewallet">
</div>
<div class="title">Figure 1. Alice utilise l&#8217;√©cran de r√©ception sur son portefeuille Bitcoin mobile Bluewallet et affiche son adresse √† Bob au format de code QR</div>
</div>
<div class="paragraph data-line-155">
<p>La vue principale du portefeuille affiche le montant en bitcoins, l&#8217;historique des transactions et les boutons <em>Receive</em> et <em>Send</em>. En outre, de nombreux portefeuilles offrent la possibilit√© d&#8217;acheter des Bitcoins directement via un √©change ou un service similaire o√π vous pouvez offrir de l&#8217;argent fiduciaire en √©change de cryptomonnaie, ce qui est fait par <a href="#bitcoin_price">Trouver le prix actuel du Bitcoin</a> et vendre √† l&#8217;utilisateur du portefeuille √† ce prix ou au-dessus. Le bouton <em>Buy Bitcoin</em> permettrait √† Alice d&#8217;acheter des Bitcoins de cette mani√®re.</p>
</div>
<div class="paragraph data-line-157">
<p>Alice est maintenant pr√™te √† commencer √† utiliser son nouveau portefeuille Bitcoin. Son application de portefeuille a g√©n√©r√© al√©atoirement une cl√© priv√©e (d√©crite plus en d√©tail dans <a href="#private_keys">Cl√©s priv√©es</a>) qui sera utilis√© pour d√©river des adresses Bitcoin qui dirigent vers son portefeuille. √Ä ce stade, ses adresses Bitcoin ne sont pas connues du r√©seau Bitcoin ou "enregistr√©es" aupr√®s d&#8217;une quelconque partie du syst√®me Bitcoin. Ses adresses Bitcoin sont simplement des nombres al√©atoires qui correspondent √† sa cl√© priv√©e qu&#8217;elle peut utiliser pour contr√¥ler l&#8217;acc√®s aux fonds. Les adresses sont g√©n√©r√©es ind√©pendamment par son portefeuille sans r√©f√©rence ni inscription √† aucun service. En fait, dans la plupart des portefeuilles, il n&#8217;y a aucune association entre une adresse Bitcoin et toute information d&#8217;identification externe, y compris l&#8217;identit√© de l&#8217;utilisateur. Jusqu&#8217;au moment o√π une adresse est r√©f√©renc√©e comme destinataire de la valeur dans une transaction publi√©e sur le grand livre bitcoin, l&#8217;adresse Bitcoin fait simplement partie du grand nombre d&#8217;adresses possibles valides en bitcoin. Ce n&#8217;est qu&#8217;une fois qu&#8217;une adresse a √©t√© associ√©e √† une transaction qu&#8217;elle fait partie des adresses connues du r√©seau.</p>
</div>
<div class="paragraph data-line-159">
<p>Alice utilise le bouton <em>Receive</em>, qui affiche un code QR avec une adresse Bitcoin. Le code QR est le carr√© avec un motif de points noirs et blancs, servant de forme de code-barres contenant les m√™mes informations dans un format pouvant √™tre scann√© par l&#8217;appareil photo du smartphone de Joe. √Ä c√¥t√© du code QR du portefeuille se trouve l&#8217;adresse Bitcoin qu&#8217;il encode, et Alice peut choisir d&#8217;envoyer manuellement son adresse √† Joe en la copiant dans son presse-papiers d&#8217;un simple toucher. Il convient de noter que lorsque vous recevez des fonds sur un nouveau portefeuille mobile pour la premi√®re fois, de nombreux portefeuilles rev√©rifieront souvent que vous avez bien s√©curis√© votre phrase mn√©monique. Cela peut aller d&#8217;une simple invitation √† demander √† l&#8217;utilisateur de ressaisir manuellement la phrase.</p>
</div>
<div class="admonitionblock tip data-line-162">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-163">
<p>Les adresses Bitcoin commencent par 1, 3 ou bc1. Comme les adresses e-mail, elles peuvent √™tre partag√©es avec d&#8217;autres utilisateurs de bitcoins qui peuvent les utiliser pour envoyer des bitcoins directement dans votre portefeuille. Il n&#8217;y a rien de sensible, du point de vue de la s√©curit√©, √† propos de l&#8217;adresse Bitcoin. Il peut √™tre affich√© n&#8217;importe o√π sans risquer la s√©curit√© du compte. Contrairement aux adresses e-mail, vous pouvez cr√©er de nouvelles adresses aussi souvent que vous le souhaitez, qui dirigeront toutes les fonds vers votre portefeuille. En fait, de nombreux portefeuilles modernes cr√©ent automatiquement une nouvelle adresse pour chaque transaction afin de maximiser la confidentialit√©. Un portefeuille est simplement une collection d&#8217;adresses et les cl√©s qui d√©bloquent les fonds √† l&#8217;int√©rieur.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-168">
<h4 id="getting_first_bitcoin">Obtenir son premier Bitcoin</h4>
<div class="paragraph data-line-170">
<p>Il existe plusieurs fa√ßons pour Alice d&#8217;acqu√©rir des bitcoins¬†:</p>
</div>
<div class="ulist data-line-172">
<ul>
<li class="data-line-172">
<p>Elle peut √©changer une partie de sa monnaie nationale (par exemple USD) √† un √©change de crypto-monnaie</p>
</li>
<li class="data-line-173">
<p>Elle peut en acheter √† un ami ou √† une connaissance d&#8217;un Meetup Bitcoin, en √©change d&#8217;argent</p>
</li>
<li class="data-line-174">
<p>Elle peut trouver un <em>guichet Bitcoin</em> dans sa r√©gion, qui agit comme un distributeur automatique, vendant des bitcoins contre de l&#8217;argent</p>
</li>
<li class="data-line-175">
<p>Elle peut offrir ses comp√©tences ou un produit qu&#8217;elle vend et accepte le paiement en bitcoin</p>
</li>
<li class="data-line-176">
<p>Elle peut demander √† son employeur ou √† ses clients de la payer en bitcoin</p>
</li>
</ul>
</div>
<div class="paragraph data-line-178">
<p>Toutes ces m√©thodes pr√©sentent des degr√©s de difficult√© variables et nombre d&#8217;entre elles impliquent le paiement de frais. Certaines institutions financi√®res exigeront √©galement qu&#8217;Alice fournisse des documents d&#8217;identification pour se conformer aux r√©glementations bancaires locales/aux pratiques de lutte contre le blanchiment d&#8217;argent (AML), un processus connu sous le nom de Know Your Customer (KYC). Cependant, avec toutes ces m√©thodes, Alice pourra recevoir des bitcoins.</p>
</div>
<div class="admonitionblock tip data-line-181">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-182">
<p>L&#8217;un des avantages du bitcoin par rapport aux autres syst√®mes de paiement est que, lorsqu&#8217;il est utilis√© correctement, il offre aux utilisateurs beaucoup plus d&#8217;intimit√©. Acqu√©rir, d√©tenir et d√©penser des bitcoins ne vous oblige pas √† divulguer des informations sensibles et personnellement identifiables √† des tiers. Cependant, lorsque le bitcoin touche les syst√®mes traditionnels, tels que les √©changes de devises, les r√©glementations nationales et internationales s&#8217;appliquent souvent. Afin d&#8217;√©changer des bitcoins contre votre monnaie nationale, il vous sera souvent demand√© de fournir une preuve d&#8217;identit√© et des informations bancaires. Les utilisateurs doivent savoir qu&#8217;une fois qu&#8217;une adresse Bitcoin est associ√©e √† une identit√©, toutes les transactions Bitcoin associ√©es sont √©galement faciles √† identifier et √† suivre. C&#8217;est l&#8217;une des raisons pour lesquelles de nombreux utilisateurs choisissent de maintenir des comptes d&#8217;√©change d√©di√©s non li√©s √† leurs portefeuilles.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-185">
<p>Alice a √©t√© initi√©e au bitcoin par un ami, elle a donc un moyen facile d&#8217;acqu√©rir son premier bitcoin. Ensuite, nous verrons comment elle ach√®te des bitcoins √† son ami Joe et comment Joe envoie les bitcoins dans son portefeuille.</p>
</div>
</div>
<div class="sect3 data-line-188">
<h4 id="bitcoin_price">Trouver le prix actuel du Bitcoin</h4>
<div class="paragraph data-line-190">
<p>Avant qu&#8217;Alice puisse acheter du bitcoin √† Joe, ils doivent s&#8217;entendre sur le <em>taux de change</em> entre le bitcoin et le dollar am√©ricain . Cela soul√®ve une question courante pour ceux qui d√©couvrent le bitcoin¬†: "Qui fixe le prix du bitcoin ?" La r√©ponse courte est que le prix est fix√© par les march√©s.</p>
</div>
<div class="paragraph data-line-192">
<p>Le bitcoin, comme la plupart des autres devises, a un <em>cours du change flottant</em>. Cela signifie que la valeur du bitcoin vis-√†-vis de toute autre devise fluctue en fonction de l&#8217;offre et de la demande sur les diff√©rents march√©s o√π il est n√©goci√©. Par exemple, le ¬´¬†prix¬†¬ª du bitcoin en dollars am√©ricains est calcul√© sur chaque march√© en fonction de la transaction la plus r√©cente de bitcoin et de dollars am√©ricains. En tant que tel, le prix a tendance √† fluctuer minutieusement plusieurs fois par seconde. Un service de tarification regroupera les prix de plusieurs march√©s et calculera une moyenne pond√©r√©e en fonction du volume repr√©sentant le taux de change g√©n√©ral du march√© d&#8217;une paire de devises (par exemple, BTC/USD).</p>
</div>
<div class="paragraph data-line-194">
<p>Il existe des centaines d&#8217;applications et de sites Web qui peuvent fournir le taux actuel du march√©. Voici quelques-uns des plus populaires¬†:</p>
</div>
<div class="dlist data-line-196">
<dl>
<dt class="hdlist1"><a href="https://bitcoinaverage.com/" data-href="https://bitcoinaverage.com/">Bitcoin Average</a> </dt>
<dd>
<p>Un site qui fournit une vue simple de la moyenne pond√©r√©e en fonction du volume pour chaque devise.</p>
</dd>
<dt class="hdlist1"><a href="https://coincap.io/" data-href="https://coincap.io/">CoinCap</a> </dt>
<dd>
<p>Un service r√©pertoriant la capitalisation boursi√®re et les taux de change de centaines de crypto-monnaies, dont le bitcoin.</p>
</dd>
<dt class="hdlist1"><a href="https://bit.ly/cmebrr" data-href="https://bit.ly/cmebrr">Chicago Mercantile Exchange Bitcoin Reference Rate</a></dt>
<dd>
<p>Un taux de r√©f√©rence qui peut √™tre utilis√© comme r√©f√©rence institutionnelle et contractuelle, fourni dans le cadre des flux de donn√©es d&#8217;investissement par le CME.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-200">
<p>En plus de ces diff√©rents sites et applications, la plupart des portefeuilles bitcoin convertiront automatiquement les montants entre le bitcoin et d&#8217;autres devises. Joe utilisera son portefeuille pour convertir automatiquement le prix avant d&#8217;envoyer des bitcoins √† Alice.</p>
</div>
</div>
<div class="sect3 data-line-203">
<h4 id="sending_receiving">Envoi et r√©ception de Bitcoin</h4>
<div class="paragraph data-line-205">
<p>Alice a d√©cid√© d&#8217;√©changer 10 dollars am√©ricains contre des bitcoins, afin de ne pas risquer trop d&#8217;argent sur cette nouvelle technologie. Elle donne √† Joe 10¬†$ en esp√®ces, ouvre son application de portefeuille mobile Bluewallet et s√©lectionne Recevoir. Cela affiche un code QR avec la premi√®re adresse Bitcoin d&#8217;Alice.</p>
</div>
<div class="paragraph data-line-207">
<p>Joe s√©lectionne ensuite <em>Envoyer</em> sur son portefeuille de smartphone Bluewallet et un √©cran contenant les entr√©es suivantes s&#8217;affiche¬†:</p>
</div>
<div class="ulist data-line-209">
<ul>
<li class="data-line-209">
<p>Le montant √† envoyer, en bitcoin (BTC) ou sa devise locale (USD)</p>
</li>
<li class="data-line-210">
<p>Une adresse Bitcoin de destination</p>
</li>
<li class="data-line-211">
<p>Une note de transaction (description)</p>
</li>
<li class="data-line-212">
<p>Des frais de transaction</p>
</li>
</ul>
</div>
<div class="paragraph data-line-214">
<p>Dans le champ de saisie de l&#8217;adresse Bitcoin, il y a un petit bouton <em>Scan</em>. Cela permet √† Joe de scanner le code QR avec l&#8217;appareil photo de son smartphone afin de ne pas avoir √† taper l&#8217;adresse Bitcoin d&#8217;Alice, qui est assez longue et difficile √† taper. Joe appuie sur le bouton <em>Scan</em> et il active la cam√©ra du smartphone, scannant le code QR affich√© sur le smartphone d&#8217;Alice.</p>
</div>
<div class="paragraph data-line-216">
<p>Joe a maintenant l&#8217;adresse Bitcoin d&#8217;Alice d√©finie comme destinataire. Joe saisit le montant de 10 dollars am√©ricains et son portefeuille le convertit en acc√©dant au taux de change le plus r√©cent √† partir d&#8217;un service en ligne. Le taux de change √† l&#8217;√©poque est de 100 dollars am√©ricains par bitcoin, donc 10 dollars am√©ricains valent 0,10 bitcoin (BTC) ou 100 millibitcoin (mBTC) comme le montre la capture d&#8217;√©cran du portefeuille de Joe (voir <a href="#bluewallet-mobile-send">√âcran d&#8217;envoi du portefeuille bitcoin mobile Bluewallet</a>).</p>
</div>
<div class="paragraph data-line-218">
<p>Dans la saisie de la note/description de la transaction, Joe saisit ¬´¬†Alice¬†¬ª. Il peut utiliser ce champ pour ajouter des informations concernant sa transaction pour r√©f√©rence future. Cette fonction est pour sa tenue de dossiers uniquement. La note de transaction sera stock√©e dans son portefeuille et seul Joe pourra la voir. Il ne sera pas envoy√© √† Alice, ni stock√© sur la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-220">
<p>Il s√©lectionne √©galement des frais de transaction pour sa transaction. Plus les frais de transaction sont √©lev√©s, plus vite sa transaction sera confirm√©e (incluse dans un bloc par un mineur). Il s√©lectionne les frais de transaction minimum possibles √† ce moment-l√† (0 satoshis/octet).</p>
</div>
<div class="admonitionblock tip data-line-223">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-224">
<p>Le prix du bitcoin a beaucoup chang√© au fil du temps, et une quantit√© incroyable depuis la r√©daction de la premi√®re √©dition de ce livre. En mars 2021, une personne aurait besoin d&#8217;environ 54 000 USD pour acheter un bitcoin entier. De nombreux exemples dans ce livre font r√©f√©rence √† des transactions pass√©es r√©elles, lorsque le prix du bitcoin √©tait beaucoup plus bas et que des transactions sans frais √©taient encore possibles. Pensez √† quel point Joe aurait √©t√© un ami g√©n√©reux s&#8217;il avait conclu le m√™me accord avec Alice aujourd&#8217;hui¬†!</p>
</div>
</td>
</tr>
</table>
</div>
<div id="bluewallet-mobile-send" class="imageblock smallereighty data-line-230">
<div class="content">
<img src="images/mbc2_0102.png" alt="√âcran d&#8217;envoi Bluewallet">
</div>
<div class="title">Figure 2. √âcran d&#8217;envoi du portefeuille bitcoin mobile Bluewallet</div>
</div>
<div class="paragraph data-line-232">
<p>√Ä l&#8217;aide de Bluewallet, Joe v√©rifie soigneusement qu&#8217;il a saisi le bon montant, car il est sur le point de transmettre de l&#8217;argent et les erreurs sont irr√©versibles. Par souci de simplicit√©, nous supposerons que Joe ne paie aucun frais de transaction. L&#8217;objet et la fixation des frais de transaction sont trait√©s dans les chapitres suivants. Apr√®s avoir rev√©rifi√© l&#8217;adresse et le montant, il appuie sur <em>Envoyer</em> pour transmettre la transaction. Le portefeuille bitcoin mobile de Joe construit une transaction qui attribue 0,10 BTC √† l&#8217;adresse fournie par Alice, puise les fonds dans le portefeuille de Joe et signe la transaction avec les cl√©s priv√©es de Joe. Cela indique au r√©seau Bitcoin que Joe a autoris√© un transfert de valeur vers la nouvelle adresse d&#8217;Alice. Comme la transaction est transmise via le protocole pair √† pair, elle se propage rapidement sur le r√©seau Bitcoin. En moins d&#8217;une seconde, la plupart des n≈ìuds bien connect√©s du r√©seau re√ßoivent la transaction et voient l&#8217;adresse d&#8217;Alice pour la premi√®re fois.</p>
</div>
<div class="paragraph data-line-234">
<p>Pendant ce temps, le portefeuille d&#8217;Alice "√©coute" constamment les transactions publi√©es sur le r√©seau Bitcoin, √† la recherche de celles qui correspondent aux adresses qu&#8217;il contient. Quelques secondes apr√®s que le portefeuille de Joe ait transmis la transaction, le portefeuille d&#8217;Alice indiquera qu&#8217;il re√ßoit 0,10 BTC.</p>
</div>
<div class="admonitionblock tip data-line-237">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-238">
<p>Chaque bitcoin peut √™tre subdivis√© en 100 millions d&#8217;unit√©s, chacune appel√©e "satoshi" (singulier) ou "satoshis" (pluriel). Nomm√© en l&#8217;honneur du cr√©ateur du bitcoin, le Satoshi est la plus petite unit√© de bitcoin, √©quivalente √† 0,00000001 BTC.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="confirmations" class="paragraph data-line-243">
<div class="title">Confirmations</div>
<p>Au d√©but, le portefeuille d&#8217;Alice affichera la transaction de Joe comme "Non confirm√©e". Cela signifie que la transaction a √©t√© propag√©e au r√©seau mais n&#8217;a pas encore √©t√© enregistr√©e dans le registre des transactions bitcoin, connu sous le nom de blockchain ou la cha√Æne de blocs. Pour √™tre confirm√©e, une transaction doit √™tre incluse dans un bloc et ajout√©e √† la cha√Æne de blocs, ce qui se produit toutes les 10 minutes en moyenne. En termes financiers traditionnels, cela s&#8217;appelle <em>liquidation (ou clearing)</em>. Ce livre couvrira en d√©tail la propagation, la validation et la liquidation (ou la confirmation) des transactions bitcoin.</p>
</div>
<div class="paragraph data-line-9">
<p>Alice est maintenant l&#8217;heureuse propri√©taire de 0,10 BTC qu&#8217;elle peut d√©penser. Dans le chapitre suivant, nous examinerons son premier achat avec Bitcoin et examinerons plus en d√©tail les technologies sous-jacentes de transaction et de propagation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="ch02_bitcoin_overview">Comment fonctionne Bitcoin</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-4">
<h3 id="_transactions_blocs_minage_et_la_cha√Æne_de_blocs">Transactions, blocs, minage et la cha√Æne de blocs</h3>
<div class="paragraph data-line-6">
<p>Le syst√®me Bitcoin, contrairement aux syst√®mes bancaires et de paiement traditionnels, est bas√© sur la confiance d√©centralis√©e. Au lieu d&#8217;une autorit√© centrale de confiance, dans le bitcoin, la confiance est obtenue en tant que propri√©t√© √©mergente √† partir des interactions des diff√©rents participants au syst√®me Bitcoin. Dans ce chapitre, nous examinerons le bitcoin d&#8217;un niveau √©lev√© en suivant une seule transaction via le syst√®me Bitcoin et en observant qu&#8217;elle devient "de confiance" et accept√©e par le m√©canisme de consensus distribu√© bitcoin et est finalement enregistr√©e sur la cha√Æne de blocs, le grand livre distribu√© de toutes transactions. Les chapitres suivants approfondiront la technologie derri√®re les transactions, le r√©seau et l&#8217;exploitation mini√®re.</p>
</div>
<div class="sect3 data-line-8">
<h4 id="_pr√©sentation_de_bitcoin">Pr√©sentation de Bitcoin</h4>
<div class="paragraph data-line-10">
<p>Dans le sch√©ma d&#8217;ensemble pr√©sent√© dans <a href="#bitcoin-overview">Pr√©sentation de Bitcoin</a>, nous voyons que le syst√®me Bitcoin se compose d&#8217;utilisateurs avec des portefeuilles contenant des cl√©s, des transactions qui se propagent √† travers le r√©seau et des mineurs qui produisent (par le calcul concurrentiel) le consensus de la cha√Æne de blocs, qui est le registre faisant autorit√© de toutes les transactions.</p>
</div>
<div class="paragraph data-line-13">
<p>Chaque exemple de ce chapitre est bas√© sur une transaction r√©elle effectu√©e sur le r√©seau Bitcoin, simulant les interactions entre les utilisateurs (Joe, Alice, Bob et Gopesh) en envoyant des fonds √† partir d&#8217;un portefeuille √† un autre. Lors du suivi d&#8217;une transaction via le r√©seau Bitcoin jusqu&#8217;√† la cha√Æne de blocs, nous utiliserons un site <em>explorateur de cha√Æne de blocs</em> pour visualiser chaque √©tape. Un explorateur de cha√Æne de blocs est une application Web qui fonctionne comme un moteur de recherche bitcoin, en ce sens qu&#8217;il vous permet de rechercher des adresses, des transactions et des blocs et de voir les relations et les flux entre eux.</p>
</div>
<div id="bitcoin-overview" class="imageblock data-line-17">
<div class="content">
<img src="images/mbc2_0201.png" alt="Survol de Bitcoin">
</div>
<div class="title">Figure 3. Pr√©sentation de Bitcoin</div>
</div>
<div class="paragraph data-line-19">
<p>Les explorateurs des cha√Ænes de blocs populaires incluent¬†:</p>
</div>
<div class="ulist data-line-21">
<ul>
<li class="data-line-21">
<p><a href="https://live.blockcypher.com" data-href="https://live.blockcypher.com">Explorateur BlockCypher</a></p>
</li>
<li class="data-line-22">
<p><a href="https://blockchain.com" data-href="https://blockchain.com">Blockchain.com</a></p>
</li>
<li class="data-line-23">
<p><a href="https://insight.bitpay.com" data-href="https://insight.bitpay.com">BitPay Insight</a></p>
</li>
<li class="data-line-24">
<p><a href="https://blockstream.info" data-href="https://blockstream.info">Blockstream Explorer</a></p>
</li>
</ul>
</div>
<div class="paragraph data-line-26">
<p>Chacun d&#8217;eux a une fonction de recherche qui peut prendre une adresse Bitcoin, un hachage de transaction, un num√©ro de bloc ou un hachage de bloc et r√©cup√©rer les informations correspondantes du r√©seau Bitcoin. Avec chaque exemple de transaction ou de bloc, nous fournirons une URL afin que vous puissiez la rechercher vous-m√™me et l&#8217;√©tudier en d√©tail.</p>
</div>
</div>
<div class="sect3 data-line-30">
<h4 id="cup_of_coffee">Acheter une tasse de caf√©</h4>
<div class="paragraph data-line-32">
<p>Alice, pr√©sent√©e dans le chapitre pr√©c√©dent, est une nouvelle utilisatrice qui vient d&#8217;acqu√©rir son premier bitcoin. Dans <a href="#getting_first_bitcoin">Obtenir son premier Bitcoin</a>, Alice a rencontr√© son ami Joe pour √©changer de l&#8217;argent contre du bitcoin. La transaction cr√©√©e par Joe a financ√© le portefeuille d&#8217;Alice avec 0,10 BTC. Alice va maintenant faire sa premi√®re transaction de vente au d√©tail en achetant une tasse de caf√© au Bob&#8217;s Caf√© √† Palo Alto, en Californie.</p>
</div>
<div class="paragraph data-line-34">
<p>Bob&#8217;s Cafe a r√©cemment commenc√© √† accepter les paiements en bitcoin en ajoutant une option bitcoin √† son syst√®me de point de vente. Les prix au Bob&#8217;s Cafe sont indiqu√©s dans la devise locale (dollars am√©ricains), mais √† la caisse, les clients ont la possibilit√© de payer en dollars ou en bitcoins. Alice passe sa commande pour une tasse de caf√© et Bob l&#8217;inscrit dans le registre, comme il le fait pour toutes les transactions. Le syst√®me de point de vente convertit automatiquement le prix total des dollars am√©ricains en bitcoins au taux du march√© en vigueur et affiche le prix dans les deux devises¬†:</p>
</div>
<div class="listingblock data-line-36">
<div class="content">
<pre>Total:
1,50¬†USD
0,015 BTC</pre>
</div>
</div>
<div class="paragraph data-line-43">
<p>Bob dit¬†: "C&#8217;est un dollar cinquante, ou quinze millibits."</p>
</div>
<div class="paragraph data-line-45">
<p>Le syst√®me de point de vente de Bob cr√©era √©galement automatiquement un code QR sp√©cial contenant une <em>demande de paiement</em> (voir <a href="#payment-request-QR">Code QR de la demande de paiement</a>).</p>
</div>
<div class="paragraph data-line-47">
<p>Contrairement √† un code QR qui contient simplement une adresse Bitcoin de destination, une demande de paiement est une URL encod√©e QR qui contient une adresse de destination, un montant de paiement et une description g√©n√©rique telle que "Bob&#8217;s Cafe". Cela permet √† une application de portefeuille bitcoin de pr√©-remplir les informations utilis√©es pour envoyer le paiement tout en affichant une description lisible par l&#8217;utilisateur √† l&#8217;utilisateur. Vous pouvez scanner le code QR avec une application de portefeuille bitcoin pour voir ce qu&#8217;Alice verrait.</p>
</div>
<div id="payment-request-QR" class="imageblock data-line-52">
<div class="content">
<img src="images/mbc2_0202.png" alt="requ√™te de paiement">
</div>
<div class="title">Figure 4. Code QR de la demande de paiement</div>
</div>
<div class="admonitionblock tip data-line-55">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-56">
<p>Essayez de scanner ceci avec votre portefeuille pour voir l&#8217;adresse et le montant, mais N&#8217;ENVOYEZ PAS D&#8217;ARGENT.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="payment-request-URL" class="listingblock data-line-60">
<div class="title">Le QR code de demande de paiement encode l&#8217;URL suivante, d√©finie dans BIP-21¬†:</div>
<div class="content">
<pre>bitcoin:1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA?
amount=0.015&amp;
label=Bob%27s%20Cafe&amp;
message=Purchase%20at%20Bob%27s%20Cafe

Composants de l'URL

Une adresse Bitcoin¬†: "1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA"
Le montant du paiement¬†: "0,015"
Une √©tiquette pour l'adresse du destinataire¬†: "Bob's Cafe"
Une description du paiement¬†: "Purchase at Bob's Cafe"</pre>
</div>
</div>
<div class="paragraph data-line-74">
<p>Alice utilise son smartphone pour scanner le code-barres affich√©. Son smartphone affiche un paiement de <code>0,0150 BTC</code> √† <code>Bob&#8217;s Cafe</code> et elle s√©lectionne Envoyer pour autoriser le paiement. En quelques secondes (environ le m√™me temps qu&#8217;une autorisation de carte de cr√©dit), Bob voit la transaction sur le registre, compl√©tant la transaction.</p>
</div>
<div class="paragraph data-line-76">
<p>Dans les sections suivantes, nous examinerons cette transaction plus en d√©tail. Nous verrons comment le portefeuille d&#8217;Alice l&#8217;a construit, comment il s&#8217;est propag√© sur le r√©seau, comment il a √©t√© v√©rifi√© et enfin, comment Bob peut d√©penser ce montant lors de transactions ult√©rieures.</p>
</div>
<div class="admonitionblock note data-line-79">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-80">
<p>Le r√©seau Bitcoin peut effectuer des transactions en valeurs fractionnaires, par exemple √† partir de millibitcoin (1/1000e de bitcoin ) jusqu&#8217;√† 1/100 000 000e de bitcoin, connu sous le nom de satoshi. Tout au long de ce livre, nous utiliserons le terme "bitcoin" pour d√©signer toute quantit√© de monnaie bitcoin, de la plus petite unit√© (1 satoshi) au nombre total (21 000 000) de tous les bitcoins qui seront extraits.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-83">
<p>Vous pouvez examiner la transaction d&#8217;Alice avec Bob&#8217;s Cafe sur la cha√Æne de blocs en utilisant un site d&#8217;exploration de blocs (<a href="#view_alice_transaction">Voir la transaction d&#8217;Alice sur blockchain.com</a>):</p>
</div>
<div id="view_alice_transaction" class="exampleblock data-line-87">
<div class="title">Example 1. Voir la transaction d&#8217;Alice sur <a href="https://www.blockchain.com/btc/tx/0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2" data-href="https://www.blockchain.com/btc/tx/0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2">blockchain.com</a></div>
<div class="content">
<div class="listingblock data-line-88">
<div class="content">
<pre>https://www.blockchain.com/btc/tx/0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-93">
<h3 id="_transactions_en_bitcoins">Transactions en bitcoins</h3>
<div class="paragraph data-line-95">
<p>En termes simples, une transaction indique au r√©seau que le propri√©taire d&#8217;une valeur bitcoin a autoris√© le transfert de cette valeur √† un autre propri√©taire. Le nouveau propri√©taire peut d√©sormais d√©penser le bitcoin en cr√©ant une autre transaction qui autorise le transfert √† un autre propri√©taire, et ainsi de suite, dans une cha√Æne de propri√©t√©.</p>
</div>
<div class="sect3 data-line-97">
<h4 id="_entr√©es_et_sorties_de_transactions">Entr√©es et sorties de transactions</h4>
<div class="paragraph data-line-99">
<p>Les transactions sont comme des lignes dans un livre comptable en partie double. Chaque transaction contient une ou plusieurs "entr√©es", qui sont comme des d√©bits sur un compte bitcoin. De l&#8217;autre c√¥t√© de la transaction, il y a une ou plusieurs "sorties", qui sont comme des cr√©dits ajout√©s √† un compte bitcoin. Les entr√©es et les sorties (d√©bits et cr√©dits) ne totalisent pas n√©cessairement le m√™me montant. Au lieu de cela, les sorties s&#8217;additionnent l√©g√®rement moins que les entr√©es et la diff√©rence repr√©sente des <em>frais de transaction</em> implicites, qui sont un petit paiement per√ßu par le mineur qui inclut la transaction dans le grand livre. Une transaction bitcoin s&#8217;affiche sous la forme d&#8217;une √©criture comptable dans <a href="#transaction-double-entry">Transaction comptable en double parties</a>.</p>
</div>
<div class="paragraph data-line-101">
<p>La transaction contient √©galement une preuve de propri√©t√© pour chaque montant de bitcoin (entr√©es) dont la valeur est d√©pens√©e, sous la forme d&#8217;une signature num√©rique du propri√©taire, qui peut √™tre valid√©e ind√©pendamment par n&#8217;importe qui. En termes de bitcoin, "d√©penser" consiste √† signer une transaction qui transf√®re la valeur d&#8217;une transaction pr√©c√©dente √† un nouveau propri√©taire identifi√© par une adresse Bitcoin.</p>
</div>
<div id="transaction-double-entry" class="imageblock data-line-105">
<div class="content">
<img src="images/mbc2_0203.png" alt="Transaction en double saisie">
</div>
<div class="title">Figure 5. Transaction comptable en double parties</div>
</div>
</div>
<div class="sect3 data-line-107">
<h4 id="_cha√Ænes_de_transaction">Cha√Ænes de transaction</h4>
<div class="paragraph data-line-109">
<p>Le paiement d&#8217;Alice √† Bob&#8217;s Cafe utilise la sortie d&#8217;une transaction pr√©c√©dente comme entr√©e. Dans le chapitre pr√©c√©dent, Alice a re√ßu des bitcoins de son ami Joe en √©change d&#8217;argent. Cette transaction a cr√©√© une valeur bitcoin verrouill√©e par la cl√© d&#8217;Alice. Sa nouvelle transaction avec Bob&#8217;s Cafe fait r√©f√©rence √† la transaction pr√©c√©dente comme entr√©e et cr√©e de nouvelles sorties pour payer la tasse de caf√© et recevoir la monnaie. Les transactions forment une cha√Æne, o√π les entr√©es de la derni√®re transaction correspondent aux sorties des transactions pr√©c√©dentes. La cl√© d&#8217;Alice fournit la signature qui d√©verrouille ces sorties de transaction pr√©c√©dentes, prouvant ainsi au r√©seau Bitcoin qu&#8217;elle poss√®de les fonds. Elle joint le paiement du caf√© √† l&#8217;adresse de Bob, "encombrant" ainsi cette sortie avec l&#8217;exigence que Bob produise une signature afin de d√©penser ce montant. Cela repr√©sente un transfert de valeur entre Alice et Bob. Cette cha√Æne de transactions, de Joe √† Alice √† Bob, est illustr√©e dans <a href="#blockchain-mnemonic">Une cha√Æne de transactions, o√π la sortie d&#8217;une transaction est l&#8217;entr√©e de la transaction suivante</a>.</p>
</div>
<div id="blockchain-mnemonic" class="imageblock data-line-113">
<div class="content">
<img src="images/mbc2_0204.png" alt="Cha√Æne de transaction">
</div>
<div class="title">Figure 6. Une cha√Æne de transactions, o√π la sortie d&#8217;une transaction est l&#8217;entr√©e de la transaction suivante</div>
</div>
</div>
<div class="sect3 data-line-115">
<h4 id="_faire_du_change_ou_de_la_petite_monnaie">Faire du change (ou de la petite monnaie)</h4>
<div class="paragraph data-line-117">
<p>De nombreuses transactions bitcoin incluront des sorties qui r√©f√©rencent √† la fois une adresse du nouveau propri√©taire et une adresse du propri√©taire actuel, appel√©e <em>adresse de change</em>. En effet, les entr√©es de transaction, comme les billets de banque, ne peuvent pas √™tre divis√©es. Si vous achetez un article de 5 dollars am√©ricains dans un magasin mais que vous utilisez un billet de 20 dollars am√©ricains pour payer l&#8217;article, vous vous attendez √† recevoir 15 dollars am√©ricains en monnaie. Le m√™me concept s&#8217;applique aux entr√©es de transaction bitcoin. Si vous avez achet√© un article qui co√ªte 5 bitcoins mais que vous n&#8217;aviez qu&#8217;une entr√©e de 20 bitcoins √† utiliser, votre portefeuille cr√©erait une seule transaction qui enverrait deux sorties, une sortie de 5 bitcoins au propri√©taire du magasin et une sortie de 15 bitcoins √† vous-m√™me comme changement (moins les frais de transaction applicables). Il est important de noter que l&#8217;adresse de change ne doit pas n√©cessairement √™tre la m√™me que celle de l&#8217;entr√©e et, pour des raisons de confidentialit√©, il s&#8217;agit souvent d&#8217;une nouvelle adresse du portefeuille du propri√©taire.</p>
</div>
<div class="paragraph data-line-119">
<p>Diff√©rents portefeuilles peuvent utiliser diff√©rentes strat√©gies lors de l&#8217;agr√©gation des entr√©es pour effectuer un paiement demand√© par l&#8217;utilisateur. Ils peuvent regrouper de nombreux petits intrants ou en utiliser un √©gal ou sup√©rieur au paiement souhait√©. √Ä moins que le portefeuille ne puisse agr√©ger les entr√©es de mani√®re √† correspondre exactement au paiement souhait√© plus les frais de transaction, le portefeuille devra g√©n√©rer du change. C&#8217;est tr√®s similaire √† la fa√ßon dont les gens g√®rent l&#8217;argent liquide. Si vous utilisez toujours le plus gros billet dans votre poche, vous vous retrouverez avec une poche pleine de monnaie. Si vous n&#8217;utilisez que la petite monnaie, vous n&#8217;aurez toujours que de gros billets. Les gens trouvent inconsciemment un √©quilibre entre ces deux extr√™mes, et les d√©veloppeurs de portefeuilles Bitcoin s&#8217;efforcent de programmer cet √©quilibre.</p>
</div>
<div class="paragraph data-line-121">
<p>En r√©sum√©, les <em>transactions</em> d√©placent des valeurs des <em>entr√©es de transaction</em> aux <em>sorties de transaction</em>. Une entr√©e est une r√©f√©rence √† la sortie d&#8217;une transaction pr√©c√©dente, indiquant d&#8217;o√π provient la valeur. Une transaction comprend g√©n√©ralement une sortie qui dirige une valeur sp√©cifique vers l&#8217;adresse Bitcoin d&#8217;un nouveau propri√©taire et une sortie de modification vers le propri√©taire d&#8217;origine. Les sorties d&#8217;une transaction peuvent √™tre utilis√©es comme entr√©es dans une nouvelle transaction, cr√©ant ainsi une cha√Æne de propri√©t√© lorsque la valeur est d√©plac√©e d&#8217;un propri√©taire √† l&#8217;autre (voir <a href="#blockchain-mnemonic">Une cha√Æne de transactions, o√π la sortie d&#8217;une transaction est l&#8217;entr√©e de la transaction suivante</a>).</p>
</div>
</div>
<div class="sect3 data-line-123">
<h4 id="_formulaires_de_transaction_communs">Formulaires de transaction communs</h4>
<div class="paragraph data-line-125">
<p>La forme de transaction la plus courante est un simple paiement d&#8217;une adresse √† une autre, qui comprend souvent une ¬´ monnaie ¬ª rendue au propri√©taire d&#8217;origine. Ce type de transaction a une entr√©e et deux sorties et est affich√© dans <a href="#transaction-common">Transaction la plus courante</a>.</p>
</div>
<div id="transaction-common" class="imageblock data-line-129">
<div class="content">
<img src="images/mbc2_0205.png" alt="Transaction commune">
</div>
<div class="title">Figure 7. Transaction la plus courante</div>
</div>
<div class="paragraph data-line-131">
<p>Une autre forme courante de transaction est celle qui agr√®ge plusieurs entr√©es en une seule sortie (voir <a href="#transaction-aggregating">Transaction agr√©geant des fonds</a>). Cela repr√©sente l&#8217;√©quivalent r√©el de l&#8217;√©change d&#8217;une pile de pi√®ces et de billets de banque contre un seul billet plus gros. Des transactions comme celles-ci sont parfois g√©n√©r√©es par des applications de portefeuille pour nettoyer de nombreux petits montants re√ßus en monnaie de paiement.</p>
</div>
<div id="transaction-aggregating" class="imageblock data-line-135">
<div class="content">
<img src="images/mbc2_0206.png" alt="Aggr√©gation de transaction">
</div>
<div class="title">Figure 8. Transaction agr√©geant des fonds</div>
</div>
<div class="paragraph data-line-137">
<p>Enfin, une autre forme de transaction que l&#8217;on voit souvent sur le grand livre bitcoin est une transaction par lots, qui distribue une entr√©e √† plusieurs sorties repr√©sentant plusieurs destinataires, une technique appel√©e "transactions par lot" (voir <a href="#transaction-distributing">Transaction distribuant des fonds</a>). √âtant donn√© que ce type de transaction est utile pour √©conomiser sur les frais de transaction, il est couramment utilis√© par les entit√©s commerciales pour distribuer des fonds, par exemple lorsqu&#8217;une entreprise traite les paiements de paie √† plusieurs employ√©s ou lorsqu&#8217;un √©change de bitcoins traite les retraits de plusieurs clients en un seul. transaction.</p>
</div>
<div id="transaction-distributing" class="imageblock data-line-141">
<div class="content">
<img src="images/mbc2_0207.png" alt="Distribution des transaction">
</div>
<div class="title">Figure 9. Transaction distribuant des fonds</div>
</div>
</div>
</div>
<div class="sect2 data-line-143">
<h3 id="_construction_dune_transaction">Construction d&#8217;une transaction</h3>
<div class="paragraph data-line-145">
<p>L&#8217;application de portefeuille d&#8217;Alice contient toute la logique pour s√©lectionner les entr√©es et les sorties appropri√©es pour construire une transaction √† la sp√©cification d&#8217;Alice. Alice n&#8217;a qu&#8217;√† sp√©cifier une destination et un montant, et le reste se passe dans l&#8217;application portefeuille sans qu&#8217;elle ne voie les d√©tails. Il est important de noter qu&#8217;une application de portefeuille peut cr√©er des transactions m√™me si elle est compl√®tement hors ligne. Comme √©crire un ch√®que √† la maison et l&#8217;envoyer plus tard √† la banque dans une enveloppe, la transaction n&#8217;a pas besoin d&#8217;√™tre construite et sign√©e tout en √©tant connect√©e au r√©seau Bitcoin.</p>
</div>
<div class="sect3 data-line-147">
<h4 id="_obtenir_les_bonnes_entr√©es">Obtenir les bonnes entr√©es</h4>
<div class="paragraph data-line-149">
<p>L&#8217;application de portefeuille d&#8217;Alice devra d&#8217;abord trouver des entr√©es qui peuvent payer le montant qu&#8217;elle veut envoyer √† Bob. La plupart des portefeuilles gardent une trace de toutes les sorties disponibles appartenant aux adresses du portefeuille. Par cons√©quent, le portefeuille d&#8217;Alice contiendrait une copie de la sortie de transaction de la transaction de Joe, qui a √©t√© cr√©√©e en √©change d&#8217;argent (voir <a href="#getting_first_bitcoin">Obtenir son premier Bitcoin</a>). Une application de portefeuille bitcoin qui s&#8217;ex√©cute en tant que client √† n≈ìud complet contient en fait une copie de chaque sortie non d√©pens√©e de chaque transaction dans la cha√Æne de blocs. Cela permet √† un portefeuille de construire des entr√©es de transaction ainsi que de v√©rifier rapidement les transactions entrantes comme ayant des entr√©es correctes. Cependant, comme un client √† n≈ìud complet occupe beaucoup d&#8217;espace disque, la plupart des portefeuilles d&#8217;utilisateurs ex√©cutent des clients "l√©gers" qui ne suivent que les sorties non d√©pens√©es de l&#8217;utilisateur.</p>
</div>
<div class="paragraph data-line-151">
<p>Si l&#8217;application de portefeuille ne conserve pas une copie des sorties de transaction non d√©pens√©es, elle peut interroger le r√©seau Bitcoin pour r√©cup√©rer ces informations √† l&#8217;aide d&#8217;une vari√©t√© d&#8217;API disponibles par diff√©rents fournisseurs ou en demandant √† un n≈ìud complet via l&#8217;aide d&#8217;un appel d&#8217;interface de programmation d&#8217;application (API). <a href="#example_2-2">Recherchez toutes les sorties non d√©pens√©es pour l&#8217;adresse Bitcoin d&#8217;Alice</a> montre une requ√™te API, construite comme une commande HTTP GET vers une URL sp√©cifique. Cette URL renverra toutes les sorties de transaction non d√©pens√©es pour une adresse, donnant √† toute application les informations dont elle a besoin pour construire des entr√©es de transaction pour les d√©penses. Nous utilisons le simple client HTTP en ligne de commande <em>cURL</em> pour r√©cup√©rer la r√©ponse.</p>
</div>
<div id="example_2-2" class="exampleblock data-line-155">
<div class="title">Example 2. Recherchez toutes les sorties non d√©pens√©es pour l&#8217;adresse Bitcoin d&#8217;Alice</div>
<div class="content">
<div class="listingblock data-line-157">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ curl https://blockchain.info/unspent?active=1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock data-line-163">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{

	"unspent_outputs":[

		{
			"tx_hash":"186f9f998a5...2836dd734d2804fe65fa35779",
			"tx_index":104810202,
			"tx_output_n": 0,
			"script":"76a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac",
			"value": 10000000,
			"value_hex": "00989680",
			"confirmations":0
		}

	]
}</code></pre>
</div>
</div>
<div class="paragraph data-line-183">
<p>La r√©ponse en <a href="#example_2-2">Recherchez toutes les sorties non d√©pens√©es pour l&#8217;adresse Bitcoin d&#8217;Alice</a> montre une sortie non d√©pens√©e (une qui n&#8217;a pas encore √©t√© √©chang√©e) sous la propri√©t√© de l&#8217;adresse d&#8217;Alice 1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK. La r√©ponse inclut la r√©f√©rence √† la transaction dans laquelle cette sortie non d√©pens√©e est contenue (le paiement de Joe) et sa valeur en satoshis, √† 10 millions, √©quivalent √† 0,10 bitcoin. Avec ces informations, l&#8217;application de portefeuille d&#8217;Alice peut construire une transaction pour transf√©rer cette valeur aux nouvelles adresses de propri√©taire.</p>
</div>
<div class="admonitionblock tip data-line-186">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-187">
<p>Voir la <a href="https://www.blockchain.com/btc/tx/7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18" data-href="https://www.blockchain.com/btc/tx/7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18">transaction de Joe √† Alice</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-190">
<p>Comme vous pouvez le voir, le portefeuille d&#8217;Alice contient suffisamment de bitcoins en une seule sortie non d√©pens√©e pour payer la tasse de caf√©. Si cela n&#8217;avait pas √©t√© le cas, l&#8217;application de portefeuille d&#8217;Alice aurait peut-√™tre d√ª "fouiller" dans une pile de petites sorties non d√©pens√©es, comme prendre des pi√®ces dans un sac √† main jusqu&#8217;√† ce qu&#8217;elle puisse en trouver assez pour payer le caf√©. Dans les deux cas, il peut √™tre n√©cessaire de r√©cup√©rer de la monnaie, ce que nous verrons dans la section suivante, car l&#8217;application de portefeuille cr√©e les sorties de transaction (paiements).</p>
</div>
</div>
<div class="sect3 data-line-193">
<h4 id="_cr√©ation_des_sorties">Cr√©ation des sorties</h4>
<div class="paragraph data-line-195">
<p>Une sortie de transaction est cr√©√©e sous la forme d&#8217;un script qui cr√©e une charge sur la valeur et ne peut √™tre rachet√©e que par l&#8217;introduction d&#8217;une solution au script. En termes plus simples, la sortie de transaction d&#8217;Alice contiendra un script qui dit quelque chose comme "Cette sortie est payable √† quiconque peut pr√©senter une signature √† partir de la cl√© correspondant √† l&#8217;adresse de Bob." √âtant donn√© que seul Bob poss√®de le portefeuille avec les cl√©s correspondant √† cette adresse, seul le portefeuille de Bob peut pr√©senter une telle signature pour racheter cette sortie. Alice ¬´ encombrera ¬ª donc la valeur de sortie avec une demande de signature de Bob.</p>
</div>
<div class="paragraph data-line-197">
<p>Cette transaction comprendra √©galement une deuxi√®me sortie, car les fonds d&#8217;Alice se pr√©sentent sous la forme d&#8217;une sortie √† 0,10 BTC, trop d&#8217;argent pour la tasse de caf√© √† 0,015 BTC. Alice aura besoin de 0,085 BTC en monnaie. Le paiement de monnaie d&#8217;Alice est cr√©√© par le portefeuille d&#8217;Alice en tant que sortie dans la m√™me transaction que le paiement √† Bob. Essentiellement, le portefeuille d&#8217;Alice divise ses fonds en deux paiements¬†: un √† Bob et un √† elle-m√™me. Elle peut ensuite utiliser (d√©penser) la sortie de monnaie dans une transaction ult√©rieure.</p>
</div>
<div class="paragraph data-line-199">
<p>Enfin, pour que la transaction soit trait√©e par le r√©seau en temps opportun, l&#8217;application de portefeuille d&#8217;Alice ajoutera une somme modique. Ce n&#8217;est pas explicite dans la transaction ; il est impliqu√© par la diff√©rence entre les entr√©es et les sorties. Si au lieu de prendre 0,085 en monnaie, Alice ne cr√©e que 0,0845 comme deuxi√®me sortie, il restera 0,0005 BTC (un demi-millibitcoin). Le 0,10 BTC de l&#8217;entr√©e n&#8217;est pas enti√®rement d√©pens√© avec les deux sorties, car elles totaliseront moins de 0,10. La diff√©rence qui en r√©sulte est le <em>frais de transaction</em> qui est per√ßu par le mineur en tant que frais de validation et d&#8217;inclusion de la transaction dans un bloc √† enregistrer sur la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-201">
<p>La transaction r√©sultante peut √™tre vue √† l&#8217;aide d&#8217;une application Web d&#8217;exploration de cha√Æne de blocs, comme indiqu√© dans <a href="#transaction-alice">Transaction d&#8217;Alice au Bob&#8217;s Cafe</a>.</p>
</div>
<div id="transaction-alice" class="imageblock data-line-206">
<div class="content">
<img src="images/mbc2_0208.png" alt="Transaction du caf√© d&#8217;Alice">
</div>
<div class="title">Figure 10. Transaction d&#8217;Alice au Bob&#8217;s Cafe</div>
</div>
<div id="transaction-alice-url" class="admonitionblock tip data-line-210">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-211">
<p>Voir la <a href="https://www.blockchain.com/btc/tx/0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2" data-href="https://www.blockchain.com/btc/tx/0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2">transaction d&#8217;Alice √† Bob&#8217;s Cafe</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-214">
<h4 id="_ajout_de_la_transaction_au_grand_livre">Ajout de la transaction au grand livre</h4>
<div class="paragraph data-line-216">
<p>La transaction cr√©√©e par l&#8217;application du portefeuille d&#8217;Alice fait 258 octets et contient tout le n√©cessaire pour confirmer la propri√©t√© des fonds et attribuer √† de nouveaux propri√©taires. D√©sormais, la transaction doit √™tre transmise au r√©seau Bitcoin o√π elle fera partie de la cha√Æne de blocs. Dans la section suivante, nous verrons comment une transaction devient partie int√©grante d&#8217;un nouveau bloc et comment le bloc est ¬´ min√© ¬ª. Enfin, nous verrons comment le nouveau bloc, une fois ajout√© √† la cha√Æne de blocs, est de plus en plus approuv√© par le r√©seau au fur et √† mesure que de nouveaux blocs sont ajout√©s.</p>
</div>
<div class="sect4 data-line-218">
<h5 id="_transmission_de_la_transaction">Transmission de la transaction</h5>
<div class="paragraph data-line-220">
<p>La transaction contient toutes les informations n√©cessaires au traitement, et ce peu importe comment et o√π elle est transmise au r√©seau Bitcoin. Le r√©seau Bitcoin est un r√©seau pair √† pair, chaque client Bitcoin participant en se connectant √† plusieurs autres clients Bitcoin. Le but du r√©seau Bitcoin est de propager les transactions et les blocages √† tous les participants.</p>
</div>
</div>
<div class="sect4 data-line-222">
<h5 id="_comment_√ßa_se_propage">Comment √ßa se propage</h5>
<div class="paragraph data-line-224">
<p>Tout syst√®me, tel qu&#8217;un serveur, une application de bureau ou un portefeuille, qui participe au r√©seau Bitcoin en "parlant", le protocole Bitcoin est appel√© un <em>n≈ìud Bitcoin</em>. L&#8217;application de portefeuille d&#8217;Alice peut envoyer la nouvelle transaction √† n&#8217;importe quel n≈ìud Bitcoin auquel elle est connect√©e via n&#8217;importe quel type de connexion¬†: filaire, Wi-Fi, mobile, etc. Son portefeuille Bitcoin n&#8217;a pas besoin d&#8217;√™tre connect√© directement au portefeuille Bitcoin de Bob et elle n&#8217;a pas √† n√©cessairement utiliser la connexion Internet offerte par le caf√©, bien que ces deux options soient √©galement possibles. Tout n≈ìud Bitcoin qui re√ßoit une transaction valide qu&#8217;il n&#8217;a pas vue auparavant la transmettra imm√©diatement √† tous les autres n≈ìuds auxquels il est connect√© , une technique de propagation connue sous le nom d'<em>inondation</em>. Ainsi, la transaction se propage (en inondant ou distribuant) rapidement √† travers le r√©seau pair √† pair, atteignant un grand pourcentage de n≈ìuds en quelques secondes.</p>
</div>
</div>
<div class="sect4 data-line-226">
<h5 id="_le_point_de_vue_de_bob">Le point de vue de Bob</h5>
<div class="paragraph data-line-228">
<p>Si l&#8217;application de portefeuille bitcoin de Bob est directement connect√©e √† l&#8217;application de portefeuille d&#8217;Alice, l&#8217;application de portefeuille de Bob peut √™tre le premier n≈ìud √† recevoir la transaction. Cependant, m√™me si le portefeuille d&#8217;Alice envoie la transaction via d&#8217;autres n≈ìuds, elle atteindra le portefeuille de Bob en quelques secondes. Le portefeuille de Bob identifiera imm√©diatement la transaction d&#8217;Alice comme un paiement entrant car il contient des sorties remboursables par les cl√©s de Bob. L&#8217;application de portefeuille de Bob peut √©galement v√©rifier de mani√®re ind√©pendante que la transaction est bien form√©e, utilise des sorties pr√©c√©demment non d√©pens√©es et contient des frais de transaction suffisants pour √™tre inclus dans le bloc suivant. √Ä ce stade, Bob peut supposer, avec peu de risques, que la transaction sera bient√¥t incluse dans un bloc et confirm√©e.</p>
</div>
<div class="admonitionblock tip data-line-231">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-232">
<p>Une id√©e fausse courante √† propos des transactions bitcoin est qu&#8217;elles doivent √™tre "confirm√©es" en attendant 10 minutes pour un nouveau bloc, ou jusqu&#8217;√† 60 minutes pour six confirmations compl√®tes. Bien que les confirmations garantissent que la transaction a √©t√© accept√©e par l&#8217;ensemble du r√©seau, un tel d√©lai n&#8217;est pas n√©cessaire pour les articles de petite valeur comme une tasse de caf√©. Un commer√ßant peut accepter une transaction valide de petite valeur sans confirmation, sans plus de risque qu&#8217;un paiement par carte de cr√©dit effectu√© sans pi√®ce d&#8217;identit√© ni signature, comme les commer√ßants l&#8217;acceptent couramment aujourd&#8217;hui.("", startref="Tconstruct02" )</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-235">
<h3 id="_extraction_de_bitcoins">Extraction de bitcoins</h3>
<div class="paragraph data-line-237">
<p>La transaction d&#8217;Alice est maintenant propag√© sur le r√©seau Bitcoin. Il ne fait pas partie de la <em>cha√Æne de blocs</em> tant qu&#8217;il n&#8217;est pas v√©rifi√© et inclus dans un bloc par un processus appel√© <em>minage</em>. Voir <a href="#mining">Minage et Consensus</a> pour une explication d√©taill√©e.</p>
</div>
<div class="paragraph data-line-239">
<p>Le syst√®me de confiance Bitcoin est bas√© sur le calcul. Les transactions sont regroup√©es en <em>blocs</em>, qui n√©cessitent une √©norme quantit√© de calculs pour prouver, mais seulement une petite quantit√© de calculs pour v√©rifier comme prouv√©. Le processus de minage sert √† deux fins dans le bitcoin :</p>
</div>
<div class="ulist data-line-241">
<ul>
<li class="data-line-241">
<p>Les n≈ìuds de minage valident toutes les transactions en se r√©f√©rant au <em>consensus des r√®gles de bitcoin</em>. Par cons√©quent, le minage assure la s√©curit√© des transactions bitcoin en rejetant les transactions invalides ou malform√©es.</p>
</li>
<li class="data-line-242">
<p>L&#8217;exploitation mini√®re cr√©e de nouveaux bitcoins dans chaque bloc, presque comme une banque centrale imprimant de la nouvelle monnaie. La quantit√© de bitcoin cr√©√©e par bloc est limit√©e et diminue avec le temps, suivant un calendrier d&#8217;√©mission fixe.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-245">
<p>L&#8217;exploitation mini√®re atteint un bon √©quilibre entre le co√ªt et la r√©compense. L&#8217;exploitation mini√®re utilise l&#8217;√©lectricit√© pour r√©soudre un probl√®me math√©matique. Un mineur qui r√©ussit recevra une <em>r√©compense</em> sous la forme de nouveaux bitcoins et de frais de transaction. Cependant, la r√©compense ne sera per√ßue que si le mineur a correctement valid√© toutes les transactions, √† la satisfaction des r√®gles de <em>consensus</em>. Cet √©quilibre d√©licat assure la s√©curit√© du bitcoin sans autorit√© centrale.</p>
</div>
<div class="paragraph data-line-247">
<p>Une bonne fa√ßon de d√©crire l&#8217;exploitation mini√®re est comme un jeu comp√©titif g√©ant de sudoku qui se r√©initialise chaque fois que quelqu&#8217;un trouve une solution et dont la difficult√© s&#8217;ajuste automatiquement de sorte qu&#8217;il faut environ 10 minutes pour trouver une solution. Imaginez un puzzle sudoku g√©ant, de plusieurs milliers de lignes et de colonnes. Si je vous montre un puzzle termin√©, vous pouvez le v√©rifier assez rapidement. Cependant, si le puzzle a quelques cases remplies et que les autres sont vides, cela demande beaucoup de travail √† r√©soudre ! La difficult√© du sudoku peut √™tre ajust√©e en modifiant sa taille (plus ou moins de lignes et de colonnes), mais elle peut toujours √™tre v√©rifi√©e assez facilement m√™me si elle est tr√®s grande. Le "casse-t√™te" utilis√© dans le bitcoin est bas√© sur un hachage cryptographique et pr√©sente des caract√©ristiques similaires¬†: il est asym√©triquement difficile √† r√©soudre mais facile √† v√©rifier, et sa difficult√© peut √™tre ajust√©e.</p>
</div>
<div class="paragraph data-line-249">
<p>In <a href="#user-stories">Utilisations, utilisateurs et histoires de Bitcoin</a>, nous avons pr√©sent√© Jing est un entrepreneur √† Shanghai. Jing dirige une <em>ferme mini√®re</em>, qui est une entreprise qui g√®re des milliers d&#8217;ordinateurs miniers sp√©cialis√©s, en comp√©tition pour la r√©compense. Toutes les 10 minutes environ, les ordinateurs miniers de Jing rivalisent avec des milliers de syst√®mes similaires dans une course mondiale pour trouver une solution √† un bloc de transactions. Trouver une telle solution, la soi-disant <em>Proof-of-Work (ou Preuve de travail)</em> (PoW), n√©cessite des quadrillions d&#8217;op√©rations de hachage par seconde sur l&#8217;ensemble du r√©seau Bitcoin. L&#8217;algorithme de preuve de travail implique de hacher √† plusieurs reprises l&#8217;en-t√™te du bloc et un nombre al√©atoire avec l&#8217;algorithme cryptographique SHA256 jusqu&#8217;√† ce qu&#8217;une solution correspondant √† un mod√®le pr√©d√©termin√© √©merge. Le premier mineur √† trouver une telle solution remporte la comp√©tition et publie ce bloc dans la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-251">
<p>Jing a commenc√© l&#8217;exploitation mini√®re en 2010 en utilisant un ordinateur de bureau tr√®s rapide pour trouver une preuve de travail appropri√©e pour les nouveaux blocs. Au fur et √† mesure que de plus en plus de mineurs rejoignaient le r√©seau Bitcoin, la difficult√© du probl√®me augmentait rapidement. Bient√¥t, Jing et d&#8217;autres mineurs sont pass√©s √† du mat√©riel plus sp√©cialis√©, avec des unit√©s de traitement graphique (GPU) d√©di√©es de haute de gamme, souvent utilis√©es dans les ordinateurs de bureau ou les consoles de jeu. Au moment d&#8217;√©crire ces lignes, la difficult√© est si √©lev√©e qu&#8217;il n&#8217;est rentable de miner qu&#8217;avec des circuits int√©gr√©s √† application sp√©cifique (ASIC), essentiellement des centaines d&#8217;algorithmes de minage imprim√© en mat√©riel, fonctionnant en parall√®le sur une seule puce de silicium. La soci√©t√© de Jing participe √©galement √† un <em>groupe ou bassin de mineurs</em>, qui, tout comme un groupe de loterie, permet √† plusieurs participants de partager leurs efforts et leurs r√©compenses. La soci√©t√© de Jing g√®re d√©sormais un entrep√¥t contenant des milliers de mineurs ASIC pour extraire du bitcoin 24 heures sur 24. L&#8217;entreprise paie ses frais d&#8217;√©lectricit√© en vendant le bitcoin qu&#8217;elle est capable de g√©n√©rer √† partir de l&#8217;exploitation mini√®re, cr√©ant ainsi des revenus √† partir des b√©n√©fices.</p>
</div>
</div>
<div class="sect2 data-line-253">
<h3 id="_transactions_mini√®res_en_blocs">Transactions mini√®res en blocs</h3>
<div class="paragraph data-line-255">
<p> De nouvelles transactions affluent constamment sur le r√©seau √† partir des portefeuilles des utilisateurs et d&#8217;autres applications. Comme ceux-ci sont vus par les n≈ìuds du r√©seau Bitcoin, ils sont ajout√©s √† un bassin temporaire de transactions non v√©rifi√©es maintenues par chaque n≈ìud. Lorsque les mineurs construisent un nouveau bloc, ils ajoutent des transactions non v√©rifi√©es de ce bassin au nouveau bloc, puis tentent de prouver la validit√© de ce nouveau bloc, avec l&#8217;algorithme de minage (la preuve de travail). Le processus d&#8217;extraction est expliqu√© en d√©tail dans <a href="#mining">Minage et Consensus</a>.</p>
</div>
<div class="paragraph data-line-257">
<p>Les transactions sont ajout√©es au nouveau bloc, class√©es par ordre de priorit√© par les transactions les plus payantes en premier et quelques autres crit√®res. Chaque mineur commence le processus d&#8217;extraction d&#8217;un nouveau bloc de transactions d√®s qu&#8217;il re√ßoit le bloc pr√©c√©dent du r√©seau, sachant qu&#8217;il a perdu le tour de comp√©tition pr√©c√©dent. Ils cr√©ent imm√©diatement un nouveau bloc, le remplissent avec les transactions et l&#8217;empreinte num√©rique du bloc pr√©c√©dent, et commencent √† calculer la preuve de travail pour le nouveau bloc. Chaque mineur inclut une transaction sp√©ciale dans son bloc, une transaction qui paie √† sa propre adresse Bitcoin la r√©compense du bloc (actuellement 6,25 bitcoins nouvellement cr√©√©s) plus la somme des frais de transaction de toutes les transactions incluses dans le bloc. S&#8217;ils trouvent une solution qui rend ce bloc valide, ils "gagnent" cette r√©compense car leur bloc r√©ussi est ajout√© √† la cha√Æne de blocs mondiale et la transaction de r√©compense qu&#8217;ils ont incluse devient d√©pensable. Jing, qui participe √† un groupe de minage, a mis en place son logiciel pour cr√©er de nouveaux blocs qui attribuent la r√©compense √† une adresse de pool. √Ä partir de l√†, une part de la r√©compense est distribu√©e √† Jing et aux autres mineurs proportionnellement √† la quantit√© de travail qu&#8217;ils ont apport√©e lors du dernier tour.</p>
</div>
<div class="paragraph data-line-259">
<p>La transaction d&#8217;Alice a √©t√© r√©cup√©r√©e par le r√©seau et incluse dans le groupe de transactions non v√©rifi√©es. Une fois valid√© par le logiciel de minage, il a √©t√© inclus dans un nouveau bloc, appel√© <em>bloc candidat</em>, g√©n√©r√© par le pool de minage de Jing. Tous les mineurs participant √† ce pool de minage commencent imm√©diatement √† calculer la preuve de travail pour le bloc candidat. Environ cinq minutes apr√®s la premi√®re transmission de la transaction par le portefeuille d&#8217;Alice, l&#8217;un des mineurs ASIC de Jing a trouv√© une solution pour le bloc candidat et l&#8217;a annonc√©e au r√©seau. Une fois que les autres mineurs ont valid√© le bloc gagnant, ils ont commenc√© la course pour g√©n√©rer le bloc suivant.</p>
</div>
<div class="paragraph data-line-261">
<p>Le bloc gagnant de Jing est devenu une partie de la cha√Æne de blocs en tant que bloc # 277316, contenant 419 transactions, y compris la transaction d&#8217;Alice. Le bloc contenant la transaction d&#8217;Alice est compt√© comme une "confirmation" de cette transaction.</p>
</div>
<div class="admonitionblock tip data-line-264">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-265">
<p>Vous pouvez voir le bloc qui inclut <a href="https://www.blockchain.com/btc/block/277316" data-href="https://www.blockchain.com/btc/block/277316">Transaction d&#8217;Alice</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-268">
<p> Environ 20 minutes plus tard, un nouveau bloc, #277317, est min√© par un autre mineur. Parce que ce nouveau bloc est construit au-dessus du bloc #277316 qui contenait la transaction d&#8217;Alice, il a ajout√© encore plus de calculs √† la cha√Æne de blocs, renfor√ßant ainsi la confiance dans ces transactions. Chaque bloc min√© en plus de celui contenant la transaction compte comme une confirmation suppl√©mentaire pour la transaction d&#8217;Alice. Au fur et √† mesure que les blocs s&#8217;empilent les uns sur les autres, il devient exponentiellement plus difficile d&#8217;inverser la transaction, ce qui la rend de plus en plus fiable par le r√©seau.</p>
</div>
<div class="paragraph data-line-270">
<p>Dans le diagramme en <a href="#block-alice1">Transaction d&#8217;Alice incluse dans le bloc #277316</a>, nous pouvons voir le bloc #277316, qui contient la transaction d&#8217;Alice. En dessous se trouvent 277 316 blocs (y compris le bloc #0), li√©s les uns aux autres dans une cha√Æne de blocs jusqu&#8217;au bloc #0, connu sous le nom de <em>bloc d&#8217;origine</em>. Au fil du temps, √† mesure que la "hauteur" des blocs augmente, la difficult√© de calcul de chaque bloc et de la cha√Æne dans son ensemble augmente √©galement. Les blocs extraits apr√®s celui qui contient la transaction d&#8217;Alice agissent comme une assurance suppl√©mentaire, car ils accumulent plus de calculs dans une cha√Æne de plus en plus longue. Par convention, tout bloc avec plus de six confirmations est consid√©r√© comme irr√©vocable, car il faudrait une immense quantit√© de calculs pour invalider et recalculer six blocs. Nous examinerons plus en d√©tail le processus d&#8217;exploitation mini√®re et la mani√®re dont il renforce la confiance dans <a href="#mining">Minage et Consensus</a>.</p>
</div>
<div id="block-alice1" class="imageblock data-line-274">
<div class="content">
<img src="images/mbc2_0209.png" alt="Transaction d&#8217;Alice incluse dans un bloc">
</div>
<div class="title">Figure 11. Transaction d&#8217;Alice incluse dans le bloc #277316</div>
</div>
</div>
<div class="sect2 data-line-276">
<h3 id="_d√©penser_la_transaction">D√©penser la transaction</h3>
<div class="paragraph data-line-278">
<p> Maintenant que la transaction d&#8217;Alice a √©t√© int√©gr√©e √† la cha√Æne de blocs dans le cadre d&#8217;un bloc, il fait partie du grand livre distribu√© de Bitcoin et est visible par toutes les applications Bitcoin. Chaque client Bitcoin peut ind√©pendamment v√©rifier que la transaction est valide et utilisable. Les clients du n≈ìud complet peuvent suivre la source des fonds √† partir du moment o√π les bitcoins ont √©t√© g√©n√©r√©s pour la premi√®re fois dans un bloc, progressivement d&#8217;une transaction √† l&#8217;autre, jusqu&#8217;√† ce qu&#8217;ils atteignent l&#8217;adresse de Bob. Les clients l√©gers peuvent faire ce qu&#8217;on appelle une v√©rification de paiement simplifi√©e (voir <a href="#spv_nodes">N≈ìuds de v√©rification simplifi√©e des paiements, ou Simplified Payment Verification (SPV)</a>) en confirmant que la transaction est dans la cha√Æne de blocs et qu&#8217;elle a plusieurs blocs extraits apr√®s elle, fournissant ainsi l&#8217;assurance que les mineurs l&#8217;ont accept√©e comme valide.</p>
</div>
<div class="paragraph data-line-280">
<p>Bob peut maintenant d√©penser le r√©sultat de cette transaction et d&#8217;autres transactions. Par exemple, Bob peut payer un entrepreneur ou un fournisseur en transf√©rant la valeur du paiement de la tasse de caf√© d&#8217;Alice √† ces nouveaux propri√©taires. Tr√®s probablement, le logiciel Bitcoin de Bob regroupera de nombreux petits paiements en un paiement plus important, concentrant peut-√™tre tous les revenus Bitcoin de la journ√©e en une seule transaction. Cela regrouperait les diff√©rents paiements en un seul r√©sultat (et une seule adresse). Pour un diagramme d&#8217;une transaction d&#8217;agr√©gation, voir <a href="#transaction-aggregating">Transaction agr√©geant des fonds</a>.</p>
</div>
<div class="paragraph data-line-282">
<p>Au fur et √† mesure que Bob d√©pense les paiements re√ßus d&#8217;Alice et d&#8217;autres clients, il √©tend la cha√Æne des transactions. Supposons que Bob paie son concepteur Web Gopesh √† Bangalore pour une nouvelle page Web. Maintenant, la cha√Æne de transactions ressemblera √† <a href="#block-alice2">La transaction d&#8217;Alice dans le cadre d&#8217;une cha√Æne de transactions de Joe √† Gopesh, o√π la sortie d&#8217;une transaction est utilis√©e comme entr√©e de la transaction suivante</a>.</p>
</div>
<div id="block-alice2" class="imageblock data-line-286">
<div class="content">
<img src="images/mbc2_0210.png" alt="Transaction d&#8217;Alice comme partie d&#8217;une cha√Æne de transactions">
</div>
<div class="title">Figure 12. La transaction d&#8217;Alice dans le cadre d&#8217;une cha√Æne de transactions de Joe √† Gopesh, o√π la sortie d&#8217;une transaction est utilis√©e comme entr√©e de la transaction suivante</div>
</div>
<div class="paragraph data-line-11">
<p>Dans ce chapitre, nous avons vu comment les transactions construisent une cha√Æne qui d√©place la valeur d&#8217;un propri√©taire √† l&#8217;autre. Nous avons √©galement suivi la transaction d&#8217;Alice, √† partir du moment o√π elle a √©t√© cr√©√©e dans son portefeuille, via le r√©seau Bitcoin et jusqu&#8217;aux mineurs qui l&#8217;ont enregistr√©e sur la cha√Æne de blocs. Dans le reste de ce livre, nous examinerons les technologies sp√©cifiques derri√®re les portefeuilles, les adresses, les signatures, les transactions, le r√©seau et enfin le minage. </p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="ch03_bitcoin_client">Bitcoin Core¬†: La r√©f√©rence d&#8217;impl√©mentation</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-4">
<p>Bitcoin est un projet <em>source libre</em> et le code source est disponible sous une licence ouverte (MIT), t√©l√©chargeable et utilisable √† n&#8217;importe quelle fin. Source libre signifie plus que simplement libre d&#8217;utilisation. Cela signifie √©galement que le bitcoin est d√©velopp√© par une communaut√© ouverte de b√©n√©voles. Au d√©but, cette communaut√© se composait uniquement de Satoshi Nakamoto. En 2016, le code source de Bitcoin comptait plus de 400 contributeurs avec une douzaine de d√©veloppeurs travaillant sur le code presque √† temps plein et plusieurs dizaines d&#8217;autres √† temps partiel. Tout le monde peut contribuer au code, y compris vous¬†!</p>
</div>
<div class="paragraph data-line-7">
<p>Lorsque bitcoin a √©t√© cr√©√© par Satoshi Nakamoto, le logiciel √©tait en fait termin√© avant le livre blanc reproduit dans <a href="#satoshi_whitepaper">Le livre blanc Bitcoin de Satoshi Nakamoto</a>. Satoshi voulait s&#8217;assurer que cela fonctionnait avant d&#8217;√©crire √† ce sujet. Cette premi√®re impl√©mentation, alors simplement connue sous le nom de "Bitcoin" ou "client Satoshi", a √©t√© fortement modifi√©e et am√©lior√©e. Il a √©volu√© vers ce qu&#8217;on appelle <em>Bitcoin Core</em>, pour le diff√©rencier des autres impl√©mentations compatibles. Bitcoin Core est la <em>mise en ≈ìuvre de r√©f√©rence</em> du syst√®me Bitcoin, ce qui signifie qu&#8217;il s&#8217;agit de la r√©f√©rence faisant autorit√© sur la mani√®re dont chaque partie de la technologie doit √™tre mise en ≈ìuvre. Bitcoin Core impl√©mente tous les aspects du bitcoin, y compris les portefeuilles, un moteur de validation des transactions et des blocs et un n≈ìud de r√©seau complet dans le r√©seau Bitcoin pair √† pair.</p>
</div>
<div class="admonitionblock warning data-line-10">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-11">
<p>M√™me si Bitcoin Core inclut une impl√©mentation de r√©f√©rence d&#8217;un portefeuille, celui-ci n&#8217;est pas destin√© √† √™tre utilis√© comme portefeuille de production pour les utilisateurs ou pour les applications. Il est conseill√© aux d√©veloppeurs d&#8217;applications de cr√©er des portefeuilles en utilisant des normes modernes telles que BIP-39 et BIP-32 (voir <a href="#mnemonic_code_words">Mots de code mn√©monique (BIP-39)</a> et <a href="#hd_wallets">Portefeuilles HD (BIP-32/BIP-44)</a>). BIP signifie <em>Bitcoin Improvement Proposal</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-14">
<p><a href="#bitcoin_core_architecture">Architecture Bitcoin Core (Source¬†: Eric Lombrozo)</a> montre l&#8217;architecture de Bitcoin Core.</p>
</div>
<div id="bitcoin_core_architecture" class="imageblock data-line-18">
<div class="content">
<img src="images/mbc2_0301.png" alt="Architecture de base Bitcoin">
</div>
<div class="title">Figure 13. Architecture Bitcoin Core (Source¬†: Eric Lombrozo)</div>
</div>
<div class="sect2 data-line-21">
<h3 id="_environnement_de_d√©veloppement_bitcoin">Environnement de d√©veloppement Bitcoin</h3>
<div class="paragraph data-line-23">
<p> Si vous √™tes un d√©veloppeur, vous souhaiterez configurer un environnement de d√©veloppement avec tous les outils, biblioth√®ques et logiciels de support pour le d√©veloppement d&#8217;applications bitcoin. Dans ce chapitre tr√®s technique, nous allons parcourir ce processus √©tape par √©tape. Si le mat√©riel devient trop dense (et que vous n&#8217;√™tes pas en train de mettre en place un environnement de d√©veloppement), n&#8217;h√©sitez pas √† passer au chapitre suivant, qui est moins technique.</p>
</div>
</div>
<div class="sect2 data-line-26">
<h3 id="compiling_core">Compilation de Bitcoin Core √† partir du code source</h3>
<div class="paragraph data-line-28">
<p>Le code source de Bitcoin Core peut √™tre t√©l√©charg√© sous forme d&#8217;archive ou en clonant le r√©f√©rentiel source faisant autorit√© √† partir de GitHub. Sur la <a href="https://bitcoincore.org/bin/" data-href="https://bitcoincore.org/bin/">page de t√©l√©chargement de Bitcoin Core</a>, s√©lectionnez la version la plus r√©cente et t√©l√©chargez l&#8217;archive compress√©e du code source, par exemple, bitcoin-0.15.0.2.tar.gz. Vous pouvez √©galement utiliser la ligne de commande git pour cr√©er une copie locale du code source √† partir de la <a href="https://github.com/bitcoin/bitcoin" data-href="https://github.com/bitcoin/bitcoin">page GitHub de bitcoin</a>.</p>
</div>
<div class="admonitionblock tip data-line-31">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-32">
<p>Dans de nombreux exemples de ce chapitre, nous utiliserons l&#8217;interface de de commande du syst√®me d&#8217;exploitation ( √©galement appel√© "shell" ou "interface syst√®me" ou "coque logicielle"), accessible via une application "terminal". L&#8217;interface syst√®me affichera une invite; vous tapez une commande; et l&#8217;interface syst√®me r√©pond avec du texte et une nouvelle invite pour votre prochaine commande. L&#8217;invite peut sembler diff√©rente sur votre syst√®me, mais dans les exemples suivants, elle est indiqu√©e par un symbole $. Dans les exemples, lorsque vous voyez du texte apr√®s un symbole $, ne tapez pas le symbole <code>$</code> mais tapez la commande qui le suit imm√©diatement, puis appuyez sur Entr√©e pour ex√©cuter la commande. Dans les exemples, les lignes sous chaque commande sont les r√©ponses du syst√®me d&#8217;exploitation √† cette commande. Lorsque vous verrez le prochain pr√©fixe $, vous saurez qu&#8217;il s&#8217;agit d&#8217;une nouvelle commande et vous devrez r√©p√©ter le processus.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-35">
<p> Dans cet exemple, nous utilisons la commande <code>git</code> pour cr√©er une copie locale (un "clone") du code source¬†:</p>
</div>
<div class="listingblock data-line-37">
<div class="content">
<pre>$ git clone https://github.com/bitcoin/bitcoin.git
Cloning into 'bitcoin'...
remote: Counting objects: 102071, done.
remote: Compressing objects: 100% (10/10), done.
Receiving objects: 100% (102071/102071), 86.38 MiB | 730.00 KiB/s, done.
remote: Total 102071 (delta 4), reused 5 (delta 1), pack-reused 102060
Resolving deltas: 100% (76168/76168), done.
Checking connectivity... done.
$</pre>
</div>
</div>
<div class="admonitionblock tip data-line-50">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-51">
<p>Git est le syst√®me de contr√¥le de version distribu√© le plus largement utilis√© et un √©l√©ment essentiel de la bo√Æte √† outils de tout d√©veloppeur de logiciels. Vous devrez peut-√™tre installer la commande git, ou une interface utilisateur graphique pour git, sur votre syst√®me d&#8217;exploitation si vous ne l&#8217;avez pas d√©j√†.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-54">
<p>Une fois l&#8217;op√©ration de clonage git termin√©e, vous aurez une copie locale compl√®te du r√©f√©rentiel de code source dans le r√©pertoire <em>bitcoin</em>. Acc√©dez √† ce r√©pertoire en tapant <code><strong>cd bitcoin</strong></code> √† l&#8217;invite¬†:</p>
</div>
<div class="listingblock data-line-56">
<div class="content">
<pre>$ cd bitcoin</pre>
</div>
</div>
<div class="sect3 data-line-60">
<h4 id="_s√©lection_dune_version_de_bitcoin_core">S√©lection d&#8217;une version de Bitcoin Core</h4>
<div class="paragraph data-line-61">
<p>Par d√©faut, la copie locale sera synchronis√©e avec le code le plus r√©cent, qui peut √™tre une version instable ou b√™ta de bitcoin. Avant de compiler le code, s√©lectionnez une version sp√©cifique en consultant une version avec la commande Git <em>tag</em>. Cela synchronisera la copie locale avec un instantan√© (snapshot) sp√©cifique du r√©f√©rentiel de code identifi√© par une balise de mot-cl√© (le <em>tag</em>.) Les balises sont utilis√©es par les d√©veloppeurs pour marquer des versions sp√©cifiques du code par num√©ro de version. Tout d&#8217;abord, pour trouver les balises disponibles, nous utilisons la commande git tag¬†:</p>
</div>
<div class="listingblock data-line-63">
<div class="content">
<pre>$ git tag
v0.1.5
v0.1.6test1
v0.10.0
...
v0.11.2
v0.11.2rc1
v0.12.0rc1
v0.12.0rc2
...</pre>
</div>
</div>
<div class="paragraph data-line-76">
<p>La liste des balises montre toutes les versions publi√©es de bitcoin. Par convention, les <em>release candidates</em> (ou <em>versions d&#8217;√©valuations</em>), qui sont destin√©es aux tests, ont le suffixe "rc". Les versions stables pouvant √™tre ex√©cut√©es sur des syst√®mes de production n&#8217;ont pas de suffixe. Dans la liste pr√©c√©dente, s√©lectionnez la version la plus √©lev√©e, qui au moment de la r√©daction √©tait v0.15.0. Pour synchroniser le code local avec cette version, utilisez la commande git checkout¬†:</p>
</div>
<div class="listingblock data-line-78">
<div class="content">
<pre>$ git checkout v0.15.0
HEAD is now at 3751912... Merge #11295: doc: Old fee_estimates.dat are discarded by 0.15.0</pre>
</div>
</div>
<div class="paragraph data-line-83">
<p>Vous pouvez confirmer que vous avez la version souhait√©e "extraite" en lan√ßant la commande git status¬†:</p>
</div>
<div class="listingblock data-line-85">
<div class="content">
<pre>$ git status
HEAD detached at v0.15.0
nothing to commit, working directory clean</pre>
</div>
</div>
</div>
<div class="sect3 data-line-91">
<h4 id="_configuration_de_la_construction_de_bitcoin_core">Configuration de la construction de Bitcoin Core</h4>
<div class="paragraph data-line-93">
<p>Le code source inclut la documentation, qui peut √™tre trouv√©e dans un certain nombre de fichiers. Passez en revue la documentation principale situ√©e dans <em>README.md</em> dans le r√©pertoire <em>bitcoin</em> en tapant <code><strong>more README.md</strong></code> √† l&#8217;invite et en utilisant la barre d&#8217;espace pour passer √† la page suivante. Dans ce chapitre, nous allons construire le client Bitcoin en ligne de commande, √©galement connu sous le nom de <code>bitcoind</code> sous Linux. Passez en revue les instructions pour compiler le client de ligne de commande <code>bitcoind</code> sur votre plate-forme en tapant <code><strong>more doc/build-unix.md</strong></code>. Des instructions alternatives pour macOS et Windows peuvent √™tre trouv√©es dans le r√©pertoire <em>doc</em>, comme <em>build-osx.md</em> ou <em>build-windows.md</em>, respectivement.</p>
</div>
<div class="paragraph data-line-95">
<p>Examinez attentivement les pr√©requis de construction, qui se trouvent dans la premi√®re partie de la documentation de construction. Ce sont des biblioth√®ques qui doivent √™tre pr√©sentes sur votre syst√®me avant de pouvoir commencer √† compiler Bitcoin. Si ces conditions pr√©alables sont manquantes, le processus de g√©n√©ration √©chouera avec une erreur. Si cela se produit parce que vous avez manqu√© une condition pr√©alable, vous pouvez l&#8217;installer, puis reprendre le processus de g√©n√©ration l√† o√π vous l&#8217;avez laiss√©. En supposant que les pr√©requis sont install√©s, vous d√©marrez le processus de g√©n√©ration en g√©n√©rant un ensemble de scripts de g√©n√©ration √† l&#8217;aide du script <em>autogen.sh</em>.</p>
</div>
<div class="listingblock data-line-97">
<div class="content">
<pre>$ ./autogen.sh
...
glibtoolize: copying file 'build-aux/m4/libtool.m4'
glibtoolize: copying file 'build-aux/m4/ltoptions.m4'
glibtoolize: copying file 'build-aux/m4/ltsugar.m4'
glibtoolize: copying file 'build-aux/m4/ltversion.m4'
...
configure.ac:10: installing 'build-aux/compile'
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:9: installing 'build-aux/install-sh'
configure.ac:9: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
...</pre>
</div>
</div>
<div class="paragraph data-line-114">
<p>Le script <em>autogen.sh</em> cr√©e un ensemble de scripts de configuration automatique qui interrogeront votre syst√®me pour d√©couvrir les param√®tres corrects et s&#8217;assurer que vous disposez de toutes les biblioth√®ques n√©cessaires pour compiler le code. Le plus important d&#8217;entre eux est le script <code>configure</code> qui offre un certain nombre d&#8217;options diff√©rentes pour personnaliser le processus de construction. Tapez <code><strong>./configure --help</strong></code> pour voir les diff√©rentes options:</p>
</div>
<div class="listingblock data-line-116">
<div class="content">
<pre>$ ./configure --help
`configure' configures Bitcoin Core 0.15.0 to adapt to many kinds of systems.

Usage: ./configure [OPTION]... [VAR=VALUE]...

...
Optional Features:
  --disable-option-checking  ignore unrecognized --enable/--with options
  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]

  --enable-wallet         enable wallet (default is yes)

  --with-gui[=no|qt4|qt5|auto]
...</pre>
</div>
</div>
<div class="paragraph data-line-134">
<p>Le script <code>configure</code> vous permet d&#8217;activer ou de d√©sactiver certaines fonctionnalit√©s de <code>bitcoind</code> gr√¢ce √† l&#8217;utilisation des drapeaux <code>--enable-FEATURE</code> et --disable-FEATURE, o√π <span class="keep-together"><code>FEATURE</code></span> est remplac√© par le nom de la fonctionnalit√©, comme indiqu√© dans la sortie d&#8217;aide. Dans ce chapitre, nous allons construire le client <code>bitcoind</code> avec toutes les fonctionnalit√©s par d√©faut. Nous n&#8217;utiliserons pas les indicateurs de configuration, mais vous devriez les consulter pour comprendre quelles fonctionnalit√©s facultatives font partie du client. Si vous √™tes dans un environnement universitaire, les restrictions du laboratoire informatique peuvent vous obliger √† installer des applications dans votre r√©pertoire personnel (par exemple, en utilisant --prefix=$HOME).</p>
</div>
<div class="paragraph data-line-136">
<p>Voici quelques options utiles qui remplacent le comportement par d√©faut du script configure:</p>
</div>
<dl>
<dt><code>--prefix=$HOME</code></dt>
<dd><p>Cela remplace l'emplacement d'installation par d√©faut (qui est <em>/usr/local/</em> ) pour l'ex√©cutable r√©sultant. Utilisez <code>$HOME</code> pour tout mettre dans votre r√©pertoire personnel, ou un chemin diff√©rent.</p></dd>

<dt><code>--disable-wallet</code></dt>
<dd><p>Ceci est utilis√© pour d√©sactiver l'impl√©mentation du portefeuille de r√©f√©rence.</p></dd>

<dt><code>--with-incompatible-bdb</code></dt>
<dd><p>Si vous construisez un portefeuille, autorisez l'utilisation d'une version incompatible de la biblioth√®que Berkeley DB.</p></dd>

<dt><code>--with-gui=no</code></dt>
<dd><p>Ne construisez pas l'interface utilisateur graphique, qui n√©cessite la biblioth√®que Qt. Cela construit uniquement le bitcoin du serveur et de la ligne de commande.</p></dd>
</dl>
<div class="paragraph data-line-154">
<p>Ensuite, ex√©cutez le script <code>configure</code> pour d√©couvrir automatiquement toutes les biblioth√®ques n√©cessaires et cr√©er un script de construction personnalis√© pour votre syst√®me¬†:</p>
</div>
<div class="listingblock data-line-156">
<div class="content">
<pre>$ ./configure
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
...
[de nombreuses pages de tests de configuration suivent]
...
$</pre>
</div>
</div>
<div class="paragraph data-line-172">
<p>Si tout s&#8217;est bien pass√©, la commande <code>configure</code> se terminera par la cr√©ation des scripts de construction personnalis√©s qui nous permettront de compiler bitcoind. S&#8217;il y a des biblioth√®ques manquantes ou des erreurs, la commande <code>configure</code> se terminera par une erreur au lieu de cr√©er les scripts de construction. Si une erreur se produit, elle est probablement due √† une biblioth√®que manquante ou incompatible. Relisez √† nouveau la documentation de build et assurez-vous d&#8217;installer les pr√©requis manquants. Ensuite, ex√©cutez √† nouveau <code>configure</code> et voyez si cela corrige l&#8217;erreur.</p>
</div>
</div>
<div class="sect3 data-line-174">
<h4 id="_construire_les_ex√©cutables_bitcoin_core">Construire les ex√©cutables Bitcoin Core</h4>
<div class="paragraph data-line-176">
<p> Ensuite, vous allez compiler le code source, un processus qui peut prendre jusqu&#8217;√† une heure, en fonction de la vitesse de votre processeur et de la m√©moire disponible. Pendant le processus de compilation, vous devriez voir une sortie toutes les quelques secondes ou toutes les quelques minutes, ou une erreur si quelque chose ne va pas. Si une erreur se produit ou si le processus de compilation est interrompu, il peut √™tre repris √† tout moment en tapant √† nouveau make. Tapez <code><strong>make</strong></code> pour lancer la compilation de l&#8217;application ex√©cutable¬†:</p>
</div>
<div class="listingblock data-line-178">
<div class="content">
<pre>$ make
Making all in src
  CXX      crypto/libbitcoinconsensus_la-hmac_sha512.lo
  CXX      crypto/libbitcoinconsensus_la-ripemd160.lo
  CXX      crypto/libbitcoinconsensus_la-sha1.lo
  CXX      crypto/libbitcoinconsensus_la-sha256.lo
  CXX      crypto/libbitcoinconsensus_la-sha512.lo
  CXX      libbitcoinconsensus_la-hash.lo
  CXX      primitives/libbitcoinconsensus_la-transaction.lo
  CXX      libbitcoinconsensus_la-pubkey.lo
  CXX      script/libbitcoinconsensus_la-bitcoinconsensus.lo
  CXX      script/libbitcoinconsensus_la-interpreter.lo

[... de nombreux autres messages de compilation suivent ...]

$</pre>
</div>
</div>
<div class="paragraph data-line-197">
<p>Sur un syst√®me rapide avec plusieurs processeurs, vous souhaiterez peut-√™tre d√©finir le nombre de t√¢ches de compilation parall√®les. Par exemple, <code>make -j 2</code> utilisera deux c≈ìurs s&#8217;ils sont disponibles. Si tout se passe bien, Bitcoin Core est maintenant compil√©. Vous devez ex√©cuter la suite de tests unitaires avec <code>make check</code> pour vous assurer que les biblioth√®ques li√©es ne sont pas cass√©es de mani√®re √©vidente. La derni√®re √©tape consiste √† installer les diff√©rents ex√©cutables sur votre syst√®me √† l&#8217;aide de la commande make install. Vous serez peut-√™tre invit√© √† saisir votre mot de passe utilisateur, car cette √©tape n√©cessite des privil√®ges d&#8217;administrateur:</p>
</div>
<div class="listingblock data-line-199">
<div class="content">
<pre>$ make check &amp;&amp; sudo make install
Password:
Making install in src
 ../build-aux/install-sh -c -d '/usr/local/lib'
libtool: install: /usr/bin/install -c bitcoind /usr/local/bin/bitcoind
libtool: install: /usr/bin/install -c bitcoin-cli /usr/local/bin/bitcoin-cli
libtool: install: /usr/bin/install -c bitcoin-tx /usr/local/bin/bitcoin-tx
...
$</pre>
</div>
</div>
<div class="paragraph data-line-211">
<p>L&#8217;installation par d√©faut de <code>bitcoind</code> le place dans <em>/usr/local/bin</em>. Vous pouvez confirmer que Bitcoin Core est correctement install√© en demandant au syst√®me le chemin des ex√©cutables, comme suit:</p>
</div>
<div class="listingblock data-line-213">
<div class="content">
<pre>$ which bitcoind
/usr/local/bin/bitcoind

$ which bitcoin-cli
/usr/local/bin/bitcoin-cli</pre>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-221">
<h3 id="_ex√©cution_dun_n≈ìud_bitcoin_core">Ex√©cution d&#8217;un n≈ìud Bitcoin Core</h3>
<div class="paragraph data-line-223">
<p>Le r√©seau pair √† pair de Bitcoin est compos√© de "n≈ìuds" de r√©seau, g√©r√©s principalement par des b√©n√©voles et certaines des entreprises qui cr√©ent des applications bitcoin. Ceux qui ex√©cutent des n≈ìuds Bitcoin ont une vue directe et faisant autorit√© sur la cha√Æne de blocs Bitcoin, avec une copie locale de toutes les transactions, valid√©es ind√©pendamment par leur propre syst√®me. En ex√©cutant un n≈ìud, vous n&#8217;avez pas besoin de faire appel √† un tiers pour valider une transaction. De plus, en ex√©cutant un n≈ìud Bitcoin, vous contribuez au r√©seau Bitcoin en le rendant plus robuste et s√©curitaire.</p>
</div>
<div class="paragraph data-line-225">
<p>Cependant, l&#8217;ex√©cution d&#8217;un n≈ìud n√©cessite un syst√®me connect√© en permanence avec suffisamment de ressources pour traiter toutes les transactions bitcoin. Selon que vous choisissez d&#8217;indexer toutes les transactions et de conserver une copie compl√®te de la cha√Æne de blocs, vous pouvez √©galement avoir besoin de beaucoup d&#8217;espace disque et de m√©moire RAM. Au d√©but de 2021, un n≈ìud √† index complet a besoin de 2 Go de RAM et d&#8217;un minimum de 360 Go d&#8217;espace disque (voir <a href="https://www.blockchain.com/charts/blocks-size" class="undefined" data-href="https://www.blockchain.com/charts/blocks-size">https://www.blockchain.com/charts/blocks-size</a>). Les n≈ìuds Bitcoin transmettent et re√ßoivent √©galement des transactions et des blocs Bitcoin, consommant de la bande passante Internet. Si votre connexion Internet est limit√©e, a un faible plafond de donn√©es ou est mesur√©e (factur√©e au gigabit), vous ne devriez probablement pas ex√©cuter un n≈ìud Bitcoin, ou l&#8217;ex√©cuter d&#8217;une mani√®re qui limite sa bande passante (voir <a href="#constrained_resources">Exemple de configuration d&#8217;un syst√®me √† ressources limit√©es</a>).</p>
</div>
<div class="admonitionblock tip data-line-228">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-229">
<p>Bitcoin Core conserve une copie compl√®te de la cha√Æne de blocs par d√©faut, avec chaque transaction qui s&#8217;est d√©j√† produite sur le Bitcoin r√©seau depuis sa cr√©ation en 2009. Cet ensemble de donn√©es a une taille de dizaines de gigaoctets et est t√©l√©charg√© de mani√®re incr√©mentielle sur plusieurs jours ou semaines, en fonction de la vitesse de votre CPU et de votre connexion Internet. Bitcoin Core ne pourra pas traiter les transactions ou mettre √† jour les soldes des comptes tant que l&#8217;ensemble de donn√©es complet de la cha√Æne de blocs n&#8217;aura pas √©t√© t√©l√©charg√©. Assurez-vous que vous disposez de suffisamment d&#8217;espace disque, de bande passante et de temps pour effectuer la synchronisation initiale. Vous pouvez configurer Bitcoin Core pour r√©duire la taille de la cha√Æne de blocs en supprimant les anciens blocs (voir <a href="#constrained_resources">Exemple de configuration d&#8217;un syst√®me √† ressources limit√©es</a>), mais il t√©l√©chargera tout de m√™me l&#8217;int√©gralit√© de l&#8217;ensemble de donn√©es avant de les supprimer.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-232">
<p>Malgr√© ces besoins en ressources, des milliers de b√©n√©voles g√®rent des n≈ìuds Bitcoin. Certains fonctionnent sur des syst√®mes aussi simples qu&#8217;un Raspberry Pi (un ordinateur √† 35¬†$ US de la taille d&#8217;un paquet de cartes). De nombreux volontaires ex√©cutent √©galement des n≈ìuds Bitcoin sur des serveurs lou√©s, g√©n√©ralement une variante de Linux. Une instance de <em>Virtual Private Server</em> (VPS ou serveur virtuel priv√©) ou <em>Cloud Computing Server</em> (ou serveur en infonuagique) peut √™tre utilis√©e pour ex√©cuter un n≈ìud Bitcoin. Ces serveurs peuvent √™tre lou√©s pour 25¬†$ √† 50¬†$ US par mois aupr√®s de divers fournisseurs.</p>
</div>
<div class="paragraph data-line-234">
<p>Pourquoi voudriez-vous ex√©cuter un n≈ìud¬†? Voici quelques-unes des raisons les plus courantes¬†:</p>
</div>
<div class="ulist data-line-236">
<ul>
<li class="data-line-236">
<p>Si vous d√©veloppez un logiciel bitcoin et que vous devez vous fier √† un n≈ìud Bitcoin pour un acc√®s programmable (API) au r√©seau et √† la cha√Æne de blocs.</p>
</li>
<li class="data-line-238">
<p>Si vous cr√©ez des applications qui doivent valider les transactions selon les r√®gles de consensus de bitcoin. En r√®gle g√©n√©rale, les √©diteurs de logiciels Bitcoin ex√©cutent plusieurs n≈ìuds.</p>
</li>
<li class="data-line-240">
<p>Si vous souhaitez prendre en charge le bitcoin. L&#8217;ex√©cution d&#8217;un n≈ìud rend le r√©seau plus robuste et capable de servir plus de portefeuilles, plus d&#8217;utilisateurs et plus de transactions.</p>
</li>
<li class="data-line-242">
<p>Si vous ne souhaitez pas vous fier √† un tiers pour traiter ou valider vos transactions.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-244">
<p>Si vous lisez ce livre et √™tes int√©ress√© par le d√©veloppement d&#8217;un logiciel Bitcoin, vous devriez ex√©cuter votre propre n≈ìud.</p>
</div>
<div class="sect3 data-line-246">
<h4 id="_configuration_du_n≈ìud_bitcoin_core">Configuration du n≈ìud Bitcoin Core</h4>
<div class="paragraph data-line-248">
<p>( "s√©curit√©", "mots de passe")Bitcoin Core recherchera un fichier de configuration dans son r√©pertoire de donn√©es √† chaque d√©marrage. Dans cette section, nous examinerons les diff√©rentes options de configuration et cr√©erons un fichier de configuration. Pour localiser le fichier de configuration, ex√©cutez <code>bitcoind -printtoconsole</code> dans votre terminal et recherchez les deux premi√®res lignes.</p>
</div>
<div class="listingblock data-line-250">
<div class="content">
<pre>$ bitcoind -printtoconsole
Bitcoin version v0.15.0
Using the 'standard' SHA256 implementation
Using data directory /home/ubuntu/.bitcoin/
Using config file /home/ubuntu/.bitcoin/bitcoin.conf
...
[beaucoup plus de sortie de d√©bogage]
...</pre>
</div>
</div>
<div class="paragraph data-line-261">
<p>Vous pouvez appuyer sur Ctrl-C pour fermer le n≈ìud une fois que vous avez d√©termin√© l&#8217;emplacement du fichier de configuration. Habituellement, le fichier de configuration se trouve dans le r√©pertoire de donn√©es <em>.bitcoin</em> sous le r√©pertoire personnel de votre utilisateur. Il n&#8217;est pas cr√©√© automatiquement, mais vous pouvez cr√©er un fichier de configuration de d√©marrage en copiant et collant √† partir de l&#8217;exemple <a href="#full_index_node">Exemple de configuration d&#8217;un n≈ìud √† index complet</a> ci-dessous. Vous pouvez cr√©er ou modifier le fichier de configuration dans votre √©diteur pr√©f√©r√©.</p>
</div>
<div class="paragraph data-line-263">
<p>Bitcoin Core propose plus de 100 options de configuration qui modifient le comportement du n≈ìud de r√©seau, le stockage de la cha√Æne de blocs et de nombreux autres aspects de son fonctionnement. Pour voir une liste de ces options, ex√©cutez bitcoind --help¬†:</p>
</div>
<div class="listingblock data-line-265">
<div class="content">
<pre>$ bitcoind --help
Bitcoin Core Daemon version v0.15.0

Usage:
  bitcoind [options]                     Start Bitcoin Core Daemon

Options:

  -?
       Print this help message and exit

  -version
       Print version and exit

  -alertnotify=&lt;cmd&gt;
       Execute command when a relevant alert is received or we see a really
       long fork (%s in cmd is replaced by message)
...
[beaucoup plus d'options]
...

  -rpcthreads=&lt;n&gt;
       Set the number of threads to service RPC calls (default: 4)</pre>
</div>
</div>
<div class="paragraph data-line-291">
<p>Voici quelques-unes des options les plus importantes que vous pouvez d√©finir dans le fichier de configuration, ou en tant que param√®tres de ligne de commande pour bitcoind¬†:</p>
</div>
<div class="dlist data-line-293">
<dl>
<dt class="hdlist1">alertnotify</dt>
<dd>
<p>Ex√©cute une commande ou un script sp√©cifi√© pour envoyer des alertes d&#8217;urgence au propri√©taire de ce n≈ìud, g√©n√©ralement par courriel.</p>
</dd>
<dt class="hdlist1">conf</dt>
<dd>
<p>Un emplacement alternatif pour le fichier de configuration. Cela n&#8217;a de sens qu&#8217;en tant que param√®tre de ligne de commande pour bitcoind, car il ne peut pas se trouver dans le fichier de configuration auquel il se r√©f√®re.</p>
</dd>
<dt class="hdlist1">datadir</dt>
<dd>
<p>S√©lectionnez le r√©pertoire et le syst√®me de fichiers dans lesquels vous placer toutes les donn√©es de la cha√Æne de blocs. Par d√©faut, il s&#8217;agit d&#8217;un sous-r√©pertoire de <em>.bitcoin</em> de votre r√©pertoire personnel. Assurez-vous que ce syst√®me de fichiers dispose de plusieurs gigaoctets d&#8217;espace libre.</p>
</dd>
<dt class="hdlist1">prune</dt>
<dd>
<p>R√©duisez les besoins en espace disque √† ce nombre de m√©gaoctets, en supprimant les anciens blocs. Utilisez ceci sur un n≈ìud √† ressources limit√©es qui ne peut pas contenir la cha√Æne de blocs compl√®te.</p>
</dd>
<dt class="hdlist1">txindex</dt>
<dd>
<p>Maintient un index de toutes les transactions. Cela signifie une copie compl√®te de la cha√Æne de blocs. Cela vous permet de r√©cup√©rer par programmation toute transaction par identifiant (ID).</p>
</dd>
<dt class="hdlist1">dbcache</dt>
<dd>
<p>La taille du cache UTXO. La valeur par d√©faut est 450 Mio. Augmentez cette valeur sur le mat√©riel haut de gamme et r√©duisez la taille sur le mat√©riel bas de gamme pour √©conomiser de la m√©moire au d√©triment des entr√©es-sorties des disques lents.</p>
</dd>
<dt class="hdlist1">maxconnections</dt>
<dd>
<p>D√©finissez le nombre maximal de n≈ìuds √† partir desquels accepter les connexions. Le r√©duire par d√©faut r√©duira votre consommation de bande passante. √Ä utiliser si vous avez un plafond de donn√©es ou si vous payez au gigaoctet.</p>
</dd>
<dt class="hdlist1">maxmempool</dt>
<dd>
<p>Limite le bassin de m√©moire de transaction √† ce nombre de m√©gaoctets. Utilisez-le pour r√©duire l&#8217;utilisation de la m√©moire sur les n≈ìuds √† m√©moire limit√©e.</p>
</dd>
<dt class="hdlist1">maxreceivebuffer/maxsendbuffer</dt>
<dd>
<p>Limite la m√©moire tampon par connexion √† ce nombre de multiples de 1000 octets. √Ä utiliser sur les n≈ìuds √† m√©moire limit√©e.</p>
</dd>
<dt class="hdlist1">minrelaytxfee</dt>
<dd>
<p>D√©finissez le taux de frais minimum pour la transaction que vous relayerez. En dessous de cette valeur, la transaction est trait√©e non standard, rejet√©e du bassin de transactions et non relay√©e.</p>
</dd>
</dl>
</div>
<div id="txindex" class="sidebarblock data-line-316">
<div class="content">
<div class="title">Index de la base de donn√©es des transactions et option txindex</div>
<div class="paragraph data-line-317">
<p>Par d√©faut, Bitcoin Core construit une base de donn√©es contenant <em>uniquement</em> les transactions li√©es au portefeuille de l&#8217;utilisateur. Si vous voulez pouvoir acc√©der √† <em>n&#8217;importe quelle</em> transaction avec des commandes comme <code>getrawtransaction</code> (voir <a href="#exploring_and_decoding_transanctions">Explorer et d√©coder les transactions</a>), vous devez configurer Bitcoin Core pour cr√©er un index de transaction complet, ce qui peut √™tre r√©alis√© avec l&#8217;option txindex. D√©finissez <code>txindex=1</code> dans le fichier de configuration de Bitcoin Core. Si vous ne d√©finissez pas cette option au d√©but et que vous la r√©glez ensuite sur l&#8217;indexation compl√®te, vous devez red√©marrer <code>bitcoind</code> avec l&#8217;option <code>-reindex</code> et attendre qu&#8217;elle reconstruise l&#8217;index.</p>
</div>
</div>
</div>
<div class="paragraph data-line-320">
<p><a href="#full_index_node">Exemple de configuration d&#8217;un n≈ìud √† index complet</a> montre comment vous pouvez combiner les options pr√©c√©dentes, avec un n≈ìud enti√®rement index√©, fonctionnant comme un backend API pour une application bitcoin.</p>
</div>
<div id="full_index_node" class="exampleblock data-line-324">
<div class="title">Example 3. Exemple de configuration d&#8217;un n≈ìud √† index complet</div>
<div class="content">
<div class="listingblock data-line-325">
<div class="content">
<pre>alertnotify=myemailscript.sh "Alerte¬†: %s"
datadir=/lotsofspace/bitcoin
index_tx=1</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-332">
<p><a href="#constrained_resources">Exemple de configuration d&#8217;un syst√®me √† ressources limit√©es</a> montre un n≈ìud √† ressources limit√©es s&#8217;ex√©cutant sur un serveur plus petit.</p>
</div>
<div id="constrained_resources" class="exampleblock data-line-336">
<div class="title">Example 4. Exemple de configuration d&#8217;un syst√®me √† ressources limit√©es</div>
<div class="content">
<div class="listingblock data-line-337">
<div class="content">
<pre>alertnotify=myemailscript.sh "Alerte¬†: %s"
maxconnexions=15
prune=5000
dbcache=150
maxmempool=150
maxreceivebuffer=2500
maxsendbuffer=500</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-348">
<p>Une fois que vous avez modifi√© le fichier de configuration et d√©fini les options qui repr√©sentent le mieux vos besoins, vous pouvez tester <code>bitcoind</code> avec cette configuration. Ex√©cutez Bitcoin Core avec l&#8217;option <code>printtoconsole</code> pour s&#8217;ex√©cuter au premier plan avec une sortie vers la console¬†:</p>
</div>
<div class="listingblock data-line-350">
<div class="content">
<pre>$ bitcoind -printtoconsole

Bitcoin version v0.15.0
InitParameterInteraction: parameter interaction: -whitelistforcerelay=1 -&gt; setting -whitelistrelay=1
Assuming ancestors of block 0000000000000000003b9ce759c2a087d52abc4266f8f4ebd6d768b89defa50a have valid signatures.
Using the 'standard' SHA256 implementation
Default data directory /home/ubuntu/.bitcoin
Using data directory /lotsofspace/.bitcoin
Using config file /home/ubuntu/.bitcoin/bitcoin.conf
Using at most 125 automatic connections (1048576 file descriptors available)
Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements
Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements
Using 2 threads for script verification
HTTP: creating work queue of depth 16
No rpcpassword set - using random cookie authentication
Generated RPC authentication cookie /lotsofspace/.bitcoin/.cookie
HTTP: starting 4 worker threads
init message: Verifying wallet(s)...
Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)
Using wallet wallet.dat
CDBEnv::Open: LogDir=/lotsofspace/.bitcoin/database ErrorFile=/lotsofspace/.bitcoin/db.log
scheduler thread start
Cache configuration:
* Using 250.0MiB for block index database
* Using 8.0MiB for chain state database
* Using 1742.0MiB for in-memory UTXO set (plus up to 286.1MiB of unused mempool space)
init message: Loading block index...
Opening LevelDB in /lotsofspace/.bitcoin/blocks/index
Opened LevelDB successfully

[... plus de messages de d√©marrage ...]</pre>
</div>
</div>
<div class="paragraph data-line-384">
<p>Vous pouvez appuyer sur Ctrl-C pour interrompre le processus une fois que vous √™tes convaincu qu&#8217;il charge les param√®tres correctement et s&#8217;ex√©cute comme pr√©vu.</p>
</div>
<div class="paragraph data-line-386">
<p>Pour ex√©cuter Bitcoin Core en arri√®re-plan en tant que processus, d√©marrez-le avec l&#8217;option daemon, en tant que bitcoind -daemon.</p>
</div>
<div class="paragraph data-line-388">
<p>Pour surveiller la progression et l&#8217;√©tat d&#8217;ex√©cution de votre n≈ìud Bitcoin, utilisez la commande bitcoin-cli getblockchaininfo¬†:</p>
</div>
<div class="listingblock data-line-390">
<div class="content">
<pre>$ bitcoin-cli getblockchaininfo</pre>
</div>
</div>
<div class="listingblock data-line-395">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "chain": "main",
  "blocks": 0,
  "headers": 83999,
  "bestblockhash": "000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f",
  "difficulty": 1,
  "mediantime": 1231006505,
  "verificationprogress": 3.783041623201835e-09,
  "chainwork": "0000000000000000000000000000000000000000000000000000000100010001",
  "pruned": false,
  [...]
}</code></pre>
</div>
</div>
<div class="paragraph data-line-410">
<p>Cela montre un n≈ìud avec une hauteur de cha√Æne de blocs de 0 blocs et 83999 en-t√™tes. Le n≈ìud r√©cup√®re actuellement les en-t√™tes de bloc de la meilleure cha√Æne et continue ensuite √† t√©l√©charger les blocs complets.</p>
</div>
<div class="paragraph data-line-412">
<p>Une fois que vous √™tes satisfait des options de configuration que vous avez s√©lectionn√©es, vous devez ajouter <em>bitcoin</em> aux scripts de d√©marrage de votre syst√®me d&#8217;exploitation, afin qu&#8217;il s&#8217;ex√©cute en continu et au red√©marrage du syst√®me d&#8217;exploitation. Vous trouverez un certain nombre d&#8217;exemples de scripts de d√©marrage pour diff√©rents syst√®mes d&#8217;exploitation dans le r√©pertoire source de bitcoin sous <em>contrib/init</em> et un fichier <em>README.md</em> indiquant quel syst√®me utilise quel script.("", startref="BNcore03")</p>
</div>
</div>
</div>
<div class="sect2 data-line-414">
<h3 id="_interface_de_programmation_dapplication_api_de_base_bitcoin">Interface de programmation d&#8217;application (API) de base Bitcoin</h3>
<div class="paragraph data-line-416">
<p>Le client Bitcoin Core impl√©mente une interface JSON-RPC accessible √©galement √† l&#8217;aide de l&#8217;assistant de ligne de commande bitcoin-cli. La ligne de commande nous permet d&#8217;exp√©rimenter de mani√®re interactive les fonctionnalit√©s qui sont √©galement disponibles par programmation via l&#8217;API. Pour commencer, appelez la commande <code>help</code> pour voir une liste des commandes RPC bitcoin disponibles¬†:</p>
</div>
<div id="bitcoind_commands" class="listingblock data-line-420">
<div class="content">
<pre>$ bitcoin-cli help
addmultisigaddress nrequired ["key",...] ( "account" )
addnode "node" "add|remove|onetry"
backupwallet "destination"
createmultisig nrequired ["key",...]
createrawtransaction [{"txid":"id","vout":n},...] {"address":amount,...}
decoderawtransaction "hexstring"
...
...
verifymessage "bitcoinaddress" "signature" "message"
walletlock
walletpassphrase "passphrase" timeout
walletpassphrasechange "oldpassphrase" "newpassphrase"</pre>
</div>
</div>
<div class="paragraph data-line-436">
<p>Chacune de ces commandes peut prendre un certain nombre de param√®tres. Pour obtenir une aide suppl√©mentaire, une description d√©taill√©e et des informations sur les param√®tres, ajoutez le nom de la commande apr√®s help. Par exemple, pour voir l&#8217;aide sur la commande <code>getblockhash</code> RPC¬†:</p>
</div>
<div class="listingblock data-line-438">
<div class="content">
<pre>$ bitcoin-cli help getblockhash
getblockhash height

Returns hash of block in best-block-chain at height provided.

Arguments:
1. height         (numeric, required) The height index

Result:
"hash"         (string) The block hash

Examples:
&gt; bitcoin-cli getblockhash 1000
&gt; curl --user myusername --data-binary '{"jsonrpc": "1.0", "id":"curltest", "method": "getblockhash", "params": [1000] }' -H 'content-type: text/plain;' http://127.0.0.1:8332/</pre>
</div>
</div>
<div class="paragraph data-line-455">
<p>√Ä la fin des informations d&#8217;aide, vous verrez deux exemples de la commande RPC, utilisant l&#8217;assistant <code>bitcoin-cli</code> ou le client HTTP curl. Ces exemples montrent comment vous pouvez appeler la commande. Copiez le premier exemple et voyez le r√©sultat¬†:</p>
</div>
<div class="listingblock data-line-457">
<div class="content">
<pre>$ bitcoin-cli getblockhash 1000
00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09</pre>
</div>
</div>
<div class="paragraph data-line-462">
<p>Le r√©sultat est un hachage de bloc, qui est d√©crit plus en d√©tail dans les chapitres suivants. Mais pour l&#8217;instant, cette commande devrait renvoyer le m√™me r√©sultat sur votre syst√®me, d√©montrant que votre n≈ìud Bitcoin Core est en cours d&#8217;ex√©cution, accepte les commandes et dispose d&#8217;informations sur le bloc 1000 √† vous renvoyer.</p>
</div>
<div class="paragraph data-line-464">
<p>Dans les sections suivantes, nous allons d√©montrer quelques commandes RPC tr√®s utiles et leur sortie attendue.</p>
</div>
<div class="sect3 data-line-466">
<h4 id="_obtenir_des_informations_sur_l√©tat_du_client_bitcoin_core">Obtenir des informations sur l&#8217;√©tat du client Bitcoin Core</h4>
<div class="paragraph data-line-468">
<p>Bitcoin Core fournit des rapports d&#8217;√©tat sur diff√©rents modules via l&#8217;interface JSON-RPC. Les commandes les plus importantes incluent getblockchaininfo, getmempoolinfo, <code>getnetworkinfo</code> et getwalletinfo.</p>
</div>
<div class="paragraph data-line-470">
<p>La commande <code>getblockchaininfo</code> RPC de Bitcoin a √©t√© introduite plus t√¥t. La commande <code>getnetworkinfo</code> affiche des informations de base sur l&#8217;√©tat du n≈ìud de r√©seau Bitcoin. Utilisez <code>bitcoin-cli</code> pour l&#8217;ex√©cuter¬†:</p>
</div>
<div class="listingblock data-line-472">
<div class="content">
<pre>$ bitcoin-cli getnetworkinfo</pre>
</div>
</div>
<div class="listingblock data-line-476">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  "version": 150000,
  "subversion": "/Satoshi:0.15.0/",
  "protocolversion": 70015,
  "localservices": "000000000000000d",
  "localrelay": true,
  "timeoffset": 0,
  "networkactive": true,
  "connections": 8,
  "networks": [
    ...
    des informations d√©taill√©es sur tous les r√©seaux (ipv4, ipv6 ou onion)
    ...
  ],
  "relayfee": 0.00001000,
  "incrementalfee": 0.00001000,
  "localaddresses": [
  ],
  "warnings": ""
}</code></pre>
</div>
</div>
<div class="paragraph data-line-499">
<p>Les donn√©es sont renvoy√©es en JavaScript Object Notation (JSON), un format qui peut facilement √™tre "consomm√©" par tous les langages de programmation mais qui est √©galement assez lisible par l&#8217;homme. Parmi ces donn√©es, nous voyons les num√©ros de version du client logiciel bitcoin (150000) et du protocole Bitcoin (70015). On y voit le nombre actuel de connexions (8) et diverses informations sur le r√©seau Bitcoin et les param√®tres li√©s √† ce client.</p>
</div>
<div class="admonitionblock tip data-line-502">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-503">
<p>Il faudra un certain temps, peut-√™tre plus d&#8217;une journ√©e, pour que le client <code>bitcoind</code> "rattrape" la hauteur actuelle de la cha√Æne de blocs lorsqu&#8217;il t√©l√©charge des blocs d&#8217;autres clients Bitcoin. Vous pouvez v√©rifier sa progression en utilisant <code>getblockchaininfo</code> pour voir le nombre de blocs connus.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-507">
<h4 id="exploring_and_decoding_transanctions">Explorer et d√©coder les transactions</h4>
<div class="paragraph data-line-509">
<p>Commandes¬†: getrawtransaction, decoderawtransaction</p>
</div>
<div class="paragraph data-line-513">
<p>Dans <a href="#cup_of_coffee">Acheter une tasse de caf√©</a>, Alice a achet√© une tasse de caf√© au Bob&#8217;s Cafe. Sa transaction a √©t√© enregistr√©e sur la cha√Æne de blocs avec l&#8217;identifiant de transaction (txid) 0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2. Utilisons l&#8217;API pour r√©cup√©rer et examiner cette transaction en transmettant l&#8217;identifiant de transaction en tant que param√®tre¬†:</p>
</div>
<div class="listingblock data-line-515">
<div class="content">
<pre>$ bitcoin-cli getrawtransaction 0627052b6f28912f2703066a912ea577f2ce4da4caa5a&amp;#x21b5;
5fbd8a57286c345c2f2

0100000001186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd734d2804fe65fa35779000&amp;#x21b5;
000008b483045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4&amp;#x21b5;
ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813014&amp;#x21b5;
10484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc54123363767&amp;#x21b5;
89d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adfffffffff0260e3160000000&amp;#x21b5;
0001976a914ab68025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef8000000000001976a9&amp;#x21b5;
147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac00000000</pre>
</div>
</div>
<div class="admonitionblock tip data-line-529">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-530">
<p>Un identifiant de transaction ne fait pas autorit√© tant qu&#8217;une transaction n&#8217;a pas √©t√© confirm√©e. L&#8217;absence d&#8217;un hachage de transaction dans la cha√Æne de blocs ne signifie pas que la transaction n&#8217;a pas √©t√© trait√©e. C&#8217;est ce qu&#8217;on appelle la "mall√©abilit√© des transactions", car les hachages de transaction peuvent √™tre modifi√©s avant la confirmation dans un bloc. Apr√®s confirmation, le <code>txid</code> est immuable et fait autorit√©.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-533">
<p>La commande <code>getrawtransaction</code> renvoie une transaction s√©rialis√©e en notation hexad√©cimale. Pour d√©coder cela, nous utilisons la commande decoderawtransaction, en passant les donn√©es hexad√©cimales en param√®tre. Vous pouvez copier l&#8217;hex renvoy√© par <code>getrawtransaction</code> et le coller en tant que param√®tre dans decoderawtransaction¬†:</p>
</div>
<div class="listingblock data-line-535">
<div class="content">
<pre>$ bitcoin-cli decoderawtransaction 0100000001186f9f998a5aa6f048e51dd8419a14d8&amp;#x21b5;
a0f1a8a2836dd734d2804fe65fa35779000000008b483045022100884d142d86652a3f47ba474&amp;#x21b5;
6ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298&amp;#x21b5;
cad530a863ea8f53982c09db8f6e381301410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fd&amp;#x21b5;
e0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa&amp;#x21b5;
336a8d752adfffffffff0260e31600000000001976a914ab68025513c3dbd2f7b92a94e0581f5&amp;#x21b5;
d50f654e788acd0ef8000000000001976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8&amp;#x21b5;
88ac00000000</pre>
</div>
</div>
<div class="listingblock data-line-546">
<div class="content">
<pre>{
  "txid": "0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2",
  "size": 258,
  "version": 1,
  "locktime": 0,
  "vin": [
    {
      "txid": "7957a35fe64f80d234d76d83a2...8149a41d81de548f0a65a8a999f6f18",
      "vout": 0,
      "scriptSig": {
        "asm":"3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1decc...",
        "hex":"483045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1de..."
      },
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 0.01500000,
      "n": 0,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 ab68...5f654e7 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a914ab68025513c3dbd2f7b92a94e0581f5d50f654e788ac",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": [
          "1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA"
        ]
      }
    },
    {
      "value": 0.08450000,
      "n": 1,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 7f9b1a...025a8 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": [
          "1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK"
        ]
      }
    }
  ]
}</pre>
</div>
</div>
<div class="paragraph data-line-594">
<p>Le d√©codage de la transaction montre tous les composants de cette transaction, y compris les entr√©es et les sorties de la transaction. Dans ce cas, nous voyons que la transaction qui a cr√©dit√© notre nouvelle adresse de 15 millibits a utilis√© une entr√©e et g√©n√©r√© deux sorties. L&#8217;entr√©e de cette transaction √©tait la sortie d&#8217;une transaction pr√©c√©demment confirm√©e (indiqu√©e par <code>txid</code> commen√ßant par 7957a35fe). Les deux sorties correspondent au cr√©dit de 15 millibits et une sortie avec retour √† l&#8217;exp√©diteur.</p>
</div>
<div class="paragraph data-line-596">
<p>Nous pouvons explorer davantage la cha√Æne de blocs en examinant la transaction pr√©c√©dente r√©f√©renc√©e par son <code>txid</code> dans cette transaction en utilisant les m√™mes commandes (par exemple, getrawtransaction). En sautant d&#8217;une transaction √† l&#8217;autre, nous pouvons suivre une cha√Æne de transactions √† mesure que les pi√®ces sont transmises d&#8217;adresse de propri√©taire √† adresse de propri√©taire.</p>
</div>
</div>
<div class="sect3 data-line-600">
<h4 id="_explorer_les_blocs">Explorer les blocs</h4>
<div class="paragraph data-line-602">
<p>Commandes¬†: getblock, getblockhash</p>
</div>
<div class="paragraph data-line-604">
<p>L&#8217;exploration de blocs est similaire √† l&#8217;exploration de transactions. Cependant, les blocs peuvent √™tre r√©f√©renc√©s soit par la <em>hauteur</em> du bloc (<em>height</em>), soit par le r√©sultat de <em>hachage</em> (ou <em>hash</em>) du bloc. Tout d&#8217;abord, trouvons un bloc par sa hauteur. Dans <a href="#cup_of_coffee">Acheter une tasse de caf√©</a>, nous avons vu que la transaction d&#8217;Alice √©tait incluse dans le bloc 277316.</p>
</div>
<div class="paragraph data-line-606">
<p>Nous utilisons la commande getblockhash, qui prend la hauteur du bloc comme param√®tre et renvoie le hachage pour ce bloc¬†:</p>
</div>
<div class="listingblock data-line-608">
<div class="content">
<pre>$ bitcoin-cli getblockhash 277316
0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4</pre>
</div>
</div>
<div class="paragraph data-line-613">
<p>Maintenant que nous savons dans quel bloc la transaction d&#8217;Alice √©tait incluse, nous pouvons interroger ce bloc. Nous utilisons la commande <code>getblock</code> avec le hachage de bloc comme param√®tre¬†:</p>
</div>
<div class="listingblock data-line-615">
<div class="content">
<pre>$ bitcoin-cli getblock 0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b3&amp;#x21b5;
1b2cc7bdc4</pre>
</div>
</div>
<div class="listingblock data-line-620">
<div class="content">
<pre>{
  "hash": "0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4",
  "confirmations": 37371,
  "size": 218629,
  "height": 277316,
  "version": 2,
  "merkleroot": "c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e",
  "tx": [
    "d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f",
    "b268b45c59b39d759614757718b9918caf0ba9d97c56f3b91956ff877c503fbe",
    "04905ff987ddd4cfe603b03cfb7ca50ee81d89d1f8f5f265c38f763eea4a21fd",
    "32467aab5d04f51940075055c2f20bbd1195727c961431bf0aff8443f9710f81",
    "561c5216944e21fa29dd12aaa1a45e3397f9c0d888359cb05e1f79fe73da37bd",
[... des centaines de transactions ...]
    "78b300b2a1d2d9449b58db7bc71c3884d6e0579617e0da4991b9734cef7ab23a",
    "6c87130ec283ab4c2c493b190c20de4b28ff3caf72d16ffa1ce3e96f2069aca9",
    "6f423dbc3636ef193fd8898dfdf7621dcade1bbe509e963ffbff91f696d81a62",
    "802ba8b2adabc5796a9471f25b02ae6aeee2439c679a5c33c4bbcee97e081196",
    "eaaf6a048588d9ad4d1c092539bd571dd8af30635c152a3b0e8b611e67d1a1af",
    "e67abc6bd5e2cac169821afc51b207127f42b92a841e976f9b752157879ba8bd",
    "d38985a6a1bfd35037cb7776b2dc86797abbb7a06630f5d03df2785d50d5a2ac",
    "45ea0a3f6016d2bb90ab92c34a7aac9767671a8a84b9bcce6c019e60197c134b",
    "c098445d748ced5f178ef2ff96f2758cbec9eb32cb0fc65db313bcac1d3bc98f"
  ],
  "time": 1388185914,
  "mediantime": 1388183675,
  "nonce": 924591752,
  "bits": "1903a30c",
  "difficulty": 1180923195.258026,
  "chainwork": "000000000000000000000000000000000000000000000934695e92aaf53afa1a",
  "previousblockhash": "0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569",
  "nextblockhash": "000000000000000010236c269dd6ed714dd5db39d36b33959079d78dfd431ba7"
}</pre>
</div>
</div>
<div class="paragraph data-line-656">
<p>Le bloc contient 419 transactions et la 64√®me transaction r√©pertori√©e (0627052b...) est le paiement du caf√© d&#8217;Alice. L&#8217;entr√©e ` hauteur ` nous indique qu&#8217;il s&#8217;agit du 277316e bloc de la cha√Æne de blocs.</p>
</div>
</div>
<div class="sect3 data-line-658">
<h4 id="_utilisation_de_linterface_de_programmation_de_bitcoin_core">Utilisation de l&#8217;interface de programmation de Bitcoin Core</h4>
<div class="paragraph data-line-660">
<p>L&#8217;assistant <code>bitcoin-cli</code> est tr√®s utile pour explorer la biblioth√®ue (API) Bitcoin Core et les fonctions de test. Mais tout l&#8217;int√©r√™t d&#8217;une interface de programmation d&#8217;application est d&#8217;acc√©der aux fonctions par programmation. Dans cette section, nous montrerons comment acc√©der √† Bitcoin Core √† partir d&#8217;un autre programme.</p>
</div>
<div class="paragraph data-line-662">
<p>L&#8217;API de Bitcoin Core est une interface JSON-RPC. JSON signifie JavaScript Object Notation et c&#8217;est un moyen tr√®s pratique de pr√©senter des donn√©es que les humains et les programmes peuvent facilement lire. RPC signifie Remote Procedure Call (ou appel de proc√©dure √† distance), ce qui signifie que nous appelons des proc√©dures (fonctions) distantes (sur le n≈ìud Bitcoin Core) via un protocole r√©seau. Dans ce cas, le protocole r√©seau est HTTP ou HTTPS (pour les connexions crypt√©es).</p>
</div>
<div class="paragraph data-line-664">
<p>Lorsque nous avons utilis√© la commande <code>bitcoin-cli</code> pour obtenir de l&#8217;aide sur une commande, elle nous a montr√© un exemple d&#8217;utilisation de curl, le client HTTP polyvalent en ligne de commande pour construire l&#8217;un de ces appels JSON-RPC¬†:</p>
</div>
<div class="listingblock data-line-666">
<div class="content">
<pre>$ curl --user myusername --data-binary '{"jsonrpc": "1.0", "id":"curltest", "method": "getblockchaininfo", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:8332/</pre>
</div>
</div>
<div class="paragraph data-line-670">
<p>Cette commande montre que <code>curl</code> soumet une requ√™te HTTP √† l&#8217;h√¥te local (127.0.0.1), se connecte au port bitcoin par d√©faut (8332) et soumet une requ√™te <code>jsonrpc</code> pour la m√©thode <code>getblockchaininfo</code> en utilisant l&#8217;encodage text/plain.</p>
</div>
<div class="paragraph data-line-672">
<p>Vous remarquerez peut-√™tre que curl demandera que les informations d&#8217;identification soient envoy√©es avec la demande. Bitcoin Core cr√©era un mot de passe al√©atoire √† chaque d√©marrage et le placera dans le r√©pertoire de donn√©es sous le nom .cookie. L&#8217;assistant <code>bitcoin-cli</code> peut lire ce fichier de mots de passe √©tant donn√© le r√©pertoire de donn√©es. De m√™me, vous pouvez copier le mot de passe et le transmettre √† curl (ou √† tout wrapper Bitcoin Core RPC de niveau sup√©rieur). Alternativement, vous pouvez cr√©er un mot de passe statique avec le script d&#8217;assistance fourni dans <em>./share/rpcauth/rpcauth.py</em> dans le r√©pertoire source de Bitcoin Core.</p>
</div>
<div class="paragraph data-line-674">
<p>Si vous impl√©mentez un appel JSON-RPC dans votre propre programme, vous pouvez utiliser une biblioth√®que HTTP g√©n√©rique pour construire l&#8217;appel, similaire √† ce qui est montr√© dans l&#8217;exemple <code>curl</code> pr√©c√©dent.</p>
</div>
<div class="paragraph data-line-676">
<p>Cependant, il existe des biblioth√®ques dans la plupart des langages de programmation qui "enveloppent" l&#8217;API Bitcoin Core d&#8217;une mani√®re qui rend cela beaucoup plus simple. Nous utiliserons la biblioth√®que <code>python-bitcoinlib</code> pour simplifier l&#8217;acc√®s √† l&#8217;API. N&#8217;oubliez pas que cela n√©cessite que vous disposiez d&#8217;une instance Bitcoin Core en cours d&#8217;ex√©cution, qui sera utilis√©e pour effectuer des appels JSON-RPC.</p>
</div>
<div class="paragraph data-line-678">
<p>Le script Python dans <a href="#rpc_example">Ex√©cution de getblockchaininfo via l&#8217;API JSON-RPC de Bitcoin Core</a> effectue un simple appel <code>getblockchaininfo</code> et imprime le param√®tre <code>blocks</code> √† partir des donn√©es renvoy√©es par Bitcoin Core (n≈ìud complet requis).</p>
</div>
<div id="rpc_example" class="exampleblock data-line-682">
<div class="title">Example 5. Ex√©cution de getblockchaininfo via l&#8217;API JSON-RPC de Bitcoin Core</div>
<div class="content">
<div class="listingblock data-line-684">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from bitcoin.rpc import RawProxy

# Cr√©er une connexion au n≈ìud local Bitcoin Core
p = RawProxy()

# Ex√©cutez la commande getinfo, stockez les donn√©es r√©sultantes dans info
info = p.getinfo()

# R√©cup√©rer l'√©l√©ment 'blocks' de l'info
print(info['blocks'])</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-689">
<p>Son ex√©cution nous donne le r√©sultat suivant:</p>
</div>
<div class="listingblock data-line-691">
<div class="content">
<pre>$ python rpc_example.py
394075</pre>
</div>
</div>
<div class="paragraph data-line-696">
<p>Il nous indique que notre n≈ìud local Bitcoin Core a 394075 blocs dans sa cha√Æne de blocs. Ce n&#8217;est pas un r√©sultat spectaculaire, mais cela d√©montre l&#8217;utilisation de base de la biblioth√®que en tant qu&#8217;interface simplifi√©e avec l&#8217;API JSON-RPC de Bitcoin Core.</p>
</div>
<div class="paragraph data-line-698">
<p>Ensuite, utilisons les appels <code>getrawtransaction</code> et <code>decodetransaction</code> pour r√©cup√©rer les d√©tails du paiement du caf√© d&#8217;Alice. Dans <a href="#rpc_transaction">R√©cup√©rer une transaction et it√©rer ses sorties</a>, nous r√©cup√©rons la transaction d&#8217;Alice et listons les sorties de la transaction. Pour chaque sortie, nous affichons l&#8217;adresse et la valeur du destinataire. Pour rappel, la transaction d&#8217;Alice avait une sortie pour payer Bob&#8217;s Cafe et une sortie pour rendre la monnaie √† Alice.</p>
</div>
<div id="rpc_transaction" class="exampleblock data-line-702">
<div class="title">Example 6. R√©cup√©rer une transaction et it√©rer ses sorties</div>
<div class="content">
<div class="listingblock data-line-704">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from bitcoin.rpc import RawProxy

p = RawProxy()

# ID de transaction d'Alice
txid = "0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2"

# Tout d'abord, r√©cup√©rez la transaction brute en hexad√©cimal
raw_tx = p.getrawtransaction(txid)

# D√©codez l'hex de transaction en un objet JSON
decoded_tx = p.decoderawtransaction(raw_tx)

# R√©cup√©rer chacune des sorties de la transaction
for output in decoded_tx['vout']:
    print(output['scriptPubKey']['addresses'], output['value'])</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-709">
<p>En ex√©cutant ce code, nous obtenons :</p>
</div>
<div class="listingblock data-line-711">
<div class="content">
<pre>$ python rpc_transaction.py
([u'1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA'], Decimal('0.01500000'))
([u'1Cdid9KFAaatwczBwBttQcwXYCpvK8h7FK'], Decimal('0.08450000'))</pre>
</div>
</div>
<div class="paragraph data-line-717">
<p>Les deux exemples pr√©c√©dents sont assez simples. Vous n&#8217;avez pas vraiment besoin d&#8217;un programme pour les ex√©cuter ; vous pouvez tout aussi bien utiliser l&#8217;assistant bitcoin-cli. L&#8217;exemple suivant, cependant, n√©cessite plusieurs centaines d&#8217;appels RPC et d√©montre plus clairement l&#8217;utilisation d&#8217;une interface de programmation.</p>
</div>
<div class="paragraph data-line-719">
<p>Dans <a href="#rpc_block">R√©cup√©ration d&#8217;un bloc et ajout de toutes les sorties de transaction</a>, nous r√©cup√©rons d&#8217;abord le bloc 277316, puis r√©cup√©rons chacune des 419 transactions en r√©f√©rence √† chaque identifiant de transaction. Ensuite, nous parcourons chacune des sorties de la transaction et additionnons la valeur.</p>
</div>
<div id="rpc_block" class="exampleblock data-line-723">
<div class="title">Example 7. R√©cup√©ration d&#8217;un bloc et ajout de toutes les sorties de transaction</div>
<div class="content">
<div class="listingblock data-line-725">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from bitcoin.rpc import RawProxy

p = RawProxy()

# La hauteur du bloc o√π la transaction d'Alice a √©t√© enregistr√©e
blockheight = 277316

# Obtenez le hachage de bloc du bloc de hauteur 277316
blockhash = p.getblockhash(blockheight)

# R√©cup√©rer le bloc par son hachage
block = p.getblock(blockhash)

# L'√©l√©ment tx contient la liste de tous les ID de transaction dans le bloc
transactions = block['tx']

block_value = 0

# It√©rer √† travers chaque ID de transaction dans le bloc
for txid in transactions:
    tx_value = 0
    # R√©cup√©rer la transaction brute par ID
    raw_tx = p.getrawtransaction(txid)
    # D√©coder la transaction
    decoded_tx = p.decoderawtransaction(raw_tx)
    # It√©rer √† travers chaque sortie de la transaction
    for output in decoded_tx['vout']:
        # Additionnez la valeur de chaque sortie
        tx_value = tx_value + output['value']

    # Ajouter la valeur de cette transaction au total
    block_value = block_value + tx_value

print("Total value in block: ", block_value)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-730">
<p>En ex√©cutant ce code, nous obtenons :</p>
</div>
<div class="listingblock data-line-732">
<div class="content">
<pre>$ python rpc_block.py

('Total value in block: ', Decimal('10322.07722534'))</pre>
</div>
</div>
<div class="paragraph data-line-738">
<p>Notre exemple de code calcule que la valeur totale des transactions dans ce bloc est de 10 322,07722534 BTC (dont 25 BTC de r√©compense et 0,0909 BTC de frais). Comparez cela au montant rapport√© par un site d&#8217;exploration de blocs en recherchant le hachage ou la hauteur du bloc. Certains explorateurs de blocs rapportent la valeur totale hors r√©compense et hors frais. Voyez si vous pouvez rep√©rer la diff√©rence.</p>
</div>
</div>
</div>
<div class="sect2 data-line-741">
<h3 id="alt_libraries">Clients, biblioth√®ques et bo√Ætes √† outils alternatifs</h3>
<div class="paragraph data-line-743">
<p> Il existe de nombreux clients alternatifs, biblioth√®ques, bo√Ætes √† outils et m√™me des impl√©mentations de n≈ìuds complets dans l&#8217;√©cosyst√®me bitcoin. Ceux-ci sont impl√©ment√©s dans une vari√©t√© de langages de programmation, offrant aux programmeurs des interfaces natives dans leur langue pr√©f√©r√©e.</p>
</div>
<div class="paragraph data-line-745">
<p>Les sections suivantes r√©pertorient certaines des meilleures biblioth√®ques, clients et kits d&#8217;outils, organis√©s par langages de programmation.</p>
</div>
<div class="sect3 data-line-747">
<h4 id="_cc">C/C++</h4>
<div class="dlist data-line-748">
<dl>
<dt class="hdlist1"><a href="https://github.com/bitcoin/bitcoin" data-href="https://github.com/bitcoin/bitcoin">Bitcoin Core</a></dt>
<dd>
<p>L&#8217;impl√©mentation de r√©f√©rence de bitcoin</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/libbitcoin/libbitcoin-system" data-href="https://github.com/libbitcoin/libbitcoin-system">libbitcoin</a></dt>
<dd>
<p>Bo√Æte √† outils de d√©veloppement C++ multiplateforme, n≈ìud et biblioth√®que de consensus</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/libbitcoin/libbitcoin-explorer" data-href="https://github.com/libbitcoin/libbitcoin-explorer">bitcoin explorer</a></dt>
<dd>
<p>L&#8217;outil de ligne de commande de Libbitcoin</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/jgarzik/picocoin" data-href="https://github.com/jgarzik/picocoin">picocoin</a></dt>
<dd>
<p>Biblioth√®que cliente l√©g√®re en langage C pour bitcoin par Jeff Garzik</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-753">
<h4 id="_javascript">JavaScript</h4>
<div class="dlist data-line-754">
<dl>
<dt class="hdlist1"><a href="https://bcoin.io/" data-href="https://bcoin.io/">bcoin</a></dt>
<dd>
<p>Une impl√©mentation modulaire et √©volutive de n≈ìud complet avec API</p>
</dd>
<dt class="hdlist1"><a href="https://bitcore.io/" data-href="https://bitcore.io/">Bitcore</a></dt>
<dd>
<p>N≈ìud complet, API et biblioth√®que par Bitpay</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/bitcoinjs/bitcoinjs-lib" data-href="https://github.com/bitcoinjs/bitcoinjs-lib">BitcoinJS</a></dt>
<dd>
<p>Une pure biblioth√®que Bitcoin en JavaScript pour node.js et les navigateurs</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-758">
<h4 id="_java">Java</h4>
<div class="dlist data-line-759">
<dl>
<dt class="hdlist1"><a href="https://bitcoinj.github.io" data-href="https://bitcoinj.github.io">bitcoinj</a> </dt>
<dd>
<p>Une biblioth√®que client Java √† n≈ìud complet</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-761">
<h4 id="_php">PHP</h4>
<div class="dlist data-line-762">
<dl>
<dt class="hdlist1"><a href="https://github.com/bit-wasp/bitcoin-php" data-href="https://github.com/bit-wasp/bitcoin-php">bitwasp/bitcoin</a></dt>
<dd>
<p>Une biblioth√®que Bitcoin en PHP et des projets associ√©s</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-764">
<h4 id="_python">Python</h4>
<div class="dlist data-line-765">
<dl>
<dt class="hdlist1"><a href="https://github.com/petertodd/python-bitcoinlib" data-href="https://github.com/petertodd/python-bitcoinlib">python-bitcoinlib</a></dt>
<dd>
<p>Une biblioth√®que Bitcoin en Python dont une biblioth√®que de consensus et un n≈ìud par Peter Todd</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/richardkiss/pycoin" data-href="https://github.com/richardkiss/pycoin">pycoin</a></dt>
<dd>
<p>Une biblioth√®que Bitcoin en Python par Richard Kiss</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/primal100/pybitcointools" data-href="https://github.com/primal100/pybitcointools">pybitcointools</a></dt>
<dd>
<p>Une fourche archiv√© de la biblioth√®que Bitcoin en Python par Vitalik Buterin</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-769">
<h4 id="_ruby">Ruby</h4>
<div class="dlist data-line-770">
<dl>
<dt class="hdlist1"><a href="https://github.com/sinisterchipmunk/bitcoin-client" data-href="https://github.com/sinisterchipmunk/bitcoin-client">bitcoin-client</a></dt>
<dd>
<p>Un wrapper de biblioth√®que Ruby pour l&#8217;API JSON-RPC</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-772">
<h4 id="_go">Go</h4>
<div class="dlist data-line-773">
<dl>
<dt class="hdlist1"><a href="https://github.com/btcsuite/btcd" data-href="https://github.com/btcsuite/btcd">btcd</a></dt>
<dd>
<p>Un client Bitcoin √† n≈ìud complet en langage Go</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-775">
<h4 id="_rust">Rust</h4>
<div class="dlist data-line-776">
<dl>
<dt class="hdlist1"><a href="https://github.com/rust-bitcoin/rust-bitcoin" data-href="https://github.com/rust-bitcoin/rust-bitcoin">rust-bitcoin</a></dt>
<dd>
<p>Biblioth√®que Bitcoin Rust pour la s√©rialisation, l&#8217;analyse et les appels d&#8217;API</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-778">
<h4 id="_c">C#</h4>
<div class="dlist data-line-779">
<dl>
<dt class="hdlist1"><a href="https://github.com/MetacoSA/NBitcoin" data-href="https://github.com/MetacoSA/NBitcoin">NBitcoin</a></dt>
<dd>
<p>Biblioth√®que Bitcoin compl√®te pour le framework .NET</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-781">
<h4 id="_objective_c">Objective-C</h4>
<div class="dlist data-line-782">
<dl>
<dt class="hdlist1"><a href="https://github.com/oleganza/CoreBitcoin" data-href="https://github.com/oleganza/CoreBitcoin">CoreBitcoin</a> </dt>
<dd>
<p>Bo√Æte √† outils Bitcoin pour ObjC et Swift</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-13">
<p>De nombreuses autres biblioth√®ques existent dans une vari√©t√© d&#8217;autres langages de programmation et d&#8217;autres sont cr√©√©es tout le temps.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-4">
<h2 id="ch04_keys_addresses">Cl√©s et adresses</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-6">
<p>Vous avez peut-√™tre entendu dire que le bitcoin est bas√© sur la <em>cryptographie</em>, qui est une branche des math√©matiques largement utilis√©e en s√©curit√© informatique. La cryptographie signifie "√©criture secr√®te" en grec, mais la science de la cryptographie englobe plus que la simple √©criture secr√®te, appel√©e cryptage. La cryptographie peut √©galement √™tre utilis√©e pour prouver la connaissance d&#8217;un secret sans r√©v√©ler ce secret (signature num√©rique), ou prouver l&#8217;authenticit√© des donn√©es (empreinte num√©rique). Ces types de preuves cryptographiques sont les outils math√©matiques essentiels au bitcoin et largement utilis√©s dans les applications bitcoin. Ironiquement, le cryptage n&#8217;est pas une partie importante du bitcoin, car ses communications et ses donn√©es de transaction ne sont pas crypt√©es et ne doivent √™tre chiffr√©s pour prot√©ger les fonds. Dans ce chapitre, nous pr√©senterons une partie de la cryptographie utilis√©e dans le bitcoin pour contr√¥ler la propri√©t√© des fonds, sous la forme de cl√©s, d&#8217;adresses et de portefeuilles.</p>
</div>
<div class="sect2 data-line-8">
<h3 id="_pr√©sentation">Pr√©sentation</h3>
<div class="paragraph data-line-10">
<p>¬†La propri√©t√© du bitcoin est √©tablie par le biais de <em>cl√©s num√©riques</em>, <em>adresses Bitcoin</em> et <em>signatures num√©riques</em>. Les cl√©s num√©riques ne sont pas r√©ellement stock√©es dans le r√©seau, mais sont plut√¥t cr√©√©es et stock√©es par les utilisateurs dans un fichier, ou une simple base de donn√©es, appel√©e <em>wallet</em>. Les cl√©s num√©riques du portefeuille d&#8217;un utilisateur sont totalement ind√©pendantes du protocole Bitcoin et peuvent √™tre g√©n√©r√©es et g√©r√©es par le logiciel du portefeuille de l&#8217;utilisateur sans r√©f√©rence √† la cha√Æne de blocs ni acc√®s √† Internet. Les cl√©s permettent de nombreuses propri√©t√©s int√©ressantes du bitcoin, notamment la confiance et le contr√¥le d√©centralis√©s, l&#8217;attestation de propri√©t√© et le mod√®le de s√©curit√© √† l&#8217;√©preuve de la cryptographie.</p>
</div>
<div class="paragraph data-line-12">
<p>La plupart des transactions bitcoin n√©cessitent une signature num√©rique valide √† inclure dans la cha√Æne de blocs, qui ne peut √™tre g√©n√©r√©e qu&#8217;avec une cl√© secr√®te ; par cons√©quent, toute personne poss√©dant une copie de cette cl√© a le contr√¥le du bitcoin.  La signature num√©rique utilis√©e pour d√©penser des fonds est √©galement appel√©e <em>t√©moin</em>, un terme utilis√© en cryptographie. Les donn√©es t√©moins dans une transaction bitcoin t√©moignent de la v√©ritable propri√©t√© des fonds d√©pens√©s.</p>
</div>
<div class="paragraph data-line-14">
<p>Les cl√©s sont fournies par paires constitu√©es d&#8217;une cl√© priv√©e (secr√®te) et une cl√© publique. Consid√©rez la cl√© publique comme similaire √† un num√©ro de compte bancaire et la cl√© priv√©e comme similaire au code PIN secret, ou √† la signature d&#8217;un ch√®que, qui permet de contr√¥ler le compte. Ces cl√©s num√©riques sont tr√®s rarement vues par les utilisateurs de bitcoin. Pour la plupart, ils sont stock√©s dans le fichier du portefeuille et g√©r√©s par le logiciel du portefeuille bitcoin.</p>
</div>
<div class="paragraph data-line-16">
<p>Dans la partie paiement d&#8217;une transaction bitcoin, la cl√© publique du destinataire est repr√©sent√©e par son empreinte num√©rique, appel√©e <em>adresse Bitcoin</em>, qui est utilis√©e de la m√™me mani√®re que le nom du b√©n√©ficiaire sur un ch√®que (c&#8217;est-√†-dire "Payer √† l&#8217;ordre de") . Dans la plupart des cas, une adresse Bitcoin correspond et est g√©n√©r√©e √† partir d&#8217;une cl√© publique. Cependant, toutes les adresses Bitcoin ne repr√©sentent pas des cl√©s publiques ; ils peuvent √©galement repr√©senter d&#8217;autres b√©n√©ficiaires tels que des scripts, comme nous le verrons plus loin dans ce chapitre. De cette mani√®re, les adresses Bitcoin font abstraction du destinataire des fonds, ce qui rend les destinations de transaction flexibles, similaires aux ch√®ques papier¬†: un instrument de paiement unique qui peut √™tre utilis√© pour payer les comptes des personnes, payer les comptes de l&#8217;entreprise, payer des factures ou payer en esp√®ces. L&#8217;adresse Bitcoin est la seule repr√©sentation des cl√©s que les utilisateurs verront r√©guli√®rement, car c&#8217;est la partie qu&#8217;ils doivent partager avec le monde.</p>
</div>
<div class="paragraph data-line-18">
<p>Tout d&#8217;abord, nous pr√©senterons la cryptographie et expliquerons les math√©matiques utilis√©es dans le bitcoin. Ensuite, nous verrons comment les cl√©s sont g√©n√©r√©es, stock√©es et g√©r√©es. Nous passerons en revue les diff√©rents formats de codage utilis√©s pour repr√©senter les cl√©s priv√©es et publiques, les adresses et les adresses de script. Enfin, nous nous pencherons sur l&#8217;utilisation avanc√©e des cl√©s et des adresses¬†: adresses personnalis√©es, multisignatures, scripts et portefeuilles papier.</p>
</div>
<div class="sect3 data-line-20">
<h4 id="_cryptographie_√†_cl√©_publique_et_cryptomonnaie">Cryptographie √† cl√© publique et cryptomonnaie</h4>
<div class="paragraph data-line-22">
<p>La cryptographie √† cl√© publique a √©t√© invent√©e dans les ann√©es 1970 et constitue une base math√©matique pour informatique et s√©curit√© de l&#8217;information.</p>
</div>
<div class="paragraph data-line-24">
<p>Depuis l&#8217;invention de la cryptographie √† cl√© publique, plusieurs fonctions math√©matiques appropri√©es, telles que l&#8217;exponentiation des nombres premiers et la multiplication des courbes elliptiques, ont √©t√© d√©couvertes. Ces fonctions math√©matiques sont pratiquement irr√©versibles, ce qui signifie qu&#8217;elles sont faciles √† calculer dans un sens et impossibles √† calculer dans le sens oppos√©. Sur la base de ces fonctions math√©matiques, la cryptographie permet la cr√©ation de secrets num√©riques et de signatures num√©riques infalsifiables. Bitcoin utilise la multiplication de courbes elliptiques comme base de sa cryptographie.</p>
</div>
<div class="paragraph data-line-26">
<p>En bitcoin, nous utilisons la cryptographie √† cl√© publique pour cr√©er une paire de cl√©s qui contr√¥le l&#8217;acc√®s au bitcoin. La paire de cl√©s se compose d&#8217;une cl√© priv√©e et - d√©riv√©e de celle-ci - d&#8217;une cl√© publique unique. La cl√© publique est utilis√©e pour recevoir des fonds et la cl√© priv√©e est utilis√©e pour signer des transactions afin de d√©penser les fonds.</p>
</div>
<div class="paragraph data-line-28">
<p>Il existe une relation math√©matique entre la cl√© publique et la cl√© priv√©e qui permet d&#8217;utiliser la cl√© priv√©e pour g√©n√©rer des signatures sur les messages. Ces signatures peuvent √™tre valid√©es par rapport √† la cl√© publique sans r√©v√©ler la cl√© priv√©e.</p>
</div>
<div class="paragraph data-line-30">
<p>Lorsqu&#8217;il d√©pense des bitcoins, le propri√©taire actuel de bitcoins pr√©sente sa cl√© publique et une signature (diff√©rente √† chaque fois, mais cr√©√©e √† partir de la m√™me cl√© priv√©e) dans une transaction pour d√©penser ces bitcoins. Gr√¢ce √† la pr√©sentation de la cl√© publique et de la signature, tous les membres du r√©seau Bitcoin peuvent v√©rifier et accepter la transaction comme valide, confirmant que la personne transf√©rant le bitcoin en √©tait propri√©taire au moment du transfert.</p>
</div>
<div class="admonitionblock tip data-line-33">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-34">
<p> Dans la plupart des impl√©mentations de portefeuille, les cl√©s priv√©es et publiques sont stock√©es ensemble sous la forme d&#8217;une <em>paire de cl√©s</em> pour plus de commodit√©. Cependant, la cl√© publique peut √™tre calcul√©e √† partir de la cl√© priv√©e, de sorte qu&#8217;il est √©galement possible de ne stocker que la cl√© priv√©e.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-38">
<h4 id="private_public_keys">Cl√©s priv√©es et publiques</h4>
<div class="paragraph data-line-40">
<p> Un portefeuille bitcoin contient une collection de paires de cl√©s, chacune compos√©e d&#8217;une cl√© priv√©e et d&#8217;une cl√© publique. La cl√© priv√©e (k) est un nombre, g√©n√©ralement choisi au hasard. A partir de la cl√© priv√©e, nous utilisons la multiplication par courbe elliptique, une fonction cryptographique √† sens unique, pour g√©n√©rer une cl√© publique (K). A partir de la cl√© publique (K), nous utilisons une fonction de hachage cryptographique unidirectionnelle pour g√©n√©rer une adresse Bitcoin (A). Dans cette section, nous commencerons par g√©n√©rer la cl√© priv√©e, examinerons les math√©matiques de la courbe elliptique utilis√©es pour la transformer en cl√© publique, et enfin, g√©n√©rerons une adresse Bitcoin √† partir de la cl√© publique. La relation entre la cl√© priv√©e, la cl√© publique et l&#8217;adresse Bitcoin est indiqu√©e dans <a href="#k_to_K_to_A">Cl√© priv√©e, cl√© publique et adresse Bitcoin</a>.</p>
</div>
<div id="k_to_K_to_A" class="imageblock data-line-44">
<div class="content">
<img src="images/mbc2_0401.png" alt="privk √† pubK √† adresse A">
</div>
<div class="title">Figure 14. Cl√© priv√©e, cl√© publique et adresse Bitcoin</div>
</div>
<div class="sidebarblock data-line-47">
<div class="content">
<div class="title">Pourquoi utiliser la cryptographie asym√©trique (cl√©s publiques/priv√©es)¬†?</div>
<div class="paragraph data-line-48">
<p>Pourquoi la cryptographie asym√©trique est-elle utilis√©e dans le bitcoin¬†? Elle n&#8217;est pas utilis√©e pour "crypter" (rendre secr√®tes) les transactions. Au contraire, la propri√©t√© utile de la cryptographie asym√©trique est la capacit√© √† g√©n√©rer des <em>signatures num√©riques</em>. Une cl√© priv√©e peut √™tre appliqu√©e √† l&#8217;empreinte num√©rique d&#8217;une transaction pour produire une signature num√©rique. Cette signature ne peut √™tre produite que par une personne connaissant la cl√© priv√©e. Cependant, toute personne ayant acc√®s √† la cl√© publique et √† l&#8217;empreinte digitale de la transaction peut les utiliser pour <em>v√©rifier</em> la signature. Cette propri√©t√© utile de la cryptographie asym√©trique permet √† quiconque de v√©rifier chaque signature sur chaque transaction, tout en garantissant que seuls les propri√©taires de cl√©s priv√©es peuvent produire des signatures valides.</p>
</div>
</div>
</div>
</div>
<div class="sect3 data-line-52">
<h4 id="private_keys">Cl√©s priv√©es</h4>
<div class="paragraph data-line-54">
<p>Une cl√© priv√©e est simplement un nombre, choisi au hasard . La propri√©t√© et le contr√¥le de la cl√© priv√©e sont √† la base du contr√¥le de l&#8217;utilisateur sur tous les fonds associ√©s √† l&#8217;adresse Bitcoin correspondante. La cl√© priv√©e est utilis√©e pour cr√©er des signatures n√©cessaires pour d√©penser des bitcoins en prouvant la propri√©t√© des fonds utilis√©s dans une transaction. La cl√© priv√©e doit rester secr√®te √† tout moment, car la r√©v√©ler √† des tiers √©quivaut √† leur donner le contr√¥le sur le bitcoin s√©curis√© par cette cl√©. La cl√© priv√©e doit √©galement √™tre sauvegard√©e et prot√©g√©e contre toute perte accidentelle, car si elle est perdue, elle ne peut pas √™tre r√©cup√©r√©e et les fonds qu&#8217;elle garantit sont √©galement perdus √† jamais.</p>
</div>
<div class="admonitionblock tip data-line-57">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-58">
<p>La cl√© priv√©e bitcoin n&#8217;est qu&#8217;un nombre. Vous pouvez choisir vos cl√©s priv√©es au hasard en utilisant simplement une pi√®ce de monnaie, un crayon et du papier¬†: lancez une pi√®ce 256 fois et vous avez les chiffres binaires d&#8217;une cl√© priv√©e al√©atoire que vous pouvez utiliser dans un portefeuille bitcoin. La cl√© publique peut alors √™tre g√©n√©r√©e √† partir de la cl√© priv√©e.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4 data-line-61">
<h5 id="_g√©n√©rer_une_cl√©_priv√©e_√†_partir_dun_nombre_al√©atoire">G√©n√©rer une cl√© priv√©e √† partir d&#8217;un nombre al√©atoire</h5>
<div class="paragraph data-line-63">
<p>La premi√®re et la plus importante √©tape de la g√©n√©ration de cl√©s consiste √† trouver une source s√©curis√©e d&#8217;entropie ou de caract√®re al√©atoire. La cr√©ation d&#8217;une cl√© bitcoin est essentiellement la m√™me que "Choisissez un nombre entre 1 et 2<sup>256</sup>". La m√©thode exacte que vous utilisez pour choisir ce nombre n&#8217;a pas d&#8217;importance tant qu&#8217;elle n&#8217;est pas pr√©visible ou reproductible. Le logiciel Bitcoin utilise les g√©n√©rateurs de nombres al√©atoires du syst√®me d&#8217;exploitation sous-jacent pour produire 256 bits d&#8217;entropie (al√©atoire). Habituellement, le g√©n√©rateur de nombres al√©atoires du syst√®me d&#8217;exploitation est initialis√© par une source humaine d&#8217;al√©atoire, c&#8217;est pourquoi il peut vous √™tre demand√© de remuer votre souris pendant quelques secondes.</p>
</div>
<div class="paragraph data-line-65">
<p>Plus pr√©cis√©ment, la cl√© priv√©e peut √™tre n&#8217;importe quel nombre compris entre <code>0</code> et <code>n - 1</code> inclus, o√π n est une constante (n = 1,1578 * 10<sup>77</sup>, l√©g√®rement inf√©rieure √† 2<sup>256</sup>) d√©finie comme l&#8217;ordre de la courbe elliptique utilis√©e dans le bitcoin (voir <a href="#elliptic_curve">La cryptographie √† courbe elliptique expliqu√©e</a>). Pour cr√©er une telle cl√©, nous choisissons au hasard un nombre de 256 bits et v√©rifions qu&#8217;il est inf√©rieur √† n. En termes de programmation, cela est g√©n√©ralement r√©alis√© en alimentant une plus grande cha√Æne de bits al√©atoires, collect√©s √† partir d&#8217;une source al√©atoire s√©curis√©e par cryptographie, dans l&#8217;algorithme de hachage SHA256, qui produira commod√©ment un nombre de 256 bits. Si le r√©sultat est inf√©rieur √† n, nous avons une cl√© priv√©e appropri√©e. Sinon, nous r√©essayons simplement avec un autre nombre al√©atoire.</p>
</div>
<div class="admonitionblock warning data-line-68">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-69">
<p>N&#8217;√©crivez pas votre propre code pour cr√©er un nombre al√©atoire ou n&#8217;utilisez pas un nombre al√©atoire "simple" g√©n√©r√© par votre langage de programmation. Utilisez un g√©n√©rateur de nombres pseudo-al√©atoires cryptographiquement s√©curis√© (CSPRNG) avec une valeur d&#8217;amor√ßage provenant d&#8217;une source d&#8217;entropie suffisante. √âtudiez la documentation de la biblioth√®que de g√©n√©rateurs de nombres al√©atoires que vous choisissez pour vous assurer qu&#8217;elle est cryptographiquement s√©curis√©e. La mise en ≈ìuvre correcte du CSPRNG est essentielle √† la s√©curit√© des cl√©s.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-72">
<p>Ce qui suit est une cl√© priv√©e g√©n√©r√©e al√©atoirement (k) affich√©e au format hexad√©cimal (256¬†bits affich√©s sous la forme de 64 chiffres hexad√©cimaux, chacun de 4¬†bits)¬†:</p>
</div>
<div class="listingblock data-line-74">
<div class="content">
<pre>1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD</pre>
</div>
</div>
<div class="admonitionblock tip data-line-80">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-81">
<p>La taille de l&#8217;espace de cl√© priv√©e de bitcoin, (2<sup>256</sup>) est un nombre insondable. Il est d&#8217;environ 10<sup>77</sup> en d√©cimal. √Ä titre de comparaison, on estime que l&#8217;univers visible contient 10<sup>80</sup> atomes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-84">
<p>Pour g√©n√©rer une nouvelle cl√© avec le client Bitcoin Core (voir <a href="#ch03_bitcoin_client">Bitcoin Core¬†: La r√©f√©rence d&#8217;impl√©mentation</a>), utilisez la commande getnewaddress. Pour des raisons de s√©curit√©, il affiche uniquement l&#8217;adresse, pas la cl√© priv√©e. Pour demander √† <code>bitcoind</code> d&#8217;exposer la cl√© priv√©e, utilisez la commande dumpprivkey. La commande <code>dumpprivkey</code> affiche la cl√© priv√©e dans un format de somme de contr√¥le Base58 appel√© <em>Wallet Import Format</em> (WIF ou format d&#8217;importation de portefeuille), que nous examinerons plus en d√©tail dans <a href="#priv_formats">Formats de cl√© priv√©e</a>. Voici un exemple de g√©n√©ration et d&#8217;affichage d&#8217;une cl√© priv√©e √† l&#8217;aide de ces deux commandes¬†:</p>
</div>
<div class="listingblock data-line-86">
<div class="content">
<pre>$ bitcoin-cli getnewaddress
1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy
$ bitcoin-cli dumpprivkey 1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy
KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</pre>
</div>
</div>
<div class="paragraph data-line-93">
<p>La commande <code>dumpprivkey</code> ouvre le portefeuille et extrait la cl√© priv√©e qui a √©t√© g√©n√©r√©e par la commande getnewaddress. Il n&#8217;est pas possible pour <code>bitcoind</code> de conna√Ætre la cl√© priv√©e √† partir de l&#8217;adresse √† moins qu&#8217;elles ne soient toutes deux stock√©es dans le portefeuille.</p>
</div>
<div class="admonitionblock tip data-line-96">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-97">
<p>La commande <code>dumpprivkey</code> ne g√©n√®re pas de cl√© priv√©e √† partir d&#8217;une adresse, car cela est impossible. La commande r√©v√®le simplement la cl√© priv√©e qui est d√©j√† connue du portefeuille et qui a √©t√© g√©n√©r√©e par la commande getnewaddress.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph pagebreak-before data-line-101">
<p>Vous pouvez √©galement utiliser l&#8217;outil de ligne de commande Bitcoin Explorer (voir <a href="#appdx_bx">Commandes de l&#8217;explorateur Bitcoin (bx)</a>) pour g√©n√©rer et afficher des cl√©s priv√©es avec les commandes seed, <code>ec-new</code> et ec-to-wif¬†:</p>
</div>
<div class="listingblock data-line-103">
<div class="content">
<pre>$ bx seed | bx ec-new | bx ec-to-wif
5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</pre>
</div>
</div>
</div>
</div>
<div class="sect3 data-line-109">
<h4 id="pubkey">Cl√©s publiques</h4>
<div class="paragraph data-line-111">
<p>La cl√© publique est calcul√©e √† partir de la cl√© priv√©e en utilisant la multiplication par courbe elliptique, qui est irr√©versible¬†: <em>K</em> = <em>k</em> * <em>G</em>, o√π <em>k</em> est la cl√© priv√©e, <em>G</em> est un point constant appel√© <em>point g√©n√©rateur</em> et <em>K</em> est la cl√© publique r√©sultante. L&#8217;op√©ration inverse, connue sous le nom de "trouver le logarithme discret" - calculer <em>k</em> si vous connaissez <em>K</em> - est aussi difficile que d&#8217;essayer toutes les valeurs possibles de <em>k</em>, c&#8217;est-√†-dire par une recherche par force brute. Avant de montrer comment g√©n√©rer une cl√© publique √† partir d&#8217;une cl√© priv√©e, examinons un peu plus en d√©tail la cryptographie √† courbe elliptique.</p>
</div>
<div class="admonitionblock tip data-line-114">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-115">
<p>La multiplication de courbe elliptique est un type de fonction que les cryptographes appellent une fonction ¬´ √† sens unique ¬ª¬†: elle est facile √† faire dans un sens (multiplication) et impossible √† faire dans le sens inverse (¬´ division ¬ª, ou trouver le logarithme discret). Le propri√©taire de la cl√© priv√©e peut facilement cr√©er la cl√© publique, puis la partager avec le monde entier, sachant que personne ne peut inverser la fonction et calculer la cl√© priv√©e √† partir de la cl√© publique. Cette astuce math√©matique devient la base de signatures num√©riques infalsifiables et s√©curis√©es qui prouvent la propri√©t√© des fonds bitcoin.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-119">
<h4 id="elliptic_curve">La cryptographie √† courbe elliptique expliqu√©e</h4>
<div class="paragraph data-line-121">
<p> La cryptographie √† courbe elliptique est un type de cryptographie asym√©trique ou √† cl√© publique bas√©e sur le probl√®me du logarithme discret exprim√© par addition et multiplication sur les points d&#8217;une courbe elliptique.</p>
</div>
<div class="paragraph data-line-123">
<p><a href="#ecc-curve">Une courbe elliptique</a> est un exemple de courbe elliptique, similaire √† celle utilis√©e par le bitcoin.</p>
</div>
<div id="ecc-curve" class="imageblock smallerthirty data-line-128">
<div class="content">
<img src="images/mbc2_0402.png" alt="courbe ecc">
</div>
<div class="title">Figure 15. Une courbe elliptique</div>
</div>
<div class="paragraph data-line-130">
<p>Bitcoin utilise une courbe elliptique sp√©cifique et un ensemble de constantes math√©matiques, telles que d√©finies dans une norme appel√©e secp256k1, √©tablie par le National Institute of Standards and Technology (NIST). La courbe <code>secp256k1</code> est d√©finie par la fonction suivante, qui produit une courbe elliptique¬†:</p>
</div>
<div class="stemblock data-line-133">
<div class="content">
\[\begin{equation}
{y^2 = (x^3 + 7)}~\text{over}~(\mathbb{F}_p)
\end{equation}\]
</div>
</div>
<div class="paragraph data-line-139">
<p>ou</p>
</div>
<div class="stemblock data-line-142">
<div class="content">
\[\begin{equation}
{y^2 \mod p = (x^3 + 7) \mod p}
\end{equation}\]
</div>
</div>
<div class="paragraph data-line-148">
<p>Le <em>mod p</em> (modulo nombre premier p) indique que cette courbe est sur un corps fini d&#8217;ordre premier <em>p</em>, √©galement √©crit comme \(\mathbb{F}_p\), o√π p = 2<sup>256</sup> ‚Äì 2<sup>32</sup> ‚Äì 2<sup>9</sup> ‚Äì 2<sup>8</sup> ‚Äì 2<sup>7</sup> ‚Äì 2<sup>6</sup> ‚Äì 2<sup>4</sup> ‚Äì 1, un tr√®s grand nombre premier.</p>
</div>
<div class="paragraph data-line-150">
<p>Parce que cette courbe est d√©finie sur un champ fini d&#8217;ordre premier au lieu de sur les nombres r√©els, elle ressemble √† un motif de points dispers√©s en deux dimensions, ce qui la rend difficile √† visualiser. Cependant, le calcul est identique √† celui d&#8217;une courbe elliptique sur des nombres r√©els. A titre d&#8217;exemple, <a href="#ecc-over-F17-math">Cryptographie sur courbe elliptique¬†: visualisation d&#8217;une courbe elliptique sur F(p), avec p=17</a> montre la m√™me courbe elliptique sur un champ fini beaucoup plus petit d&#8217;ordre premier 17, montrant un motif de points sur une grille. La courbe elliptique du bitcoin <code>secp256k1</code> peut √™tre consid√©r√©e comme un motif beaucoup plus complexe de points sur une grille insondable.</p>
</div>
<div id="ecc-over-F17-math" class="imageblock smallersixty data-line-155">
<div class="content">
<img src="images/mbc2_0403.png" alt="ecc sur math√©matiques F17">
</div>
<div class="title">Figure 16. Cryptographie sur courbe elliptique¬†: visualisation d&#8217;une courbe elliptique sur F(p), avec p=17</div>
</div>
<div class="paragraph data-line-157">
<p>Ainsi, par exemple, ce qui suit est un point P de coordonn√©es (x,y) qui est un point sur la courbe secp256k1¬†:</p>
</div>
<div class="listingblock data-line-159">
<div class="content">
<pre>P = (55066263022277343669578718895168534326250603453777594175500187360389116729240, 32670510020758816978083085130507043184471273380659243275938904335757337482424)</pre>
</div>
</div>
<div class="paragraph data-line-163">
<p><a href="#example_4_1">Utiliser Python pour confirmer que ce point est sur la courbe elliptique</a> montre comment vous pouvez v√©rifier cela vous-m√™me en utilisant Python¬†:</p>
</div>
<div id="example_4_1" class="exampleblock data-line-167">
<div class="title">Example 8. Utiliser Python pour confirmer que ce point est sur la courbe elliptique</div>
<div class="content">
<div class="listingblock data-line-169">
<div class="content">
<pre class="highlight"><code class="language-pycon" data-lang="pycon">Python 3.4.0 (default, Mar 30 2014, 19:23:13)
[GCC 4.2.1 Compatible Apple LLVM 5.1 (clang-503.0.38)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; p = 115792089237316195423570985008687907853269984665640564039457584007908834671663
&gt;&gt;&gt; x = 55066263022277343669578718895168534326250603453777594175500187360389116729240
&gt;&gt;&gt; y = 32670510020758816978083085130507043184471273380659243275938904335757337482424
&gt;&gt;&gt; (x ** 3 + 7 - y**2) % p
0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-181">
<p>Dans les math√©matiques des courbes elliptiques, il existe un point appel√© le "point √† l&#8217;infini", qui correspond √† peu pr√®s au r√¥le de z√©ro. Sur les ordinateurs, il est parfois repr√©sent√© par x = y = 0 (ce qui ne satisfait pas l&#8217;√©quation de la courbe elliptique, mais c&#8217;est un cas s√©par√© facile qui peut √™tre v√©rifi√©).</p>
</div>
<div class="paragraph data-line-183">
<p>Il existe √©galement un op√©rateur +, appel√© "addition", qui poss√®de certaines propri√©t√©s similaires √† l&#8217;addition traditionnelle de nombres r√©els apprise par les √©l√®ves du primaire. √âtant donn√© deux points P<sub>1</sub> et P<sub>2</sub> sur la courbe elliptique, il existe un troisi√®me point P<sub>3</sub> = P<sub>1</sub> + P<sub>2</sub>, √©galement sur la courbe elliptique.</p>
</div>
<div class="paragraph data-line-185">
<p>G√©om√©triquement, ce troisi√®me point P<sub>3</sub> est calcul√© en tra√ßant une ligne entre P<sub>1</sub> et P<sub>2</sub>. Cette ligne coupera la courbe elliptique exactement √† un endroit suppl√©mentaire. Appelons ce point P<sub>3</sub> = (x, y). Renvoy√© ensuite sur l&#8217;axe des x pour obtenir P<sub>3</sub> = (x, ‚Äìy).</p>
</div>
<div class="paragraph data-line-187">
<p>Il y a quelques cas particuliers qui expliquent la n√©cessit√© du "point √† l&#8217;infini".</p>
</div>
<div class="paragraph data-line-189">
<p>Si P<sub>1</sub> et P<sub>2</sub> sont le m√™me point, la ligne "entre" P<sub>1</sub> et P<sub>2</sub> doit s&#8217;√©tendre pour √™tre la tangente sur la courbe en ce point P<sub>1</sub>. Cette tangente coupera la courbe en exactement un nouveau point. Vous pouvez utiliser des techniques de calcul pour d√©terminer la pente de la ligne tangente. Ces techniques fonctionnent curieusement, m√™me si nous restreignons notre int√©r√™t aux points de la courbe √† deux coordonn√©es enti√®res !</p>
</div>
<div class="paragraph data-line-191">
<p>Dans certains cas (par exemple, si P<sub>1</sub> et P<sub>2</sub> ont les m√™mes valeurs x mais des valeurs y diff√©rentes), la ligne entre P<sub>1</sub> et P<sub>2</sub> sera exactement verticale, auquel cas P<sub>3</sub> = "point √† l&#8217;infini."</p>
</div>
<div class="paragraph data-line-193">
<p>Si P<sub>1</sub> est le "point √† l&#8217;infini", alors P<sub>1</sub> ` P<sub>2</sub> = P<sub>2</sub>. De m√™me, si P<sub>2</sub> est le point √† l&#8217;infini, alors P<sub>1</sub> ` P<sub>2</sub> = P<sub>1</sub>. Cela montre comment le point √† l&#8217;infini joue le r√¥le de z√©ro.</p>
</div>
<div class="paragraph data-line-195">
<p>Il s&#8217;av√®re que + est associatif, ce qui signifie que (A + B) + C = A + (B + C). Cela signifie que nous pouvons √©crire A + B + C sans parenth√®ses et sans ambigu√Øt√©.</p>
</div>
<div class="paragraph data-line-197">
<p>Maintenant que nous avons d√©fini l&#8217;addition, nous pouvons d√©finir la multiplication de la mani√®re standard qui extensionne l&#8217;addition. Pour un point P sur la courbe elliptique, si k est un nombre entier, alors kP = P ` P ` P ` &#8230;&#8203; ` P (k fois). Notez que k est parfois appel√© un "exposant" dans ce cas.</p>
</div>
</div>
<div class="sect3 data-line-200">
<h4 id="public_key_derivation">G√©n√©ration d&#8217;une cl√© publique</h4>
<div class="paragraph data-line-202">
<p>En partant d&#8217;une cl√© priv√©e sous la forme d&#8217;un nombre g√©n√©r√© al√©atoirement <em>k</em>, nous la multiplions par un point pr√©d√©termin√© sur la courbe appel√© <em>point g√©n√©rateur</em> <em>G</em> pour produire un autre point ailleurs sur la courbe, qui est la cl√© publique correspondante <em>K</em>. Le point g√©n√©rateur est sp√©cifi√© dans le cadre de la norme <code>secp256k1</code> et est toujours le m√™me pour toutes les cl√©s en bitcoin¬†:</p>
</div>
<div class="stemblock data-line-205">
<div class="content">
\[\begin{equation}
{K = k * G}
\end{equation}\]
</div>
</div>
<div class="paragraph data-line-211">
<p>o√π <em>k</em> est la cl√© priv√©e, <em>G</em> est le point g√©n√©rateur et <em>K</em> est la cl√© publique r√©sultante, un point sur la courbe. Comme le point g√©n√©rateur est toujours le m√™me pour tous les utilisateurs de bitcoins, une cl√© priv√©e <em>k</em> multipli√©e par <em>G</em> donnera toujours la m√™me cl√© publique <em>K</em>. La relation entre <em>k</em> et <em>K</em> est fixe, mais ne peut √™tre calcul√©e que dans un sens, de <em>k</em> vers <em>K</em>. C&#8217;est pourquoi une adresse Bitcoin (d√©riv√©e de <em>K</em>) peut √™tre partag√©e avec n&#8217;importe qui et ne r√©v√®le pas la cl√© priv√©e de l&#8217;utilisateur (<em>k</em>).</p>
</div>
<div class="admonitionblock tip data-line-214">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-215">
<p>Une cl√© priv√©e peut √™tre convertie en cl√© publique, mais une cl√© publique ne peut pas √™tre reconvertie en cl√© priv√©e car le calcul ne fonctionne que dans un sens.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-218">
<p>En impl√©mentant la multiplication par courbe elliptique, nous prenons la cl√© priv√©e <em>k</em> g√©n√©r√©e pr√©c√©demment et la multiplions avec le point g√©n√©rateur G pour trouver la cl√© publique <em>K</em>¬†:</p>
</div>
<div class="listingblock data-line-220">
<div class="content">
<pre>K = 1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD * G</pre>
</div>
</div>
<div class="paragraph data-line-224">
<p>La cl√© publique <em>K</em> est d√©finie comme un point K = (x,y)¬†:</p>
</div>
<div class="listingblock data-line-226">
<div class="content">
<pre>K = (x, y)

o√π,

x = F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A
y = 07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB</pre>
</div>
</div>
<div class="paragraph data-line-235">
<p>Pour visualiser la multiplication d&#8217;un point avec un nombre entier, nous utiliserons la courbe elliptique plus simple sur des nombres r√©els - rappelez-vous, le calcul est le m√™me. Notre objectif est de trouver le multiple <em>kG</em> du point g√©n√©rateur <em>G</em>, ce qui revient √† ajouter <em>G</em> √† lui-m√™me, <em>k</em> fois de suite. Dans les courbes elliptiques, l&#8217;ajout d&#8217;un point √† lui-m√™me √©quivaut √† tracer une ligne tangente sur le point et √† trouver √† nouveau l&#8217;endroit o√π il coupe la courbe, puis √† refl√©ter ce point sur l&#8217;axe des x.</p>
</div>
<div class="paragraph data-line-237">
<p><a href="#ecc_illustrated">Cryptographie sur courbe elliptique¬†: visualisation de la multiplication d&#8217;un point G par un entier k sur une courbe elliptique</a> montre le processus de d√©rivation de <em>G</em>, <em>2G</em>, <em>4G</em> et <em>8G</em> en tant qu&#8217;op√©ration g√©om√©trique sur la courbe.</p>
</div>
<div class="admonitionblock tip data-line-240">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-241">
<p>Bitcoin utilise la <a href="https://github.com/bitcoin-core/secp256k1" data-href="https://github.com/bitcoin-core/secp256k1">biblioth√®que C optimis√©e secp256k1</a> pour effectuer les calculs de la courbe elliptique.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="ecc_illustrated" class="imageblock data-line-246">
<div class="content">
<img src="images/mbc2_0404.png" alt="illustration d&#8217;ecc">
</div>
<div class="title">Figure 17. Cryptographie sur courbe elliptique¬†: visualisation de la multiplication d&#8217;un point G par un entier k sur une courbe elliptique</div>
</div>
</div>
</div>
<div class="sect2 data-line-248">
<h3 id="_adresses_bitcoin">Adresses Bitcoin</h3>
<div class="paragraph data-line-250">
<p>Une adresse Bitcoin est une cha√Æne de chiffres et de caract√®res qui peut √™tre partag√©e avec toute personne souhaitant vous envoyer de l&#8217;argent. Les adresses produites √† partir de cl√©s publiques consistent en une cha√Æne de chiffres et de lettres commen√ßant par le chiffre "1". Voici un exemple d&#8217;adresse Bitcoin¬†:</p>
</div>
<div class="listingblock data-line-252">
<div class="content">
<pre>1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy</pre>
</div>
</div>
<div class="paragraph data-line-257">
<p>L&#8217;adresse Bitcoin est ce qui appara√Æt le plus souvent dans une transaction en tant que "destinataire" des fonds. Si nous comparons une transaction bitcoin √† un ch√®que papier, l&#8217;adresse Bitcoin est le b√©n√©ficiaire, c&#8217;est ce que nous √©crivons sur la ligne apr√®s "Payer √† l&#8217;ordre de". Sur un ch√®que papier, ce b√©n√©ficiaire peut parfois √™tre le nom d&#8217;un titulaire de compte bancaire, mais peut √©galement inclure des soci√©t√©s, des institutions ou m√™me des esp√®ces. √âtant donn√© que les ch√®ques papier n&#8217;ont pas besoin de sp√©cifier un compte, mais utilisent plut√¥t un nom abstrait en tant que destinataire des fonds, ce sont des instruments de paiement tr√®s flexibles. Les transactions Bitcoin utilisent une abstraction similaire, l&#8217;adresse Bitcoin, pour les rendre tr√®s flexibles. Une adresse Bitcoin peut repr√©senter le propri√©taire d&#8217;une paire de cl√©s priv√©e/publique, ou elle peut repr√©senter autre chose, comme un script de paiement, comme nous le verrons dans <a href="#p2sh">Pay-to-Script-Hash (P2SH)</a>. Pour l&#8217;instant, examinons le cas simple; une adresse Bitcoin qui repr√©sente et est d√©riv√©e d&#8217;une cl√© publique.</p>
</div>
<div class="paragraph data-line-259">
<p>L&#8217;adresse Bitcoin est d√©riv√©e de la cl√© publique gr√¢ce √† l&#8217;utilisation d&#8217;un hachage cryptographique unidirectionnel. Un "algorithme de hachage" ou simplement "algorithme de hachage" est une fonction √† sens unique qui produit une empreinte digitale ou un "hachage" (ou un "r√©sultat de hachage") d&#8217;une entr√©e de taille arbitraire. Les fonctions de hachage cryptographiques sont largement utilis√©es dans le bitcoin¬†: dans les adresses Bitcoin, dans les adresses de script et dans l&#8217;algorithme de minage de preuve de travail. Les algorithmes utilis√©s pour cr√©er une adresse Bitcoin √† partir d&#8217;une cl√© publique sont le Secure Hash Algorithm (SHA) et le RACE Integrity Primitives Evaluation Message Digest (RIPEMD), ou plus pr√©cis√©ment SHA256 et RIPEMD160.</p>
</div>
<div class="paragraph data-line-261">
<p>En commen√ßant par la cl√© publique <em>K</em>, nous calculons le hachage SHA256, puis calculons le hachage RIPEMD160 du r√©sultat, produisant un nombre de 160 bits (20 octets) :</p>
</div>
<div class="stemblock data-line-264">
<div class="content">
\[\begin{equation}
{A = RIPEMD160(SHA256(K))}
\end{equation}\]
</div>
</div>
<div class="paragraph data-line-270">
<p>o√π <em>K</em> est la cl√© publique et <em>A</em> est l&#8217;adresse Bitcoin r√©sultante.</p>
</div>
<div class="admonitionblock tip data-line-274">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-275">
<p>Une adresse Bitcoin n&#8217;est <em>pas</em> la m√™me chose qu&#8217;une cl√© publique. Les adresses Bitcoin sont d√©riv√©es d&#8217;une cl√© publique √† l&#8217;aide d&#8217;une fonction unidirectionnelle.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-278">
<p>Les adresses Bitcoin sont presque toujours encod√©es en "Base58Check" (voir <a href="#base58">Encodage Base58 et Base58Check</a>), qui utilise 58 caract√®res (un syst√®me de num√©rotation Base58) et une somme de contr√¥le pour faciliter la lisibilit√© humaine, √©viter toute ambigu√Øt√© et prot√©ger contre les erreurs de transcription et de saisie d&#8217;adresse. Base58Check est √©galement utilis√© de nombreuses autres mani√®res dans Bitcoin, par exemple lorsque chaque fois qu&#8217;un utilisateur a besoin de lire et de transcrire correctement un num√©ro, tel qu&#8217;une adresse Bitcoin, une cl√© priv√©e, une cl√© crypt√©e ou un hachage de script. Dans la section suivante, nous examinerons les m√©canismes d&#8217;encodage et de d√©codage Base58Check et les repr√©sentations qui en r√©sultent. <a href="#pubkey_to_address">Cl√© publique vers adresse Bitcoin¬†: conversion d&#8217;une cl√© publique en adresse Bitcoin</a> illustre la conversion d&#8217;une cl√© publique en une adresse Bitcoin.</p>
</div>
<div id="pubkey_to_address" class="imageblock data-line-282">
<div class="content">
<img src="images/mbc2_0405.png" alt="pubkey √† adresse">
</div>
<div class="title">Figure 18. Cl√© publique vers adresse Bitcoin¬†: conversion d&#8217;une cl√© publique en adresse Bitcoin</div>
</div>
<div class="sect3 data-line-285">
<h4 id="base58">Encodage Base58 et Base58Check</h4>
<div class="paragraph data-line-287">
<p>Afin de repr√©senter les nombres longs de mani√®re compacte, en utilisant moins de symboles, de nombreux syst√®mes informatiques utilisent des repr√©sentations alphanum√©riques mixtes avec une base sup√©rieure √† 10. Par exemple, alors que le syst√®me d√©cimal traditionnel utilise les 10 chiffres de 0 √† 9, le syst√®me hexad√©cimal utilise 16, avec les lettres A √† F comme six symboles suppl√©mentaires. Un nombre repr√©sent√© au format hexad√©cimal est plus court que la repr√©sentation d√©cimale √©quivalente. Encore plus compacte, la repr√©sentation Base64 utilise 26 lettres minuscules, 26 lettres majuscules, 10 chiffres et 2 caract√®res suppl√©mentaires tels que &#8220;+&#8221; et "/" pour transmettre des donn√©es binaires sur des supports textuels tels que le courrier √©lectronique. Base64 est le plus couramment utilis√© pour ajouter des pi√®ces jointes binaires aux e-mails. Base58 est un format de codage binaire bas√© sur du texte d√©velopp√© pour √™tre utilis√© dans le bitcoin et utilis√© dans de nombreuses autres cryptomonnaies. Il offre un √©quilibre entre repr√©sentation compacte, lisibilit√© et d√©tection et pr√©vention des erreurs. Base58 est un sous-ensemble de Base64, utilisant des lettres et des chiffres majuscules et minuscules, mais omettant certains caract√®res qui sont fr√©quemment confondus et qui peuvent appara√Ætre identiques lorsqu&#8217;ils sont affich√©s dans certaines polices. Plus pr√©cis√©ment, Base58 est Base64 sans le 0 (chiffre z√©ro), O (o majuscule), l (L inf√©rieur), I (i majuscule) et les symboles &#8220;+&#8221; et "/". Ou, plus simplement, c&#8217;est un ensemble de lettres minuscules et majuscules et de chiffres sans les quatre (0, O, l, I) que nous venons de mentionner. <a href="#base58alphabet">Alphabet Base58 de Bitcoin</a> affiche l&#8217;alphabet Base58 complet.</p>
</div>
<div id="base58alphabet" class="exampleblock data-line-291">
<div class="title">Example 9. Alphabet Base58 de Bitcoin</div>
<div class="content">
<div class="listingblock data-line-292">
<div class="content">
<pre>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-298">
<p>Pour ajouter une s√©curit√© suppl√©mentaire contre les fautes de frappe ou les erreurs de transcription, Base58Check est un format d&#8217;encodage Base58, fr√©quemment utilis√© dans le bitcoin, qui poss√®de un code de v√©rification des erreurs int√©gr√©. La somme de contr√¥le est constitu√©e de quatre octets suppl√©mentaires ajout√©s √† la fin des donn√©es en cours de codage. La somme de contr√¥le est d√©riv√©e du hachage des donn√©es cod√©es et peut donc √™tre utilis√©e pour d√©tecter et pr√©venir les erreurs de transcription et de frappe. Lorsqu&#8217;il est pr√©sent√© avec le code Base58Check, le logiciel de d√©codage calcule la somme de contr√¥le des donn√©es et la compare √† la somme de contr√¥le incluse dans le code. Si les deux ne correspondent pas, une erreur a √©t√© introduite et les donn√©es Base58Check ne sont pas valides. Cela emp√™che qu&#8217;une adresse Bitcoin mal saisie soit accept√©e par le logiciel du portefeuille comme destination valide, une erreur qui entra√Ænerait autrement une perte de fonds.</p>
</div>
<div class="paragraph data-line-300">
<p>Pour convertir des donn√©es (un nombre) dans un format Base58Check, nous ajoutons d&#8217;abord un pr√©fixe aux donn√©es, appel√© "octet de version", qui sert √† identifier facilement le type de donn√©es encod√©es. Par exemple, dans le cas d&#8217;une adresse Bitcoin, le pr√©fixe est z√©ro (0x00 en hexad√©cimal), alors que le pr√©fixe utilis√© lors de l&#8217;encodage d&#8217;une cl√© priv√©e est 128 (0x80 en hexad√©cimal). Une liste des pr√©fixes de version courants est affich√©e dans <a href="#base58check_versions">Base58Check pr√©fixe de version et exemples de r√©sultats encod√©s</a>.</p>
</div>
<div class="paragraph data-line-302">
<p>Ensuite, nous calculons la somme de contr√¥le "double-SHA", ce qui signifie que nous appliquons l&#8217;algorithme de hachage SHA256 deux fois sur le r√©sultat pr√©c√©dent (pr√©fixe et donn√©es):</p>
</div>
<div class="listingblock data-line-304">
<div class="content">
<pre>somme de contr√¥le (checksum) = SHA256(SHA256(pr√©fixe+donn√©es))</pre>
</div>
</div>
<div class="paragraph data-line-308">
<p>√Ä partir du hachage de 32 octets r√©sultant (hachage-d&#8217;un-hachage), nous ne prenons que les quatre premiers octets. Ces quatre octets servent de code de contr√¥le d&#8217;erreur ou de somme de contr√¥le (checksum). La somme de contr√¥le est concat√©n√©e (ajout√©e) √† la fin.</p>
</div>
<div class="paragraph data-line-310">
<p>Le r√©sultat est compos√© de trois √©l√©ments¬†: un pr√©fixe, les donn√©es et une somme de contr√¥le. Ce r√©sultat est encod√© en utilisant l&#8217;alphabet Base58 d√©crit pr√©c√©demment. <a href="#base58check_encoding">Encodage Base58Check¬†: un format Base58, versionn√© et √† somme de contr√¥le pour encoder sans ambigu√Øt√© les donn√©es bitcoin</a> illustre le processus d&#8217;encodage Base58Check.</p>
</div>
<div id="base58check_encoding" class="imageblock data-line-314">
<div class="content">
<img src="images/mbc2_0406.png" alt="Base58CheckEncoding">
</div>
<div class="title">Figure 19. Encodage Base58Check¬†: un format Base58, versionn√© et √† somme de contr√¥le pour encoder sans ambigu√Øt√© les donn√©es bitcoin</div>
</div>
<div class="paragraph data-line-316">
<p>En bitcoin, la plupart des donn√©es pr√©sent√©es √† l&#8217;utilisateur sont encod√©es en Base58Check pour les rendre compactes, faciles √† lire et faciles √† d√©tecter les erreurs. Le pr√©fixe de version dans l&#8217;encodage Base58Check est utilis√© pour cr√©er des formats faciles √† distinguer qui, lorsqu&#8217;ils sont encod√©s en Base58, contiennent des caract√®res sp√©cifiques au d√©but de la charge utile encod√©e en Base58Check. Ces caract√®res permettent aux humains d&#8217;identifier facilement le type de donn√©es cod√©es et comment les utiliser. C&#8217;est ce qui diff√©rencie, par exemple, une adresse Bitcoin encod√©e en Base58Check qui commence par un 1 d&#8217;une cl√© priv√©e WIF encod√©e en Base58Check qui commence par un 5. Quelques exemples de pr√©fixes de version et les caract√®res Base58 r√©sultants sont affich√©s dans <a href="#base58check_versions">Base58Check pr√©fixe de version et exemples de r√©sultats encod√©s</a>.</p>
</div>
<table id="base58check_versions" class="tableblock frame-all grid-all stretch data-line-321">
<caption class="title">Table 1. Base58Check pr√©fixe de version et exemples de r√©sultats encod√©s</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Pr√©fixe de version (hex)</th>
<th class="tableblock halign-left valign-top">Pr√©fixe de r√©sultat Base58</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse Bitcoin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse de hachage Pay-to-Script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x05</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse de test Bitcoin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m ou n</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cl√© priv√©e WIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5, K ou L</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cl√© priv√©e crypt√©e BIP-38</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0142</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6P</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cl√© publique √©tendue BIP-32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0488B21E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xpub</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3 data-line-331">
<h4 id="_formats_de_cl√©">Formats de cl√©</h4>
<div class="paragraph data-line-333">
<p> Les cl√©s priv√©es et publiques peuvent √™tre repr√©sent√©es dans un certain nombre de formats diff√©rents. Ces repr√©sentations codent tous le m√™me nombre, m√™me si elles semblent diff√©rentes. Ces formats sont principalement utilis√©s pour faciliter la lecture et la transcription des cl√©s sans introduire d&#8217;erreurs.</p>
</div>
<div class="sect4 data-line-336">
<h5 id="priv_formats">Formats de cl√© priv√©e</h5>
<div class="paragraph data-line-338">
<p> La cl√© priv√©e peut √™tre repr√©sent√©e dans un certain nombre de formats diff√©rents, qui correspondent tous au m√™me nombre de 256 bits. <a href="#table_4-2">Repr√©sentations de cl√©s priv√©es (formats d&#8217;encodage)</a> montre trois formats courants utilis√©s pour repr√©senter les cl√©s priv√©es. Diff√©rents formats sont utilis√©s dans diff√©rentes circonstances. Les formats binaires hexad√©cimaux et bruts sont utilis√©s en interne dans les logiciels et rarement montr√©s aux utilisateurs. Le WIF est utilis√© pour l&#8217;importation/exportation de cl√©s entre portefeuilles et souvent utilis√© dans les repr√©sentations de code QR (code-barres) des cl√©s priv√©es.</p>
</div>
<table id="table_4-2" class="tableblock frame-all grid-all stretch data-line-343">
<caption class="title">Table 2. Repr√©sentations de cl√©s priv√©es (formats d&#8217;encodage)</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Pr√©fixe</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brut</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aucun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aucun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64 chiffres hexad√©cimaux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encodage Base58Check¬†: Base58 avec pr√©fixe de version 0x80 et somme de contr√¥le de 4¬†octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIF compress√©</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K ou L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comme ci-dessus, avec le suffixe ajout√© 0x01 avant l&#8217;encodage</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-351">
<p><a href="#table_4-3">Exemple¬†: m√™me cl√©, diff√©rents formats</a> affiche la cl√© priv√©e g√©n√©r√©e dans ces trois formats.</p>
</div>
<table id="table_4-3" class="tableblock frame-all grid-all stretch data-line-356">
<caption class="title">Table 3. Exemple¬†: m√™me cl√©, diff√©rents formats</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Format</th>
<th class="tableblock halign-left valign-top">Cl√© priv√©e</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIF compress√©</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-363">
<p>Toutes ces repr√©sentations sont des mani√®res diff√©rentes de montrer le m√™me num√©ro, la m√™me cl√© priv√©e. Ils semblent diff√©rents, mais n&#8217;importe quel format peut facilement √™tre converti en n&#8217;importe quel autre format. Notez que le "binaire brut" n&#8217;est pas affich√© dans <a href="#table_4-3">Exemple¬†: m√™me cl√©, diff√©rents formats</a> car tout encodage √† afficher ici ne serait, par d√©finition, pas une donn√©e binaire brute.</p>
</div>
<div class="paragraph data-line-365">
<p>Nous utilisons la commande <code>wif-to-ec</code> de Bitcoin Explorer (voir <a href="#appdx_bx">Commandes de l&#8217;explorateur Bitcoin (bx)</a>) pour montrer que les deux cl√©s WIF repr√©sentent la m√™me cl√© priv√©e¬†:</p>
</div>
<div class="listingblock data-line-367">
<div class="content">
<pre>$ bx wif-to-ec 5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn
1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd

$ bx wif-to-ec KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ
1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd</pre>
</div>
</div>
</div>
<div class="sect4 data-line-375">
<h5 id="_d√©coder_√†_partir_de_base58check">D√©coder √† partir de Base58Check</h5>
<div class="paragraph data-line-377">
<p>Les commandes de Bitcoin Explorer (voir <a href="#appdx_bx">Commandes de l&#8217;explorateur Bitcoin (bx)</a>) facilitent l&#8217;√©criture de scripts interface syst√®me (ou shell) √† l&#8217;aide d'"op√©rateurs de transfert de donn√©es" en ligne de commande (ou "command-line pipes") qui manipulent les cl√©s, les adresses et les transactions bitcoin. Vous pouvez utiliser Bitcoin Explorer pour d√©coder le format Base58Check sur la ligne de commande.</p>
</div>
<div class="paragraph data-line-379">
<p>Nous utilisons la commande <code>base58check-decode</code> pour d√©coder la cl√© non compress√©e¬†:</p>
</div>
<div class="listingblock data-line-381">
<div class="content">
<pre>$ bx base58check-decode 5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn
wrapper
{
    checksum 4286807748
    payload 1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd
    version 128
}</pre>
</div>
</div>
<div class="paragraph data-line-391">
<p>Le r√©sultat contient la cl√© comme charge utile (payload), le pr√©fixe de version WIF 128 et une somme de contr√¥le (checksum).</p>
</div>
<div class="paragraph data-line-393">
<p>Notez que la "charge utile" (ou "payload") de la cl√© compress√©e est ajout√©e avec le suffixe 01, signalant que la cl√© publique d√©riv√©e doit √™tre compress√©e¬†:</p>
</div>
<div class="listingblock data-line-395">
<div class="content">
<pre>$ bx base58check-decode KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ
wrapper
{
    checksum 2339607926
    payload 1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd01
    version 128
}</pre>
</div>
</div>
</div>
<div class="sect4 data-line-405">
<h5 id="_encoder_de_lhex_vers_base58check">Encoder de l&#8217;hex vers Base58Check</h5>
<div class="paragraph data-line-407">
<p>Pour encoder en Base58Check (l&#8217;inverse de la commande pr√©c√©dente), nous utilisons la commande <code>base58check-encode</code> de Bitcoin Explorer (voir <a href="#appdx_bx">Commandes de l&#8217;explorateur Bitcoin (bx)</a>) et indiquez la cl√© priv√©e hexad√©cimale, suivie du pr√©fixe de version WIF¬†128¬†:</p>
</div>
<div class="listingblock data-line-409">
<div class="content">
<pre>bx base58check-encode 1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd --version 128
5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</pre>
</div>
</div>
</div>
<div class="sect4 data-line-414">
<h5 id="_encoder_de_lhex_cl√©_compress√©e_√†_base58check">Encoder de l&#8217;hex (cl√© compress√©e) √† Base58Check</h5>
<div class="paragraph data-line-416">
<p>Pour encoder dans Base58Check comme une cl√© priv√©e "compress√©e" (voir <a href="#comp_priv">Cl√©s priv√©es compress√©es</a>), nous ajoutons le suffixe <code>01</code> √† la cl√© hexad√©cimale puis encodons comme dans la section pr√©c√©dente¬†:</p>
</div>
<div class="listingblock data-line-418">
<div class="content">
<pre>$ bx base58check-encode 1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd01 --version 128
KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</pre>
</div>
</div>
<div class="paragraph data-line-423">
<p>Le format compress√© WIF r√©sultant commence par un "K". Cela indique que la cl√© priv√©e √† l&#8217;int√©rieur a un suffixe de "01" et sera utilis√©e pour produire des cl√©s publiques compress√©es uniquement (voir <a href="#comp_pub">Cl√©s publiques compress√©es</a>).</p>
</div>
</div>
<div class="sect4 data-line-425">
<h5 id="_formats_de_cl√©_publique">Formats de cl√© publique</h5>
<div class="paragraph data-line-427">
<p>Les cl√©s publiques sont √©galement pr√©sent√©es de diff√©rentes mani√®res, g√©n√©ralement sous forme de cl√©s publiques <em>compress√©es</em> ou <em>non compress√©es</em>.</p>
</div>
<div class="paragraph data-line-429">
<p>Comme nous l&#8217;avons vu pr√©c√©demment, la cl√© publique est un point de la courbe elliptique constitu√© d&#8217;un couple de coordonn√©es (x,y). Il est g√©n√©ralement pr√©sent√© avec le pr√©fixe <code>04</code> suivi de deux nombres de 256 bits¬†: un pour la coordonn√©e <em>x</em> du point, l&#8217;autre pour la coordonn√©e <em>y</em>. Le pr√©fixe <code>04</code> est utilis√© pour distinguer les cl√©s publiques non compress√©es des cl√©s publiques compress√©es qui commencent par un <code>02</code> ou un 03.</p>
</div>
<div class="paragraph data-line-431">
<p>Voici la cl√© publique g√©n√©r√©e par la cl√© priv√©e que nous avons cr√©√©e pr√©c√©demment, indiqu√©e par les coordonn√©es <code>x</code> et y¬†:</p>
</div>
<div class="listingblock data-line-433">
<div class="content">
<pre>x = F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A
y = 07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB</pre>
</div>
</div>
<div class="paragraph data-line-438">
<p>Voici la m√™me cl√© publique affich√©e sous la forme d&#8217;un nombre de 520¬†bits (130 chiffres hexad√©cimaux) avec le pr√©fixe <code>04</code> suivi de <code>x</code> puis des coordonn√©es y, sous la forme 04 x y¬†:</p>
</div>
<div class="listingblock data-line-440">
<div class="content">
<pre>K = 04F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A&amp;#x21b5;
07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB</pre>
</div>
</div>
</div>
<div class="sect4 data-line-446">
<h5 id="comp_pub">Cl√©s publiques compress√©es</h5>
<div class="paragraph data-line-448">
<p>Des cl√©s publiques compress√©es ont √©t√© introduites dans le bitcoin pour r√©duire la taille des transactions et √©conomiser de l&#8217;espace disque sur les n≈ìuds qui stockent la base de donn√©es de la cha√Æne de blocs Bitcoin. La plupart des transactions incluent la cl√© publique, qui est n√©cessaire pour valider les informations d&#8217;identification du propri√©taire et d√©penser le bitcoin. Chaque cl√© publique n√©cessite 520 bits (pr√©fixe ` x ` y), ce qui, multipli√© par plusieurs centaines de transactions par bloc, soit des dizaines de milliers de transactions par jour, ajoute une quantit√© importante de donn√©es √† la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-450">
<p>Comme nous l&#8217;avons vu dans la section <a href="#pubkey">Cl√©s publiques</a>, une cl√© publique est un point (x,y) sur une courbe elliptique. Parce que la courbe exprime une fonction math√©matique, un point sur la courbe repr√©sente une solution √† l&#8217;√©quation et, par cons√©quent, si nous connaissons la coordonn√©e <em>x</em>, nous pouvons calculer la coordonn√©e <em>y</em> en r√©solvant l&#8217;√©quation y<sup>2</sup> mod p = (x<sup>3</sup> + 7) mod p. Cela nous permet de stocker uniquement la coordonn√©e <em>x</em> du point de cl√© publique, en omettant la coordonn√©e <em>y</em> et en r√©duisant la taille de la cl√© et l&#8217;espace requis pour la stocker de 256 bits. Une r√©duction de pr√®s de 50¬†% de la taille de chaque transaction repr√©sente une grande quantit√© de donn√©es enregistr√©es au fil du temps¬†!</p>
</div>
<div class="paragraph data-line-452">
<p>Alors que les cl√©s publiques non compress√©es ont un pr√©fixe de 04, les cl√©s publiques compress√©es commencent par un pr√©fixe <code>02</code> ou 03. Regardons pourquoi il y a deux pr√©fixes possibles¬†: parce que le c√¥t√© gauche de l&#8217;√©quation est <em>y</em><sup>2</sup>, la solution pour <em>y</em> est une racine carr√©e, qui peut avoir une valeur positive ou n√©gative. Visuellement, cela signifie que la coordonn√©e <em>y</em> r√©sultante peut √™tre au-dessus ou au-dessous de l&#8217;axe des x. Comme vous pouvez le voir sur le graphique de la courbe elliptique en <a href="#ecc-curve">Une courbe elliptique</a>, la courbe est sym√©trique, c&#8217;est-√†-dire qu&#8217;elle est r√©fl√©chie comme par un miroir √† l&#8217;axe des abscisses. Ainsi, bien que nous puissions omettre la coordonn√©e <em>y</em>, nous devons stocker le <em>signe</em> de <em>y</em> (positif ou n√©gatif)¬†; ou en d&#8217;autres termes, nous devons nous rappeler si c&#8217;√©tait au-dessus ou au-dessous de l&#8217;axe des x parce que chacune de ces options repr√©sente un point diff√©rent et une cl√© publique diff√©rente. Lors du calcul de la courbe elliptique en arithm√©tique binaire sur le corps fini d&#8217;ordre premier p, la coordonn√©e <em>y</em> est paire ou impaire, ce qui correspond au signe positif/n√©gatif comme expliqu√© pr√©c√©demment. Ainsi, pour distinguer les deux valeurs possibles de <em>y</em>, on stocke une cl√© publique compress√©e avec le pr√©fixe <code>02</code> si le <em>y</em> est pair, et <code>03</code> s&#8217;il est impair, permettant au logiciel de d√©duire correctement la coordonn√©e <em>y</em> de la coordonn√©e <em>x</em> et de d√©compresser la cl√© publique aux coordonn√©es compl√®tes du point. La compression de cl√© publique est illustr√©e dans <a href="#pubkey_compression">Compression de cl√© publique</a>.</p>
</div>
<div class="paragraph data-line-454">
<p>Voici la m√™me cl√© publique g√©n√©r√©e pr√©c√©demment, pr√©sent√©e sous la forme d&#8217;une cl√© publique compress√©e stock√©e sur 264¬†bits (66¬†chiffres hexad√©cimaux) avec le pr√©fixe <code>03</code> indiquant que la coordonn√©e <em>y</em> est impaire¬†:</p>
</div>
<div class="listingblock data-line-456">
<div class="content">
<pre>K = 03F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A</pre>
</div>
</div>
<div class="paragraph data-line-460">
<p>Cette cl√© publique compress√©e correspond √† la m√™me cl√© priv√©e, c&#8217;est-√†-dire qu&#8217;elle est g√©n√©r√©e √† partir de la m√™me cl√© priv√©e. Cependant, il semble diff√©rent de la cl√© publique non compress√©e. Plus important encore, si nous convertissons cette cl√© publique compress√©e en une adresse Bitcoin √† l&#8217;aide de la fonction de double hachage (RIPEMD160(SHA256(K))), cela produira une adresse Bitcoin <em>diff√©rente</em>. Cela peut pr√™ter √† confusion, car cela signifie qu&#8217;une seule cl√© priv√©e peut produire une cl√© publique exprim√©e dans deux formats diff√©rents (compress√© et non compress√©) qui produisent deux adresses Bitcoin diff√©rentes. Cependant, la cl√© priv√©e est identique pour les deux adresses Bitcoin.</p>
</div>
<div id="pubkey_compression" class="imageblock smallerseventy data-line-465">
<div class="content">
<img src="images/mbc2_0407.png" alt="Compression de pubkey">
</div>
<div class="title">Figure 20. Compression de cl√© publique</div>
</div>
<div class="paragraph data-line-467">
<p>Les cl√©s publiques compress√©es deviennent progressivement la valeur par d√©faut pour les clients Bitcoin, ce qui a un impact significatif sur la r√©duction de la taille des transactions et donc de la cha√Æne de blocs. Cependant, tous les clients ne prennent pas encore en charge les cl√©s publiques compress√©es. Les clients plus r√©cents qui prennent en charge les cl√©s publiques compress√©es doivent comptabiliser les transactions des clients plus anciens qui ne prennent pas en charge les cl√©s publiques compress√©es. Ceci est particuli√®rement important lorsqu&#8217;une application de portefeuille importe des cl√©s priv√©es √† partir d&#8217;une autre application de portefeuille bitcoin, car le nouveau portefeuille doit analyser la cha√Æne de blocs pour trouver les transactions correspondant √† ces cl√©s import√©es. Quelles adresses Bitcoin le portefeuille Bitcoin doit-il rechercher ? Les adresses Bitcoin produites par des cl√©s publiques non compress√©es, ou les adresses Bitcoin produites par des cl√©s publiques compress√©es ? Les deux sont des adresses Bitcoin valides et peuvent √™tre sign√©es par la cl√© priv√©e, mais ce sont des adresses diff√©rentes !</p>
</div>
<div class="paragraph data-line-469">
<p>Pour r√©soudre ce probl√®me, lorsque des cl√©s priv√©es sont export√©es depuis un portefeuille, le WIF utilis√© pour les repr√©senter est impl√©ment√© diff√©remment dans les nouveaux portefeuilles Bitcoin, pour indiquer que ces cl√©s priv√©es ont √©t√© utilis√©es pour produire des cl√©s publiques <em>compress√©es</em> et donc des adresses Bitcoin <em>compress√©es</em>. Cela permet au portefeuille importateur de faire la distinction entre les cl√©s priv√©es provenant de portefeuilles plus anciens ou plus r√©cents et de rechercher dans la cha√Æne de blocs des transactions avec des adresses Bitcoin correspondant respectivement aux cl√©s publiques non compress√©es ou compress√©es. Voyons comment cela fonctionne plus en d√©tail, dans la section suivante.</p>
</div>
</div>
<div class="sect4 data-line-472">
<h5 id="comp_priv">Cl√©s priv√©es compress√©es</h5>
<div class="paragraph data-line-474">
<p>Ironiquement, le terme "cl√© priv√©e compress√©e" est un abus de langage, car lorsqu&#8217;une cl√© priv√©e est export√©e au format WIF compress√©, elle est en fait un octet <em>plus long</em> qu&#8217;une cl√© priv√©e "non compress√©e". C&#8217;est parce que la cl√© priv√©e a un suffixe d&#8217;un octet ajout√© (affich√© comme 01 en hexad√©cimal dans <a href="#table_4-4">Exemple¬†: m√™me cl√©, diff√©rents formats</a>), ce qui signifie que la cl√© priv√©e provient d&#8217;un portefeuille plus r√©cent et ne doit √™tre utilis√©e que pour produire des cl√©s publiques compress√©es. Les cl√©s priv√©es ne sont pas elles-m√™mes compress√©es et ne peuvent pas √™tre compress√©es. Le terme "cl√© priv√©e compress√©e" signifie en r√©alit√© "cl√© priv√©e √† partir de laquelle seules les cl√©s publiques compress√©es doivent √™tre d√©riv√©es", tandis que "cl√© priv√©e non compress√©e" signifie en r√©alit√© "cl√© priv√©e √† partir de laquelle seules les cl√©s publiques non compress√©es doivent √™tre d√©riv√©es". Vous devez uniquement faire r√©f√©rence au format d&#8217;exportation en tant que "WIF-compress√©" ou "WIF" et ne pas faire r√©f√©rence √† la cl√© priv√©e elle-m√™me en tant que "compress√©e" pour √©viter toute confusion suppl√©mentaire.</p>
</div>
<div class="paragraph data-line-476">
<p><a href="#table_4-4">Exemple¬†: m√™me cl√©, diff√©rents formats</a> affiche la m√™me cl√©, encod√©e aux formats WIF et WIF compress√©.</p>
</div>
<table id="table_4-4" class="tableblock frame-all grid-all stretch data-line-481">
<caption class="title">Table 4. Exemple¬†: m√™me cl√©, diff√©rents formats</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Format</th>
<th class="tableblock halign-left valign-top">Cl√© priv√©e</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hex-compress√©</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD01</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WIF compress√©</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-489">
<p>Notez que le format de cl√© priv√©e compress√©e en hexad√©cimal a un octet suppl√©mentaire √† la fin (01 en hexad√©cimal). Bien que le pr√©fixe de version Base58Check soit le m√™me (0x80) pour les formats WIF et WIF compress√©s, l&#8217;ajout d&#8217;un octet √† la fin du num√©ro fait passer le premier caract√®re de l&#8217;encodage Base58 de 5 √† <em>K</em> ou <em>L</em> . Consid√©rez cela comme l&#8217;√©quivalent Base58 de la diff√©rence de codage d√©cimal entre le nombre 100 et le nombre 99. Alors que 100 est un chiffre plus long que 99, il a √©galement un pr√©fixe de 1 au lieu d&#8217;un pr√©fixe de 9. Lorsque la longueur change, il affecte le pr√©fixe. En Base58, le pr√©fixe 5 se transforme en <em>K</em> ou <em>L</em> lorsque la longueur du nombre augmente d&#8217;un octet.</p>
</div>
<div class="paragraph data-line-491">
<p>N&#8217;oubliez pas que ces formats ne sont <em>pas</em> utilis√©s de mani√®re interchangeable. Dans un portefeuille plus r√©cent qui impl√©mente des cl√©s publiques compress√©es, les cl√©s priv√©es ne seront export√©es qu&#8217;au format WIF compress√© (avec un pr√©fixe <em>K</em> ou <em>L</em>). Si le portefeuille est une impl√©mentation plus ancienne et n&#8217;utilise pas de cl√©s publiques compress√©es, les cl√©s priv√©es ne seront export√©es qu&#8217;au format WIF (avec un pr√©fixe 5). Le but ici est de signaler au portefeuille qui importe ces cl√©s priv√©es s&#8217;il doit rechercher dans la cha√Æne de blocs des cl√©s et des adresses publiques compress√©es ou non.</p>
</div>
<div class="paragraph data-line-493">
<p>Si un portefeuille bitcoin est capable d&#8217;impl√©menter des cl√©s publiques compress√©es, il les utilisera dans toutes les transactions. Les cl√©s priv√©es du portefeuille seront utilis√©es pour d√©river les points de cl√© publique sur la courbe, qui seront compress√©s. Les cl√©s publiques compress√©es seront utilis√©es pour produire des adresses Bitcoin et celles-ci seront utilis√©es dans les transactions. Lors de l&#8217;exportation de cl√©s priv√©es √† partir d&#8217;un nouveau portefeuille qui impl√©mente des cl√©s publiques compress√©es, le WIF est modifi√©, avec l&#8217;ajout d&#8217;un suffixe d&#8217;un octet <code>01</code> √† la cl√© priv√©e. La cl√© priv√©e encod√©e en Base58Check qui en r√©sulte est appel√©e "WIF compress√©" et commence par la lettre <em>K</em> ou <em>L</em>, au lieu de commencer par "5" comme c&#8217;est le cas avec les cl√©s encod√©es en WIF (non compress√©es) des portefeuilles plus anciens.</p>
</div>
<div class="admonitionblock tip data-line-497">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-498">
<p>"Cl√©s priv√©es compress√©es" est un terme impropre¬†! Ils ne sont pas compress√©s ; au lieu de cela, WIF-compress√© signifie que les cl√©s ne doivent √™tre utilis√©es que pour d√©river des cl√©s publiques compress√©es et leurs adresses Bitcoin correspondantes. Ironiquement, une cl√© priv√©e cod√©e "compress√©e en WIF" est plus longue d&#8217;un octet car elle a le suffixe <code>01</code> ajout√© pour la distinguer d&#8217;une cl√© "non compress√©e".</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-501">
<h3 id="_impl√©mentation_des_cl√©s_et_des_adresses_dans_c">Impl√©mentation des cl√©s et des adresses dans C++</h3>
<div class="paragraph data-line-503">
<p>Regardons le processus complet de cr√©ation d&#8217;une adresse Bitcoin, d&#8217;une cl√© priv√©e, √† une cl√© publique (un point sur la courbe elliptique), √† une adresse √† hachage double, et enfin, l&#8217;encodage Base58Check. Le code C++ dans <a href="#addr_example">Cr√©ation d&#8217;une adresse Bitcoin encod√©e en Base58Check √† partir d&#8217;une cl√© priv√©e</a> montre le processus complet √©tape par √©tape, de la cl√© priv√©e √† l&#8217;adresse Bitcoin encod√©e en Base58Check. L&#8217;exemple de code utilise la biblioth√®que libbitcoin introduite dans <a href="#alt_libraries">Clients, biblioth√®ques et bo√Ætes √† outils alternatifs</a> pour certaines fonctions d&#8217;assistance.</p>
</div>
<div id="addr_example" class="exampleblock data-line-507">
<div class="title">Example 10. Cr√©ation d&#8217;une adresse Bitcoin encod√©e en Base58Check √† partir d&#8217;une cl√© priv√©e</div>
<div class="content">
<div class="listingblock c_less_space data-line-510">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;bitcoin/bitcoin.hpp&gt;

int main()
{
    // Cha√Æne de cl√© secr√®te priv√©e en base16
    bc::ec_secret decoded;
    bc::decode_base16(decoded,
        "038109007313a5807b2eccc082c8c3fbb988a973cacf1a7df9ce725c31b14776");

    bc::wallet::ec_private secret(
        decoded, bc::wallet::ec_private::mainnet_p2kh);

    // Obtenir la cl√© publique.
    bc::wallet::ec_public public_key(secret);
    std::cout &lt;&lt; "Public key: " &lt;&lt; public_key.encoded() &lt;&lt; std::endl;

    // Cr√©er une adresse Bitcoin.
    // Normalement, vous pouvez utiliser :
    //    bc::wallet::payment_address payaddr =
    //        public_key.to_payment_address(
    //            bc::wallet::ec_public::mainnet_p2kh);
    //  const std::string address = payaddr.encoded();

    // Calcule le hachage de la cl√© publique pour l'adresse P2PKH.
    bc::data_chunk public_key_data;
    public_key.to_data(public_key_data);
    const auto hash = bc::bitcoin_short_hash(public_key_data);

    bc::data_chunk unencoded_address;
    // R√©server 25 octets
    //   [ version:1  ]
    //   [ hash:20    ]
    //   [ checksum:4 ]
    unencoded_address.reserve(25);
    // Octet de version, 0 est l'adresse BTC normale (P2PKH).
    unencoded_address.push_back(0);
    // Donn√©es de hachage
    bc::extend_data(unencoded_address, hash);
    // La somme de contr√¥le est calcul√©e en hachant les donn√©es et en ajoutant 4 octets √† partir du hachage.
    bc::append_checksum(unencoded_address);
    // Enfin, nous devons encoder le r√©sultat dans l'encodage base58 de Bitcoin.
    assert(unencoded_address.size() == 25);
    const std::string address = bc::encode_base58(unencoded_address);

    std::cout &lt;&lt; "Address: " &lt;&lt; address &lt;&lt; std::endl;
    return 0;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-515">
<p>Le code utilise une cl√© priv√©e pr√©d√©finie pour produire la m√™me adresse Bitcoin √† chaque ex√©cution, comme indiqu√© dans <a href="#addr_example_run">Compilation et ex√©cution du code addr</a>.</p>
</div>
<div id="addr_example_run" class="exampleblock data-line-519">
<div class="title">Example 11. Compilation et ex√©cution du code addr</div>
<div class="content">
<div class="listingblock data-line-521">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Compiler le code addr.cpp
$ g++ -o addr addr.cpp -std=c++11 $(pkg-config --cflags --libs libbitcoin)
# Lancer l'ex√©cutable addr
$ ./addr
Public key: 0202a406624211f2abbdc68da3df929f938c3399dd79fac1b51b0e4ad1d26a47aa
Address: 1PRTTaJesdNovgne6Ehcdu1fpEdX7913CK</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip data-line-532">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-533">
<p>Le code dans <a href="#addr_example_run">Compilation et ex√©cution du code addr</a> produit une adresse Bitcoin (1PRTT...) √† partir d&#8217;une cl√© publique <em>compress√©e</em> (voir <a href="#comp_pub">Cl√©s publiques compress√©es</a>). Si vous utilisiez la cl√© publique non compress√©e √† la place, cela produirait une adresse Bitcoin diff√©rente (14K1y...).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 data-line-536">
<h3 id="_impl√©menter_des_cl√©s_et_des_adresses_en_python">Impl√©menter des cl√©s et des adresses en Python</h3>
<div class="paragraph data-line-538">
<p> La biblioth√®que bitcoin la plus compl√®te en Python est <a href="https://github.com/vbuterin/pybitcointools" data-href="https://github.com/vbuterin/pybitcointools">pybitcointools</a> par Vitalik Buterin. Dans <a href="#key-to-address_script">G√©n√©ration et formatage de cl√©s et d&#8217;adresses avec la biblioth√®que pybitcointools</a>, nous utilisons la biblioth√®que pybitcointools (import√©e en tant que "bitcoin") pour g√©n√©rer et afficher des cl√©s et des adresses dans diff√©rents formats.</p>
</div>
<div id="key-to-address_script" class="exampleblock data-line-542">
<div class="title">Example 12. G√©n√©ration et formatage de cl√©s et d&#8217;adresses avec la biblioth√®que pybitcointools</div>
<div class="content">
<div class="listingblock data-line-544">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import bitcoin

# G√©n√©rer une cl√© priv√©e al√©atoire
valid_private_key = False
while not valid_private_key:
    private_key = bitcoin.random_key()
    decoded_private_key = bitcoin.decode_privkey(private_key, 'hex')
    valid_private_key =  0 &lt; decoded_private_key &lt; bitcoin.N

print "Private Key (hex) is: ", private_key
print "Private Key (decimal) is: ", decoded_private_key

# Convertir la cl√© priv√©e au format WIF
wif_encoded_private_key = bitcoin.encode_privkey(decoded_private_key, 'wif')
print "Private Key (WIF) is: ", wif_encoded_private_key

# Ajouter le suffixe "01" pour indiquer une cl√© priv√©e compress√©e
compressed_private_key = private_key + '01'
print "Private Key Compressed (hex) is: ", compressed_private_key

# G√©n√©rer un format WIF √† partir de la cl√© priv√©e compress√©e (WIF-compress√©)
wif_compressed_private_key = bitcoin.encode_privkey(
    bitcoin.decode_privkey(compressed_private_key, 'hex'), 'wif')
print "Private Key (WIF-Compressed) is: ", wif_compressed_private_key

# Multipliez le point g√©n√©rateur EC G avec la cl√© priv√©e pour obtenir un point de cl√© publique
public_key = bitcoin.fast_multiply(bitcoin.G, decoded_private_key)
print "Public Key (x,y) coordinates is:", public_key

# Encoder en hexad√©cimal, pr√©fixe 04
hex_encoded_public_key = bitcoin.encode_pubkey(public_key,'hex')
print "Public Key (hex) is:", hex_encoded_public_key

# Compressez la cl√© publique, ajustez le pr√©fixe selon que y est pair ou impair
(public_key_x, public_key_y) = public_key
if (public_key_y % 2) == 0:
    compressed_prefix = '02'
else:
    compressed_prefix = '03'
hex_compressed_public_key = compressed_prefix + bitcoin.encode(public_key_x, 16)
print "Compressed Public Key (hex) is:", hex_compressed_public_key

# G√©n√©rer une adresse bitcoin √† partir de la cl√© publique
print "Bitcoin Address (b58check) is:", bitcoin.pubkey_to_address(public_key)

# G√©n√©rer une adresse bitcoin compress√©e √† partir d'une cl√© publique compress√©e
print "Compressed Bitcoin Address (b58check) is:", \
    bitcoin.pubkey_to_address(hex_compressed_public_key)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-549">
<p><a href="#key-to-address_script_run">Ex√©cution de key-to-address-ecc-example.py</a> affiche la sortie de l&#8217;ex√©cution de ce code.</p>
</div>
<div id="key-to-address_script_run" class="exampleblock data-line-553">
<div class="title">Example 13. Ex√©cution de key-to-address-ecc-example.py</div>
<div class="content">
<div class="listingblock data-line-554">
<div class="content">
<pre>$ python key-to-address-ecc-example.py
Private Key (hex) is:
 3aba4162c7251c891207b747840551a71939b0de081f85c4e44cf7c13e41daa6
Private Key (decimal) is:
 26563230048437957592232553826663696440606756685920117476832299673293013768870
Private Key (WIF) is:
 5JG9hT3beGTJuUAmCQEmNaxAuMacCTfXuw1R3FCXig23RQHMr4K
Private Key Compressed (hex) is:
 3aba4162c7251c891207b747840551a71939b0de081f85c4e44cf7c13e41daa601
Private Key (WIF-Compressed) is:
 KyBsPXxTuVD82av65KZkrGrWi5qLMah5SdNq6uftawDbgKa2wv6S
Public Key (x,y) coordinates is:
 (41637322786646325214887832269588396900663353932545912953362782457239403430124L,
 16388935128781238405526710466724741593761085120864331449066658622400339362166L)
Public Key (hex) is:
 045c0de3b9c8ab18dd04e3511243ec2952002dbfadc864b9628910169d9b9b00ec&amp;#x21b5;
243bcefdd4347074d44bd7356d6a53c495737dd96295e2a9374bf5f02ebfc176
Compressed Public Key (hex) is:
 025c0de3b9c8ab18dd04e3511243ec2952002dbfadc864b9628910169d9b9b00ec
Bitcoin Address (b58check) is:
 1thMirt546nngXqyPEz532S8fLwbozud8
Compressed Bitcoin Address (b58check) is:
 14cxpo3MBCYYWCgF74SWTdcmxipnGUsPw3</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-582">
<p><a href="#ec_math">Un script d√©montrant les math√©matiques de la courbe elliptique utilis√©es pour les cl√©s bitcoin</a> est un autre exemple, utilisant la biblioth√®que Python ECDSA pour les math√©matiques de la courbe elliptique et sans utiliser de biblioth√®ques bitcoin sp√©cialis√©es.</p>
</div>
<div id="ec_math" class="exampleblock data-line-586">
<div class="title">Example 14. Un script d√©montrant les math√©matiques de la courbe elliptique utilis√©es pour les cl√©s bitcoin</div>
<div class="content">
<div class="listingblock data-line-588">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import ecdsa
import os
from ecdsa.util import string_to_number, number_to_string

# secp256k1, http://www.oid-info.com/get/1.3.132.0.10
_p = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2FL
_r = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141L
_b = 0x0000000000000000000000000000000000000000000000000000000000000007L
_a = 0x0000000000000000000000000000000000000000000000000000000000000000L
_Gx = 0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798L
_Gy = 0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8L
curve_secp256k1 = ecdsa.ellipticcurve.CurveFp(_p, _a, _b)
generator_secp256k1 = ecdsa.ellipticcurve.Point(curve_secp256k1, _Gx, _Gy, _r)
oid_secp256k1 = (1, 3, 132, 0, 10)
SECP256k1 = ecdsa.curves.Curve("SECP256k1", curve_secp256k1, generator_secp256k1, oid_secp256k1)
ec_order = _r

curve = curve_secp256k1
generator = generator_secp256k1

def random_secret():
    convert_to_int = lambda array: int("".join(array).encode("hex"), 16)

    # Collectez 256 bits de donn√©es al√©atoires √† partir du g√©n√©rateur al√©atoire cryptographiquement s√©curis√© du syst√®me d'exploitation
    byte_array = os.urandom(32)

    return convert_to_int(byte_array)

def get_point_pubkey(point):
    if point.y() &amp; 1:
        key = '03' + '%064x' % point.x()
    else:
        key = '02' + '%064x' % point.x()
    return key.decode('hex')

def get_point_pubkey_uncompressed(point):
    key = '04' + \
          '%064x' % point.x() + \
          '%064x' % point.y()
    return key.decode('hex')


# G√©n√©rez une nouvelle cl√© priv√©e.
secret = random_secret()
print "Secret: ", secret

# Obtenez le point de cl√© publique.
point = secret * generator
print "EC point:", point

print "BTC public key:", get_point_pubkey(point).encode("hex")

# √âtant donn√© le point (x, y), nous pouvons cr√©er l'objet en utilisant¬†:
point1 = ecdsa.ellipticcurve.Point(curve, point.x(), point.y(), ec_order)
assert point1 == point</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-593">
<p><a href="#ec_math_run">Installation de la biblioth√®que Python ECDSA et ex√©cution du script ec_math.py</a> affiche la sortie produite en ex√©cutant ce script.</p>
</div>
<div class="admonitionblock warning data-line-596">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-597">
<p><a href="#ec_math">Un script d√©montrant les math√©matiques de la courbe elliptique utilis√©es pour les cl√©s bitcoin</a> utilise os.urandom, qui refl√®te un g√©n√©rateur de nombres al√©atoires cryptographiquement s√©curis√© (CSRNG) fourni par le syst√®me d&#8217;exploitation sous-jacent. Attention¬†: Selon le syst√®me d&#8217;exploitation, <code>os.urandom</code> peut <em>ne pas</em> √™tre impl√©ment√© avec une s√©curit√© suffisante ou correctement amorc√© et peut <em>ne pas</em> √™tre appropri√© pour g√©n√©rer des cl√©s bitcoin de qualit√© production.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="ec_math_run" class="exampleblock data-line-602">
<div class="title">Example 15. Installation de la biblioth√®que Python ECDSA et ex√©cution du script ec_math.py</div>
<div class="content">
<div class="listingblock data-line-603">
<div class="content">
<pre># Installer le gestionnaire de packages Python PIP
$ sudo apt-get install python-pip
# Installer la biblioth√®que Python ECDSA
$ sudo pip install ecdsa
# Ex√©cuter le script
$ python ec-math.py
Secret:  38090835015954358862481132628887443905906204995912378278060168703580660294000
EC point: (70048853531867179489857750497606966272382583471322935454624595540007269312627, 105262206478686743191060800263479589329920209527285803935736021686045542353380)
BTC public key: 029ade3effb0a67d5c8609850d797366af428f4a0d5194cb221d807770a1522873</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-616">
<h3 id="_cl√©s_et_adresses_avanc√©es">Cl√©s et adresses avanc√©es</h3>
<div class="paragraph data-line-618">
<p>Dans les sections suivantes, nous examinerons les formes avanc√©es de cl√©s et d&#8217;adresses, telles que les cl√©s priv√©es crypt√©es, les adresses de script et des multisignatures, les adresses personnalis√©es, et les portefeuilles en papier.</p>
</div>
<div class="sect3 data-line-621">
<h4 id="p2sh_addresses">Pay-to-Script Hash (P2SH) et adresses multisig</h4>
<div class="paragraph data-line-623">
<p>("Pay-to-Script-Hash (P2SH)", "adresses multisig et")Comme nous le savons, les adresses Bitcoin traditionnelles commencent par le chiffre "1" et sont d√©riv√©es de la cl√© publique, qui est d√©riv√© de la cl√© priv√©e. Bien que n&#8217;importe qui puisse envoyer des bitcoins √† une adresse "1", ce bitcoin ne peut √™tre d√©pens√© qu&#8217;en pr√©sentant la signature de la cl√© priv√©e et la cl√© publique correspondantes.</p>
</div>
<div class="paragraph data-line-625">
<p>Les adresses Bitcoin qui commencent par le chiffre "3" sont des adresses Pay-to-Script Hash (P2SH ou hachage de paiement-√†-script), parfois appel√©es √† tort adresses multisig ou adresses multisignatures. Ils d√©signent le b√©n√©ficiaire d&#8217;une transaction bitcoin comme le hachage d&#8217;un script, au lieu du propri√©taire d&#8217;une cl√© publique. La fonctionnalit√© a √©t√© introduite en janvier 2012 avec BIP-16 (voir <a href="#appdxbitcoinimpproposals">Bitcoin Improvement Proposals (ou Propositions d&#8217;am√©lioration du Bitcoin)</a>), et est largement adopt√© car il offre la possibilit√© d&#8217;ajouter des fonctionnalit√©s √† l&#8217;adresse elle-m√™me. Contrairement aux transactions qui "envoient" des fonds aux adresses Bitcoin traditionnelles "1", √©galement connues sous le nom de hachage de cl√© publique (P2PKH), les fonds envoy√©s aux adresses "3" n√©cessitent quelque chose de plus que la pr√©sentation d&#8217;une cl√© publique et une signature de cl√© priv√©e comme preuve de propri√©t√©. Les exigences sont d√©sign√©es au moment de la cr√©ation de l&#8217;adresse, dans le script, et toutes les entr√©es de cette adresse seront encombr√©es des m√™mes exigences.</p>
</div>
<div class="paragraph data-line-627">
<p>Une adresse P2SH est cr√©√©e √† partir d&#8217;un script de transaction, qui d√©finit qui peut d√©penser une sortie de transaction (pour plus de d√©tails, voir <a href="#p2sh">Pay-to-Script-Hash (P2SH)</a>). L&#8217;encodage d&#8217;une adresse P2SH consiste √† utiliser la m√™me fonction de double hachage que celle utilis√©e lors de la cr√©ation d&#8217;une adresse Bitcoin, appliqu√©e uniquement sur le script √† la place de la cl√© publique :</p>
</div>
<div class="listingblock data-line-629">
<div class="content">
<pre>hachage de script = RIPEMD160(SHA256(script))</pre>
</div>
</div>
<div class="paragraph data-line-633">
<p>Le "hachage de script" r√©sultant est encod√© avec Base58Check avec un pr√©fixe de version de 5, ce qui donne une adresse encod√©e commen√ßant par un 3. Un exemple d&#8217;adresse P2SH est 3F6i6kwkevjR7AsAd4te2YB2zZyASEm1HM, qui peut √™tre d√©riv√©e √† l&#8217;aide des commandes Bitcoin Explorer script-encode, sha256, <code>ripemd160</code> et <code>base58check-encode</code> (voir <a href="#appdx_bx">Commandes de l&#8217;explorateur Bitcoin (bx)</a>) comme suit¬†:</p>
</div>
<div class="listingblock data-line-635">
<div class="content">
<pre>$ echo \
'DUP HASH160 [89abcdefabbaabbaabbaabbaabbaabbaabbaabba] EQUALVERIFY CHECKSIG' &gt; script
$ bx script-encode &lt; script | bx sha256 | bx ripemd160 \
| bx base58check-encode --version 5
3F6i6kwkevjR7AsAd4te2YB2zZyASEm1HM</pre>
</div>
</div>
<div class="admonitionblock tip data-line-644">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-645">
<p>P2SH n&#8217;est pas n√©cessairement la m√™me chose qu&#8217;une transaction standard multisignature. Une adresse P2SH repr√©sente <em>le plus souvent</em> un script multi-signatures, mais elle peut √©galement repr√©senter un script codant d&#8217;autres types de transactions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4 data-line-648">
<h5 id="_adresses_multisignatures_et_p2sh">Adresses multisignatures et P2SH</h5>
<div class="paragraph data-line-650">
<p>Actuellement, l&#8217;impl√©mentation la plus courante de la fonction P2SH est le script d&#8217;adresse multisignature. Comme son nom l&#8217;indique, le script sous-jacent n√©cessite un nombre minimum de signatures pour prouver la propri√©t√© et donc d√©penser des fonds. La fonctionnalit√© de multisignature bitcoin est con√ßue pour exiger M signatures (√©galement appel√©es ¬´seuil¬ª) √† partir d&#8217;un total de N cl√©s, appel√©es multisig M-de-N, o√π M est √©gal ou inf√©rieur √† N. Par exemple , Bob le propri√©taire du caf√© de <a href="#ch01_intro_what_is_bitcoin">Pr√©sentation</a> pourrait utiliser une adresse multisignature n√©cessitant 1 sur 2 signatures d&#8217;une cl√© lui appartenant et d&#8217;une cl√© appartenant √† son ou sa conjointe, garantissant que l&#8217;un ou l&#8217;autre pourrait signer pour passer une sortie de transaction verrouill√©e √† cette adresse. Cela ressemblerait √† un ¬´compte conjoint¬ª tel qu&#8217;il est mis en ≈ìuvre dans les banques traditionnelles o√π l&#8217;un ou l&#8217;autre des conjoints peut d√©penser avec une seule signature. Gopesh, le concepteur Web pay√© par Bob pour cr√©er un site Web, pourrait avoir une adresse multisignature 2 sur 3 pour son entreprise qui garantit qu&#8217;aucun fonds ne peut √™tre d√©pens√© √† moins qu&#8217;au moins deux des partenaires commerciaux ne signent une transaction.</p>
</div>
<div class="paragraph data-line-652">
<p>Nous explorerons comment cr√©er des transactions qui d√©pensent des fonds √† partir d&#8217;adresses P2SH (et multisignatures) dans <a href="#transactions">Op√©rations</a>.</p>
</div>
</div>
</div>
<div class="sect3 data-line-654">
<h4 id="_adresses_personnalis√©es">Adresses personnalis√©es</h4>
<div class="paragraph data-line-656">
<p>Les adresses personnalis√©es sont des adresses Bitcoin valides qui contiennent des messages lisibles par l&#8217;homme. Par exemple, <code>1LoveBPzzD72PUXLzCkYAtGFYmK5vYNR33</code> est une adresse valide qui contient les lettres formant le mot "Love" comme les quatre premi√®res lettres Base58. Les adresses personnalis√©es n√©cessitent de g√©n√©rer et de tester des milliards de cl√©s priv√©es candidates, jusqu&#8217;√† ce qu&#8217;une adresse Bitcoin avec le mod√®le souhait√© soit trouv√©e. Bien qu&#8217;il y ait quelques optimisations dans l&#8217;algorithme de g√©n√©ration de vanit√©, le processus consiste essentiellement √† choisir une cl√© priv√©e au hasard, √† d√©river la cl√© publique, √† d√©river l&#8217;adresse Bitcoin et √† v√©rifier si elle correspond au mod√®le de vanit√© souhait√©, en r√©p√©tant des milliards de fois jusqu&#8217;√† ce qu&#8217;un correspondance est trouv√©e.</p>
</div>
<div class="paragraph data-line-658">
<p>Une fois qu&#8217;une adresse personnalis√©e correspondant au mod√®le souhait√© est trouv√©e, la cl√© priv√©e dont elle est d√©riv√©e peut √™tre utilis√©e par le propri√©taire pour d√©penser des bitcoins exactement de la m√™me mani√®re que n&#8217;importe quelle autre adresse. Les adresses personnalis√©es ne sont ni moins ni plus s√©curis√©es que toute autre adresse. Ils d√©pendent de la m√™me cryptographie √† courbe elliptique (ECC) et SHA que toute autre adresse. Vous ne pouvez pas plus facilement trouver la cl√© priv√©e d&#8217;une adresse commen√ßant par un mod√®le de vanit√© que vous ne le pouvez de n&#8217;importe quelle autre adresse.</p>
</div>
<div class="paragraph data-line-660">
<p>Dans <a href="#ch01_intro_what_is_bitcoin">Pr√©sentation</a>, nous avons pr√©sent√© Eugenia, directrice d&#8217;une association caritative pour enfants op√©rant aux Philippines. Disons qu&#8217;Eugenia organise une collecte de fonds en bitcoins et souhaite utiliser une adresse personnalis√©e Bitcoin pour faire conna√Ætre la collecte de fonds. Eugenia cr√©era une adresse de vanit√© qui commence par "1Kids" pour promouvoir la collecte de fonds caritative pour les enfants. Voyons comment cette adresse personnalis√©e sera cr√©√©e et ce que cela signifie pour la s√©curit√© de l&#8217;association caritative d&#8217;Eugenia.</p>
</div>
<div class="sect4 data-line-662">
<h5 id="_g√©n√©ration_dadresses_personnalis√©es">G√©n√©ration d&#8217;adresses personnalis√©es</h5>
<div class="paragraph data-line-664">
<p>Il est important de r√©aliser qu&#8217;une adresse Bitcoin est simplement un nombre repr√©sent√© par des symboles dans l&#8217;alphabet Base58. La recherche d&#8217;un mod√®le comme "1Kids" peut √™tre consid√©r√©e comme la recherche d&#8217;une adresse comprise entre <code>1Kids1111111111111111111111111111</code> et 1Kidszzzzzzzzzzzzzzzzzzzzzzzzzz. Il y a environ 58 ^ 29 ^ (environ 1,4 * 10 ^ 51 ^) adresses dans cette plage, toutes commen√ßant par "1Kids". <a href="#table_4-11">La plage d&#8217;adresses personnalis√©es (ou de vanit√©s) commen√ßant par "1Kids"</a> affiche la plage d&#8217;adresses qui ont le pr√©fixe 1Kids.</p>
</div>
<table id="table_4-11" class="tableblock frame-all grid-all stretch data-line-668">
<caption class="title">Table 5. La plage d&#8217;adresses personnalis√©es (ou de vanit√©s) commen√ßant par "1Kids"</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>De</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Kids11111111111111111111111111111</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Kids11111111111111111111111111112</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Kids11111111111111111111111111113</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">...</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>√Ä</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Kidszzzzzzzzzzzzzzzzzzzzzzzzzzzzz</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-676">
<p>Regardons le mod√®le "1Kids" comme un nombre et voyons √† quelle fr√©quence nous pourrions trouver ce mod√®le dans une adresse Bitcoin (voir <a href="#table_4-12">La fr√©quence d&#8217;un mod√®le de vanit√© (1KidsCharity) et le temps de recherche moyen sur un PC de bureau</a>). Un ordinateur de bureau moyen, sans aucun mat√©riel sp√©cialis√©, peut rechercher environ 100 000 cl√©s par seconde.</p>
</div>
<table id="table_4-12" class="tableblock frame-all grid-all stretch data-line-681">
<caption class="title">Table 6. La fr√©quence d&#8217;un mod√®le de vanit√© (1KidsCharity) et le temps de recherche moyen sur un PC de bureau</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Longueur</th>
<th class="tableblock halign-left valign-top">Motif</th>
<th class="tableblock halign-left valign-top">Fr√©quence</th>
<th class="tableblock halign-left valign-top">Temps de recherche moyen</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 58 touches</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; 1 millisecondes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Ki</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 3 364</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50 millisecondes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Kid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 195 000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; 2 secondes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Kids</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 11 millions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 minute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1KidsC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 656 millions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 heure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1KidsCh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 38 milliards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 jours</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1KidsCha</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 2,2 trillions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3‚Äì4 mois</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1KidsChar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 128 billions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13‚Äì18 ans</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1KidsChari</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 7 quadrillions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">800 ans</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1KidsCharit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 400 quadrillions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">46 000 ans</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1KidsCharity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 sur 23 quintillions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2,5 millions d&#8217;ann√©es</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-697">
<p>Comme vous pouvez le voir, Eugenia ne cr√©era pas de sit√¥t l&#8217;adresse personnalis√©e "1KidsCharity", m√™me si elle avait acc√®s √† plusieurs milliers d&#8217;ordinateurs. Chaque caract√®re suppl√©mentaire augmente la difficult√© d&#8217;un facteur de 58. Les mod√®les de plus de sept caract√®res sont g√©n√©ralement trouv√©s par du mat√©riel sp√©cialis√©, tel que des ordinateurs de bureau personnalis√©s avec plusieurs GPU. Ce sont souvent des "plates-formes" de minage de bitcoin r√©utilis√©es qui ne sont plus rentables pour le minage de bitcoin mais peuvent √™tre utilis√©es pour trouver des adresses personnalis√©es. Les recherches d&#8217;adresse personnalis√©es (ou de vanit√©s) sur les syst√®mes GPU sont de plusieurs ordres de grandeur plus rapides que sur un processeur √† usage g√©n√©ral.</p>
</div>
<div class="paragraph data-line-699">
<p>Une autre fa√ßon de trouver une adresse de vanit√© consiste √† sous-traiter le travail √† un groupe ou bassin de mineurs de vanit√©, comme le groupe sur <a href="https://vanitypool.appspot.com" data-href="https://vanitypool.appspot.com">Vanity Pool</a>. Un groupe ou bassin de ce type est un service qui permet √† ceux qui disposent de mat√©riel GPU de gagner des bitcoins en recherchant des adresses personnalis√©es pour les autres. Pour un petit paiement (0,01 bitcoin ou environ 5¬†$ au moment d&#8217;√©crire ces lignes), Eugenia peut externaliser la recherche d&#8217;une adresse personnalis√©e √† sept caract√®res et obtenir des r√©sultats en quelques heures au lieu d&#8217;avoir √† ex√©cuter une recherche de CPU pendant des mois.</p>
</div>
<div class="paragraph data-line-701">
<p>G√©n√©rer une adresse personnalis√©e est un exercice de force brute¬†: essayez une cl√© al√©atoire, v√©rifiez l&#8217;adresse r√©sultante pour voir si elle correspond au mod√®le souhait√©, et r√©p√©tez jusqu&#8217;√† ce que vous r√©ussissiez. <a href="#vanity_miner_code">Mineur d&#8217;adresse personnalis√©es (ou de vanit√©)</a> montre un exemple de "mineur de vanit√©", un programme con√ßu pour trouver des adresses personnalis√©es, √©crit en C++. L&#8217;exemple utilise la biblioth√®que libbitcoin, que nous avons introduite dans <a href="#alt_libraries">Clients, biblioth√®ques et bo√Ætes √† outils alternatifs</a>.</p>
</div>
<div id="vanity_miner_code" class="exampleblock data-line-705">
<div class="title">Example 16. Mineur d&#8217;adresse personnalis√©es (ou de vanit√©)</div>
<div class="content">
<div class="listingblock data-line-707">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;random&gt;
#include &lt;bitcoin/bitcoin.hpp&gt;

// La cha√Æne que nous recherchons
const std::string search = "1kid";

// G√©n√©rer une cl√© secr√®te al√©atoire. Un 32 octets al√©atoires.
bc::ec_secret random_secret(std::default_random_engine&amp; engine);
// Extraire l'adresse Bitcoin d'un secret EC.
std::string bitcoin_address(const bc::ec_secret&amp; secret);
// Comparaison insensible √† la casse avec la cha√Æne de recherche.
bool match_found(const std::string&amp; address);

int main()
{
    // random_device sous Linux utilise "/dev/urandom"
    // ATTENTION¬†: selon la mise en ≈ìuvre, ce RNG peut ne pas √™tre suffisamment s√©curis√©¬†!
    // Ne pas utiliser les cl√©s personnalis√©es g√©n√©r√©es par cet exemple en production
    std::random_device random;
    std::default_random_engine engine(random());

    // Boucle en continu...
    while (true)
    {
        // G√©n√©rer un secret al√©atoire.
        bc::ec_secret secret = random_secret(engine);
        // Obtenez l'adresse.
        std::string address = bitcoin_address(secret);
        // Correspond-il √† votre cha√Æne de recherche¬†? (1kid)
        if (match_found(address))
        {
            // Succ√®s!
            std::cout &lt;&lt; "Found vanity address! " &lt;&lt; address &lt;&lt; std::endl;
            std::cout &lt;&lt; "Secret: " &lt;&lt; bc::encode_base16(secret) &lt;&lt; std::endl;
            return 0;
        }
    }
    // Ne devrait jamais arriver ici¬†!
    return 0;
}

bc::ec_secret random_secret(std::default_random_engine&amp; engine)
{
    // Cr√©er un nouveau secret...
    bc::ec_secret secret;
    // It√©rer sur chaque octet en d√©finissant une valeur al√©atoire...
    for (uint8_t&amp; byte: secret)
        byte = engine() % std::numeric_limits&lt;uint8_t&gt;::max();
    // Renvoyer le r√©sultat.
    return secret;
}

std::string bitcoin_address(const bc::ec_secret&amp; secret)
{
    // Convertir le secret en adresse de paiement
    bc::wallet::ec_private private_key(secret);
    bc::wallet::payment_address payaddr(private_key);
    // Retourner le formulaire encod√©.
    return payaddr.encoded();
}

bool match_found(const std::string&amp; address)
{
    auto addr_it = address.begin();
    // Parcourez la cha√Æne de recherche en la comparant au caract√®re minuscule de l'adresse fournie.
    for (auto it = search.begin(); it != search.end(); ++it, ++addr_it)
        if (*it != std::tolower(*addr_it))
            return false;
    // Fin de la cha√Æne de recherche atteinte, donc l'adresse correspond.
    return true;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note data-line-713">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-714">
<p><a href="#vanity_miner_code">Mineur d&#8217;adresse personnalis√©es (ou de vanit√©)</a> utilise std::random_device. Selon l&#8217;impl√©mentation, cela peut refl√©ter un CSRNG fourni par le syst√®me d&#8217;exploitation sous-jacent. Dans le cas d&#8217;un syst√®me d&#8217;exploitation de type Unix tel que Linux, il tire de /dev/urandom. Le g√©n√©rateur de nombres al√©atoires utilis√© ici est √† des fins de d√©monstration n&#8217;est <em>pas</em> appropri√© pour g√©n√©rer des cl√©s bitcoin de qualit√© production car il n&#8217;est pas impl√©ment√© avec une s√©curit√© suffisante.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-717">
<p>L&#8217;exemple de code doit √™tre compil√© √† l&#8217;aide d&#8217;un compilateur C++ et li√© √† la biblioth√®que libbitcoin (qui doit d&#8217;abord √™tre install√©e sur ce syst√®me). Pour ex√©cuter l&#8217;exemple, lancez l&#8217;ex√©cutable vanity-miner sans param√®tres (voir <a href="#vanity_miner_run">Compilation et ex√©cution de l&#8217;exemple vanity-miner</a>) et il tentera de trouver une adresse personnalis√©e commen√ßant par "1kid".</p>
</div>
<div id="vanity_miner_run" class="exampleblock data-line-721">
<div class="title">Example 17. Compilation et ex√©cution de l&#8217;exemple vanity-miner</div>
<div class="content">
<div class="listingblock data-line-723">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Compiler le code avec g++
$ g++ -o vanity-miner vanity-miner.cpp $(pkg-config --cflags --libs libbitcoin)
# Ex√©cutez l'exemple
$ ./vanity-miner
Found vanity address! 1KiDzkG4MxmovZryZRj8tK81oQRhbZ46YT
Secret: 57cc268a05f83a23ac9d930bc8565bac4e277055f4794cbd1a39e5e71c038f3f
# Ex√©cutez-le √† nouveau pour un r√©sultat diff√©rent
$ ./vanity-miner
Found vanity address! 1Kidxr3wsmMzzouwXibKfwTYs5Pau8TUFn
Secret: 7f65bbbbe6d8caae74a0c6a0d2d7b5c6663d71b60337299a1a2cf34c04b2a623
# Utilisez "time" pour voir combien de temps il faut pour trouver un r√©sultat
$ time ./vanity-miner
Found vanity address! 1KidPWhKgGRQWD5PP5TAnGfDyfWp5yceXM
Secret: 2a802e7a53d8aa237cd059377b616d2bfcfa4b0140bc85fa008f2d3d4b225349

real	0m8.868s
user	0m8.828s
sys	0m0.035s</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-745">
<p>L&#8217;exemple de code prendra quelques secondes pour trouver une correspondance pour le mod√®le √† trois caract√®res "kid", comme nous pouvons le voir lorsque nous utilisons la commande Unix <code>time</code> pour mesurer le temps d&#8217;ex√©cution. Modifiez le mod√®le <code>search</code> dans le code source et voyez combien de temps cela prend pour les mod√®les √† quatre ou cinq caract√®res¬†!</p>
</div>
</div>
<div class="sect4 data-line-747">
<h5 id="_s√©curit√©_de_ladresse_personnalis√©e">S√©curit√© de l&#8217;adresse personnalis√©e</h5>
<div class="paragraph data-line-749">
<p>Les adresses personnalis√©es peuvent √™tre utilis√©es pour am√©liorer <em>et</em> pour contourner les mesures de s√©curit√©¬†; ils sont vraiment une √©p√©e √† double tranchant. Utilis√©e pour am√©liorer la s√©curit√©, une adresse distinctive rend plus difficile pour les adversaires de substituer leur propre adresse et de tromper vos clients en les payant √† votre place. Malheureusement, les adresses personnalis√©es permettent √©galement √† quiconque de cr√©er une adresse qui <em>ressemble</em> √† n&#8217;importe quelle adresse al√©atoire, ou m√™me √† une autre adresse personnalis√©e, trompant ainsi vos clients.</p>
</div>
<div class="paragraph data-line-751">
<p>Eugenia pourrait annoncer une adresse g√©n√©r√©e al√©atoirement (par exemple, 1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy) √† laquelle les gens peuvent envoyer leurs dons. Ou, elle pourrait g√©n√©rer une adresse de vanit√© qui commence par 1Kids, pour la rendre plus distinctive.</p>
</div>
<div class="paragraph data-line-753">
<p>Dans les deux cas, l&#8217;un des risques d&#8217;utiliser une seule adresse fixe (plut√¥t qu&#8217;une adresse dynamique distincte par donateur) est qu&#8217;un voleur puisse s&#8217;infiltrer dans votre site Web et le remplacer par sa propre adresse, d√©tournant ainsi les dons vers lui. Si vous avez annonc√© votre adresse de don √† plusieurs endroits diff√©rents, vos utilisateurs peuvent inspecter visuellement l&#8217;adresse avant d&#8217;effectuer un paiement pour s&#8217;assurer qu&#8217;il s&#8217;agit de la m√™me adresse qu&#8217;ils ont vue sur votre site Web, sur votre e-mail et sur votre d√©pliant. Dans le cas d&#8217;une adresse al√©atoire comme 1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy, l&#8217;utilisateur moyen inspectera peut-√™tre les premiers caract√®res "1J7mdg" et sera satisfait que l&#8217;adresse corresponde. √Ä l&#8217;aide d&#8217;un g√©n√©rateur d&#8217;adresses personnalis√©es, une personne ayant l&#8217;intention de voler en substituant une adresse d&#8217;apparence similaire peut rapidement g√©n√©rer des adresses qui correspondent aux premiers caract√®res, comme indiqu√© dans <a href="#table_4-13">G√©n√©ration d&#8217;adresses personnalis√©es pour correspondre √† une adresse al√©atoire</a>.</p>
</div>
<table id="table_4-13" class="tableblock frame-all grid-all stretch data-line-757">
<caption class="title">Table 7. G√©n√©ration d&#8217;adresses personnalis√©es pour correspondre √† une adresse al√©atoire</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Adresse al√©atoire originale</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Vanit√© (correspondance √† 4 caract√®res)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1J7md1QqU4LpctBetHS2ZoyLV5d6dShhEy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Vanit√© (correspondance √† 5 caract√®res)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1J7mdgYqyNd4ya3UEcq31Q7sqRMXw2XZ6n</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Vanit√© (correspondance √† 6 caract√®res)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1J7mdg5WxGENmwyJP9xuGhG5KRzu99BBCX</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-764">
<p>Alors, une adresse personnalis√©e augmente-t-elle la s√©curit√©¬†? Si Eugenia g√©n√®re l&#8217;adresse personnalis√©e 1Kids33q44erFfpeXrmDSz7zEqG2FesZEN, les utilisateurs sont susceptibles de regarder le mot de mod√®le personnalis√© <em>et quelques caract√®res au-del√†</em>, par exemple en remarquant la partie "1Kids33" de l&#8217;adresse. Cela obligerait un attaquant √† g√©n√©rer une adresse de vanit√© correspondant √† au moins six caract√®res (deux de plus), en d√©ployant un effort 3 364 fois (58 √ó 58) sup√©rieur √† l&#8217;effort qu&#8217;Eugenia a d√©pens√© pour sa vanit√© √† 4 caract√®res. Essentiellement, l&#8217;effort qu&#8217;Eugenia d√©ploie (ou paie une vanit√© pour) "pousse" l&#8217;attaquant √† devoir produire une vanit√© de mod√®le plus longue. Si Eugenia paie un pool pour g√©n√©rer une adresse de vanit√© √† 8 caract√®res, l&#8217;attaquant serait pouss√© dans le domaine de 10 caract√®res, ce qui est irr√©alisable sur un ordinateur personnel et co√ªteux m√™me avec une plate-forme d&#8217;extraction de vanit√© personnalis√©e ou un pool de vanit√©. Ce qui est abordable pour Eugenia devient inabordable pour l&#8217;attaquant, surtout si la r√©compense potentielle de la fraude n&#8217;est pas assez √©lev√©e pour couvrir le co√ªt de la g√©n√©ration d&#8217;adresse personnalis√©e.</p>
</div>
</div>
</div>
<div class="sect3 data-line-767">
<h4 id="paper_wallets">Portefeuilles en papier</h4>
<div class="paragraph data-line-769">
<p> Les paper wallets, ou les portefeuilles en papier, sont des cl√©s priv√©es bitcoin imprim√©es sur papier. Souvent, le portefeuille papier comprend √©galement l&#8217;adresse Bitcoin correspondante pour plus de commodit√©, mais ce n&#8217;est pas n√©cessaire car elle peut √™tre d√©riv√©e de la cl√© priv√©e.</p>
</div>
<div class="admonitionblock warning data-line-772">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-773">
<p>Les portefeuilles en papier sont une technologie OBSOL√àTE et sont dangereux pour la plupart des utilisateurs. Il existe de nombreux pi√®ges subtils impliqu√©s dans leur g√©n√©ration, notamment la possibilit√© que le code de g√©n√©ration soit compromis par une "porte d√©rob√©e". Des centaines de bitcoins ont √©t√© vol√©s de cette fa√ßon. Les portefeuilles en papier sont pr√©sent√©s ici √† titre informatif uniquement et ne doivent pas √™tre utilis√©s pour stocker des bitcoins. Utilisez une phrase mn√©monique BIP-39 pour sauvegarder vos cl√©s. Utilisez un portefeuille mat√©riel pour stocker des cl√©s et signer des transactions. N&#8217;UTILISEZ PAS DE PORTEFEUILLES EN PAPIER.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-776">
<p>Les portefeuilles en papier se pr√©sentent sous de nombreuses formes, tailles et conceptions, mais √† un niveau tr√®s basique, il ne s&#8217;agit que d&#8217;une cl√© et d&#8217;une adresse imprim√©es sur papier. <a href="#table_4-14">La forme la plus simple d&#8217;un portefeuille papier - une impression de l&#8217;adresse Bitcoin et de la cl√© priv√©e</a> montre la forme la plus simple d&#8217;un portefeuille en papier.</p>
</div>
<table id="table_4-14" class="tableblock frame-all grid-all stretch data-line-781">
<caption class="title">Table 8. La forme la plus simple d&#8217;un portefeuille papier - une impression de l&#8217;adresse Bitcoin et de la cl√© priv√©e</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Adresse publique</th>
<th class="tableblock halign-left valign-top">Cl√© priv√©e (WIF)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1424C2F4bC9JidNjjTUZCbUxv6Sa1Mt62x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-786">
<p>Les portefeuilles en papier sont disponibles dans de nombreux mod√®les et tailles, avec de nombreuses fonctionnalit√©s diff√©rentes. <a href="#paper_wallet_simple">Un exemple de portefeuille en papier simple</a> montre un exemple de portefeuille en papier.</p>
</div>
<div id="paper_wallet_simple" class="imageblock data-line-790">
<div class="content">
<img src="images/mbc2_0408.png" alt="mbc2 0408">
</div>
<div class="title">Figure 21. Un exemple de portefeuille en papier simple</div>
</div>
<div class="paragraph data-line-793">
<p>Certains sont destin√©s √† √™tre offerts en cadeau et ont des th√®mes saisonniers, tels que les th√®mes de No√´l et du Nouvel An. D&#8217;autres sont con√ßus pour √™tre stock√©s dans un coffre-fort de banque ou un coffre-fort avec la cl√© priv√©e cach√©e d&#8217;une mani√®re ou d&#8217;une autre, soit avec des autocollants opaques √† gratter, soit pli√©s et scell√©s avec une feuille adh√©sive inviolable.</p>
</div>
<div class="paragraph data-line-795">
<p>D&#8217;autres conceptions comportent des copies suppl√©mentaires de la cl√© et de l&#8217;adresse, sous la forme de talons d√©tachables similaires aux talons de ticket, vous permettant de stocker plusieurs copies pour vous prot√©ger contre les incendies, les inondations ou d&#8217;autres catastrophes naturelles.</p>
</div>
<div id="paper_wallet_spw" class="imageblock data-line-15">
<div class="content">
<img src="images/mbc2_0412.png" alt="mbc2 0412">
</div>
<div class="title">Figure 22. Un exemple de portefeuille papier avec des copies suppl√©mentaires des cl√©s sur un "talon" de sauvegarde</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="ch05_wallets">Portefeuilles</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-4">
<p>Le mot "portefeuille" est utilis√© pour d√©crire diff√©rentes choses dans le bitcoin.</p>
</div>
<div class="paragraph data-line-6">
<p>√Ä un niveau √©lev√©, un portefeuille est une application qui sert d&#8217;interface utilisateur principale. Le portefeuille contr√¥le l&#8217;acc√®s √† l&#8217;argent d&#8217;un utilisateur, g√®re les cl√©s et les adresses, le solde et cr√©e et signe des transactions.</p>
</div>
<div class="paragraph data-line-8">
<p>Plus pr√©cis√©ment, du point de vue d&#8217;un programmeur, le mot "portefeuille" fait r√©f√©rence √† la structure de donn√©es utilis√©e pour stocker et g√©rer les cl√©s d&#8217;un utilisateur.</p>
</div>
<div class="paragraph data-line-10">
<p>Dans ce chapitre, nous examinerons la deuxi√®me signification, o√π les portefeuilles sont des conteneurs de cl√©s priv√©es, g√©n√©ralement impl√©ment√©s sous forme de fichiers structur√©s ou de simples bases de donn√©es.</p>
</div>
<div class="sect2 data-line-12">
<h3 id="_pr√©sentation_de_la_technologie_de_portefeuille">Pr√©sentation de la technologie de portefeuille</h3>
<div class="paragraph data-line-14">
<p>Dans cette section, nous r√©sumons les diff√©rentes technologies utilis√©es pour construire des portefeuilles Bitcoin conviviaux, s√©curis√©s et flexibles.</p>
</div>
<div class="paragraph data-line-16">
<p> Une id√©e faussement courante √† propos du bitcoin est que les portefeuilles bitcoin contiennent du bitcoin. En fait, le portefeuille ne contient que des cl√©s. Les "monnaies ou coins" sont enregistr√©s dans la cha√Æne de blocs sur le r√©seau Bitcoin. Les utilisateurs contr√¥lent les pi√®ces sur le r√©seau en signant des transactions avec les cl√©s de leur portefeuille. Dans un sens, un portefeuille bitcoin est un <em>porte-cl√©s</em>.</p>
</div>
<div class="admonitionblock tip data-line-19">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-20">
<p>Les portefeuilles Bitcoin contiennent des cl√©s, pas des pi√®ces (ou coins). Chaque utilisateur dispose d&#8217;un portefeuille contenant des cl√©s. Les portefeuilles sont en r√©alit√© des porte-cl√©s contenant des paires de cl√©s priv√©es/publiques (voir <a href="#private_public_keys">Cl√©s priv√©es et publiques</a>). Les utilisateurs signent des transactions avec les cl√©s, prouvant ainsi qu&#8217;ils sont propri√©taires des sorties de transaction (leurs pi√®ces ou monnaies). Les pi√®ces sont stock√©es sur la cha√Æne de blocs sous la forme de sorties de transaction (souvent not√©es vout ou txout).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-23">
<p>Il existe deux principaux types de portefeuilles, qui se distinguent par le fait que les cl√©s qu&#8217;ils contiennent sont li√©es les unes aux autres ou non.</p>
</div>
<div class="paragraph data-line-25">
<p>Le premier type est un <em>portefeuille non d√©terministe</em>, o√π chaque cl√© est g√©n√©r√©e ind√©pendamment √† partir d&#8217;un nombre al√©atoire. Les cl√©s ne sont pas li√©es les unes aux autres. Ce type de portefeuille est √©galement connu sous le nom de portefeuille JBOK √† partir de l&#8217;expression "Just a Bunch Of Keys" (juste une poign√©es de cl√©s).</p>
</div>
<div class="paragraph data-line-27">
<p>Le deuxi√®me type de portefeuille est un <em>portefeuille d√©terministe</em>, o√π toutes les cl√©s sont d√©riv√©es d&#8217;une seule cl√© principale, connue sous le nom de <em>seed</em> (ou valeur d&#8217;amor√ßage). Toutes les cl√©s de ce type de portefeuille sont li√©es les unes aux autres et peuvent √™tre g√©n√©r√©es √† nouveau si l&#8217;on dispose de la valeur d&#8217;amor√ßage d&#8217;origine.  Il existe un certain nombre de m√©thodes diff√©rentes de <em>d√©rivation de cl√©</em> utilis√©es dans les portefeuilles d√©terministes. La m√©thode de d√©rivation la plus couramment utilis√©e utilise une structure arborescente et est connue sous le nom de portefeuille <em>d√©terministe hi√©rarchique</em> ou <em>HD</em>.</p>
</div>
<div class="paragraph data-line-29">
<p>Les portefeuilles d√©terministes sont initialis√©s √† partir d&#8217;une s√©quence al√©atoire (une entropie). Pour faciliter leur utilisation, les s√©quences al√©atoires sont encod√©es sous forme de mots anglais, √©galement appel√©s <em>mots de code mn√©moniques</em>.</p>
</div>
<div class="paragraph data-line-31">
<p>Les prochaines sections pr√©sentent chacune de ces technologies √† un niveau √©lev√©.</p>
</div>
<div class="sect3 data-line-34">
<h4 id="random_wallet">Portefeuilles non d√©terministes (al√©atoires)</h4>
<div class="paragraph data-line-36">
<p>Dans le premier portefeuille bitcoin (maintenant appel√© Bitcoin Core), les portefeuilles √©taient des collections de cl√©s priv√©es g√©n√©r√©es al√©atoirement. Par exemple, le client Bitcoin Core d&#8217;origine pr√©g√©n√®re 100 cl√©s priv√©es al√©atoires lors du premier d√©marrage et g√©n√®re plus de cl√©s si n√©cessaire, en utilisant chaque cl√© une seule fois. Ces portefeuilles sont remplac√©s par des portefeuilles d√©terministes car ils sont lourds √† g√©rer, √† sauvegarder et √† importer. L&#8217;inconv√©nient des cl√©s al√©atoires est que si vous en g√©n√©rez beaucoup, vous devez conserver des copies de toutes, ce qui signifie que le portefeuille doit √™tre sauvegard√© fr√©quemment. Chaque cl√© doit √™tre sauvegard√©e, sinon les fonds qu&#8217;elle contr√¥le sont irr√©vocablement perdus si le portefeuille devient inaccessible. Cela entre directement en conflit avec le principe d&#8217;√©viter la r√©utilisation des adresses, en utilisant chaque adresse Bitcoin pour une seule transaction. La r√©utilisation des adresses r√©duit la confidentialit√© en associant plusieurs transactions et adresses les unes aux autres. Un portefeuille non d√©terministe de type-0 est un mauvais choix de portefeuille, surtout si vous voulez √©viter la r√©utilisation des adresses car cela implique de g√©rer de nombreuses cl√©s, ce qui cr√©e le besoin de sauvegardes fr√©quentes. Bien que le client Bitcoin Core inclue un portefeuille de type 0, l&#8217;utilisation de ce portefeuille est d√©conseill√©e par les d√©veloppeurs de Bitcoin Core. <a href="#Type0_wallet">Portefeuille non d√©terministe (al√©atoire) de type-0¬†: une collection de cl√©s g√©n√©r√©es al√©atoirement</a> montre un portefeuille non d√©terministe, contenant une collection l√¢che de cl√©s al√©atoires.</p>
</div>
<div class="admonitionblock tip data-line-39">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-40">
<p>L&#8217;utilisation de portefeuilles non d√©terministes est d√©conseill√©e pour autre chose que de simples tests. Ils sont tout simplement trop lourds √† sauvegarder et √† utiliser. √Ä la place, utilisez un <em>portefeuille HD</em> standard de l&#8217;industrie avec une s√©quence al√©atoire <em>mn√©monique</em> (entropie, ou "valeur d&#8217;amor√ßage") pour la sauvegarde.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="Type0_wallet" class="imageblock smallersixty data-line-46">
<div class="content">
<img src="images/mbc2_0501.png" alt="Portefeuille non d√©terministe">
</div>
<div class="title">Figure 23. Portefeuille non d√©terministe (al√©atoire) de type-0¬†: une collection de cl√©s g√©n√©r√©es al√©atoirement</div>
</div>
</div>
<div class="sect3 data-line-48">
<h4 id="_portefeuilles_d√©terministes_ensemenc√©s">Portefeuilles d√©terministes (ensemenc√©s)</h4>
<div class="paragraph data-line-50">
<p>Les portefeuilles d√©terministes ou "ensemenc√©s" sont des portefeuilles qui contiennent des cl√©s priv√©es qui sont toutes d√©riv√©es d&#8217;une valeur d&#8217;amor√ßage commune, gr√¢ce √† l&#8217;utilisation d&#8217;un fonction de hachage √† sens unique. La valeur d&#8217;amor√ßage est un nombre g√©n√©r√© al√©atoirement qui est combin√© avec d&#8217;autres donn√©es, telles qu&#8217;un num√©ro d&#8217;index ou un "code de cha√Æne" (voir <a href="#hd_wallets">Portefeuilles HD (BIP-32/BIP-44)</a>) pour d√©river les cl√©s priv√©es. Dans un portefeuille d√©terministe, la valeur d&#8217;amor√ßage est suffisante pour r√©cup√©rer toutes les cl√©s d√©riv√©es, et donc une seule sauvegarde au moment de la cr√©ation est suffisante. La valeur d&#8217;amor√ßage est √©galement suffisante pour une exportation ou une importation de portefeuille, permettant une migration facile de toutes les cl√©s de l&#8217;utilisateur entre diff√©rentes impl√©mentations de portefeuille. <a href="#Type1_wallet">Portefeuille d√©terministe (ensemenc√©) de type-1¬†: une s√©quence d√©terministe de cl√©s d√©riv√©e d&#8217;une valeur d&#8217;amor√ßage</a> montre un diagramme logique d&#8217;un portefeuille d√©terministe.</p>
</div>
<div id="Type1_wallet" class="imageblock smallersixty data-line-55">
<div class="content">
<img src="images/mbc2_0502.png" alt="Portefeuille d√©terministe">
</div>
<div class="title">Figure 24. Portefeuille d√©terministe (ensemenc√©) de type-1¬†: une s√©quence d√©terministe de cl√©s d√©riv√©e d&#8217;une valeur d&#8217;amor√ßage</div>
</div>
</div>
<div class="sect3 data-line-58">
<h4 id="hd_wallets">Portefeuilles HD (BIP-32/BIP-44)</h4>
<div class="paragraph data-line-60">
<p>Des portefeuilles d√©terministes ont √©t√© d√©velopp√©s pour faciliter la d√©rivation de nombreuses cl√©s √† partir d&#8217;une seule "valeur d&#8217;amor√ßage". La forme la plus avanc√©e de portefeuilles d√©terministes est le portefeuille HD d√©fini par la norme BIP-32. Les portefeuilles HD contiennent des cl√©s d√©riv√©es dans une structure arborescente, de sorte qu&#8217;une cl√© parent peut d√©river une s√©quence de cl√©s enfants, chacune pouvant d√©river une s√©quence de cl√©s petits-enfants, et ainsi de suite, jusqu&#8217;√† une profondeur infinie. Cette arborescence est illustr√©e dans <a href="#Type2_wallet">Portefeuille HD de type-2¬†: un arbre de cl√©s g√©n√©r√© √† partir d&#8217;une seule valeur d&#8217;amor√ßage</a>.</p>
</div>
<div id="Type2_wallet" class="imageblock data-line-64">
<div class="content">
<img src="images/mbc2_0503.png" alt="portefeuille HD">
</div>
<div class="title">Figure 25. Portefeuille HD de type-2¬†: un arbre de cl√©s g√©n√©r√© √† partir d&#8217;une seule valeur d&#8217;amor√ßage</div>
</div>
<div class="paragraph data-line-66">
<p>Les portefeuilles HD offrent deux avantages majeurs par rapport aux cl√©s al√©atoires (non d√©terministes). Tout d&#8217;abord, la structure arborescente peut √™tre utilis√©e pour exprimer une signification organisationnelle suppl√©mentaire, par exemple lorsqu&#8217;une branche sp√©cifique de sous-cl√©s est utilis√©e pour recevoir des paiements entrants et qu&#8217;une branche diff√©rente est utilis√©e pour recevoir la monnaie des paiements sortants. Les branches de cl√©s peuvent √©galement √™tre utilis√©es dans les param√®tres de l&#8217;entreprise, en attribuant diff√©rentes branches √† des d√©partements, des filiales, des fonctions sp√©cifiques ou des cat√©gories comptables.</p>
</div>
<div class="paragraph data-line-68">
<p>Le deuxi√®me avantage des portefeuilles HD est que les utilisateurs peuvent cr√©er une s√©quence de cl√©s publiques sans avoir acc√®s aux cl√©s priv√©es correspondantes. Cela permet aux portefeuilles HD d&#8217;√™tre utilis√©s sur un serveur non s√©curis√© ou dans une capacit√© de r√©ception uniquement, en √©mettant une cl√© publique diff√©rente pour chaque transaction. Les cl√©s publiques n&#8217;ont pas besoin d&#8217;√™tre pr√©charg√©es ou d√©riv√©es √† l&#8217;avance, mais le serveur ne dispose pas des cl√©s priv√©es qui peuvent d√©penser les fonds.</p>
</div>
</div>
<div class="sect3 data-line-70">
<h4 id="_valeurs_damor√ßages_ou_graines_et_codes_mn√©moniques_bip_39">Valeurs d&#8217;amor√ßages (ou graines) et codes mn√©moniques (BIP-39)</h4>
<div class="paragraph data-line-72">
<p>Les portefeuilles HD sont un m√©canisme tr√®s puissant pour g√©rer de nombreuses cl√©s et adresses. Ils sont encore plus utiles s&#8217;ils sont combin√©s √† une mani√®re standardis√©e de cr√©er des valeurs d&#8217;amor√ßage √† partir d&#8217;une s√©quence de mots anglais faciles √† transcrire, exporter et importer sur plusieurs portefeuilles. C&#8217;est ce qu&#8217;on appelle un <em>mn√©monique</em> et la norme est d√©finie par BIP-39. Aujourd&#8217;hui, la plupart des portefeuilles Bitcoin (ainsi que des portefeuilles pour d&#8217;autres cryptomonnaies) utilisent cette norme et peuvent importer et exporter des valeurs d&#8217;amor√ßage pour la sauvegarde et la r√©cup√©ration √† l&#8217;aide de mn√©moniques interop√©rables.</p>
</div>
<div class="paragraph data-line-74">
<p>Regardons cela d&#8217;un point de vue pratique. Laquelle des valeurs d&#8217;amor√ßage suivantes est la plus facile √† transcrire, √† enregistrer sur papier, √† lire sans erreur ou √† exporter et √† importer dans un autre portefeuille¬†?</p>
</div>
<div class="listingblock data-line-77">
<div class="title">Une valeur d&#8217;amor√ßage pour un portefeuille d√©terministe, en hexad√©cimal</div>
<div class="content">
<pre>0C1E24E5917779D297E14D45F14E1A1A</pre>
</div>
</div>
<div class="listingblock data-line-82">
<div class="title">Une valeur d&#8217;amor√ßage pour un portefeuille d√©terministe, √† partir d&#8217;un mn√©monique de 12 mots</div>
<div class="content">
<pre>army van defense carry jealous true
garbage claim echo media make crunch</pre>
</div>
</div>
</div>
<div class="sect3 data-line-87">
<h4 id="_meilleures_proc√©dures_de_portefeuille">Meilleures proc√©dures de portefeuille</h4>
<div class="paragraph data-line-89">
<p>Au fur et √† mesure que les portefeuilles de Bitcoin ont atteint un degr√© de maturit√©, certaines normes industrielles mis en commun ont √©merg√©, rendant de nos jours des portefeuilles Bitcoin largement interop√©rables, faciles √† utiliser, s√©curis√©s et flexibles. Ces normes communes sont :</p>
</div>
<div class="ulist data-line-91">
<ul>
<li class="data-line-91">
<p>Mots de code mn√©monique, bas√©s sur BIP-39</p>
</li>
<li class="data-line-92">
<p>Portefeuilles HD, bas√©s sur BIP-32</p>
</li>
<li class="data-line-93">
<p>Structure de portefeuille HD polyvalente, bas√©e sur BIP-43</p>
</li>
<li class="data-line-94">
<p>Portefeuilles multidevises et multicomptes, bas√©s sur BIP-44</p>
</li>
</ul>
</div>
<div class="paragraph data-line-96">
<p>Ces normes peuvent changer ou devenir obsol√®tes en raison de d√©veloppements futurs, mais pour l&#8217;instant, elles forment un ensemble de technologies imbriqu√©es qui sont devenues de facto la norme de portefeuille pour le bitcoin.</p>
</div>
<div class="paragraph data-line-98">
<p>Les normes ont √©t√© adopt√©es par une large gamme de portefeuilles bitcoin logiciels et mat√©riels, rendant tous ces portefeuilles interop√©rables. Un utilisateur peut exporter un mn√©monique g√©n√©r√© sur l&#8217;un de ces portefeuilles et l&#8217;importer dans un autre portefeuille, r√©cup√©rant toutes les transactions, cl√©s et adresses.</p>
</div>
<div class="paragraph data-line-100">
<p> Quelques exemples de portefeuilles logiciels prenant en charge ces normes incluent (par ordre alphab√©tique) Bluewallet, Breadwallet, Copay et Multibit HD. Des exemples de portefeuilles mat√©riels prenant en charge ces normes incluent (par ordre alphab√©tique) KeepKey, Ledger et Trezor.</p>
</div>
<div class="paragraph data-line-102">
<p>Les sections suivantes examinent chacune de ces technologies en d√©tail.</p>
</div>
<div class="admonitionblock tip data-line-105">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-106">
<p>Si vous impl√©mentez un portefeuille bitcoin, il doit √™tre construit comme un portefeuille HD, avec une valeur d&#8217;amor√ßage d√©riv√©e et cod√©e comme un code mn√©monique pour la sauvegarde, suivant les normes BIP-32, BIP-39, BIP-43 et BIP-44, comme d√©crit dans les sections suivantes.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-109">
<h4 id="_utiliser_un_portefeuille_bitcoin">Utiliser un portefeuille Bitcoin</h4>
<div class="paragraph data-line-111">
<p>Dans <a href="#user-stories">Utilisations, utilisateurs et histoires de Bitcoin</a> nous avons pr√©sent√© Gabriel, un jeune adolescent entreprenant √† Rio de Janeiro, qui g√®re une simple boutique en ligne qui vend des t-shirts de marque bitcoin, des tasses √† caf√© et des autocollants.</p>
</div>
<div class="paragraph data-line-113">
<p>Gabriel utilise un portefeuille mat√©riel bitcoin Trezor (<a href="#a_trezor_device">Un appareil Trezor¬†: un portefeuille bitcoin HD en mat√©riel</a>) pour g√©rer en toute s√©curit√© son bitcoin. Le Trezor est un simple p√©riph√©rique USB √† deux boutons qui stocke les cl√©s (sous la forme d&#8217;un portefeuille HD) et signe les transactions. Les portefeuilles Trezor mettent en ≈ìuvre toutes les normes de l&#8217;industrie abord√©es dans ce chapitre, de sorte que Gabriel ne d√©pend d&#8217;aucune technologie propri√©taire ou d&#8217;une solution de fournisseur unique.</p>
</div>
<div id="a_trezor_device" class="imageblock data-line-117">
<div class="content">
<img src="images/mbc2_0504.png" alt="alt">
</div>
<div class="title">Figure 26. Un appareil Trezor¬†: un portefeuille bitcoin HD en mat√©riel</div>
</div>
<div class="paragraph data-line-119">
<p>Lorsque Gabriel a utilis√© le Trezor pour la premi√®re fois, l&#8217;appareil a g√©n√©r√© une s√©quence al√©atoire (entropie), le mn√©monique associ√© et a d√©riv√© une valeur d&#8217;amor√ßage √† partir d&#8217;un g√©n√©rateur de nombres al√©atoires mat√©riel int√©gr√©. Lors de cette phase d&#8217;initialisation, le portefeuille affichait √† l&#8217;√©cran une s√©quence de mots num√©rot√©s, un par un (voir <a href="#trezor_mnemonic_display">Trezor affichant un des mots mn√©moniques</a>).</p>
</div>
<div id="trezor_mnemonic_display" class="imageblock data-line-123">
<div class="content">
<img src="images/mbc2_0505.png" alt="Vue des mots mn√©moniques du portefeuille Trezor">
</div>
<div class="title">Figure 27. Trezor affichant un des mots mn√©moniques</div>
</div>
<div class="paragraph data-line-125">
<p>En √©crivant ce mn√©monique, Gabriel a cr√©√© une sauvegarde (voir <a href="#mnemonic_paper_backup">La sauvegarde papier de Gabriel du mn√©monique</a>) qui peut √™tre utilis√© pour la r√©cup√©ration en cas de perte ou d&#8217;endommagement de l&#8217;appareil Trezor. Ce mn√©monique peut √™tre utilis√© pour la r√©cup√©ration dans un nouveau Trezor ou dans l&#8217;un des nombreux portefeuilles logiciels ou mat√©riels compatibles. Notez que la s√©quence des mots est importante, donc les sauvegardes papier mn√©motechniques ont des espaces num√©rot√©s pour chaque mot. Gabriel a d√ª enregistrer soigneusement chaque mot dans l&#8217;espace num√©rot√© pour pr√©server la s√©quence correcte.</p>
</div>
<table id="mnemonic_paper_backup" class="tableblock frame-all grid-all data-line-130" style="width: 80%;">
<caption class="title">Table 9. La sauvegarde papier de Gabriel du mn√©monique</caption>
<colgroup>
<col style="width: 0.9803%;">
<col style="width: 49.0196%;">
<col style="width: 0.9803%;">
<col style="width: 49.0198%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>army</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>7.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>garbage</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>2.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>van</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>8.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>claim</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>3.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>defense</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>9.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>echo</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>4.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>carry</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>10.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>media</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>5.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>jealous</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>11.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>make</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>6.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>true</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>12.</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>crunch</em></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note data-line-140">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-141">
<p>Un mn√©monique de 12 mots est affich√© dans <a href="#mnemonic_paper_backup">La sauvegarde papier de Gabriel du mn√©monique</a>, pour plus de simplicit√©. En fait, la plupart des portefeuilles mat√©riels g√©n√®rent un mn√©monique de 24 mots plus s√©curis√©. Le mn√©monique est utilis√© exactement de la m√™me mani√®re, quelle que soit sa longueur.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-144">
<p>Pour la premi√®re impl√©mentation de sa boutique en ligne, Gabriel utilise une seule adresse Bitcoin, g√©n√©r√©e sur son appareil Trezor. Cette adresse unique est utilis√©e par tous les clients pour toutes les commandes. Comme nous le verrons, cette approche pr√©sente quelques inconv√©nients et peut √™tre am√©lior√©e avec un portefeuille HD.</p>
</div>
</div>
</div>
<div class="sect2 data-line-146">
<h3 id="_d√©tails_de_la_technologie_de_portefeuille">D√©tails de la technologie de portefeuille</h3>
<div class="paragraph data-line-148">
<p>Examinons maintenant en d√©tail chacune des normes importantes de l&#8217;industrie utilis√©es par de nombreux portefeuilles Bitcoin.</p>
</div>
<div class="sect3 data-line-151">
<h4 id="mnemonic_code_words">Mots de code mn√©monique (BIP-39)</h4>
<div class="paragraph data-line-153">
<p>Les mots de code mn√©monique sont des s√©quences de mots qui repr√©sentent (encodent) un nombre al√©atoire utilis√© comme valeur d&#8217;amor√ßage pour d√©river un portefeuille d√©terministe. La s√©quence de mots est suffisante pour recr√©er la valeur d&#8217;amor√ßage et √† partir de l√† recr√©er le portefeuille et toutes les cl√©s d√©riv√©es. Une application de portefeuille qui impl√©mente des portefeuilles d√©terministes avec des mots mn√©moniques montrera √† l&#8217;utilisateur une s√©quence de 12 √† 24 mots lors de la premi√®re cr√©ation d&#8217;un portefeuille. Cette s√©quence de mots est √† sauvegarder et est la valeur d&#8217;amor√ßage du portefeuille. Elle peut √™tre utilis√©e pour r√©cup√©rer et recr√©er toutes les cl√©s dans la m√™me application de portefeuille ou dans n&#8217;importe quelle application de portefeuille compatible. Les mots mn√©motechniques facilitent la sauvegarde des portefeuilles par les utilisateurs, car ils sont faciles √† lire et √† transcrire correctement, par rapport √† une s√©quence al√©atoire de chiffres.</p>
</div>
<div class="admonitionblock tip data-line-156">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-157">
<p>Les mots mn√©moniques sont souvent confondus avec les "brainwallets". Ils ne sont pas les m√™mes. La principale diff√©rence est qu&#8217;un brainwallet se compose de mots choisis par l&#8217;utilisateur, tandis que les mots mn√©moniques sont cr√©√©s de mani√®re al√©atoire par le portefeuille et pr√©sent√©s √† l&#8217;utilisateur. Cette diff√©rence importante rend les mots mn√©moniques beaucoup plus s√ªrs, car les humains sont de tr√®s mauvaises sources d&#8217;al√©atoire.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-160">
<p>Les codes mn√©moniques sont d√©finis dans le BIP-39 (voir <a href="#appdxbitcoinimpproposals">Bitcoin Improvement Proposals (ou Propositions d&#8217;am√©lioration du Bitcoin)</a>). Notez que BIP-39 est une impl√©mentation d&#8217;une norme de code mn√©monique. Il existe une norme diff√©rente, avec un ensemble de mots diff√©rent, utilis√©e par le portefeuille Electrum et ant√©rieure √† BIP-39. BIP-39 a √©t√© propos√© par la soci√©t√© √† l&#8217;origine du portefeuille mat√©riel Trezor et est incompatible avec la mise en ≈ìuvre d&#8217;Electrum. Cependant, BIP-39 a maintenant obtenu un large soutien de l&#8217;industrie √† travers des dizaines d&#8217;impl√©mentations interop√©rables et devrait √™tre consid√©r√© comme la norme de facto de l&#8217;industrie.</p>
</div>
<div class="paragraph data-line-162">
<p>La BIP-39 d√©finit la cr√©ation d&#8217;un code mn√©monique et d&#8217;une valeur d&#8217;amor√ßage, que nous d√©crivons ici en neuf √©tapes. Pour plus de clart√©, le processus est divis√© en deux parties¬†: les √©tapes 1 √† 6 sont pr√©sent√©es dans <a href="#generating_mnemonic_words">G√©n√©ration de mots mn√©moniques</a> et les √©tapes 7 √† 9 sont illustr√©es dans <a href="#mnemonic_to_seed">Du mn√©monique √† la valeur d&#8217;amor√ßage</a>.</p>
</div>
<div class="sect4 data-line-165">
<h5 id="generating_mnemonic_words">G√©n√©ration de mots mn√©moniques</h5>
<div class="paragraph data-line-167">
<p>Les mots mn√©moniques sont g√©n√©r√©s automatiquement par le portefeuille en utilisant le processus standardis√© d√©fini dans BIP-39. Le portefeuille part d&#8217;une source d&#8217;entropie, ajoute une somme de contr√¥le, puis mappe l&#8217;entropie sur une liste de mots¬†:</p>
</div>
<div class="olist arabic data-line-169">
<ol class="arabic">
<li class="data-line-169">
<p>Cr√©ez une s√©quence al√©atoire (entropie) de 128 √† 256 bits.</p>
</li>
<li class="data-line-170">
<p>Cr√©ez une somme de contr√¥le de la s√©quence al√©atoire en prenant les premiers bits (longueur d&#8217;entropie/32) de son hachage SHA256.</p>
</li>
<li class="data-line-171">
<p>Ajoutez la somme de contr√¥le √† la fin de la s√©quence al√©atoire.</p>
</li>
<li class="data-line-172">
<p>Divisez le r√©sultat en segments de 11 bits.</p>
</li>
<li class="data-line-173">
<p>Associez chaque valeur 11 bits √† un mot du dictionnaire pr√©d√©fini de 2048 mots.</p>
</li>
<li class="data-line-174">
<p>Le code mn√©monique est la s√©quence de mots.</p>
</li>
</ol>
</div>
<div class="paragraph data-line-176">
<p><a href="#generating_entropy_and_encoding">G√©n√©ration d&#8217;entropie et encodage sous forme de mots mn√©moniques</a> montre comment l&#8217;entropie est utilis√©e pour g√©n√©rer des mots mn√©moniques.</p>
</div>
<div id="generating_entropy_and_encoding" class="imageblock smallerseventy data-line-181">
<div class="content">
<img src="images/mbc2_0506.png" alt="G√©n√©ration d&#8217;entropie et encodage sous forme de mots mn√©moniques">
</div>
<div class="title">Figure 28. G√©n√©ration d&#8217;entropie et encodage sous forme de mots mn√©moniques</div>
</div>
<div class="paragraph data-line-183">
<p><a href="#table_4-5">Codes mn√©moniques¬†: entropie et longueur des mots</a> montre la relation entre la taille des donn√©es d&#8217;entropie et la longueur des codes mn√©moniques en mots.</p>
</div>
<table id="table_4-5" class="tableblock frame-all grid-all stretch data-line-188">
<caption class="title">Table 10. Codes mn√©moniques¬†: entropie et longueur des mots</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entropie (bits)</th>
<th class="tableblock halign-left valign-top">Somme de contr√¥le (bits)</th>
<th class="tableblock halign-left valign-top">Somme de contr√¥le d&#8217;entropie <strong>+</strong> (bits)</th>
<th class="tableblock halign-left valign-top">Longueur mn√©monique (mots)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">132</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">160</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">165</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">192</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">198</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">224</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">231</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">264</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4 data-line-198">
<h5 id="mnemonic_to_seed">Du mn√©monique √† la valeur d&#8217;amor√ßage</h5>
<div class="paragraph data-line-200">
<p>Les mots mn√©moniques repr√©sentent l&#8217;entropie d&#8217;une longueur de 128 √† 256 bits. L&#8217;entropie est ensuite utilis√©e pour d√©river une valeur d&#8217;amor√ßage plus longue (512 bits) gr√¢ce √† l&#8217;utilisation de la fonction d&#8217;√©tirement de cl√© PBKDF2. La valeur d&#8217;amor√ßage produite est ensuite utilis√©e pour construire un portefeuille d√©terministe et en d√©river ses cl√©s.</p>
</div>
<div class="paragraph data-line-202">
<p>La fonction d&#8217;√©tirement de cl√© prend deux param√®tres¬†: le mn√©monique et un <em>sel</em>. Le but d&#8217;un sel dans une fonction d&#8217;√©tirement de cl√© est de rendre difficile la construction d&#8217;une table de recherche permettant une attaque par force brute. Dans la norme BIP-39, le sel a un autre objectif¬†: il permet l&#8217;introduction d&#8217;une phrase secr√®te qui sert de facteur de s√©curit√© suppl√©mentaire prot√©geant la valeur d&#8217;amor√ßage, comme nous le d√©crirons plus en d√©tail dans <a href="#mnemonic_passphrase">Phrase secr√®te facultative dans BIP-39</a>.</p>
</div>
<div class="paragraph data-line-204">
<p>Le processus d√©crit aux √©tapes 7 √† 9 continue √† partir du processus d√©crit pr√©c√©demment dans <a href="#generating_mnemonic_words">G√©n√©ration de mots mn√©moniques</a>¬†:</p>
</div>
<ol start="7">
	<li>Le premier param√®tre de la fonction d'√©tirement de cl√© PBKDF2 est le <em>mn√©monique</em> produit √† partir de l'√©tape 6.</li>
	<li>Le deuxi√®me param√®tre de la fonction d'√©tirement de cl√© PBKDF2 est un <em>sel</em> . Le sel est compos√© de la constante de cha√Æne "<code>mnemonique</code>" concat√©n√©e avec une phrase secr√®te facultative fournie par l'utilisateur.</li>
	<li>PBKDF2 √©tend les param√®tres mn√©moniques et le sel en utilisant 2048 cycles de hachage avec l'algorithme HMAC-SHA512, produisant une valeur de 512 bits comme sortie finale. Cette valeur de 512 bits est la valeur d'amor√ßage.</li>
</ol>
<div class="paragraph data-line-214">
<p><a href="#fig_5_7">Du mn√©monique √† la valeur d&#8217;amor√ßage</a> montre comment un mn√©monique est utilis√© pour g√©n√©rer une valeur d&#8217;amor√ßage.</p>
</div>
<div id="fig_5_7" class="imageblock data-line-218">
<div class="content">
<img src="images/mbc2_0507.png" alt="Du mn√©monique √† la valeur d&#8217;amor√ßage">
</div>
<div class="title">Figure 29. Du mn√©monique √† la valeur d&#8217;amor√ßage</div>
</div>
<div class="admonitionblock tip data-line-221">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-222">
<p>La fonction d&#8217;√©tirement de cl√©, avec ses 2048 tours de hachage, est une protection tr√®s efficace contre les attaques par force brute contre le mn√©monique ou la phrase secr√®te. Cela rend extr√™mement co√ªteux (en calcul) d&#8217;essayer plus de quelques milliers de combinaisons de mots de passe et de mn√©moniques, alors que le nombre de valeurs d&#8217;amor√ßage d√©riv√©es possibles est vaste (2<sup>512</sup>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-225">
<p>Les tableaux <a data-type="xref" href="#mnemonic_128_no_pass" data-xrefstyle="select: labelnumber">#mnemonic_128_no_pass</a>, <a data-type="xref" href="#mnemonic_128_w_pass" data-xrefstyle="select: labelnumber">#mnemonic_128_w_pass</a> et <a data-type="xref" href="#mnemonic_256_no_pass" data-xrefstyle="select: labelnumber">#mnemonic_256_no_pass</a> montrent quelques exemples de codes mn√©moniques et les valeurs d&#8217;amor√ßage qu&#8217;ils produisent (avec ou sans phrase secr√®te).</p>
</div>
<table id="mnemonic_128_no_pass" class="tableblock frame-all grid-all stretch data-line-230">
<caption class="title">Table 11. Code mn√©monique d&#8217;entropie 128 bits, sans phrase secr√®te, valeur d&#8217;amor√ßage r√©sultante</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Entr√©e d&#8217;entropie (128 bits)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">0c1e24e5917779d297e14d45f14e1a1a</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Mn√©monique (12 mots)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">army van defense carry jealous true garbage claim echo media make crunch</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Phrase secr√®te</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">(rien)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Valeur d&#8217;amor√ßage (512 bits)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">5b56c417303faa3fcba7e57400e120a0ca83ec5a4fc9ffba757fbe63fbd77a89a1a3be4c67196f57c39
a88b76373733891bfaba16ed27a813ceed498804c0570</p></td>
</tr>
</tbody>
</table>
<table id="mnemonic_128_w_pass" class="tableblock frame-all grid-all stretch data-line-241">
<caption class="title">Table 12. Code mn√©monique d&#8217;entropie 128 bits, avec phrase secr√®te, valeur d&#8217;amor√ßage r√©sultante</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Entr√©e d&#8217;entropie (128 bits)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">0c1e24e5917779d297e14d45f14e1a1a</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Mn√©monique (12 mots)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">army van defense carry jealous true garbage claim echo media make crunch</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Phrase secr√®te</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">SuperDuperSecret</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Valeur d&#8217;amor√ßage (512 bits)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">3b5df16df2157104cfdd22830162a5e170c0161653e3afe6c88defeefb0818c793dbb28ab3ab091897d0
715861dc8a18358f80b79d49acf64142ae57037d1d54</p></td>
</tr>
</tbody>
</table>
<table id="mnemonic_256_no_pass" class="tableblock frame-all grid-all stretch data-line-253">
<caption class="title">Table 13. Code mn√©monique d&#8217;entropie 256 bits, sans phrase secr√®te, valeur d&#8217;amor√ßage r√©sultante</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Entr√©e d&#8217;entropie (256 bits)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">2041546864449caff939d32d574753fe684d3c947c3346713dd8423e74abcf8c</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Mn√©monique (24 mots)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">cake apple borrow silk endorse fitness top denial coil riot stay wolf
luggage oxygen faint major edit measure invite love trap field dilemma oblige</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Phrase secr√®te</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">(rien)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><strong>Valeur d&#8217;amor√ßge (512 bits)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">3269bce2674acbd188d4f120072b13b088a0ecf87c6e4cae41657a0bb78f5315b33b3a04356e53d062e5
5f1e0deaa082df8d487381379df848a6ad7e98798404</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip data-line-263">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-264">
<p>De nombreux portefeuilles ne permettent pas la cr√©ation de portefeuilles avec plus d&#8217;une phrase mn√©monique de 12 mots. Vous remarquerez dans les tableaux ci-dessus que malgr√© les longueurs uniques d&#8217;entr√©e d&#8217;entropie, la taille de la valeur d&#8217;amor√ßage reste la m√™me (512 bits). Du point de vue de la s√©curit√©, la quantit√© d&#8217;entropie r√©ellement utilis√©e pour la production de portefeuilles HD est d&#8217;environ 128 bits, ce qui √©quivaut √† 12 mots. Fournir plus de 12 mots produit une entropie suppl√©mentaire qui n&#8217;est pas n√©cessaire, et cette entropie est <em>inutilis√©e</em>  pour la d√©rivation de la valeur d&#8217;amor√ßage de la mani√®re que l&#8217;on pourrait initialement soup√ßonner. Du point de vue de la convivialit√©, 12 mots sont √©galement plus faciles √† √©crire, √† sauvegarder et √† stocker.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 data-line-268">
<h5 id="mnemonic_passphrase">Phrase secr√®te facultative dans BIP-39</h5>
<div class="paragraph data-line-270">
<p>La norme BIP-39 permet l&#8217;utilisation d&#8217;une phrase secr√®te facultative dans la d√©rivation de la valeur d&#8217;amor√ßage. Si aucune phrase secr√®te n&#8217;est utilis√©e, le mn√©monique est √©tir√© avec un sel constitu√© de la cha√Æne constante "mn√©monique", produisant une valeur d&#8217;amor√ßage sp√©cifique de 512 bits √† partir de n&#8217;importe quel mn√©monique donn√©. Si une phrase secr√®te est utilis√©e, la fonction d&#8217;√©tirement produit une valeur d&#8217;amor√ßage <em>diff√©rente</em> √† partir de ce m√™me mn√©monique. En fait, √©tant donn√© un seul mn√©monique, chaque phrases secr√®tes possible conduit √† une valeurs d&#8217;amor√ßage diff√©rente. Essentiellement, il n&#8217;y a pas de "mauvaise" phrase secr√®te. Toutes les phrases secr√®tes sont valides et m√®nent toutes √† des valeurs d&#8217;amor√ßage diff√©rentes, formant un vaste ensemble de portefeuilles non initialis√©s possibles. L&#8217;ensemble des portefeuilles possibles est si grand (2<sup>512</sup>) qu&#8217;il n&#8217;y a aucune possibilit√© pratique de forcer brutalement ou de deviner accidentellement celui qui est utilis√©.</p>
</div>
<div class="admonitionblock tip data-line-273">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-274">
<p>Il n&#8217;y a pas de "mauvaises" phrases secr√®tes dans BIP-39. Chaque phrase secr√®te m√®ne √† un portefeuille qui, √† moins qu&#8217;il n&#8217;ait √©t√© utilis√© auparavant, sera vide.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-277">
<p>La phrase secr√®te facultative cr√©e deux fonctionnalit√©s importantes¬†:</p>
</div>
<div class="ulist data-line-279">
<ul>
<li class="data-line-279">
<p>Un deuxi√®me facteur (quelque chose de m√©moris√©) qui rend un mn√©monique inutile par lui-m√™me, prot√©geant les sauvegardes mn√©moniques de la compromission par un voleur.</p>
</li>
<li class="data-line-281">
<p>Une forme de d√©ni plausible ou "portefeuille sous contrainte", o√π une phrase secr√®te choisie m√®ne √† un portefeuille avec une petite quantit√© de fonds utilis√©e pour distraire un attaquant du "vrai" portefeuille qui contient la majorit√© des fonds.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-283">
<p>Cependant, il est important de noter que l&#8217;utilisation d&#8217;une phrase secr√®te introduit √©galement un risque de perte¬†:</p>
</div>
<div class="ulist data-line-285">
<ul>
<li class="data-line-285">
<p>Si le propri√©taire du portefeuille est incapacit√© ou d√©c√©d√© et que personne d&#8217;autre ne conna√Æt la phrase secr√®te, le code mn√©monique est inutile et tous les fonds stock√©s dans le portefeuille sont perdus √† jamais.</p>
</li>
<li class="data-line-287">
<p>√Ä l&#8217;inverse, si le propri√©taire sauvegarde la phrase secr√®te au m√™me endroit que le code mn√©monique, cela va √† l&#8217;encontre de l&#8217;objectif d&#8217;un deuxi√®me facteur.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-289">
<p>Bien que les phrases secr√®tes soient tr√®s utiles, elles ne doivent √™tre utilis√©es qu&#8217;en combinaison avec un processus soigneusement planifi√© de sauvegarde et de r√©cup√©ration, compte tenu de la possibilit√© de survivre au propri√©taire et de permettre √† sa famille de r√©cup√©rer le patrimoine de la cryptomonnaie.</p>
</div>
</div>
<div class="sect4 data-line-291">
<h5 id="_travailler_avec_des_codes_mn√©moniques">Travailler avec des codes mn√©moniques</h5>
<div class="paragraph data-line-293">
<p>BIP-39 est impl√©ment√© en tant que biblioth√®que dans de nombreux langages de programmation diff√©rents¬†:</p>
</div>
<div class="dlist data-line-295">
<dl>
<dt class="hdlist1"><a href="https://github.com/trezor/python-mnemonic" data-href="https://github.com/trezor/python-mnemonic">python-mnemonic</a></dt>
<dd>
<p>L&#8217;impl√©mentation de r√©f√©rence de la norme par l&#8217;√©quipe SatoshiLabs qui a propos√© BIP-39, en Python</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/bitcoinjs/bip39" data-href="https://github.com/bitcoinjs/bip39">bitcoinjs/bip39</a></dt>
<dd>
<p>Une impl√©mentation de BIP-39, dans le cadre du populaire framework bitcoinJS, en JavaScript</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/libbitcoin/libbitcoin/blob/master/src/wallet/mnemonic.cpp" data-href="https://github.com/libbitcoin/libbitcoin/blob/master/src/wallet/mnemonic.cpp">libbitcoin/mnemonic</a></dt>
<dd>
<p>Une impl√©mentation de BIP-39, dans le cadre du populaire framework Libbitcoin, en <span class="keep-together">C++</span></p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3 data-line-301">
<h4 id="_cr√©er_un_portefeuille_hd_√†_partir_de_la_valeur_damor√ßage">Cr√©er un portefeuille HD √† partir de la valeur d&#8217;amor√ßage</h4>
<div class="paragraph data-line-303">
<p>Les portefeuilles HD sont cr√©√© √† partir d&#8217;une seule <em>valeur d&#8217;amor√ßage racine</em>, qui est un nombre al√©atoire de 128, 256 ou 512 bits. Le plus souvent, cette valeur d&#8217;amor√ßage est g√©n√©r√©e √† partir d&#8217;un <em>mnemonique</em> comme d√©taill√© dans la section pr√©c√©dente.</p>
</div>
<div class="paragraph data-line-305">
<p>Chaque cl√© du portefeuille HD est d√©riv√©e de mani√®re d√©terministe de cette valeur d&#8217;amor√ßage racine, ce qui permet de recr√©er l&#8217;int√©gralit√© du portefeuille HD √† partir de cette valeur d&#8217;amor√ßage dans n&#8217;importe quel portefeuille HD compatible. Cela facilite la sauvegarde, la restauration, l&#8217;exportation et l&#8217;importation de portefeuilles HD contenant des milliers, voire des millions de cl√©s en transf√©rant simplement uniquement le mn√©monique dont la valeur d&#8217;amor√ßage racine est d√©riv√©e.</p>
</div>
<div class="paragraph data-line-307">
<p>Le processus de cr√©ation des cl√©s principales et du code de cha√Æne principal pour un portefeuille HD est illustr√© dans <a href="#HDWalletFromSeed">Cr√©ation de cl√©s principales et de code de cha√Æne √† partir d&#8217;une valeur d&#8217;amor√ßage racine</a>.</p>
</div>
<div id="HDWalletFromSeed" class="imageblock data-line-311">
<div class="content">
<img src="images/mbc2_0509.png" alt="Valeur d&#8217;amor√ßage racine du portefeuille HD">
</div>
<div class="title">Figure 30. Cr√©ation de cl√©s principales et de code de cha√Æne √† partir d&#8217;une valeur d&#8217;amor√ßage racine</div>
</div>
<div class="paragraph data-line-313">
<p>La valeur d&#8217;amor√ßage racine est entr√©e dans l&#8217;algorithme HMAC-SHA512 et le hachage r√©sultant est utilis√© pour cr√©er une <em>cl√© priv√©e principale</em> (m) et un <em>code de cha√Æne principal</em> (c).</p>
</div>
<div class="paragraph data-line-315">
<p>La cl√© priv√©e principale (m) g√©n√®re ensuite une cl√© publique principale correspondante (M) en utilisant le processus normal de multiplication de courbe elliptique <code>m * G</code> que nous avons vu dans <a href="#pubkey">Cl√©s publiques</a>.</p>
</div>
<div class="paragraph data-line-317">
<p>Le code de cha√Æne (c) est utilis√© pour introduire de l&#8217;entropie dans la fonction qui cr√©e des cl√©s enfants √† partir des cl√©s parents, comme nous le verrons dans la section suivante.</p>
</div>
<div class="sect4 data-line-319">
<h5 id="_d√©rivation_de_cl√©_enfant_priv√©e">D√©rivation de cl√© enfant priv√©e</h5>
<div class="paragraph data-line-321">
<p>Les portefeuilles HD utilisent une fonction <em>d√©rivation de la cl√© enfant</em> (CKD) pour d√©river les cl√©s enfants √† partir des cl√©s parents.</p>
</div>
<div class="paragraph data-line-323">
<p>Les fonctions de d√©rivation de la cl√© enfant sont bas√©es sur une fonction de hachage unidirectionnelle qui combine¬†:</p>
</div>
<div class="ulist data-line-325">
<ul>
<li class="data-line-325">
<p>Une cl√© priv√©e ou publique parent (cl√© compress√©e ECDSA)</p>
</li>
<li class="data-line-326">
<p>Une valeur d&#8217;amor√ßage appel√©e code de cha√Æne (256 bits)</p>
</li>
<li class="data-line-327">
<p>Un num√©ro d&#8217;index (32 bits)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-329">
<p>Le code de cha√Æne est utilis√© pour introduire des donn√©es al√©atoires d√©terministes dans le processus, de sorte que la connaissance de l&#8217;index et d&#8217;une cl√© enfant ne suffit pas pour d√©river d&#8217;autres cl√©s enfants. Conna√Ætre une cl√© enfant ne permet pas de retrouver ses fr√®res et s≈ìurs, sauf si vous disposez √©galement du code cha√Æne. La valeur d&#8217;amor√ßage de code de cha√Æne initiale (√† la racine de l&#8217;arborescence) est cr√©√©e √† partir de la valeur d&#8217;amor√ßage, tandis que les codes de cha√Æne enfants suivants sont d√©riv√©s de chaque code de cha√Æne parent.</p>
</div>
<div class="paragraph data-line-331">
<p>Ces trois √©l√©ments (cl√© parent, code de cha√Æne et index) sont combin√©s et hach√©s pour g√©n√©rer des cl√©s enfants, comme suit.</p>
</div>
<div class="paragraph data-line-333">
<p>La cl√© publique parent, le code de cha√Æne et le num√©ro d&#8217;index sont combin√©s et hach√©s avec l&#8217;algorithme HMAC-SHA512 pour produire un hachage de 512 bits. Ce hachage de 512 bits est divis√© en deux moiti√©s de 256 bits. Les 256 bits de la moiti√© droite de la sortie de hachage deviennent le code de cha√Æne pour l&#8217;enfant. Les 256 bits de la moiti√© gauche du hachage sont ajout√©s √† la cl√© parent pour produire la cl√© priv√©e enfant. Dans <a href="#CKDpriv">√âtendre une cl√© priv√©e parent pour cr√©er une cl√© priv√©e enfant</a>, nous voyons cela illustr√© avec l&#8217;index mis √† 0 pour produire l&#8217;enfant "z√©ro" (premier par index) du parent.</p>
</div>
<div id="CKDpriv" class="imageblock data-line-337">
<div class="content">
<img src="images/mbc2_0510.png" alt="D√©rivation enfant priv√©e">
</div>
<div class="title">Figure 31. √âtendre une cl√© priv√©e parent pour cr√©er une cl√© priv√©e enfant</div>
</div>
<div class="paragraph data-line-339">
<p>Changer l&#8217;index nous permet d&#8217;√©tendre le parent et de cr√©er les autres enfants dans la s√©quence, par exemple, Enfant 0, Enfant 1, Enfant 2, etc. Chaque cl√© parent peut avoir 2 147 483 647 (2<sup>31</sup>) enfants (2<sup>31</sup> est moiti√© de la plage enti√®re 2<sup>32</sup> disponible car l&#8217;autre moiti√© est r√©serv√©e √† un type sp√©cial de d√©rivation dont nous parlerons plus loin dans ce chapitre).</p>
</div>
<div class="paragraph data-line-341">
<p>En r√©p√©tant le processus un niveau plus bas dans l&#8217;arbre, chaque enfant peut √† son tour devenir parent et cr√©er ses propres enfants, dans un nombre infini de g√©n√©rations.</p>
</div>
</div>
<div class="sect4 data-line-343">
<h5 id="_utilisation_de_cl√©s_enfants_d√©riv√©es">Utilisation de cl√©s enfants d√©riv√©es</h5>
<div class="paragraph data-line-345">
<p>Les cl√©s priv√©es enfants ne peuvent pas √™tre distingu√©es des cl√©s non d√©terministes (al√©atoires). Comme la fonction de d√©rivation est une fonction √† sens unique, la cl√© enfant ne peut pas √™tre utilis√©e pour trouver la cl√© parent. La cl√© enfant ne peut pas non plus √™tre utilis√©e pour trouver des fr√®res et s≈ìurs. Si vous avez le n<sub>i√®me</sub> enfant, vous ne pouvez pas trouver ses fr√®res et s≈ìurs, tels que l&#8217;enfant n‚Äì1 ou l&#8217;enfant n+1, ou tout autre enfant faisant partie de la s√©quence. Seuls la cl√© parent et le code de cha√Æne peuvent d√©river tous les enfants. Sans le code de cha√Æne enfant, la cl√© enfant ne peut pas non plus √™tre utilis√©e pour d√©river des petits-enfants. Vous avez besoin √† la fois de la cl√© priv√©e enfant et du code de cha√Æne enfant pour d√©marrer une nouvelle branche et d√©river des petits-enfants.</p>
</div>
<div class="paragraph data-line-347">
<p>Alors, √† quoi peut servir la cl√© priv√©e enfant seule¬†? Il peut √™tre utilis√© pour cr√©er une cl√© publique et une adresse Bitcoin. Ensuite, il peut √™tre utilis√© pour signer des transactions afin de d√©penser tout ce qui est pay√© √† cette adresse.</p>
</div>
<div class="admonitionblock tip data-line-350">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-351">
<p>Une cl√© priv√©e enfant, la cl√© publique correspondante et l&#8217;adresse Bitcoin sont toutes indiscernables des cl√©s et des adresses cr√©√©es au hasard. Le fait qu&#8217;ils fassent partie d&#8217;une s√©quence n&#8217;est pas visible en dehors de la fonction de portefeuille HD qui les a cr√©√©s. Une fois cr√©√©es, elles fonctionnent exactement comme des cl√©s "normales".</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 data-line-354">
<h5 id="_touches_√©tendues">Touches √©tendues</h5>
<div class="paragraph data-line-356">
<p>Comme nous l&#8217;avons vu pr√©c√©demment, la fonction de d√©rivation de cl√© peut √™tre utilis√©e pour cr√©er des enfants √† n&#8217;importe quel niveau de l&#8217;arborescence, en fonction sur les trois entr√©es¬†: une cl√©, un code cha√Æne et l&#8217;index de l&#8217;enfant souhait√©. Les deux ingr√©dients essentiels sont la cl√© et le code de cha√Æne, et combin√©s, ils s&#8217;appellent une <em>cl√© √©tendue</em>. Le terme "cl√© √©tendue" pourrait √©galement √™tre consid√©r√© comme une "cl√© extensible" car une telle cl√© peut √™tre utilis√©e pour d√©river des enfants.</p>
</div>
<div class="paragraph data-line-358">
<p>Les cl√©s √©tendues sont stock√©es et repr√©sent√©es simplement comme la concat√©nation de la cl√© de 256 bits et du code de cha√Æne de 256 bits dans une s√©quence de 512 bits. Il existe deux types de cl√©s √©tendues. Une cl√© priv√©e √©tendue est la combinaison d&#8217;une cl√© priv√©e et d&#8217;un code de cha√Æne et peut √™tre utilis√©e pour d√©river des cl√©s priv√©es enfants (et √† partir de celles-ci, des cl√©s publiques enfants). Une cl√© publique √©tendue est une cl√© publique et un code de cha√Æne, qui peuvent √™tre utilis√©s pour cr√©er des cl√©s publiques enfants (<em>public uniquement</em>), comme d√©crit dans <a href="#public_key_derivation">G√©n√©ration d&#8217;une cl√© publique</a>.</p>
</div>
<div class="paragraph data-line-360">
<p>Consid√©rez une cl√© √©tendue comme la racine d&#8217;une branche dans l&#8217;arborescence du portefeuille HD. Avec la racine de la branche, vous pouvez d√©river le reste de la branche. La cl√© priv√©e √©tendue peut cr√©er une branche compl√®te, tandis que la cl√© publique √©tendue peut cr√©er <em>uniquement</em> une branche de cl√©s publiques.</p>
</div>
<div class="admonitionblock tip data-line-363">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-364">
<p>Une cl√© √©tendue se compose d&#8217;une cl√© priv√©e ou publique et d&#8217;un code de cha√Æne. Une cl√© √©tendue peut cr√©er des enfants, g√©n√©rant sa propre branche dans l&#8217;arborescence. Le partage d&#8217;une cl√© √©tendue donne acc√®s √† l&#8217;ensemble de la branche.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-367">
<p>Les cl√©s √©tendues sont encod√©es √† l&#8217;aide de Base58Check, pour exporter et importer facilement entre diff√©rents portefeuilles compatibles BIP-32. Le codage Base58Check pour les cl√©s √©tendues utilise une somme de contr√¥le qui se traduit par le pr√©fixe "xprv" et "xpub" lorsqu&#8217;il est cod√© en caract√®res Base58 pour les rendre facilement reconnaissables. √âtant donn√© que la cl√© √©tendue est de 512 ou 513 bits, elle est √©galement beaucoup plus longue que les autres cha√Ænes cod√©es en Base58Check que nous avons vues pr√©c√©demment.</p>
</div>
<div class="paragraph data-line-369">
<p>Voici un exemple de cl√© <em>priv√©e</em> √©tendue, cod√©e en Base58Check¬†:</p>
</div>
<div class="listingblock data-line-371">
<div class="content">
<pre>xprv9tyUQV64JT5qs3RSTJkXCWKMyUgoQp7F3hA1xzG6ZGu6u6Q9VMNjGr67Lctvy5P8oyaYAL9CAWrUE9i6GoNMKUga5biW6Hx4tws2six3b9c</pre>
</div>
</div>
<div class="paragraph data-line-375">
<p>Voici la cl√© <em>publique</em> √©tendue correspondante, cod√©e en Base58Check¬†:</p>
</div>
<div class="listingblock data-line-377">
<div class="content">
<pre>xpub67xpozcx8pe95XVuZLHXZeG6XWXHpGq6Qv5cmNfi7cS5mtjJ2tgypeQbBs2UAR6KECeeMVKZBPLrtJunSDMstweyLXhRgPxdp14sk9tJPW9</pre>
</div>
</div>
</div>
<div class="sect4 data-line-382">
<h5 id="public__child_key_derivation">D√©rivation de la cl√© enfant publique</h5>
<div class="paragraph data-line-384">
<p>Comme mentionn√© pr√©c√©demment, une caract√©ristique tr√®s utile des portefeuilles HD est la possibilit√© de d√©river des cl√©s publiques enfant √† partir de cl√©s publiques parent, <em>sans</em> avoir les cl√©s priv√©es. Cela nous donne deux fa√ßons de d√©river une cl√© publique enfant¬†: soit √† partir de la cl√© priv√©e enfant, soit directement √† partir de la cl√© publique parent.</p>
</div>
<div class="paragraph data-line-386">
<p>Une cl√© publique √©tendue peut donc √™tre utilis√©e pour d√©river toutes les cl√©s <em>publiques</em> (et uniquement les cl√©s publiques) dans cette branche de la structure du portefeuille HD.</p>
</div>
<div class="paragraph data-line-388">
<p>Ce raccourci peut √™tre utilis√© pour cr√©er des d√©ploiements tr√®s s√©curis√©s √† cl√© publique uniquement dans lesquels un serveur ou une application poss√®de une copie d&#8217;une cl√© publique √©tendue et aucune cl√© priv√©e. Ce type de d√©ploiement peut produire un nombre infini de cl√©s publiques et d&#8217;adresses Bitcoin, mais ce type de d√©ploiement ne permet pas d√©penser l&#8217;argent envoy√© √† ces adresses. Pendant ce temps, sur un autre serveur plus s√©curis√©, la cl√© priv√©e √©tendue peut d√©river toutes les cl√©s priv√©es correspondantes pour signer des transactions et d√©penser de l&#8217;argent.</p>
</div>
<div class="paragraph data-line-390">
<p>Une application courante de cette solution consiste √† installer une cl√© publique √©tendue sur un serveur Web qui sert une application de commerce √©lectronique. Le serveur Web peut utiliser la fonction de d√©rivation de cl√© publique pour cr√©er une nouvelle adresse Bitcoin pour chaque transaction (par exemple, pour le panier d&#8217;un client). Le serveur Web n&#8217;aura aucune cl√© priv√©e qui serait vuln√©rable au vol. Sans les portefeuilles HD, la seule fa√ßon d&#8217;y parvenir est de g√©n√©rer des milliers d&#8217;adresses Bitcoin sur un serveur s√©curis√© s√©par√©, puis de les pr√©charger sur le serveur de commerce √©lectronique. Cette approche est lourde et n√©cessite une maintenance constante pour s&#8217;assurer que le serveur de commerce √©lectronique ne "manque" pas d&#8217;adresses.</p>
</div>
<div class="paragraph data-line-392">
<p>Une autre application courante de cette solution est le stockage √† froid ou les portefeuilles mat√©riels. Dans ce sc√©nario, la cl√© priv√©e √©tendue peut √™tre stock√©e sur un portefeuille papier ou un p√©riph√©rique mat√©riel (tel qu&#8217;un portefeuille mat√©riel Trezor), tandis que la cl√© publique √©tendue peut √™tre conserv√©e en ligne. L&#8217;utilisateur peut cr√©er des adresses "de r√©ception" √† volont√©, tandis que les cl√©s priv√©es sont stock√©es en toute s√©curit√© hors ligne. Pour d√©penser les fonds, l&#8217;utilisateur peut utiliser la cl√© priv√©e √©tendue sur un client Bitcoin de signature hors ligne ou signer des transactions sur le p√©riph√©rique de portefeuille mat√©riel (par exemple, Trezor). <a href="#CKDpub">√âtendre une cl√© publique parent pour cr√©er une cl√© publique enfant</a> illustre le m√©canisme d&#8217;extension d&#8217;une cl√© publique parent pour d√©river des cl√©s publiques enfants.</p>
</div>
<div id="CKDpub" class="imageblock data-line-396">
<div class="content">
<img src="images/mbc2_0511.png" alt="D√©rivation enfant publique">
</div>
<div class="title">Figure 32. √âtendre une cl√© publique parent pour cr√©er une cl√© publique enfant</div>
</div>
</div>
<div class="sect4 data-line-398">
<h5 id="_d√©rivation_de_cl√©_enfant_renforc√©e">D√©rivation de cl√© enfant renforc√©e</h5>
<div class="paragraph data-line-400">
<p>La possibilit√© de d√©river une branche de cl√©s publiques √† partir d&#8217;un xpub est tr√®s utile, mais elle est potentiellement risqu√©e. L&#8217;acc√®s √† une xpub ne donne pas acc√®s aux cl√©s priv√©es enfants. Cependant, √©tant donn√© que xpub contient le code de cha√Æne, si une cl√© priv√©e enfant est connue ou divulgu√©e d&#8217;une mani√®re ou d&#8217;une autre, elle peut √™tre utilis√©e avec le code de cha√Æne pour d√©river toutes les autres cl√©s priv√©es enfants. Une seule cl√© priv√©e enfant divulgu√©e, associ√©e √† un code de cha√Æne parent, r√©v√®le toutes les cl√©s priv√©es de tous les enfants. Pire encore, la cl√© priv√©e enfant associ√©e √† un code de cha√Æne parent peut √™tre utilis√©e pour d√©duire la cl√© priv√©e parent.</p>
</div>
<div class="paragraph data-line-402">
<p>Pour contrer ce risque, les portefeuilles HD utilisent une fonction de d√©rivation alternative appel√©e <em>d√©rivation renforc√©e</em>, qui "casse" la relation entre la cl√© publique parent et le code de cha√Æne enfant. La fonction de d√©rivation renforc√©e utilise la cl√© priv√©e parent pour d√©river le code de cha√Æne enfant, au lieu de la cl√© publique parent. Cela cr√©e un "pare-feu" dans la s√©quence parent/enfant, avec un code de cha√Æne qui ne peut pas √™tre utilis√© pour compromettre une cl√© priv√©e parent ou s≈ìur. La fonction de d√©rivation renforc√©e semble presque identique √† la d√©rivation de cl√© priv√©e enfant normale, sauf que la cl√© priv√©e parent est utilis√©e comme entr√©e de la fonction de hachage, au lieu de la cl√© publique parent, comme indiqu√© dans le diagramme de <a href="#CKDprime">D√©rivation renforc√©e d&#8217;une cl√© enfant¬†; omet la cl√© publique parent</a>.</p>
</div>
<div id="CKDprime" class="imageblock data-line-406">
<div class="content">
<img src="images/mbc2_0513.png" alt="D√©rivation enfant stricte priv√©e">
</div>
<div class="title">Figure 33. D√©rivation renforc√©e d&#8217;une cl√© enfant¬†; omet la cl√© publique parent</div>
</div>
<div class="paragraph pagebreak-before data-line-409">
<p>Lorsque la fonction de d√©rivation priv√©e renforc√©e est utilis√©e, la cl√© priv√©e enfant et le code de cha√Æne r√©sultants sont compl√®tement diff√©rents de ce qui r√©sulterait de la fonction de d√©rivation normale. La "branche" de cl√©s r√©sultante peut √™tre utilis√©e pour produire des cl√©s publiques √©tendues qui ne sont pas vuln√©rables, car le code de cha√Æne qu&#8217;elles contiennent ne peut pas √™tre exploit√© pour r√©v√©ler des cl√©s priv√©es. La d√©rivation renforc√©e est donc utilis√©e pour cr√©er un "trou" dans l&#8217;arborescence au-dessus du niveau o√π les cl√©s publiques √©tendues sont utilis√©es.</p>
</div>
<div class="paragraph data-line-411">
<p>En termes simples, si vous souhaitez utiliser la commodit√© d&#8217;un xpub pour d√©river des branches de cl√©s publiques, sans vous exposer au risque d&#8217;une fuite de code de cha√Æne, vous devez le d√©river d&#8217;une cl√© parent renforc√©e, plut√¥t que d&#8217;une cl√© normale (non-renforc√©e) cl√© parent. En tant que meilleure pratique, les enfants de niveau 1 des cl√©s principales sont toujours d√©riv√©s via la d√©rivation renforc√©e, pour √©viter la compromission des cl√©s principales.</p>
</div>
</div>
<div class="sect4 data-line-413">
<h5 id="_num√©ros_dindex_pour_d√©rivation_normale_et_durcie">Num√©ros d&#8217;index pour d√©rivation normale et durcie</h5>
<div class="paragraph data-line-415">
<p>Le num√©ro d&#8217;index utilis√© dans la fonction de d√©rivation est un entier de 32 bits. Pour distinguer facilement les cl√©s d√©riv√©es par la fonction de d√©rivation normale des cl√©s d√©riv√©es par d√©rivation renforc√©e, ce num√©ro d&#8217;index est divis√© en deux plages. Les num√©ros d&#8217;index entre 0 et 2<sup>31</sup>‚Äì1 (0x0 √† 0x7FFFFFFF) sont utilis√©s <em>uniquement</em> pour la d√©rivation normale. Les num√©ros d&#8217;index entre 2<sup>31</sup> et 2<sup>32</sup>‚Äì1 (0x80000000 √† 0xFFFFFFFF) sont utilis√©s <em>uniquement</em> pour la d√©rivation renforc√©e. Donc, si l&#8217;indice est inf√©rieur √† 2<sup>31</sup>, l&#8217;enfant est normal, alors que si l&#8217;indice est √©gal ou sup√©rieur √† 2<sup>31</sup>, l&#8217;enfant est renforc√©.</p>
</div>
<div class="paragraph data-line-417">
<p>Pour faciliter la lecture et l&#8217;affichage du num√©ro d&#8217;index, le num√©ro d&#8217;index pour les enfants renforc√©s est affich√© √† partir de z√©ro, mais avec un symbole prime. La premi√®re cl√© enfant normale s&#8217;affiche donc sous la forme 0, tandis que la premi√®re cl√© enfant renforc√©e (index 0x80000000) s&#8217;affiche sous la forme 0 <code><strong>'</strong></code> . Dans l&#8217;ordre, la deuxi√®me cl√© renforc√©e aurait l&#8217;index 0x80000001 et serait affich√©e sous la forme 1 <code><strong>'</strong></code> , et ainsi de suite. Lorsque vous voyez un index de portefeuille HD i <code><strong>'</strong></code> , cela signifie 2<sup>31</sup>+i.</p>
</div>
</div>
<div class="sect4 data-line-419">
<h5 id="_identifiant_de_cl√©_de_portefeuille_hd_chemin">Identifiant de cl√© de portefeuille HD (chemin)</h5>
<div class="paragraph data-line-421">
<p>Les cl√©s d&#8217;un portefeuille HD sont identifi√©es √† l&#8217;aide d&#8217;une convention de d√©nomination "chemin", o√π chaque niveau de l&#8217;arborescence est s√©par√© par une barre oblique (/) (voir <a href="#table_4-8">Exemples de chemin de portefeuille HD</a>). Les cl√©s priv√©es d√©riv√©es de la cl√© priv√©e principale commencent par "m". Les cl√©s publiques d√©riv√©es de la cl√© publique principale commencent par ¬´¬†M¬†¬ª. Par cons√©quent, la premi√®re cl√© priv√©e enfant de la cl√© priv√©e principale est m/0. La premi√®re cl√© publique enfant est M/0. Le deuxi√®me petit-enfant du premier enfant est m/0/1, et ainsi de suite.</p>
</div>
<div class="paragraph data-line-423">
<p>L'"ascendance" d&#8217;une cl√© se lit de droite √† gauche, jusqu&#8217;√† atteindre la cl√© ma√Ætresse dont elle est issue. Par exemple, l&#8217;identifiant m/x/y/z d√©crit la cl√© priv√©e qui est le z-i√®me enfant de la cl√© priv√©e parent m/x/y, qui est le y-i√®me enfant de la cl√© priv√©e parent m/x, qui est le x-i√®me enfant de la cl√© priv√©e principale parente m.</p>
</div>
<table id="table_4-8" class="tableblock frame-all grid-all stretch data-line-428">
<caption class="title">Table 14. Exemples de chemin de portefeuille HD</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Chemin HD</th>
<th class="tableblock halign-left valign-top">Cl√© d√©crite</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m/0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La premi√®re (0) cl√© priv√©e enfant de la cl√© priv√©e ma√Ætresse (m)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m/0/0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La premi√®re (0) cl√© priv√©e enfant du premier enfant (m/0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m/0'/0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le premier (0) enfant normal du premier enfant <em>renforc√©</em> (m/0')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m/1/0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La premi√®re (0) cl√© priv√©e enfant du deuxi√®me enfant (m/1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M/23/17/0/0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La premi√®re (0) cl√© publique enfant du premier enfant (M/23/17/0) du 18√®me enfant (M/23/17) du 24√®me enfant (M/23)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4 data-line-437">
<h5 id="_naviguer_dans_larborescence_du_portefeuille_hd">Naviguer dans l&#8217;arborescence du portefeuille HD</h5>
<div class="paragraph data-line-439">
<p>La structure arborescente du portefeuille HD offre une grande flexibilit√©. Chaque cl√© √©tendue parent peut avoir 4 milliards d&#8217;enfants¬†: 2 milliards d&#8217;enfants normaux et 2 milliards d&#8217;enfants renforc√©s. Chacun de ces enfants peut avoir 4 milliards d&#8217;enfants suppl√©mentaires, et ainsi de suite. L&#8217;arbre peut √™tre aussi profond que vous le souhaitez, avec un nombre infini de g√©n√©rations. Avec toute cette flexibilit√©, cependant, il devient assez difficile de naviguer dans cet arbre infini. Il est particuli√®rement difficile de transf√©rer des portefeuilles HD entre les impl√©mentations, car les possibilit√©s d&#8217;organisation interne en succursales et sous-succursales sont infinies.</p>
</div>
<div class="paragraph data-line-441">
<p>Deux BIP offrent une solution √† cette complexit√© en cr√©ant des propositions de normes pour la structure des arborescences de portefeuille HD. BIP-43 propose l&#8217;utilisation du premier index enfant renforc√© comme identifiant sp√©cial qui signifie le "but" de la structure arborescente. Bas√© sur BIP-43, un portefeuille HD ne devrait utiliser qu&#8217;une seule branche de niveau 1 de l&#8217;arborescence, le num√©ro d&#8217;index identifiant la structure et l&#8217;espace de noms du reste de l&#8217;arborescence en d√©finissant son objectif. Par exemple, un portefeuille HD utilisant uniquement la branche m/i <code><strong>'</strong></code> / est destin√© √† signifier un objectif sp√©cifique et cet objectif est identifi√© par le num√©ro d&#8217;index "i".</p>
</div>
<div class="paragraph data-line-443">
<p>En √©tendant cette sp√©cification, BIP-44 propose une structure multicompte en tant que num√©ro "d&#8217;objet" <code>44'</code> sous BIP-43. Tous les portefeuilles HD suivant la structure BIP-44 sont identifi√©s par le fait qu&#8217;ils n&#8217;utilisent qu&#8217;une seule branche de l&#8217;arborescence¬†: m/44'/.</p>
</div>
<div class="paragraph data-line-445">
<p>BIP-44 sp√©cifie la structure comme √©tant compos√©e de cinq niveaux d&#8217;arborescence pr√©d√©finis¬†:</p>
</div>
<div class="listingblock data-line-447">
<div class="content">
<pre>m / but' / type_monnaie' / compte' / change / index_adresse</pre>
</div>
</div>
<div class="paragraph data-line-451">
<p>Le "but" de premier niveau est toujours r√©gl√© sur 44'. Le "type_monnaie" de deuxi√®me niveau sp√©cifie le type de pi√®ce de cryptomonnaie, permettant des portefeuilles HD multidevises o√π chaque devise a son propre sous-arbre sous le deuxi√®me niveau. Il y a trois devises d√©finies pour l&#8217;instant¬†: Bitcoin est m/44'/0', Bitcoin Testnet est m/44 <code><strong>'</strong></code> /1 <code><strong>'</strong></code> , et Litecoin est m/44 <code><strong>'</strong></code> /2 <code><strong>'</strong></code> .</p>
</div>
<div class="paragraph data-line-453">
<p>Le troisi√®me niveau de l&#8217;arborescence est "compte", qui permet aux utilisateurs de subdiviser leurs portefeuilles en sous-comptes logiques distincts, √† des fins comptables ou organisationnelles. Par exemple, un portefeuille HD peut contenir deux "comptes" bitcoin¬†: m/44 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /0 <code><strong>'</strong></code>  et m/44 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /1 <code><strong>'</strong></code> . Chaque compte est la racine de sa propre sous-arborescence.</p>
</div>
<div class="paragraph data-line-455">
<p>Au quatri√®me niveau, "change", un portefeuille HD a deux sous-arborescences, une pour cr√©er des adresses de r√©ception et une pour cr√©er des adresses de modification. Notez qu&#8217;alors que les niveaux pr√©c√©dents utilisaient une d√©rivation renforc√©e, ce niveau utilise une d√©rivation normale. Cela permet √† ce niveau de l&#8217;arborescence d&#8217;exporter des cl√©s publiques √©tendues pour une utilisation dans un environnement non s√©curis√©. Les adresses utilisables sont d√©riv√©es par le portefeuille HD en tant qu&#8217;enfants du quatri√®me niveau, faisant du cinqui√®me niveau de l&#8217;arborescence l'"index_adresse". Par exemple, la troisi√®me adresse de r√©ception pour les paiements en bitcoins dans le compte principal serait M/44 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /0/2. <a href="#table_4-9">Exemples de structure de portefeuille HD BIP-44</a> montre quelques exemples suppl√©mentaires.</p>
</div>
<table id="table_4-9" class="tableblock frame-all grid-all stretch data-line-460">
<caption class="title">Table 15. Exemples de structure de portefeuille HD BIP-44</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Chemin HD</th>
<th class="tableblock halign-left valign-top">Cl√© d√©crite</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M/44 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /0/2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La troisi√®me cl√© publique de r√©ception pour le compte bitcoin principal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M/44 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /3 <code><strong>'</strong></code> /1/14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La quinzi√®me cl√© publique de changement d&#8217;adresse pour le quatri√®me compte bitcoin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m/44 <code><strong>'</strong></code> /2 <code><strong>'</strong></code> /0 <code><strong>'</strong></code> /0/1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La deuxi√®me cl√© priv√©e du compte principal Litecoin, pour la signature des transactions</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3 data-line-467">
<h4 id="_utilisation_dune_cl√©_publique_√©tendue_sur_une_boutique_en_ligne">Utilisation d&#8217;une cl√© publique √©tendue sur une boutique en ligne</h4>
<div class="paragraph data-line-469">
<p>Voyons comment les portefeuilles HD sont utilis√©s en poursuivant notre histoire avec la boutique en ligne de Gabriel.</p>
</div>
<div class="paragraph data-line-471">
<p>Gabriel a d&#8217;abord cr√©√© sa boutique en ligne comme passe-temps, bas√© sur une simple page Wordpress h√©berg√©e. Son magasin √©tait assez simple avec seulement quelques pages et un bon de commande avec une seule adresse Bitcoin.</p>
</div>
<div class="paragraph data-line-473">
<p>Gabriel a utilis√© la premi√®re adresse Bitcoin g√©n√©r√©e par son appareil Trezor comme adresse Bitcoin principale pour son magasin. De cette fa√ßon, tous les paiements entrants seraient vers√©s √† une adresse contr√¥l√©e par son portefeuille mat√©riel Trezor.</p>
</div>
<div class="paragraph data-line-475">
<p>Les clients soumettraient une commande en utilisant le formulaire et enverraient le paiement √† l&#8217;adresse Bitcoin publi√©e de Gabriel, d√©clenchant un e-mail avec les d√©tails de la commande √† traiter par Gabriel. Avec seulement quelques commandes par semaine, ce syst√®me fonctionnait assez bien.</p>
</div>
<div class="paragraph data-line-477">
<p>Cependant, la petite boutique en ligne a connu un certain succ√®s et a attir√© de nombreuses commandes de la communaut√© locale. Bient√¥t, Gabriel a √©t√© submerg√©. Avec toutes les commandes pay√©es √† la m√™me adresse, il devenait difficile de faire correspondre correctement les commandes et les transactions, en particulier lorsque plusieurs commandes pour le m√™me montant arrivaient √† proximit√©.</p>
</div>
<div class="paragraph data-line-479">
<p>Le portefeuille HD de Gabriel offre une bien meilleure solution gr√¢ce √† la possibilit√© de d√©river des cl√©s enfants publiques sans conna√Ætre les cl√©s priv√©es. Gabriel peut charger une cl√© publique √©tendue (xpub) sur son site Web, qui peut √™tre utilis√©e pour d√©river une adresse unique pour chaque commande client. Gabriel peut d√©penser les fonds de son Trezor, mais le xpub charg√© sur le site Web ne peut que g√©n√©rer des adresses et recevoir des fonds. Cette fonctionnalit√© des portefeuilles HD est une excellente fonctionnalit√© de s√©curit√©. Le site Web de Gabriel ne contient aucune cl√© priv√©e et n&#8217;a donc pas besoin de niveaux de s√©curit√© √©lev√©s.</p>
</div>
<div class="paragraph data-line-481">
<p>Pour exporter le xpub, Gabriel utilise l&#8217;application de bureau Trezor Suite en conjonction avec le portefeuille mat√©riel Trezor. L&#8217;appareil Trezor doit √™tre branch√© pour que les cl√©s publiques soient export√©es. Notez que les portefeuilles mat√©riels n&#8217;exporteront jamais de cl√©s priv√©es, celles-ci restant toujours sur l&#8217;appareil. <a href="#export_xpub">Exportation d&#8217;un xpub √† partir d&#8217;un portefeuille mat√©riel Trezor</a> montre ce que Gabriel voit dans Trezor Suite lors de l&#8217;exportation du xpub.</p>
</div>
<div id="export_xpub" class="imageblock data-line-485">
<div class="content">
<img src="images/mbc2_0512.png" alt="Exporter le xpub du Trezor">
</div>
<div class="title">Figure 34. Exportation d&#8217;un xpub √† partir d&#8217;un portefeuille mat√©riel Trezor</div>
</div>
<div class="paragraph data-line-487">
<p>Gabriel copie le xpub dans le logiciel de boutique bitcoin de sa boutique en ligne. Il utilise <em>BTCPay Server</em>, qui est une boutique en ligne open source pour une vari√©t√© de plates-formes d&#8217;h√©bergement Web et de contenu. BTCPay Server utilise le xpub pour g√©n√©rer une adresse unique pour chaque achat. </p>
</div>
<div class="sect4 data-line-489">
<h5 id="_d√©couverte_et_gestion_de_compte">D√©couverte et gestion de compte</h5>
<div class="paragraph data-line-491">
<p>L&#8217;entreprise de Gabriel est florissante. Il a fourni sa cl√© publique √©tendue (xpub) √† <em>BTCPay Server</em>, qui g√©n√®re des adresses uniques pour les clients de son site Web. Chaque fois qu&#8217;un client du site Web de Gabriel clique sur le bouton "Commander" avec une modalit√© de paiement sp√©cifi√©e (dans ce cas, bitcoin), <em>BTCPay Server</em> g√©n√®re une nouvelle adresse pour ce client. Plus pr√©cis√©ment, <em>BTCPay Server</em> it√®re sur l&#8217;arborescence <em>address_index</em> pour cr√©er une nouvelle adresse √† afficher au client, comme d√©fini par BIP-44. Si le client d√©cide de changer de m√©thode de paiement ou d&#8217;abandonner compl√®tement la transaction, cette adresse Bitcoin n&#8217;est pas utilis√©e et ne sera pas utilis√©e pour un autre client tout de suite.</p>
</div>
<div class="paragraph data-line-493">
<p>√Ä un moment donn√©, le site Web de Gabriel peut avoir un grand nombre d&#8217;adresses en attente pour les clients effectuant des achats, dont certaines peuvent rester inutilis√©es et √©ventuellement expirer. Une fois ces adresses expir√©es, <em>BTCPay Server</em> r√©utilisera ces adresses pour combler le vide dans l'<em>index_adresse</em>, mais il devient clair qu&#8217;il peut y avoir des vides entre les feuilles d'<em>index_adresse</em> de l&#8217;arbre d√©terministe hi√©rarchique o√π se trouve r√©ellement l&#8217;argent.</p>
</div>
<div class="paragraph data-line-495">
<p>Disons que Gabriel est int√©ress√© √† voir son montant total de bitcoin gagn√© sur un portefeuille de surveillance uniquement (celui qui vous permet de voir l&#8217;historique des transactions, mais pas de d√©penser des fonds) qui est distinct du serveur BTCPay mais √©galement conforme √† la norme BIP-44 . Comment ce portefeuille s√©par√© devrait-il rechercher des fonds dans ce vaste arbre hi√©rarchique, et quand devrait-il cesser de chercher¬†? La plupart des portefeuilles suivent g√©n√©ralement un processus it√©ratif qui utilise une limite pr√©d√©finie, connue sous le nom de <em>gap limit</em>. Si, lors de la recherche d&#8217;adresses utilis√©es, le portefeuille ne trouve pas d&#8217;adresses utilis√©es d&#8217;affil√©e au-del√† de ce nombre limite, il arr√™te de rechercher la cha√Æne d&#8217;adresses. La limite d&#8217;√©cart par d√©faut est g√©n√©ralement fix√©e √† 20. Ceci est d√©taill√© dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki">BIP-44</a>.</p>
</div>
<div class="admonitionblock tip data-line-498">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-499">
<p>Les limites d&#8217;√©cart expliquent le ph√©nom√®ne selon lequel l&#8217;importation d&#8217;un portefeuille peut afficher un solde incorrect ou nul. Les fonds ne sont pas perdus, mais plut√¥t, la fonction d&#8217;importation de portefeuille n&#8217;a pas travers√© suffisamment de feuilles pour d√©tecter pleinement les fonds. De nombreux portefeuilles permettent de modifier cette limite d&#8217;√©cart par d√©faut, et Gabriel peut avoir besoin d&#8217;augmenter cette limite pour permettre √† son portefeuille d&#8217;importer enti√®rement son historique de transactions.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-5">
<h2 id="transactions">Op√©rations</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-8">
<h3 id="ch06_intro">Pr√©sentation</h3>
<div class="paragraph data-line-10">
<p>Les transactions sont la partie la plus importante du syst√®me Bitcoin. Tout le reste dans le bitcoin est con√ßu pour garantir que les transactions peuvent √™tre cr√©√©es, propag√©es sur le r√©seau, valid√©es et finalement ajout√©es au grand livre mondial des transactions (la cha√Æne de blocs). Les transactions sont des structures de donn√©es qui encodent le transfert de valeur entre les participants au syst√®me Bitcoin. Chaque transaction est une entr√©e publique dans la cha√Æne de blocs de bitcoin, le grand livre comptable mondial en partie double.</p>
</div>
<div class="paragraph data-line-12">
<p>Dans ce chapitre, nous examinerons toutes les diff√©rentes formes de transactions, ce qu&#8217;elles contiennent, comment les cr√©er, comment elles sont v√©rifi√©es et comment elles deviennent partie int√©grante de l&#8217;enregistrement permanent de toutes les transactions. Lorsque nous utilisons le terme "portefeuille" dans ce chapitre, nous faisons r√©f√©rence au logiciel qui construit les transactions, et pas seulement √† la base de donn√©es des cl√©s.</p>
</div>
</div>
<div class="sect2 data-line-15">
<h3 id="tx_structure">Transactions en d√©tail</h3>
<div class="paragraph data-line-17">
<p>Dans <a href="#ch02_bitcoin_overview">Comment fonctionne Bitcoin</a>, nous avons examin√© la transaction utilis√©e par Alice pour payer un caf√© au Bob&#8217;s Caf√© √† l&#8217;aide d&#8217;un explorateur de blocs (<a href="#alices_transactions_to_bobs_cafe">Transaction d&#8217;Alice au Bob&#8217;s Caf√©</a>).</p>
</div>
<div class="paragraph data-line-19">
<p>L&#8217;application de l&#8217;explorateur de blocs montre une transaction de "l&#8217;adresse" d&#8217;Alice √† "l&#8217;adresse" de Bob. Il s&#8217;agit d&#8217;une vue tr√®s simplifi√©e de ce qui est contenu dans une transaction. En fait, comme nous le verrons dans ce chapitre, une grande partie des informations affich√©es sont construites par l&#8217;explorateur de blocs et ne se trouvent pas r√©ellement dans la transaction.</p>
</div>
<div id="alices_transactions_to_bobs_cafe" class="imageblock data-line-23">
<div class="content">
<img src="images/mbc2_0208.png" alt="Alice Coffee Transaction">
</div>
<div class="title">Figure 35. Transaction d&#8217;Alice au Bob&#8217;s Caf√©</div>
</div>
<div class="sect3 data-line-26">
<h4 id="transactions_behind_the_scenes">Transactions¬†: Dans les coulisses</h4>
<div class="paragraph data-line-28">
<p> Dans les coulisses, une transaction r√©elle est tr√®s diff√©rente d&#8217;une transaction fournie par un explorateur de blocs typique. En fait, la plupart des constructions de haut niveau que nous voyons dans les diff√©rentes interfaces utilisateur des applications bitcoin <em>n&#8217;existent pas r√©ellement</em> dans le syst√®me Bitcoin.</p>
</div>
<div class="paragraph data-line-30">
<p>Nous pouvons utiliser l&#8217;interface de ligne de commande de Bitcoin Core (<code>getrawtransaction</code> et <code>decoderawtransaction</code>) pour r√©cup√©rer la transaction "brute" d&#8217;Alice, la d√©coder et voir ce qu&#8217;elle contient. Le r√©sultat ressemble √† ceci¬†:</p>
</div>
<div id="alice_tx" class="listingblock data-line-35">
<div class="title">La transaction d&#8217;Alice d√©cod√©e</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "version": 1,
  "locktime": 0,
  "vin": [
    {
      "txid": "7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18",
      "vout": 0,
      "scriptSig" : "3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf",
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 0.01500000,
      "scriptPubKey": "OP_DUP OP_HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 OP_EQUALVERIFY OP_CHECKSIG"
    },
    {
      "value": 0.08450000,
      "scriptPubKey": "OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG",
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph data-line-60">
<p>Vous remarquerez peut-√™tre certaines choses √† propos de cette transaction, principalement les choses qui manquent¬†! O√π est l&#8217;adresse d&#8217;Alice ? O√π est l&#8217;adresse de Bob ? O√π est l&#8217;entr√©e 0.1 "envoy√©e" par Alice¬†? En bitcoin, il n&#8217;y a pas de pi√®ces, pas d&#8217;exp√©diteurs, pas de destinataires, pas de soldes, pas de comptes et pas d&#8217;adresses. Toutes ces choses sont construites √† un niveau sup√©rieur pour le b√©n√©fice de l&#8217;utilisateur, pour rendre les choses plus faciles √† comprendre.</p>
</div>
<div class="paragraph data-line-62">
<p>Vous pouvez √©galement remarquer de nombreux champs √©tranges et ind√©chiffrables et des cha√Ænes hexad√©cimales. Ne vous inqui√©tez pas, nous expliquerons en d√©tail chaque champ affich√© ici dans ce chapitre.</p>
</div>
</div>
</div>
<div class="sect2 data-line-65">
<h3 id="tx_inputs_outputs">Sorties et entr√©es de transaction</h3>
<div class="paragraph data-line-67">
<p>La base fondamentale d&#8217;une transaction bitcoin est une <em>sortie de transaction</em>. Les sorties de transaction sont des morceaux indivisibles de monnaie bitcoin, enregistr√©s sur la cha√Æne de blocs et reconnus comme valides par l&#8217;ensemble du r√©seau. Les n≈ìuds complets Bitcoin suivent toutes les sorties disponibles et utilisables, appel√©es <em>sorties de transaction non d√©pens√©es</em>, ou <em>UTXO</em>. La collection de tous les UTXO est connue sous le nom d'<em>ensemble UTXO</em> et compte actuellement des millions d&#8217;UTXO. L&#8217;ensemble UTXO augmente √† mesure que de nouveaux UTXO sont cr√©√©s et diminue lorsque UTXO est consomm√©. Chaque transaction repr√©sente un changement (transition d&#8217;√©tat) dans l&#8217;ensemble UTXO.</p>
</div>
<div class="paragraph data-line-69">
<p>Lorsque nous disons que le portefeuille d&#8217;un utilisateur a "re√ßu" du bitcoin, nous voulons dire que le portefeuille a d√©tect√© sur la cha√Æne de blocs un UTXO pouvant √™tre d√©pens√© avec l&#8217;une des cl√©s contr√¥l√©es par ce portefeuille. Ainsi, le "solde" de bitcoins d&#8217;un utilisateur est la somme de tous les UTXO que le portefeuille de l&#8217;utilisateur peut d√©penser et qui peuvent √™tre dispers√©s parmi des centaines de transactions et des centaines de blocs. Le concept de solde est cr√©√© par l&#8217;application de portefeuille. Le portefeuille calcule le solde de l&#8217;utilisateur en scannant la cha√Æne de blocs et en agr√©geant la valeur de tout UTXO que le portefeuille peut d√©penser avec les cl√©s qu&#8217;il contr√¥le. La plupart des portefeuilles maintiennent une base de donn√©es ou utilisent un service de base de donn√©es pour stocker un ensemble de r√©f√©rence rapide de tous les UTXO qu&#8217;ils peuvent d√©penser avec les cl√©s qu&#8217;ils contr√¥lent.</p>
</div>
<div class="paragraph data-line-71">
<p><a href="#utxo-stxo">Cha√Æne de transaction de Joe √† Gopesh en cours de construction sur la cha√Æne de blocs</a> affiche la cha√Æne de blocs √† trois moments diff√©rents, alors que la cha√Æne de transaction de Joe √† Gopesh est en cours de construction. Remarquez comment chaque transaction d√©pense un UTXO qui a √©t√© cr√©√© dans une transaction pr√©c√©dente, le transformant en une <em>sortie de transaction d√©pens√©e</em>, ou <em>STXO</em>. Puisque la transaction #1 (de Joe √† Alice) d√©pense un seul UTXO (de Joe) et cr√©e un seul UTXO (√† Alice), elle ne modifie pas la taille de l&#8217;ensemble UTXO. D&#8217;autre part, les transactions #2 et #3 cr√©ent toutes deux des sorties de change √† l&#8217;exp√©diteur, d√©pensant un seul UTXO et cr√©ant deux UTXO (le paiement et la sortie de change). Par cons√©quent, chacun d&#8217;eux augmente la taille de l&#8217;ensemble UTXO de 1.</p>
</div>
<div id="utxo-stxo" class="imageblock data-line-75">
<div class="content">
<img src="images/mbc2_0609.png" alt="Cha√Æne de transaction de Joe √† Gopesh en cours de construction sur la cha√Æne de blocs">
</div>
<div class="title">Figure 36. Cha√Æne de transaction de Joe √† Gopesh en cours de construction sur la cha√Æne de blocs</div>
</div>
<div class="paragraph data-line-77">
<p>Une sortie de transaction peut avoir une valeur arbitraire (enti√®re) libell√©e comme un multiple de satoshis. Tout comme les dollars peuvent √™tre divis√©s jusqu&#8217;√† deux d√©cimales sous forme de cents, le bitcoin peut √™tre divis√© jusqu&#8217;√† huit d√©cimales sous forme de satoshis. Bien qu&#8217;une sortie puisse avoir n&#8217;importe quelle valeur arbitraire, une fois cr√©√©e, elle est indivisible. Il s&#8217;agit d&#8217;une caract√©ristique importante des sorties qui doit √™tre soulign√©e¬†: les sorties sont des unit√©s de valeur <em>discr√®tes</em> et <em>indivisibles</em>, libell√©es en satoshis entiers. Une production non d√©pens√©e ne peut √™tre consomm√©e dans son int√©gralit√© que par une transaction.</p>
</div>
<div class="paragraph data-line-79">
<p>Si un UTXO est sup√©rieur √† la valeur souhait√©e d&#8217;une transaction, il doit toujours √™tre consomm√© dans son int√©gralit√© et le changement doit √™tre g√©n√©r√© dans la transaction. En d&#8217;autres termes, si vous avez un UTXO d&#8217;une valeur de 20 bitcoins et que vous souhaitez payer seulement 1 bitcoin, votre transaction doit consommer l&#8217;int√©gralit√© de l&#8217;UTXO de 20 bitcoins et produire deux sorties¬†: une payant 1 bitcoin au destinataire souhait√© et une autre payant 19 bitcoin en √©change. retour dans votre portefeuille. En raison de la nature indivisible des sorties de transaction, la plupart des transactions bitcoin devront g√©n√©rer du change.</p>
</div>
<div class="paragraph data-line-81">
<p>Imaginez une cliente qui ach√®te une boisson √† 1,50 $, puise dans son portefeuille et essaie de trouver une combinaison de pi√®ces et de billets de banque pour couvrir le co√ªt de 1,50 $. L&#8217;acheteur choisira la monnaie exacte si disponible, par exemple un billet d&#8217;un dollar et deux quarts (un quart vaut 0,25 $), ou une combinaison de coupures plus petites (six quarts), ou si n√©cessaire, une unit√© plus grande comme un billet de 5 $. Si elle remet trop d&#8217;argent, disons 5 $, au propri√©taire du magasin, elle s&#8217;attendra √† 3,50¬†$ de monnaie, qu&#8217;elle remettra dans son portefeuille et qu&#8217;elle disposera pour de futures transactions.</p>
</div>
<div class="paragraph data-line-83">
<p>De m√™me, une transaction bitcoin doit √™tre cr√©√©e √† partir de l&#8217;UTXO d&#8217;un utilisateur dans toutes les d√©nominations disponibles pour cet utilisateur. Les utilisateurs ne peuvent pas couper un UTXO en deux, pas plus qu&#8217;ils ne peuvent couper un billet d&#8217;un dollar en deux et l&#8217;utiliser comme monnaie. L&#8217;application de portefeuille de l&#8217;utilisateur s√©lectionne g√©n√©ralement √† partir de l&#8217;UTXO disponible de l&#8217;utilisateur pour composer un montant sup√©rieur ou √©gal au montant de transaction souhait√©.</p>
</div>
<div class="paragraph data-line-85">
<p>Comme dans la vraie vie, l&#8217;application bitcoin peut utiliser plusieurs strat√©gies pour satisfaire le montant de l&#8217;achat¬†: combiner plusieurs unit√©s plus petites, trouver la monnaie exacte ou utiliser une seule unit√© sup√©rieure √† la valeur de la transaction et rendre la monnaie. Tout cet assemblage complexe d&#8217;UTXO d√©pensables est effectu√© automatiquement par le portefeuille de l&#8217;utilisateur et est invisible pour les utilisateurs. Cela n&#8217;est pertinent que si vous construisez par programme des transactions brutes √† partir d&#8217;UTXO.</p>
</div>
<div class="paragraph data-line-87">
<p>Une transaction consomme des sorties de transaction non d√©pens√©es pr√©c√©demment enregistr√©es et cr√©e de nouvelles sorties de transaction qui peuvent √™tre consomm√©es par une transaction future. De cette fa√ßon, des morceaux de valeur bitcoin passent d&#8217;un propri√©taire √† l&#8217;autre dans une cha√Æne de transactions consommant et cr√©ant des UTXO.</p>
</div>
<div class="paragraph data-line-89">
<p>L&#8217;exception √† la cha√Æne de sortie et d&#8217;entr√©e est une type sp√©cial de transaction appel√© transaction <em>coinbase</em>, qui est la premi√®re transaction de chaque bloc. Cette transaction y est plac√©e par le mineur "gagnant" et cr√©e un tout nouveau bitcoin payable √† ce mineur en r√©compense de l&#8217;exploitation mini√®re. Cette transaction coinbase sp√©ciale ne consomme pas d&#8217;UTXO ; √† la place, il a un type sp√©cial d&#8217;entr√©e appel√© "coinbase". C&#8217;est ainsi que la masse mon√©taire du bitcoin est cr√©√©e pendant le processus de minage, comme nous le verrons dans <a href="#mining">Minage et Consensus</a>.</p>
</div>
<div class="admonitionblock tip data-line-92">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-93">
<p>Qu&#8217;est-ce qui vient en premier¬†? Entr√©es ou sorties, la poule ou l&#8217;≈ìuf ? Strictement parlant, les sorties viennent en premier parce que les transactions coinbase, qui g√©n√®rent de nouveaux bitcoins, n&#8217;ont pas d&#8217;entr√©es et cr√©ent des sorties √† partir de rien.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 data-line-97">
<h4 id="tx_outs">Sorties des transactions</h4>
<div class="paragraph data-line-99">
<p>Chaque transaction bitcoin cr√©e des sorties, qui sont enregistr√©es sur le grand livre bitcoin. Presque toutes ces sorties, √† une exception pr√®s (voir <a href="#op_return">Sortie d&#8217;enregistrement de donn√©es (RETURN)</a>) cr√©ent des morceaux de bitcoin utilisables appel√©s UTXO, qui sont ensuite reconnus par l&#8217;ensemble du r√©seau et disponibles pour que le propri√©taire les d√©pense lors d&#8217;une future transaction.</p>
</div>
<div class="paragraph data-line-101">
<p>Les UTXO sont suivis par chaque client Bitcoin √† n≈ìud complet dans l&#8217;ensemble UTXO. Les nouvelles transactions consomment (d√©pensent) une ou plusieurs de ces sorties de l&#8217;ensemble UTXO.</p>
</div>
<div class="paragraph data-line-103">
<p>Les sorties de transaction se composent de deux parties¬†:</p>
</div>
<div class="ulist data-line-105">
<ul>
<li class="data-line-105">
<p>Un montant de bitcoin, libell√© en <em>satoshis</em>, la plus petite unit√© de bitcoin</p>
</li>
<li class="data-line-106">
<p>Un puzzle cryptographique qui d√©termine les conditions requises pour passer la sortie</p>
</li>
</ul>
</div>
<div class="paragraph data-line-108">
<p>Le puzzle cryptographique est √©galement connu sous le nom de <em>script de verrouillage</em>, un <em>script de t√©moin</em> ou un <code>scriptPubKey</code>.</p>
</div>
<div class="paragraph data-line-110">
<p>Le langage de script de transaction, utilis√© dans le script de verrouillage mentionn√© pr√©c√©demment, est d√©crit en d√©tail dans <a href="#tx_script">Scripts de transaction et langage de script</a>.</p>
</div>
<div class="paragraph data-line-112">
<p>Maintenant, regardons la transaction d&#8217;Alice (montr√©e pr√©c√©demment dans <a href="#transactions_behind_the_scenes">Transactions¬†: Dans les coulisses</a>) et voir si nous pouvons identifier les sorties. Dans l&#8217;encodage JSON, les sorties sont dans un tableau (liste) nomm√© <code>vout</code>¬†:</p>
</div>
<div class="listingblock data-line-115">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vout": [
  {
    "value": 0.01500000,
    "scriptPubKey": "OP_DUP OP_HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 OP_EQUALVERIFY
    OP_CHECKSIG"
  },
  {
    "value": 0.08450000,
    "scriptPubKey": "OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG",
  }
]</code></pre>
</div>
</div>
<div class="paragraph data-line-129">
<p>Comme vous pouvez le voir, la transaction contient deux sorties. Chaque sortie est d√©finie par une valeur et un puzzle cryptographique. Dans l&#8217;encodage indiqu√© par Bitcoin Core, la valeur est indiqu√©e en bitcoin, mais dans la transaction elle-m√™me, elle est enregistr√©e sous la forme d&#8217;un entier libell√© en satoshis. La deuxi√®me partie de chaque sortie est le puzzle cryptographique qui fixe les conditions de d√©penses. Bitcoin Core le montre comme <code>scriptPubKey</code> et nous montre une repr√©sentation lisible par l&#8217;homme du script.</p>
</div>
<div class="paragraph data-line-131">
<p>Le sujet du verrouillage et du d√©verrouillage de l&#8217;UTXO sera abord√© plus tard, dans <a href="#tx_lock_unlock">Construction du script (Verrouiller + D√©verrouiller)</a>. Le langage de script utilis√© pour le script dans <code>scriptPubKey</code> est d√©crit dans <a href="#tx_script">Scripts de transaction et langage de script</a>. Mais avant d&#8217;approfondir ces sujets, nous devons comprendre la structure globale des entr√©es et sorties des transactions.</p>
</div>
<div class="sect4 data-line-133">
<h5 id="_s√©rialisation_des_transactions_sorties">S√©rialisation des transactions¬†: sorties</h5>
<div class="paragraph data-line-135">
<p>Lorsque les transactions sont transmises sur le r√©seau ou √©chang√©es entre applications, elles sont <em>s√©rialis√©es</em>. La s√©rialisation est le processus de conversion de la repr√©sentation interne d&#8217;une structure de donn√©es dans un format qui peut √™tre transmis un octet √† la fois, √©galement appel√© flux d&#8217;octets. La s√©rialisation est le plus souvent utilis√©e pour coder des structures de donn√©es √† transmettre sur un r√©seau ou √† stocker dans un fichier. Le format de s√©rialisation d&#8217;une sortie de transaction est affich√© dans <a href="#tx_out_structure">S√©rialisation des sorties de transaction</a>.</p>
</div>
<table id="tx_out_structure" class="tableblock frame-all grid-all stretch data-line-140">
<caption class="title">Table 16. S√©rialisation des sorties de transaction</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 octets (petit-boutiste)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Montant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valeur du bitcoin en satoshis (10<sup>-8</sup> bitcoin)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1‚Äì9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille du script de verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur du script de verrouillage en octets, √† suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script de verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un script d√©finissant les conditions n√©cessaires pour d√©penser la sortie</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-147">
<p>La plupart des biblioth√®ques et frameworks bitcoin ne stockent pas les transactions en interne sous forme de flux d&#8217;octets, car cela n√©cessiterait une analyse complexe chaque fois que vous auriez besoin d&#8217;acc√©der √† un seul champ. Pour plus de commodit√© et de lisibilit√©, les biblioth√®ques bitcoin stockent les transactions en interne dans des structures de donn√©es (g√©n√©ralement des structures orient√©es objet).</p>
</div>
<div class="paragraph data-line-149">
<p>Le processus de conversion de la repr√©sentation de flux d&#8217;octets d&#8217;une transaction en donn√©es de repr√©sentation interne d&#8217;une biblioth√®que est appel√©e <em>d√©s√©rialisation</em> ou <em>analyse des transactions</em>. Le processus de reconversion en un flux d&#8217;octets pour la transmission sur le r√©seau, pour le hachage ou pour le stockage sur disque est appel√© <em>s√©rialisation</em>. La plupart des biblioth√®ques bitcoin ont des fonctions int√©gr√©es pour la s√©rialisation et la d√©s√©rialisation des transactions.</p>
</div>
<div class="paragraph data-line-151">
<p>Voyez si vous pouvez d√©coder manuellement la transaction d&#8217;Alice √† partir de la forme hexad√©cimale s√©rialis√©e, en trouvant certains des √©l√©ments que nous avons vus pr√©c√©demment. La section contenant les deux sorties est mise en surbrillance dans <a href="#example_6_1">Transaction d&#8217;Alice, s√©rialis√©e et pr√©sent√©e en notation hexad√©cimale</a> pour vous aider :</p>
</div>
<div id="example_6_1" class="exampleblock data-line-155">
<div class="title">Example 18. Transaction d&#8217;Alice, s√©rialis√©e et pr√©sent√©e en notation hexad√©cimale</div>
<div class="content">
<div class="paragraph data-line-156">
<p>0100000001186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd73
4d2804fe65fa35779000000008b483045022100884d142d86652a3f47
ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039
ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813
01410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade84
16ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc1
7b4a10fa336a8d752adfffffffff02<strong>60e31600000000001976a914ab6</strong>
<strong>8025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef800000000000</strong>
<strong>1976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac</strong>
00000000</p>
</div>
</div>
</div>
<div class="paragraph data-line-168">
<p>Voici quelques conseils¬†:</p>
</div>
<div class="ulist data-line-170">
<ul>
<li class="data-line-170">
<p>Il y a deux sorties dans la section en surbrillance, chacune s√©rialis√©e comme indiqu√© dans <a href="#tx_out_structure">S√©rialisation des sorties de transaction</a>.</p>
</li>
<li class="data-line-171">
<p>La valeur de 0,015 bitcoin est de 1 500 000 satoshis. C&#8217;est <code>16 e3 60</code> en hexad√©cimal.</p>
</li>
<li class="data-line-172">
<p>Dans la transaction s√©rialis√©e, la valeur <code>16 e3 60</code> est encod√©e dans l&#8217;ordre d&#8217;octets petit-boutiste (octet le moins significatif en premier), elle ressemble donc √† <code>60 e3 16</code>.</p>
</li>
<li class="data-line-173">
<p>La longueur de <code>scriptPubKey</code> est de 25¬†octets, soit <code>19</code> en hexad√©cimal.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3 data-line-176">
<h4 id="tx_inputs">Entr√©es de transactions</h4>
<div class="paragraph data-line-178">
<p> Les entr√©es de transaction identifient (par r√©f√©rence) quel UTXO sera consomm√© et fournissent une preuve de propri√©t√© via un script de d√©verrouillage.</p>
</div>
<div class="paragraph data-line-180">
<p>Pour construire une transaction, un portefeuille s√©lectionne parmi l&#8217;UTXO qu&#8217;il contr√¥le, l&#8217;UTXO avec une valeur suffisante pour effectuer le paiement demand√©. Parfois un UTXO suffit, d&#8217;autres fois plus d&#8217;un est n√©cessaire. Pour chaque UTXO qui sera consomm√© pour effectuer ce paiement, le portefeuille cr√©e une entr√©e pointant vers l&#8217;UTXO et le d√©verrouille avec un script de d√©verrouillage.</p>
</div>
<div class="paragraph data-line-182">
<p>Examinons plus en d√©tail les composants d&#8217;une entr√©e. La premi√®re partie d&#8217;une entr√©e est un pointeur vers un UTXO par r√©f√©rence au hachage de transaction et √† un index de sortie, qui identifie l&#8217;UTXO sp√©cifique dans cette transaction. La deuxi√®me partie est un script de d√©verrouillage, que le portefeuille construit afin de satisfaire aux conditions de d√©penses d√©finies dans l&#8217;UTXO. Le plus souvent, le script de d√©verrouillage est une signature num√©rique et une cl√© publique prouvant la propri√©t√© du bitcoin. Cependant, ce ne sont pas tous les scripts de d√©verrouillage qui contiennent une signature. La troisi√®me partie est un num√©ro de s√©quence, qui sera discut√© plus tard.</p>
</div>
<div class="paragraph data-line-184">
<p>Consid√©rez notre exemple dans <a href="#transactions_behind_the_scenes">Transactions¬†: Dans les coulisses</a>. Les entr√©es de transaction sont un tableau (liste) appel√© <code>vin</code>¬†:</p>
</div>
<div id="vin" class="listingblock data-line-189">
<div class="title">Les entr√©es de transaction dans la transaction d&#8217;Alice</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vin": [
  {
    "txid": "7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18",
    "vout": 0,
    "scriptSig" : "3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf",
    "sequence": 4294967295
  }
]</code></pre>
</div>
</div>
<div class="paragraph data-line-200">
<p>Comme vous pouvez le voir, il n&#8217;y a qu&#8217;une seule entr√©e dans la liste (car un UTXO contenait une valeur suffisante pour effectuer ce paiement). L&#8217;entr√©e contient quatre √©l√©ments¬†:</p>
</div>
<div class="ulist data-line-202">
<ul>
<li class="data-line-202">
<p>Un ID de transaction, faisant r√©f√©rence √† la transaction qui contient l&#8217;UTXO d√©pens√©</p>
</li>
<li class="data-line-203">
<p>Un index de sortie (<code>vout</code>), identifiant quel UTXO de cette transaction est r√©f√©renc√© (le premier est z√©ro)</p>
</li>
<li class="data-line-204">
<p>Un <code>scriptSig</code>, qui satisfait aux conditions impos√©es √† l&#8217;UTXO, le d√©verrouillant pour les d√©penses</p>
</li>
<li class="data-line-205">
<p>Un num√©ro de s√©quence (√† discuter plus tard)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-207">
<p>Dans la transaction d&#8217;Alice, l&#8217;entr√©e pointe vers l&#8217;ID de transaction¬†:</p>
</div>
<div class="listingblock data-line-209">
<div class="content">
<pre>7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18</pre>
</div>
</div>
<div class="paragraph data-line-213">
<p>et l&#8217;indice de sortie <code>0</code> (c&#8217;est-√†-dire le premier UTXO cr√©√© par cette transaction). Le script de d√©verrouillage est construit par le portefeuille d&#8217;Alice en r√©cup√©rant d&#8217;abord l&#8217;UTXO r√©f√©renc√©, en examinant son script de verrouillage, puis en l&#8217;utilisant pour cr√©er le script de d√©verrouillage n√©cessaire pour le satisfaire.</p>
</div>
<div class="paragraph data-line-215">
<p>En regardant simplement l&#8217;entr√©e, vous avez peut-√™tre remarqu√© que nous ne savons rien de cet UTXO, √† part une r√©f√©rence √† la transaction parent qui le contient. Nous ne connaissons pas sa valeur (montant en satoshi), et nous ne connaissons pas le script de verrouillage qui fixe les conditions pour le d√©penser. Pour retrouver ces informations, il faut r√©cup√©rer l&#8217;UTXO r√©f√©renc√© en r√©cup√©rant la transaction m√®re qui le contient. Notez que parce que la valeur de l&#8217;entr√©e n&#8217;est pas explicitement indiqu√©e, nous devons √©galement utiliser l&#8217;UTXO r√©f√©renc√© afin de calculer les frais qui seront pay√©s dans cette transaction (voir <a href="#tx_fees">Frais de transaction</a>).</p>
</div>
<div class="paragraph data-line-217">
<p>Ce n&#8217;est pas seulement le portefeuille d&#8217;Alice qui doit r√©cup√©rer l&#8217;UTXO r√©f√©renc√© dans les entr√©es. Une fois cette transaction diffus√©e sur le r√©seau, chaque n≈ìud de validation devra √©galement r√©cup√©rer l&#8217;UTXO r√©f√©renc√© dans les entr√©es de transaction afin de valider la transaction.</p>
</div>
<div class="paragraph data-line-219">
<p>Les transactions en elles-m√™mes semblent incompl√®tes car elles manquent de contexte. Elles r√©f√©rencent l&#8217;UTXO dans leurs entr√©es mais sans r√©cup√©rer cet UTXO on ne peut pas conna√Ætre la valeur des entr√©es ni leurs conditions de verrouillage. Lors de l&#8217;√©criture d&#8217;un logiciel bitcoin, chaque fois que vous d√©codez une transaction dans le but de la valider ou de compter les frais ou de v√©rifier le script de d√©verrouillage, votre code devra d&#8217;abord r√©cup√©rer l&#8217;UTXO r√©f√©renc√© de la cha√Æne de blocs afin de construire le contexte implicite mais non pr√©sent dans les r√©f√©rences UTXO des entr√©es. Par exemple, pour calculer le montant pay√© en frais, vous devez conna√Ætre la somme des valeurs des entr√©es et des sorties. Mais sans r√©cup√©rer les UTXO r√©f√©renc√©s dans les entr√©es, vous ne connaissez pas leur valeur. Ainsi, une op√©ration apparemment simple comme le comptage des frais dans une seule transaction implique en fait plusieurs √©tapes et des donn√©es provenant de plusieurs transactions.</p>
</div>
<div class="paragraph data-line-221">
<p>Nous pouvons utiliser la m√™me s√©quence de commandes avec Bitcoin Core que celle que nous avons utilis√©e lors de la r√©cup√©ration de la transaction d&#8217;Alice (<code>getrawtransaction</code> et <code>decoderawtransaction</code>). Avec cela, nous pouvons obtenir l&#8217;UTXO r√©f√©renc√© dans l&#8217;entr√©e de la transaction d&#8217;Alice et jeter un ≈ìil¬†:</p>
</div>
<div id="alice_input_tx" class="listingblock data-line-226">
<div class="title">UTXO de la transaction pr√©c√©dente, r√©f√©renc√© dans l&#8217;entr√©e de la transaction d&#8217;Alice</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vout": [
   {
     "value": 0.10000000,
     "scriptPubKey": "OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG"
   }
 ]</code></pre>
</div>
</div>
<div class="paragraph data-line-235">
<p>On voit que cet UTXO a une valeur de 0.1 BTC et qu&#8217;il a un script de verrouillage (<code>scriptPubKey</code>) qui contient "OP_DUP OP_HASH160&#8230;&#8203;".</p>
</div>
<div class="admonitionblock tip data-line-238">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-239">
<p>Pour bien comprendre la transaction d&#8217;Alice, nous avons d√ª r√©cup√©rer la transaction pr√©c√©dente r√©f√©renc√©e en entr√©e. Une fonction qui r√©cup√®re les transactions pr√©c√©dentes et les sorties de transaction non d√©pens√©es est tr√®s courante et existe dans presque toutes les biblioth√®ques et API Bitcoin.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4 data-line-242">
<h5 id="_s√©rialisation_des_transactions_entr√©es">S√©rialisation des transactions¬†: entr√©es</h5>
<div class="paragraph data-line-244">
<p>Lorsque les transactions sont s√©rialis√©es pour √™tre transmises sur le r√©seau, leurs entr√©es sont cod√©es dans un flux d&#8217;octets comme indiqu√© dans <a href="#tx_in_structure">S√©rialisation des entr√©es de transaction</a>.</p>
</div>
<table id="tx_in_structure" class="tableblock frame-all grid-all stretch data-line-249">
<caption class="title">Table 17. S√©rialisation des entr√©es de transaction</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pointeur vers la transaction contenant l&#8217;UTXO √† d√©penser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indice de sortie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le num√©ro d&#8217;index de l&#8217;UTXO √† d√©penser¬†; le premier est 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1‚Äì9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille du script de d√©verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur du script de d√©verrouillage en octets √† suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©verrouillage-Script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un script remplissant les conditions du script de verrouillage UTXO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Num√©ro de s√©quence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Utilis√© pour le temps de verrouillage ou d√©sactiv√© (0xFFFFFFFF)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-258">
<p>Comme pour les sorties, voyons si nous pouvons trouver les entr√©es de la transaction d&#8217;Alice au format s√©rialis√©. Tout d&#8217;abord, les entr√©es d√©cod√©es¬†:</p>
</div>
<div class="listingblock data-line-261">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vin": [
  {
    "txid": "7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18",
    "vout": 0,
    "scriptSig" : "3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf",
    "sequence": 4294967295
  }
],</code></pre>
</div>
</div>
<div class="paragraph data-line-272">
<p>Voyons maintenant si nous pouvons identifier ces champs dans le codage hexad√©cimal s√©rialis√© dans <a href="#example_6_2">Transaction d&#8217;Alice, s√©rialis√©e et pr√©sent√©e en notation hexad√©cimale</a>¬†:</p>
</div>
<div id="example_6_2" class="exampleblock data-line-276">
<div class="title">Example 19. Transaction d&#8217;Alice, s√©rialis√©e et pr√©sent√©e en notation hexad√©cimale</div>
<div class="content">
<div class="paragraph data-line-277">
<p>0100000001<strong>186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd73</strong>
<strong>4d2804fe65fa35779000000008b483045022100884d142d86652a3f47</strong>
<strong>ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039</strong>
<strong>ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813</strong>
<strong>01410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade84</strong>
<strong>16ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc1</strong>
<strong>7b4a10fa336a8d752adfffffffff</strong>0260e31600000000001976a914ab6
8025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef800000000000
1976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac00000
000</p>
</div>
</div>
</div>
<div class="paragraph data-line-289">
<p>Astuces:</p>
</div>
<div class="ulist data-line-291">
<ul>
<li class="data-line-291">
<p>L&#8217;ID de transaction est s√©rialis√© dans l&#8217;ordre inverse des octets, il commence donc par (hex) <code>18</code> et se termine par <code>79</code></p>
</li>
<li class="data-line-292">
<p>L&#8217;index de sortie est un groupe de z√©ros de 4 octets, facile √† identifier</p>
</li>
<li class="data-line-293">
<p>La longueur du <code>scriptSig</code> est de 139 octets, soit <code>8b</code> en hexad√©cimal</p>
</li>
<li class="data-line-294">
<p>Le num√©ro de s√©quence est d√©fini sur <code>FFFFFFFF</code>, encore une fois facile √† identifier</p>
</li>
</ul>
</div>
<div class="paragraph data-line-296">
<p>ScriptSig est un type sp√©cifique de script de d√©verrouillage qui, lorsqu&#8217;il est s√©rialis√© pour √™tre transmis sur le r√©seau, les entr√©es sont cod√©es dans un flux d&#8217;octets, comme indiqu√© dans <a href="#scriptsig_in_structure">S√©rialisation des entr√©es ScriptSig</a>. La s√©rialisation du champ signature est d√©taill√©e dans <a href="#seralization_of_signatures_der">S√©rialisation des signatures (DER)</a>. Le champ de signature comprend √©galement un type de hachage de signature (SIGHASH), qui est d√©taill√© dans <a href="#sighash_types">Types de hachage de signature (SIGHASH)</a>.</p>
</div>
<table id="scriptsig_in_structure" class="tableblock frame-all grid-all stretch data-line-301">
<caption class="title">Table 18. S√©rialisation des entr√©es ScriptSig</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1‚Äì9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille signature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur de la signature en octets √† suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Une signature produite par le portefeuille de l&#8217;utilisateur √† partir de sa cl√© priv√©e, qui comprend un SIGHASH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1‚Äì9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille de la cl√© publique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur de la cl√© publique en octets √† suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cl√© publique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La cl√© publique, non hach√©e</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3 data-line-310">
<h4 id="tx_fees">Frais de transaction</h4>
<div class="paragraph data-line-312">
<p>La plupart des transactions incluent des frais de transaction, qui r√©mun√®rent les mineurs de bitcoins pour la s√©curisation du r√©seau. Les frais servent √©galement de m√©canisme de s√©curit√© eux-m√™mes, en rendant √©conomiquement impossible pour les attaquants d&#8217;inonder le r√©seau de transactions. L&#8217;exploitation mini√®re et les frais et r√©compenses per√ßus par les mineurs sont discut√©s plus en d√©tail dans <a href="#mining">Minage et Consensus</a>.</p>
</div>
<div class="paragraph data-line-314">
<p>Cette section examine comment les frais de transaction sont inclus dans une transaction typique. La plupart des portefeuilles calculent et incluent automatiquement les frais de transaction. Toutefois, si vous cr√©ez des transactions par programmation ou √† l&#8217;aide d&#8217;une interface de ligne de commande, vous devez comptabiliser et inclure manuellement ces frais.</p>
</div>
<div class="paragraph data-line-316">
<p>Les frais de transaction servent d&#8217;incitation √† inclure (exploiter) une transaction dans le bloc suivant et √©galement de dissuasion contre les abus du syst√®me en imposant un petit co√ªt sur chaque transaction. Les frais de transaction sont per√ßus par le mineur qui exploite le bloc qui enregistre la transaction sur la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-318">
<p>Les frais de transaction sont calcul√©s en fonction de la taille de la transaction en kilo-octets, et non de la valeur de la transaction en bitcoin. Dans l&#8217;ensemble, les frais de transaction sont fix√©s en fonction des forces du march√© au sein du r√©seau Bitcoin. Les mineurs hi√©rarchisent les transactions en fonction de nombreux crit√®res diff√©rents, y compris les frais, et peuvent m√™me traiter les transactions gratuitement dans certaines circonstances. Les frais de transaction affectent la priorit√© de traitement, ce qui signifie qu&#8217;une transaction avec des frais suffisants est susceptible d&#8217;√™tre incluse dans le prochain bloc min√©, alors qu&#8217;une transaction avec des frais insuffisants ou nuls peut √™tre retard√©e, trait√©e au mieux apr√®s quelques blocs, ou pas trait√© du tout. Les frais de transaction ne sont pas obligatoires et les transactions sans frais peuvent √©ventuellement √™tre trait√©es¬†; cependant, l&#8217;inclusion des frais de transaction encourage le traitement prioritaire.</p>
</div>
<div class="paragraph data-line-320">
<p>Au fil du temps, la fa√ßon dont les frais de transaction sont calcul√©s et leur effet sur la hi√©rarchisation des transactions ont √©volu√©. Au d√©part, les frais de transaction √©taient fixes et constants sur l&#8217;ensemble du r√©seau. Progressivement, la structure tarifaire s&#8217;est assouplie et peut √™tre influenc√©e par les forces du march√©, en fonction de la capacit√© du r√©seau et du volume des transactions. Depuis au moins le d√©but de 2016, les limites de capacit√© en bitcoin ont cr√©√© une concurrence entre les transactions, entra√Ænant des frais plus √©lev√©s et faisant des transactions gratuites une chose du pass√©. Les transactions sans frais ou √† tr√®s faibles frais sont rarement min√©es et parfois ne seront m√™me pas propag√©es sur le r√©seau.</p>
</div>
<div class="paragraph data-line-322">
<p>Dans Bitcoin Core, les politiques de relais des frais sont d√©finies par l&#8217;option <code>minrelaytxfee</code>. Le <code>minrelaytxfee</code> par d√©faut actuel est de 0,00001 bitcoin ou un centi√®me de millibitcoin par kilooctet. Par cons√©quent, par d√©faut, les transactions dont les frais sont inf√©rieurs √† 0,00001 bitcoin sont trait√©es comme gratuites et ne sont relay√©es que s&#8217;il y a de la place dans le mempool ; sinon, ils sont supprim√©s. Les n≈ìuds Bitcoin peuvent remplacer la politique de relais de frais par d√©faut en ajustant la valeur de <code>minrelaytxfee</code>.</p>
</div>
<div class="paragraph data-line-324">
<p>Tout service bitcoin qui cr√©e des transactions, y compris les portefeuilles, les √©changes, les applications de vente au d√©tail, etc., <em>doit</em> impl√©menter des frais dynamiques. Les frais dynamiques peuvent √™tre mis en ≈ìuvre via un service tiers d&#8217;estimation des frais ou avec un algorithme d&#8217;estimation des frais int√©gr√©. Si vous n&#8217;√™tes pas s√ªr, commencez par un service tiers et, √† mesure que vous acqu√©rez de l&#8217;exp√©rience, concevez et impl√©mentez votre propre algorithme si vous souhaitez supprimer la d√©pendance tierce.</p>
</div>
<div class="paragraph data-line-326">
<p>Les algorithmes d&#8217;estimation des frais calculent les frais appropri√©s, en fonction de la capacit√© et des frais offerts par les transactions ¬´ concurrentes ¬ª. Ces algorithmes vont du simple (frais moyens ou m√©dians dans le dernier bloc) au sophistiqu√© (analyse statistique). Ils estiment les frais n√©cessaires (en satoshis par octet) qui donneront √† une transaction une forte probabilit√© d&#8217;√™tre s√©lectionn√©e et incluse dans un certain nombre de blocs. La plupart des services offrent aux utilisateurs la possibilit√© de choisir des frais de priorit√© √©lev√©s, moyens ou faibles. Une priorit√© √©lev√©e signifie que les utilisateurs paient des frais plus √©lev√©s, mais la transaction est susceptible d&#8217;√™tre incluse dans le bloc suivant. Une priorit√© moyenne et faible signifie que les utilisateurs paient des frais de transaction moins √©lev√©s, mais que la confirmation des transactions peut prendre beaucoup plus de temps.</p>
</div>
<div class="paragraph data-line-328">
<p>De nombreuses applications de portefeuille utilisent des services tiers pour le calcul des frais. Un service populaire est <a href="https://bitcoinfees.earn.com/" data-href="https://bitcoinfees.earn.com/"><em>https://bitcoinfees.earn.com/</em></a>, qui fournit une API et un graphique visuel montrant les frais en satoshi/octet pour diff√©rentes priorit√©s.</p>
</div>
<div class="admonitionblock tip data-line-331">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-332">
<p>Les frais statiques ne sont plus viables sur le r√©seau Bitcoin. Les portefeuilles qui fixent des frais statiques produiront une mauvaise exp√©rience utilisateur car les transactions seront souvent "bloqu√©es" et resteront non confirm√©es. Les utilisateurs qui ne comprennent pas les transactions et les frais en bitcoins sont constern√©s par les transactions "bloqu√©es" car ils pensent avoir perdu leur argent.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-335">
<p>Le graphique en <a href="#bitcoinfeesearncom">Service d&#8217;estimation des frais bitcoinfees.earn.com</a> affiche l&#8217;estimation en temps r√©el des frais par incr√©ments de 10 satoshi/octet et le temps de confirmation attendu (en minutes et en nombre de blocs) pour les transactions avec des frais dans chaque plage. Pour chaque fourchette de frais (par exemple, 61 √† 70¬†satoshi/octet), deux barres horizontales indiquent le nombre de transactions non confirm√©es (1¬†405) et le nombre total de transactions au cours des derni√®res 24¬†heures (102¬†975), avec des frais compris dans cette fourchette. Sur la base du graphique, les frais de haute priorit√© recommand√©s √† ce moment √©taient de 80 satoshi/octet, des frais susceptibles d&#8217;entra√Æner l&#8217;inclusion de la transaction dans le bloc suivant (d√©lai de bloc nul). Pour la perspective, la taille m√©diane des transactions est de 226 octets, donc les frais recommand√©s pour cette taille de transaction seraient de 18 080 satoshis (0,00018080 BTC).</p>
</div>
<div class="paragraph data-line-337">
<p>Les donn√©es d&#8217;estimation des frais peuvent √™tre r√©cup√©r√©es via une simple API HTTP REST, √† l&#8217;adresse <a href="https://bitcoinfees.earn.com/api/v1/fees/recommended" data-href="https://bitcoinfees.earn.com/api/v1/fees/recommended">https://bitcoinfees.earn.com/api/v1/fees/recommended </a>. Par exemple, sur la ligne de commande en utilisant la commande <code>curl</code>¬†:</p>
</div>
<div class="listingblock data-line-340">
<div class="title">Utilisation de l&#8217;API d&#8217;estimation des frais</div>
<div class="content">
<pre>$ curl https://bitcoinfees.earn.com/api/v1/fees/recommended

{"fastestFee":80,"halfHourFee":80,"hourFee":60}</pre>
</div>
</div>
<div class="paragraph data-line-346">
<p>L&#8217;API renvoie un objet JSON avec l&#8217;estimation actuelle des frais pour la confirmation la plus rapide (<code>fastestFee</code>), la confirmation dans les trois blocs (<code>halfHourFee</code>) et six blocs (<code>hourFee</code>), en satoshi par octet.</p>
</div>
<div id="bitcoinfeesearncom" class="imageblock data-line-350">
<div class="content">
<img src="images/mbc2_0602.png" alt="Service d&#8217;estimation des frais bitcoinfees.earn.com">
</div>
<div class="title">Figure 37. Service d&#8217;estimation des frais bitcoinfees.earn.com</div>
</div>
</div>
<div class="sect3 data-line-352">
<h4 id="_ajout_de_frais_aux_transactions">Ajout de frais aux transactions</h4>
<div class="paragraph data-line-354">
<p>La structure de donn√©es des transactions n&#8217;a pas de champ pour les frais. Au lieu de cela, les frais sont implicites comme la diff√©rence entre la somme des entr√©es et la somme des sorties. Tout montant exc√©dentaire qui reste apr√®s que toutes les sorties ont √©t√© d√©duites de toutes les entr√©es est la redevance per√ßue par les mineurs¬†:</p>
</div>
<div id="tx_fee_equation" class="listingblock data-line-358">
<div class="title">Les frais de transaction sont implicites, comme l&#8217;exc√©dent des intrants moins les extrants¬†:</div>
<div class="content">
<pre>Frais = Somme(intrants) - Somme(extrants)</pre>
</div>
</div>
<div class="paragraph data-line-362">
<p>Il s&#8217;agit d&#8217;un √©l√©ment quelque peu d√©routant des transactions et d&#8217;un point important √† comprendre, car si vous construisez vos propres transactions, vous devez vous assurer de ne pas inclure par inadvertance des frais tr√®s importants en sous-d√©pensant les intrants. Cela signifie que vous devez comptabiliser toutes les entr√©es, si n√©cessaire en cr√©ant du change, ou vous finirez par donner un tr√®s gros pourboire aux mineurs¬†!</p>
</div>
<div class="paragraph data-line-364">
<p>Par exemple, si vous consommez un UTXO de 20¬†bitcoins pour effectuer un paiement de 1¬†bitcoin, vous devez inclure une sortie de modification de 19¬†bitcoins dans votre portefeuille. Sinon, le "reste" de 19 bitcoins sera compt√© comme des frais de transaction et sera collect√© par le mineur qui exploite votre transaction dans un bloc. Bien que vous receviez un traitement prioritaire et rendiez un mineur tr√®s heureux, ce n&#8217;est probablement pas ce que vous vouliez.</p>
</div>
<div class="admonitionblock warning data-line-367">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-368">
<p> Si vous oubliez d&#8217;ajouter une sortie de modification dans une transaction construite manuellement, vous paierez la modification en tant que frais de transaction. Dire "Gardez la monnaie¬†!" au mineur n&#8217;est peut-√™tre pas ce que vous vouliez vraiment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-371">
<p> Voyons comment cela fonctionne en pratique, en examinant √† nouveau l&#8217;achat de caf√© d&#8217;Alice. Alice veut d√©penser 0,015 bitcoin pour payer son caf√©. Pour s&#8217;assurer que cette transaction est trait√©e rapidement, elle voudra inclure des frais de transaction, disons 0,0005. Cela signifie que le co√ªt total de la transaction sera de 0,0155. Son portefeuille doit donc se procurer un ensemble d&#8217;UTXO qui totalise 0,0155 bitcoin ou plus et, si n√©cessaire, cr√©er de la monnaie. Disons que son portefeuille dispose d&#8217;un UTXO de 0,1 bitcoin. Elle devra donc consommer cet UTXO, cr√©er une sortie pour le Bob&#8217;s Caf√© pour 0,015, et une seconde sortie avec 0,0845 bitcoin en retour vers son propre portefeuille, laissant 0,0005 bitcoin non allou√©, comme frais implicites pour la transaction.</p>
</div>
<div class="paragraph data-line-373">
<p>Regardons maintenant un sc√©nario diff√©rent. Eugenia, directrice de notre association caritative pour enfants aux Philippines, a organis√© une collecte de fonds pour acheter des manuels scolaires pour les enfants. Elle a re√ßu plusieurs milliers de petits dons de personnes du monde entier, totalisant 50 bitcoins, donc son portefeuille est plein de tr√®s petits paiements (UTXO). Maintenant, elle veut acheter des centaines de manuels scolaires aupr√®s d&#8217;un √©diteur local, en payant en bitcoins.</p>
</div>
<div class="paragraph data-line-375">
<p>Alors que l&#8217;application de portefeuille d&#8217;Eugenia tente de construire une seule transaction de paiement plus importante, elle doit s&#8217;approvisionner √† partir de l&#8217;ensemble UTXO disponible, qui est compos√© de nombreux montants plus petits. Cela signifie que la transaction r√©sultante proviendra de plus d&#8217;une centaine d&#8217;UTXO de petite valeur en tant qu&#8217;entr√©es et d&#8217;une seule sortie, payant l&#8217;√©diteur du livre. Une transaction avec autant d&#8217;entr√©es sera sup√©rieure √† un kilo-octet, peut-√™tre plusieurs kilo-octets. En cons√©quence, cela n√©cessitera des frais beaucoup plus √©lev√©s que la transaction de taille m√©diane.</p>
</div>
<div class="paragraph data-line-377">
<p>L&#8217;application de portefeuille d&#8217;Eugenia calculera les frais appropri√©s en mesurant la taille de la transaction et en la multipliant par les frais par kilo-octet. De nombreux portefeuilles surpayeront les frais pour les transactions plus importantes afin de s&#8217;assurer que la transaction est trait√©e rapidement. Les frais plus √©lev√©s ne sont pas dus au fait qu&#8217;Eugenia d√©pense plus d&#8217;argent, mais au fait que sa transaction est plus complexe et plus volumineuse - les frais sont ind√©pendants de la valeur en bitcoins de la transaction.</p>
</div>
</div>
</div>
<div class="sect2 pagebreak-before less_space_h1 data-line-381">
<h3 id="tx_script">Scripts de transaction et langage de script</h3>
<div class="paragraph data-line-383">
<p>Le langage de script de transaction bitcoin, appel√© <em>Script</em> , est un langage d&#8217;ex√©cution bas√© sur une pile de notation polonaise invers√©e (RPN) de type Forth. Si cela ressemble √† du charabia, vous n&#8217;avez probablement pas √©tudi√© les langages de programmation des ann√©es 1960, mais ce n&#8217;est pas grave, nous vous expliquerons tout dans ce chapitre. Le script de verrouillage plac√© sur un UTXO et le script de d√©verrouillage sont √©crits dans ce langage de script. Lorsqu&#8217;une transaction est valid√©e, le script de d√©verrouillage de chaque entr√©e est ex√©cut√© parall√®lement au script de verrouillage correspondant pour voir s&#8217;il satisfait √† la condition de d√©pense.</p>
</div>
<div class="paragraph data-line-385">
<p>Script est un langage tr√®s simple qui a √©t√© con√ßu pour √™tre limit√© dans sa port√©e et √™tre ex√©cutable sur une gamme de mat√©riel et peut √™tre aussi simple qu&#8217;un p√©riph√©rique int√©gr√©. Il n√©cessite un traitement minimal et ne peut pas faire la plupart des choses fantaisistes que les langages de programmation modernes peuvent faire. Pour son utilisation dans la validation de monnaie programmable, il s&#8217;agit d&#8217;une fonction de s√©curit√© d√©lib√©r√©e.</p>
</div>
<div class="paragraph data-line-387">
<p>Aujourd&#8217;hui, la plupart des transactions trait√©es via le r√©seau Bitcoin ont la forme "Paiement √† l&#8217;adresse Bitcoin de Bob" et sont bas√©es sur un script appel√© Pay-to-Script Public-Key-Hash. Cependant, les transactions bitcoin ne se limitent pas au script "Paiement √† l&#8217;adresse Bitcoin de Bob". En fait, les scripts de verrouillage peuvent √™tre √©crits pour exprimer une grande vari√©t√© de conditions complexes. Afin de comprendre ces scripts plus complexes, nous devons d&#8217;abord comprendre les bases des scripts de transaction et du langage de script.</p>
</div>
<div class="paragraph data-line-389">
<p>Dans cette section, nous d√©montrerons les composants de base du langage de script de transaction bitcoin et montrerons comment il peut √™tre utilis√© pour exprimer des conditions simples de d√©penses et comment ces conditions peuvent √™tre satisfaites en d√©verrouillant des scripts.</p>
</div>
<div class="admonitionblock tip data-line-392">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-393">
<p>La validation des transactions Bitcoin n&#8217;est pas bas√©e sur un mod√®le statique, mais est plut√¥t obtenue gr√¢ce √† l&#8217;ex√©cution d&#8217;un langage de script. Ce langage permet d&#8217;exprimer une vari√©t√© presque infinie de conditions. C&#8217;est ainsi que le bitcoin obtient le pouvoir de "l&#8217;argent programmable".</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 data-line-397">
<h4 id="_incompl√©tude_de_turing">Incompl√©tude de Turing</h4>
<div class="paragraph data-line-399">
<p>Le langage de script de transaction bitcoin contient de nombreux op√©rateurs, mais est d√©lib√©r√©ment limit√© d&#8217;une mani√®re importante¬†: il n&#8217;y a pas de boucles ou de capacit√©s de contr√¥le de flux complexes autres que le contr√¥le de flux conditionnel. Cela garantit que le langage n&#8217;est pas <em>Turing complet</em>, ce qui signifie que les scripts ont une complexit√© limit√©e et des temps d&#8217;ex√©cution pr√©visibles. Le script n&#8217;est pas un langage universel. Ces limitations garantissent que le langage ne peut pas √™tre utilis√© pour cr√©er une boucle infinie ou une autre forme de "bombe logique" qui pourrait √™tre int√©gr√©e dans une transaction de mani√®re √† provoquer une attaque par d√©ni de service contre le r√©seau Bitcoin. N&#8217;oubliez pas que chaque transaction est valid√©e par chaque n≈ìud complet du r√©seau Bitcoin. Un langage limit√© emp√™che le m√©canisme de validation des transactions d&#8217;√™tre utilis√© comme une vuln√©rabilit√©.</p>
</div>
</div>
<div class="sect3 data-line-401">
<h4 id="_v√©rification_sans_√©tat">V√©rification sans √©tat</h4>
<div class="paragraph data-line-403">
<p>Le langage de script de transaction bitcoin est sans √©tat, en ce sens qu&#8217;il n&#8217;y a pas d&#8217;√©tat avant l&#8217;ex√©cution du script, ou d&#8217;√©tat enregistr√© apr√®s l&#8217;ex√©cution du script. Par cons√©quent, toutes les informations n√©cessaires √† l&#8217;ex√©cution d&#8217;un script sont contenues dans le script. Un script s&#8217;ex√©cutera de mani√®re pr√©visible de la m√™me mani√®re sur n&#8217;importe quel syst√®me. Si votre syst√®me v√©rifie un script, vous pouvez √™tre s√ªr que tous les autres syst√®mes du r√©seau Bitcoin v√©rifieront √©galement le script, ce qui signifie qu&#8217;une transaction valide est valide pour tout le monde et tout le monde le sait. Cette pr√©visibilit√© des r√©sultats est un avantage essentiel du syst√®me Bitcoin.</p>
</div>
</div>
<div class="sect3 data-line-406">
<h4 id="tx_lock_unlock">Construction du script (Verrouiller + D√©verrouiller)</h4>
<div class="paragraph data-line-408">
<p>Le moteur de validation des transactions de Bitcoin s&#8217;appuie sur deux types de scripts pour valider les transactions¬†: un script de verrouillage et un script de d√©verrouillage.</p>
</div>
<div class="paragraph data-line-410">
<p>Un script de verrouillage est une condition de d√©pense plac√©e sur une sortie¬†: il sp√©cifie les conditions qui doivent √™tre remplies pour d√©penser la production √† l&#8217;avenir. Historiquement, le script de verrouillage √©tait appel√© <em>scriptPubKey</em>, car il contenait g√©n√©ralement une cl√© publique ou une adresse Bitcoin (hachage de cl√© publique). Dans ce livre, nous l&#8217;appelons un "script de verrouillage" pour reconna√Ætre l&#8217;√©ventail de possibilit√©s beaucoup plus large de cette technologie de script. Dans la plupart des applications bitcoin, ce que nous appelons un script de verrouillage appara√Ætra dans le code source sous la forme <code>scriptPubKey</code>. Vous verrez √©galement le script de verrouillage appel√© <em>script de t√©moin</em> (voir <a href="#segwit">T√©moin s√©par√©</a>) ou plus g√©n√©ralement comme un <em>casse-t√™te cryptographique</em>. Ces termes signifient tous la m√™me chose, √† diff√©rents niveaux d&#8217;abstraction.</p>
</div>
<div class="paragraph data-line-412">
<p>Un script de d√©verrouillage est un script qui ¬´ r√©sout ¬ª, ou satisfait, les conditions plac√©es sur une sortie par un script de verrouillage et permet √† la sortie d&#8217;√™tre d√©pens√©e. Les scripts de d√©verrouillage font partie de chaque entr√©e de transaction. Ils contiennent la plupart du temps une signature num√©rique produite par le portefeuille de l&#8217;utilisateur √† partir de sa cl√© priv√©e. Historiquement, le script de d√©verrouillage s&#8217;appelait <em>scriptSig</em>, car il contenait g√©n√©ralement une signature num√©rique. Dans la plupart des applications bitcoin, le code source fait r√©f√©rence au script de d√©verrouillage sous la forme <code>scriptSig</code>. Vous verrez √©galement le script de d√©verrouillage appel√© <em>t√©moin</em> (voir <a href="#segwit">T√©moin s√©par√©</a>). Dans ce livre, nous l&#8217;appelons un "script de d√©verrouillage" pour reconna√Ætre la gamme beaucoup plus large d&#8217;exigences de script de verrouillage, car ce n&#8217;est pas tous les scripts de d√©verrouillage qui doivent contenir des signatures.</p>
</div>
<div class="paragraph data-line-414">
<p>Chaque n≈ìud de validation Bitcoin validera les transactions en ex√©cutant les scripts de verrouillage et de d√©verrouillage ensemble. Chaque entr√©e contient un script de d√©verrouillage et fait r√©f√©rence √† un UTXO existant pr√©c√©demment. Le logiciel de validation copiera le script de d√©verrouillage, r√©cup√©rera l&#8217;UTXO r√©f√©renc√© par l&#8217;entr√©e et copiera le script de verrouillage √† partir de cet UTXO. Les scripts de d√©verrouillage et de verrouillage sont ensuite ex√©cut√©s en s√©quence. L&#8217;entr√©e est valide si le script de d√©verrouillage satisfait les conditions du script de verrouillage (voir <a href="#script_exec">Ex√©cution s√©par√©e des scripts de d√©verrouillage et de verrouillage</a>). Toutes les entr√©es sont valid√©es ind√©pendamment, dans le cadre de la validation globale de la transaction.</p>
</div>
<div class="paragraph data-line-416">
<p>Notez que l&#8217;UTXO est enregistr√© en permanence dans la cha√Æne de blocs, et est donc invariable et n&#8217;est pas affect√© par les tentatives infructueuses de le d√©penser par r√©f√©rence dans une nouvelle transaction. Seule une transaction valide qui satisfait correctement les conditions de la sortie entra√Æne que la sortie est consid√©r√©e comme "d√©pens√©e" et retir√©e de l&#8217;ensemble des sorties de transaction non d√©pens√©es (ensemble UTXO).</p>
</div>
<div class="paragraph data-line-418">
<p><a href="#scriptSig_and_scriptPubKey">Combiner scriptSig et scriptPubKey pour √©valuer un script de transaction</a> est un exemple des scripts de d√©verrouillage et de verrouillage pour le type de transaction bitcoin le plus courant (un paiement √† un hachage de cl√© publique), montrant le script combin√© r√©sultant de la concat√©nation des scripts de d√©verrouillage et de verrouillage avant la validation du script.</p>
</div>
<div id="scriptSig_and_scriptPubKey" class="imageblock data-line-422">
<div class="content">
<img src="images/mbc2_0603.png" alt="scriptSig et scriptPubKey">
</div>
<div class="title">Figure 38. Combiner scriptSig et scriptPubKey pour √©valuer un script de transaction</div>
</div>
<div class="sect4 data-line-424">
<h5 id="_la_pile_dex√©cution_de_script">La pile d&#8217;ex√©cution de script</h5>
<div class="paragraph data-line-426">
<p>Le langage de script de Bitcoin est appel√© un langage bas√© sur la pile car il utilise une structure de donn√©es appel√©e <em>pile</em>. Une pile est une structure de donn√©es tr√®s simple qui peut √™tre visualis√©e comme une pile de cartes. Une pile permet deux op√©rations¬†: push et pop. Push ajoute un √©l√©ment au sommet de la pile. Pop supprime l&#8217;√©l√©ment du haut de la pile. Les op√©rations sur une pile ne peuvent agir que sur l&#8217;√©l√©ment le plus haut de la pile. Une structure de donn√©es de pile est √©galement appel√©e file d&#8217;attente Last-In-First-Out (dernier entr√©, premier sorti), ou "LIFO".</p>
</div>
<div class="paragraph data-line-428">
<p>Le langage de script ex√©cute le script en traitant chaque √©l√©ment de gauche √† droite. Les nombres (constantes de donn√©es) sont pouss√©s sur la pile. Les op√©rateurs poussent ou sortent un ou plusieurs param√®tres de la pile, agissent sur eux et peuvent pousser un r√©sultat sur la pile. Par exemple, <code>OP_ADD</code> fera sortir deux √©l√©ments de la pile, les ajoutera et poussera la somme r√©sultante sur la pile.</p>
</div>
<div class="paragraph data-line-430">
<p>Les op√©rateurs conditionnels √©valuent une condition, produisant un r√©sultat bool√©en TRUE (VRAI) ou FALSE (FAUX). Par exemple, <code>OP_EQUAL</code> d√©pile deux √©l√©ments de la pile et pousse TRUE (TRUE est repr√©sent√© par le nombre 1) s&#8217;ils sont √©gaux ou FALSE (repr√©sent√© par z√©ro) s&#8217;ils ne sont pas √©gaux. Les scripts de transaction Bitcoin contiennent g√©n√©ralement un op√©rateur conditionnel, afin qu&#8217;ils puissent produire le r√©sultat TRUE qui signifie une transaction valide.</p>
</div>
</div>
<div class="sect4 data-line-432">
<h5 id="_un_script_simple">Un script simple</h5>
<div class="paragraph data-line-434">
<p>Appliquons maintenant ce que nous avons appris sur les scripts et les piles √† quelques exemples simples.</p>
</div>
<div class="paragraph data-line-436">
<p>Dans <a href="#simplemath_script">La validation du script Bitcoin en calculs simples</a>, le script <code>2 3 OP_ADD 5 OP_EQUAL</code> d√©montre l&#8217;op√©rateur d&#8217;addition arithm√©tique <code>OP_ADD</code>, additionnant deux nombres et mettant le r√©sultat sur la pile, suivi de l&#8217;op√©rateur conditionnel <code>OP_EQUAL</code>, qui v√©rifie que la somme r√©sultante est √©gale √† <code>5</code>. Par souci de bri√®vet√©, le pr√©fixe <code>OP_</code> est omis dans l&#8217;exemple √©tape par √©tape. Pour plus de d√©tails sur les op√©rateurs de script et les fonctions disponibles, voir <a href="#tx_script_ops">Op√©rateurs, constantes et symboles du langage de script de transaction</a>.</p>
</div>
<div class="paragraph data-line-438">
<p>Bien que la plupart des scripts de verrouillage se r√©f√®rent √† un hachage de cl√© publique (essentiellement, une adresse Bitcoin), n√©cessitant ainsi une preuve de propri√©t√© pour d√©penser les fonds, le script n&#8217;a pas besoin d&#8217;√™tre aussi complexe. Toute combinaison de scripts de verrouillage et de d√©verrouillage donnant une valeur TRUE est valide. L&#8217;arithm√©tique simple que nous avons utilis√©e comme exemple de langage de script est √©galement un script de verrouillage valide qui peut √™tre utilis√© pour verrouiller une sortie de transaction.</p>
</div>
<div class="paragraph data-line-440">
<p>Utilisez une partie de l&#8217;exemple de script arithm√©tique comme script de verrouillage¬†:</p>
</div>
<div class="listingblock data-line-442">
<div class="content">
<pre>3 OP_ADD 5 OP_EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-446">
<p>qui peut √™tre satisfaite par une transaction contenant une entr√©e avec le script de d√©verrouillage¬†:</p>
</div>
<div class="listingblock data-line-448">
<div class="content">
<pre>2</pre>
</div>
</div>
<div class="paragraph data-line-452">
<p>Le logiciel de validation combine les scripts de verrouillage et de d√©verrouillage et le script r√©sultant est¬†:</p>
</div>
<div class="listingblock data-line-454">
<div class="content">
<pre>2 3 OP_ADD 5 OP_EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-458">
<p>Comme nous l&#8217;avons vu dans l&#8217;exemple √©tape par √©tape dans <a href="#simplemath_script">La validation du script Bitcoin en calculs simples</a>, lorsque ce script est ex√©cut√©, le r√©sultat est <code>OP_TRUE</code>, rendant la transaction valide. Non seulement il s&#8217;agit d&#8217;un script de verrouillage de sortie de transaction valide, mais l&#8217;UTXO r√©sultant pourrait √™tre d√©pens√© par toute personne ayant les comp√©tences en arithm√©tique pour savoir que le nombre 2 satisfait le script.</p>
</div>
<div class="admonitionblock tip data-line-461">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-462">
<p>Les transactions sont valides si le premier r√©sultat de la pile est <code>TRUE</code> (not√© <code>{0x01}</code>), toute autre valeur diff√©rente de z√©ro, autre que <code>OP_0</code>, ou si la pile est vide apr√®s l&#8217;ex√©cution du script. Les transactions ne sont pas valides si la valeur sup√©rieure de la pile est <code>FALSE</code> (une valeur vide de longueur nulle, not√©e <code>{}</code>) ou si l&#8217;ex√©cution du script est arr√™t√©e explicitement par un op√©rateur, tel que <code>OP_VERIFY</code>, <code>OP_RETURN</code> ou un terminateur conditionnel tel que <code>OP_ENDIF</code>. Voir <a href="#tx_script_ops">Op√©rateurs, constantes et symboles du langage de script de transaction</a> pour plus de d√©tails.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="simplemath_script" class="imageblock data-line-467">
<div class="content">
<img src="images/mbc2_0604.png" alt="Exemple math√©matique simple du TxScript">
</div>
<div class="title">Figure 39. La validation du script Bitcoin en calculs simples</div>
</div>
<div class="paragraph pagebreak-before data-line-470">
<p>Ce qui suit est un script l√©g√®rement plus complexe, qui calcule <code>2 + 7 - 3 + 1</code>. Notez que lorsque le script contient plusieurs op√©rateurs √† la suite, la pile permet aux r√©sultats d&#8217;un op√©rateur d&#8217;√™tre appliqu√©s par l&#8217;op√©rateur suivant¬†:</p>
</div>
<div class="listingblock data-line-472">
<div class="content">
<pre>2 7 OP_ADD 3 OP_SUB 1 OP_ADD 7 OP_EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-476">
<p>Essayez de valider vous-m√™me le script pr√©c√©dent √† l&#8217;aide d&#8217;un crayon et de papier. Lorsque l&#8217;ex√©cution du script se termine, vous devriez vous retrouver avec la valeur <code>TRUE</code> sur la pile.</p>
</div>
</div>
<div class="sect4 data-line-479">
<h5 id="script_exec">Ex√©cution s√©par√©e des scripts de d√©verrouillage et de verrouillage</h5>
<div class="paragraph data-line-481">
<p>Dans le client Bitcoin d&#8217;origine, les scripts de d√©verrouillage et de verrouillage √©taient concat√©n√©s et ex√©cut√©s en s√©quence. Pour des raisons de s√©curit√©, cela a √©t√© modifi√© en 2010, en raison d&#8217;une vuln√©rabilit√© qui permettait √† un script de d√©verrouillage malform√© de pousser des donn√©es sur la pile et de corrompre le script de verrouillage. Dans l&#8217;impl√©mentation actuelle, les scripts sont ex√©cut√©s s√©par√©ment avec la pile transf√©r√©e entre les deux ex√©cutions, comme d√©crit ci-apr√®s.</p>
</div>
<div class="paragraph data-line-483">
<p>Tout d&#8217;abord, le script de d√©verrouillage est ex√©cut√© √† l&#8217;aide du moteur d&#8217;ex√©cution de la pile. Si le script de d√©verrouillage est ex√©cut√© sans erreur (par exemple, s&#8217;il ne reste plus de pointeurs " pendants"), la pile principale est copi√©e et le script de verrouillage est ex√©cut√©. Si le r√©sultat de l&#8217;ex√©cution du script de verrouillage avec les donn√©es de la pile copi√©es √† partir du script de d√©verrouillage est "TRUE", le script de d√©verrouillage a r√©ussi √† r√©soudre les conditions impos√©es par le script de verrouillage et, par cons√©quent, l&#8217;entr√©e est une autorisation valide de d√©penser l&#8217;UTXO. S&#8217;il reste un r√©sultat autre que "TRUE" apr√®s l&#8217;ex√©cution du script combin√©, l&#8217;entr√©e est invalide car elle n&#8217;a pas satisfait aux conditions de d√©penses plac√©es sur l&#8217;UTXO.</p>
</div>
</div>
</div>
<div class="sect3 data-line-487">
<h4 id="p2pkh">Pay-to-Public-Key-Hash (P2PKH)</h4>
<div class="paragraph data-line-489">
<p>La grande majorit√© des transactions trait√©es sur le r√©seau Bitcoin d√©pensent des sorties verrouill√©es avec un script Pay-to-Public-Key-Hash ou "P2PKH". Ces sorties contiennent un script de verrouillage qui verrouille la sortie sur un hachage de cl√© publique, plus commun√©ment appel√© adresse Bitcoin. Une sortie verrouill√©e par un script P2PKH peut √™tre d√©verrouill√©e (pass√©e) en pr√©sentant une cl√© publique et une signature num√©rique cr√©√©e par la cl√© priv√©e correspondante (voir <a href="#digital_sigs">Signatures num√©riques (ECDSA)</a>).</p>
</div>
<div class="paragraph data-line-491">
<p>Par exemple, regardons √† nouveau le paiement d&#8217;Alice au Bob&#8217;s Caf√©. Alice a effectu√© un paiement de 0,015 bitcoin √† l&#8217;adresse Bitcoin du comptoir. Cette sortie de transaction aurait un script de verrouillage de la forme¬†:</p>
</div>
<div class="listingblock data-line-493">
<div class="content">
<pre>OP_DUP OP_HASH160 &lt;Cafe Public Key Hash&gt; OP_EQUALVERIFY OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-497">
<p>Le <code>Cafe Public Key Hash</code> √©quivaut √† l&#8217;adresse Bitcoin du caf√©, sans l&#8217;encodage Base58Check. La plupart des applications afficheraient le <em>hachage de la cl√© publique</em> en codage hexad√©cimal et non le format familier de l&#8217;adresse Bitcoin Base58Check qui commence par un "1".</p>
</div>
<div class="paragraph data-line-499">
<p>Le script de verrouillage pr√©c√©dent peut se contenter d&#8217;un script de d√©verrouillage de la forme :</p>
</div>
<div class="listingblock data-line-501">
<div class="content">
<pre>&lt;Cafe Signature&gt; &lt;Cafe Public Key&gt;</pre>
</div>
</div>
<div class="paragraph data-line-505">
<p>Les deux scripts ensemble formeraient le script de validation combin√© suivant¬†:</p>
</div>
<div class="listingblock data-line-507">
<div class="content">
<pre>&lt;Cafe Signature&gt; &lt;Cafe Public Key&gt; OP_DUP OP_HASH160
&lt;Cafe Public Key Hash&gt; OP_EQUALVERIFY OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-512">
<p>Lorsqu&#8217;il est ex√©cut√©, ce script combin√© sera √©valu√© √† TRUE si, et seulement si, le script de d√©verrouillage correspond aux conditions d√©finies par le script de verrouillage. En d&#8217;autres termes, le r√©sultat sera TRUE si le script de d√©verrouillage a une signature valide de la cl√© priv√©e du comptoir qui correspond au hachage de la cl√© publique d√©fini comme encombrement.</p>
</div>
<div class="paragraph data-line-514">
<p>Les figures <a data-type="xref" href="#P2PubKHash1" data-xrefstyle="select: labelnumber">#P2PubKHash1</a> et <a data-type="xref" href="#P2PubKHash2" data-xrefstyle="select: labelnumber">#P2PubKHash2</a> montrent (en deux parties) une ex√©cution pas √† pas du script combin√©, qui prouvera qu&#8217;il s&#8217;agit d&#8217;une transaction valide.</p>
</div>
<div id="P2PubKHash1" class="imageblock data-line-518">
<div class="content">
<img src="images/mbc2_0605.png" alt="Tx_Script_P2PubKeyHash_1">
</div>
<div class="title">Figure 40. √âvaluer un script pour une transaction P2PKH (partie 1 sur 2)</div>
</div>
<div id="P2PubKHash2" class="imageblock data-line-522">
<div class="content">
<img src="images/mbc2_0606.png" alt="Tx_Script_P2PubKeyHash_2">
</div>
<div class="title">Figure 41. √âvaluer un script pour une transaction P2PKH (partie 2 sur 2)</div>
</div>
</div>
</div>
<div class="sect2 data-line-525">
<h3 id="digital_sigs">Signatures num√©riques (ECDSA)</h3>
<div class="paragraph data-line-527">
<p>Jusqu&#8217;√† pr√©sent, nous n&#8217;avons approfondi aucun d√©tail sur les "signatures num√©riques". Dans cette section, nous examinons le fonctionnement des signatures num√©riques et comment elles peuvent pr√©senter la preuve de la propri√©t√© d&#8217;une cl√© priv√©e sans r√©v√©ler cette cl√© priv√©e.</p>
</div>
<div class="paragraph data-line-529">
<p>L&#8217;algorithme de signature num√©rique utilis√© dans le bitcoin est l'<em>Elliptic Curve Digital Signature Algorithm</em>, ou <em>ECDSA</em>. ECDSA est l&#8217;algorithme utilis√© pour les signatures num√©riques bas√©es sur des paires de cl√©s priv√©es/publiques √† courbe elliptique, comme d√©crit dans <a href="#elliptic_curve">La cryptographie √† courbe elliptique expliqu√©e</a>. ECDSA est utilis√© par les fonctions de script <code>OP_CHECKSIG</code>, <code>OP_CHECKSIGVERIFY</code>, <code>OP_CHECKMULTISIG</code> et <code>OP_CHECKMULTISIGVERIFY</code>. Chaque fois que vous les voyez dans un script de verrouillage, le script de d√©verrouillage doit contenir une signature ECDSA.</p>
</div>
<div class="paragraph data-line-531">
<p> Une signature num√©rique a trois objectifs en bitcoin. Premi√®rement, la signature prouve que le propri√©taire de la cl√© priv√©e, qui est implicitement le propri√©taire des fonds, a <em>autoris√©</em> la d√©pense de ces fonds. Deuxi√®mement, la preuve de l&#8217;autorisation est <em>ind√©niable</em> (non-r√©pudiable). Troisi√®mement, la signature prouve que la transaction (ou des parties sp√©cifiques de la transaction) n&#8217;a pas et <em>ne peut pas √™tre modifi√©e</em> par qui que ce soit apr√®s avoir √©t√© sign√©e.</p>
</div>
<div class="paragraph data-line-533">
<p>Notez que chaque entr√©e de transaction est sign√©e ind√©pendamment. Ceci est essentiel, car ni les signatures ni les entr√©es ne doivent appartenir ou √™tre appliqu√©es par les m√™mes "propri√©taires". En fait, un sch√©ma de transaction sp√©cifique appel√© "CoinJoin" utilise ce fait pour cr√©er des transactions multipartites pour la confidentialit√©.</p>
</div>
<div class="admonitionblock note data-line-536">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-537">
<p>Chaque entr√©e de transaction et toute signature qu&#8217;elle peut contenir est <em>compl√®tement</em> ind√©pendante de toute autre entr√©e ou signature. Plusieurs parties peuvent collaborer pour construire des transactions et signer une seule entr√©e chacune.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="digital_signature_definition" class="sidebarblock data-line-542">
<div class="content">
<div class="title">D√©finition de Wikipedia d&#8217;une "signature num√©rique"</div>
<div class="paragraph data-line-543">
<p>Une signature num√©rique est un sch√©ma math√©matique permettant de d√©montrer l&#8217;authenticit√© d&#8217;un message ou de documents num√©riques. Une signature num√©rique valide donne au destinataire des raisons de croire que le message a √©t√© cr√©√© par un exp√©diteur connu (authentification), que l&#8217;exp√©diteur ne peut pas nier avoir envoy√© le message (non-r√©pudiable) et que le message n&#8217;a pas √©t√© alt√©r√© en transit (int√©grit√©).</p>
</div>
<div class="paragraph data-line-545">
<p><em>Source¬†: <a href="https://en.wikipedia.org/wiki/Digital_signature" class="undefined" data-href="https://en.wikipedia.org/wiki/Digital_signature">https://en.wikipedia.org/wiki/Digital_signature</a></em></p>
</div>
</div>
</div>
<div class="sect3 data-line-548">
<h4 id="_comment_fonctionnent_les_signatures_num√©riques">Comment fonctionnent les signatures num√©riques</h4>
<div class="paragraph data-line-550">
<p>Une signature num√©rique est un <em>sch√©ma math√©matique</em> qui se compose de deux parties. La premi√®re partie est un algorithme de cr√©ation d&#8217;une signature, √† l&#8217;aide d&#8217;une cl√© priv√©e (la cl√© de signature), √† partir d&#8217;un message (la transaction). La deuxi√®me partie est un algorithme qui permet √† quiconque de v√©rifier la signature, √©tant donn√© √©galement le message et une cl√© publique.</p>
</div>
<div class="sect4 data-line-552">
<h5 id="_cr√©ation_dune_signature_num√©rique">Cr√©ation d&#8217;une signature num√©rique</h5>
<div class="paragraph data-line-554">
<p>Dans l&#8217;impl√©mentation de l&#8217;algorithme ECDSA par bitcoin, le "message" sign√© est la transaction, ou plus pr√©cis√©ment un hachage d&#8217;un sous-ensemble sp√©cifique des donn√©es de la transaction (voir <a href="#sighash_types">Types de hachage de signature (SIGHASH)</a>). La cl√© de signature est la cl√© priv√©e de l&#8217;utilisateur. Le r√©sultat est la signature :</p>
</div>
<div class="paragraph data-line-556">
<p>\(Sig = F_{sig}(F_{hash}(m), dA)\)</p>
</div>
<div class="paragraph data-line-558">
<p>o√π:</p>
</div>
<div class="ulist data-line-560">
<ul>
<li class="data-line-560">
<p><em>dA</em> est la cl√© priv√©e de signature</p>
</li>
<li class="data-line-561">
<p><em>m</em> est la transaction (ou une partie de celle-ci)</p>
</li>
<li class="data-line-562">
<p><em>F</em><sub><em>hash</em></sub> est la fonction de hachage</p>
</li>
<li class="data-line-563">
<p><em>F</em><sub><em>sig</em></sub> est l&#8217;algorithme de signature</p>
</li>
<li class="data-line-564">
<p><em>Sig</em> est la signature r√©sultante</p>
</li>
</ul>
</div>
<div class="paragraph data-line-566">
<p>Plus de d√©tails sur les math√©matiques d&#8217;ECDSA peuvent √™tre trouv√©s dans <a href="#ecdsa_math">Math√©matiques ECDSA</a>.</p>
</div>
<div class="paragraph data-line-568">
<p>La fonction <em>F</em><sub><em>sig</em></sub> produit une signature <code>Sig</code> compos√©e de deux valeurs, commun√©ment appel√©es <code>R</code> et <code>S</code>¬†:</p>
</div>
<div class="listingblock data-line-570">
<div class="content">
<pre>Sig = (R, S)</pre>
</div>
</div>
<div class="paragraph data-line-574">
<p>Maintenant que les deux valeurs <code>R</code> et <code>S</code> ont √©t√© calcul√©es, elles sont s√©rialis√©es en un flux d&#8217;octets √† l&#8217;aide d&#8217;un sch√©ma de codage standard international appel√© <em>Distinguished Encoding Rules</em>, ou <em>DER</em> (ou r√®gles d&#8217;encodage distingu√©s).</p>
</div>
</div>
<div class="sect4 data-line-577">
<h5 id="seralization_of_signatures_der">S√©rialisation des signatures (DER)</h5>
<div class="paragraph data-line-579">
<p>Regardons la transaction Alice cr√©√©e √† nouveau. Dans l&#8217;entr√©e de transaction, il y a un script de d√©verrouillage qui contient la signature encod√©e DER suivante du portefeuille d&#8217;Alice¬†:</p>
</div>
<div class="listingblock data-line-581">
<div class="content">
<pre>3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e38133</pre>
</div>
</div>
<div class="paragraph data-line-585">
<p>Cette signature est un flux d&#8217;octets s√©rialis√© des valeurs <code>R</code> et <code>S</code> produites par le portefeuille d&#8217;Alice pour prouver qu&#8217;elle poss√®de la cl√© priv√©e autoris√©e √† d√©penser cette sortie. Le format de s√©rialisation se compose de neuf √©l√©ments comme suit¬†:</p>
</div>
<div class="ulist data-line-587">
<ul>
<li class="data-line-587">
<p><code>0x30</code>‚Äîindiquant le d√©but d&#8217;une s√©quence DER</p>
</li>
<li class="data-line-588">
<p><code>0x45</code>‚Äîla longueur de la s√©quence (69 octets)</p>
</li>
<li class="data-line-589">
<p><code>0x02</code>‚Äîune valeur enti√®re suit</p>
</li>
<li class="data-line-590">
<p><code>0x21</code>‚Äîla longueur de l&#8217;entier (33 octets)</p>
</li>
<li class="data-line-591">
<p><code>R</code>‚Äî<code>00884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb</code></p>
</li>
<li class="data-line-592">
<p><code>0x02</code>‚Äîun autre entier suit</p>
</li>
<li class="data-line-593">
<p><code>0x20</code>‚Äîla longueur de l&#8217;entier (32 octets)</p>
</li>
<li class="data-line-594">
<p><code>S</code>‚Äî<code>4b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813</code></p>
</li>
<li class="data-line-595">
<p>Un suffixe (<code>0x01</code>) indiquant le type de hachage utilis√© (<code>SIGHASH_ALL</code>)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-597">
<p>Voyez si vous pouvez d√©coder la signature s√©rialis√©e (encod√©e en DER) d&#8217;Alice en utilisant cette liste. Les nombres importants sont <code>R</code> et <code>S</code>¬†; le reste des donn√©es fait partie du sch√©ma de codage DER.</p>
</div>
</div>
</div>
<div class="sect3 data-line-599">
<h4 id="_v√©rification_de_la_signature">V√©rification de la signature</h4>
<div class="paragraph data-line-601">
<p>Pour v√©rifier la signature, il faut avoir la signature (<code>R</code> et <code>S</code>), la transaction s√©rialis√©e, et la cl√© publique (qui correspond √† la cl√© priv√©e utilis√©e pour cr√©er la signature). Essentiellement, la v√©rification d&#8217;une signature signifie "Seul le propri√©taire de la cl√© priv√©e qui a g√©n√©r√© cette cl√© publique pourrait avoir produit cette signature sur cette transaction."</p>
</div>
<div class="paragraph data-line-603">
<p>L&#8217;algorithme de v√©rification de signature prend le message (un hachage de la transaction ou de parties de celui-ci), la cl√© publique du signataire et la signature (<code>valeurs R</code> et <code>S</code>), et renvoie TRUE si la signature est valide pour ce message et cette cl√© publique.</p>
</div>
</div>
<div class="sect3 data-line-606">
<h4 id="sighash_types">Types de hachage de signature (SIGHASH)</h4>
<div class="paragraph data-line-608">
<p>Les signatures num√©riques sont appliqu√©es aux messages, qui dans le cas du bitcoin, sont les transactions elles-m√™mes. La signature implique un <em>engagement</em> du signataire sur des donn√©es de transaction sp√©cifiques. Dans sa forme la plus simple, la signature s&#8217;applique √† l&#8217;ensemble de la transaction, engageant ainsi toutes les entr√©es, sorties et autres champs de transaction. Cependant, une signature ne peut s&#8217;engager que sur un sous-ensemble des donn√©es d&#8217;une transaction, ce qui est utile pour un certain nombre de sc√©narios, comme nous le verrons dans cette section.</p>
</div>
<div class="paragraph data-line-610">
<p>Les signatures Bitcoin ont un moyen d&#8217;indiquer quelle partie des donn√©es d&#8217;une transaction est incluse dans le hachage sign√© par la cl√© priv√©e √† l&#8217;aide d&#8217;un drapeau <code>SIGHASH</code>. Le drapeau <code>SIGHASH</code> est un octet unique ajout√© √† la signature. Chaque signature a un drapeau <code>SIGHASH</code> et le drapeau peut √™tre diff√©rent d&#8217;une entr√©e √† l&#8217;autre. Une transaction avec trois entr√©es sign√©es peut avoir trois signatures avec des drapeaux <code>SIGHASH</code> diff√©rents, chaque signature signant (committant) diff√©rentes parties de la transaction.</p>
</div>
<div class="paragraph data-line-612">
<p>N&#8217;oubliez pas que chaque entr√©e peut contenir une signature dans son script de d√©verrouillage. Par cons√©quent, une transaction qui contient plusieurs entr√©es peut avoir des signatures avec diff√©rents indicateurs <code>SIGHASH</code> qui valident diff√©rentes parties de la transaction dans chacune des entr√©es. Notez √©galement que les transactions bitcoin peuvent contenir des entr√©es de diff√©rents "propri√©taires", qui ne peuvent signer qu&#8217;une seule entr√©e dans une transaction partiellement construite (et invalide), collaborant avec d&#8217;autres pour rassembler toutes les signatures n√©cessaires pour effectuer une transaction valide. De nombreux types d&#8217;indicateurs <code>SIGHASH</code> n&#8217;ont de sens que si vous pensez √† plusieurs participants collaborant en dehors du r√©seau Bitcoin et mettant √† jour une transaction partiellement sign√©e.</p>
</div>
<div class="paragraph pagebreak-before data-line-615">
<p>Il existe trois indicateurs <code>SIGHASH</code>¬†: <code>ALL</code>, <code>NONE</code> et <code>SINGLE</code>, comme indiqu√© dans <a href="#sighash_types_and_their">Types SIGHASH et leurs significations</a>.</p>
</div>
<table id="sighash_types_and_their" class="tableblock frame-all grid-all stretch data-line-620">
<caption class="title">Table 19. Types SIGHASH et leurs significations</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Drapeau <code>SIGHASH</code></th>
<th class="tableblock halign-left valign-top">Valeur</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ALL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique √† toutes les entr√©es et sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NONE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique √† toutes les entr√©es, aucune des sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SINGLE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique √† toutes les entr√©es mais uniquement √† la sortie avec le m√™me num√©ro d&#8217;index que l&#8217;entr√©e sign√©e</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-627">
<p>De plus, il existe un drapeau modificateur <code>SIGHASH_ANYONECANPAY</code>, qui peut √™tre combin√© avec chacun des drapeaux pr√©c√©dents. Lorsque <code>ANYONECANPAY</code> est d√©fini, une seule entr√©e est sign√©e, laissant le reste (et leurs num√©ros de s√©quence) ouverts pour modification. Le <code>ANYONECANPAY</code> a la valeur <code>0x80</code> et est appliqu√© par OR au niveau du bit, ce qui donne les drapeaux combin√©s comme indiqu√© dans <a href="#sighash_types_with_modifiers">Types SIGHASH avec modificateurs et leurs significations</a>.</p>
</div>
<table id="sighash_types_with_modifiers" class="tableblock frame-all grid-all stretch data-line-632">
<caption class="title">Table 20. Types SIGHASH avec modificateurs et leurs significations</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Drapeau SIGHASH</th>
<th class="tableblock halign-left valign-top">Valeur</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL|ANYONECANPAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x81</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique √† une entr√©e et √† toutes les sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NONE|ANYONECANPAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique √† une entr√©e, aucune des sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SINGLE|ANYONECANPAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x83</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique √† une entr√©e et √† la sortie avec le m√™me num√©ro d&#8217;index</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-639">
<p>Ces combinaisons de drapeaux sont r√©sum√©es dans <a href="#sighash_combinations">R√©sum√© des diff√©rentes combinaisons de sighash</a>.</p>
</div>
<div id="sighash_combinations" class="imageblock data-line-643">
<div class="content">
<img src="images/sighash_combinations.png" alt="R√©sum√© des diff√©rentes combinaisons de drapeaux SIGHASH">
</div>
<div class="title">Figure 42. R√©sum√© des diff√©rentes combinaisons de sighash</div>
</div>
<div class="paragraph data-line-645">
<p>La fa√ßon dont les drapeaux <code>SIGHASH</code> sont appliqu√©s lors de la signature et de la v√©rification est qu&#8217;une copie de la transaction est faite et que certains champs √† l&#8217;int√©rieur sont tronqu√©s (mis √† z√©ro et vid√©s). La transaction r√©sultante est s√©rialis√©e. Le drapeau <code>SIGHASH</code> est ajout√© √† la fin de la transaction s√©rialis√©e et le r√©sultat est hach√©. Le hachage lui-m√™me est le "message" qui est sign√©. Selon l&#8217;indicateur <code>SIGHASH</code> utilis√©, diff√©rentes parties de la transaction sont tronqu√©es. Le hachage r√©sultant d√©pend de diff√©rents sous-ensembles de donn√©es dans la transaction. En incluant le <code>SIGHASH</code> comme derni√®re √©tape avant le hachage, la signature valide √©galement le type <code>SIGHASH</code>, de sorte qu&#8217;il ne peut pas √™tre modifi√© (par exemple, par un mineur).</p>
</div>
<div class="admonitionblock note data-line-648">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-649">
<p>Tous les types <code>SIGHASH</code> signent le champ <code>nLocktime</code> de la transaction (voir <a href="#transaction_locktime_nlocktime">Temps de verrouillage des transactions (nLocktime)</a>). De plus, le type <code>SIGHASH</code> lui-m√™me est ajout√© √† la transaction avant sa signature, de sorte qu&#8217;il ne peut pas √™tre modifi√© une fois sign√©.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-652">
<p>Dans l&#8217;exemple de la transaction d&#8217;Alice (voir la liste dans <a href="#seralization_of_signatures_der">S√©rialisation des signatures (DER)</a>), nous avons vu que la derni√®re partie de la signature cod√©e en DER √©tait <code>01</code>, qui est le drapeau <code>SIGHASH_ALL</code>. Cela verrouille les donn√©es de transaction, de sorte que la signature d&#8217;Alice valide l&#8217;√©tat de toutes les entr√©es et sorties. C&#8217;est la forme de signature la plus courante.</p>
</div>
<div class="paragraph data-line-654">
<p>Examinons quelques-uns des autres types de <code>SIGHASH</code> et comment ils peuvent √™tre utilis√©s dans la pratique¬†:</p>
</div>
<div class="dlist data-line-656">
<dl>
<dt class="hdlist1"><code>ALL|ANYONECANPAY</code> </dt>
<dd>
<p>Cette construction peut √™tre utilis√©e pour effectuer une transaction de type "financement participatif". les fonds peuvent construire une transaction avec une seule sortie. La sortie unique paie le montant "objectif" √† la collecte de fonds. Une telle transaction n&#8217;est √©videmment pas valide, car elle n&#8217;a pas d&#8217;entr√©es. Cependant, d&#8217;autres peuvent maintenant la modifier en ajoutant une entr√©e de leur propre, en tant que don. Ils signent leur propre entr√©e avec <code>ALL|ANYONECANPAY</code>. √Ä moins que suffisamment d&#8217;entr√©es ne soient rassembl√©es pour atteindre la valeur de la sortie, la transaction n&#8217;est pas valide. Chaque don est un "engagement", qui ne peut pas √™tre collect√© par le collecteur de fonds jusqu&#8217;√† ce que le montant total de l&#8217;objectif soit atteint.</p>
</dd>
<dt class="hdlist1"><code>NONE</code> </dt>
<dd>
<p>Cette construction peut √™tre utilis√©e pour cr√©er un "ch√®que au porteur" ou un "ch√®que en blanc" d&#8217;un montant sp√©cifique. Il s&#8217;engage sur l&#8217;entr√©e, mais permet de modifier le script de verrouillage de sortie. N&#8217;importe qui peut √©crire sa propre adresse Bitcoin dans le script de verrouillage de sortie et racheter la transaction. Cependant, la valeur de sortie elle-m√™me est verrouill√©e par la signature.</p>
</dd>
<dt class="hdlist1"><code>NONE|ANYONECANPAY</code> </dt>
<dd>
<p>Cette construction peut √™tre utilis√©e pour construire un "collecteur de poussi√®re". Les utilisateurs qui ont de minuscules UTXO dans leur portefeuille ne peuvent pas les d√©penser car le co√ªt des frais d√©passe la valeur de la poussi√®re. Avec ce type de signature, la poussi√®re UTXO peut √™tre donn√©e √† quiconque pour l&#8217;agr√©ger et la d√©penser quand il le souhaite.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-662">
<p>Il y a quelques propositions pour modifier ou √©tendre le syst√®me <code>SIGHASH</code>. L&#8217;une de ces propositions est <em>Bitmask Sighash Modes</em> de Glenn Willen de Blockstream, dans le cadre du projet Elements. Cela vise √† cr√©er un remplacement flexible pour les types <code>SIGHASH</code> qui permet "des masques de bits arbitraires et r√©inscriptibles par des mineurs d&#8217;entr√©es et de sorties" qui peuvent exprimer "des sch√©mas de pr√©-engagement contractuels plus complexes, tels que des offres sign√©es avec changement dans un √©change d&#8217;actifs distribu√©".</p>
</div>
<div class="admonitionblock note data-line-665">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-666">
<p>Vous ne verrez pas les drapeaux <code>SIGHASH</code> pr√©sent√©s comme une option dans l&#8217;application de portefeuille d&#8217;un utilisateur. √Ä quelques exceptions pr√®s, les portefeuilles construisent des scripts P2PKH et signent avec les drapeaux <code>SIGHASH_ALL</code>. Pour utiliser un indicateur <code>SIGHASH</code> diff√©rent, vous devrez √©crire un logiciel pour construire et signer des transactions. Plus important encore, les drapeaux <code>SIGHASH</code> peuvent √™tre utilis√©s par des applications bitcoin √† usage sp√©cial qui permettent de nouvelles utilisations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-670">
<h4 id="ecdsa_math">Math√©matiques ECDSA</h4>
<div class="paragraph data-line-672">
<p>Comme mentionn√© pr√©c√©demment, les signatures sont cr√©√©es par une fonction math√©matique <em>F</em><sub><em>sig</em></sub> qui produit une signature compos√©e de deux valeurs <em>R</em> et <em>S</em>. Dans cette section, nous examinons la fonction <em>F</em><sub><em>sig</em></sub> plus en d√©tail.</p>
</div>
<div class="paragraph data-line-674">
<p>L&#8217;algorithme de signature g√©n√®re d&#8217;abord une paire de cl√©s publiques priv√©es <em>√©ph√©m√®res</em> (temporaires). Cette paire de cl√©s temporaire est utilis√©e dans le calcul des valeurs <em>R</em> et <em>S</em>, apr√®s une transformation impliquant la cl√© priv√©e de signature et le hachage de la transaction.</p>
</div>
<div class="paragraph data-line-676">
<p>La paire de cl√©s temporaire est bas√©e sur un nombre al√©atoire <em>k</em>, qui est utilis√© comme cl√© priv√©e temporaire. √Ä partir de <em>k</em>, nous g√©n√©rons la cl√© publique temporaire correspondante <em>P</em> (calcul√©e comme <em>P = k*G</em>, de la m√™me mani√®re que les cl√©s publiques bitcoin sont d√©riv√©es¬†; voir <a href="#pubkey">Cl√©s publiques</a>). La valeur <em>R</em> de la signature num√©rique est alors la coordonn√©e x de la cl√© publique √©ph√©m√®re <em>P</em>.</p>
</div>
<div class="paragraph data-line-678">
<p>A partir de l√†, l&#8217;algorithme calcule la valeur <em>S</em> de la signature, telle que¬†:</p>
</div>
<div class="paragraph data-line-680">
<p><em>S</em> = <em>k</em><sup>-1</sup> (<em>Hash</em>(<em>m</em>) + <em>dA</em> * <em>R</em>) <em>mod n</em></p>
</div>
<div class="paragraph data-line-682">
<p>o√π:</p>
</div>
<div class="ulist data-line-684">
<ul>
<li class="data-line-684">
<p><em>k</em> est la cl√© priv√©e √©ph√©m√®re</p>
</li>
<li class="data-line-685">
<p><em>R</em> est la coordonn√©e x de la cl√© publique √©ph√©m√®re</p>
</li>
<li class="data-line-686">
<p><em>dA</em> est la cl√© priv√©e de signature</p>
</li>
<li class="data-line-687">
<p><em>m</em> est les donn√©es de transaction</p>
</li>
<li class="data-line-688">
<p><em>n</em> est l&#8217;ordre premier de la courbe elliptique</p>
</li>
</ul>
</div>
<div class="paragraph data-line-690">
<p>La v√©rification est l&#8217;inverse de la fonction de g√©n√©ration de signature, utilisant les valeurs <em>R</em>, <em>S</em> et la cl√© publique pour calculer une valeur <em>P</em>, qui est un point sur la courbe elliptique (la cl√© publique √©ph√©m√®re utilis√©e dans la cr√©ation de signature)¬†:</p>
</div>
<div class="paragraph data-line-692">
<p><em>P</em> = <em>S</em><sup>-1</sup> * <em>Hash</em>(<em>m</em>) * <em>G</em> + <em>S</em><sup>-1</sup> * <em>R</em> * <em>Qa</em></p>
</div>
<div class="paragraph data-line-694">
<p>o√π:</p>
</div>
<div class="ulist data-line-696">
<ul>
<li class="data-line-696">
<p><em>R</em> et <em>S</em> sont les valeurs de signature</p>
</li>
<li class="data-line-697">
<p><em>Qa</em> est la cl√© publique d&#8217;Alice</p>
</li>
<li class="data-line-698">
<p><em>m</em> est les donn√©es de transaction qui ont √©t√© sign√©es</p>
</li>
<li class="data-line-699">
<p><em>G</em> est le point g√©n√©rateur de la courbe elliptique</p>
</li>
</ul>
</div>
<div class="paragraph data-line-701">
<p>Si la coordonn√©e x du point calcul√© <em>P</em> est √©gale √† <em>R</em>, alors le v√©rificateur peut conclure que la signature est valide.</p>
</div>
<div class="paragraph data-line-703">
<p>Notez qu&#8217;en v√©rifiant la signature, la cl√© priv√©e n&#8217;est ni connue ni r√©v√©l√©e.</p>
</div>
<div class="admonitionblock tip data-line-706">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-707">
<p>ECDSA est n√©cessairement un calcul assez compliqu√©; une explication compl√®te est au-del√† de la port√©e de ce livre. Un certain nombre d&#8217;excellents guides en ligne vous guident √©tape par √©tape¬†: recherchez "ECDSA expliqu√©" ou essayez celui-ci¬†: <a href="https://bit.ly/2r0HhGB" class="undefined" data-href="https://bit.ly/2r0HhGB">https://bit.ly/2r0HhGB</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-710">
<h4 id="_limportance_du_caract√®re_al√©atoire_dans_les_signatures">L&#8217;importance du caract√®re al√©atoire dans les signatures</h4>
<div class="paragraph data-line-712">
<p>Comme nous l&#8217;avons vu dans <a href="#ecdsa_math">Math√©matiques ECDSA</a>, l&#8217;algorithme de g√©n√©ration de signature utilise une cl√© al√©atoire <em>k</em>, comme base d&#8217;un couple cl√© priv√©e/publique √©ph√©m√®re. La valeur de <em>k</em> n&#8217;est pas importante, <em>tant qu&#8217;elle est al√©atoire</em>. Si la m√™me valeur <em>k</em> est utilis√©e pour produire deux signatures sur diff√©rents messages (transactions), alors la signature <em>cl√© priv√©e</em> peut √™tre calcul√©e par n&#8217;importe qui. La r√©utilisation de la m√™me valeur pour <em>k</em> dans un algorithme de signature conduit √† l&#8217;exposition de la cl√© priv√©e¬†!</p>
</div>
<div class="admonitionblock warning data-line-715">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-716">
<p>Si la m√™me valeur <em>k</em> est utilis√©e dans l&#8217;algorithme de signature sur deux transactions diff√©rentes, la cl√© priv√©e peut √™tre calcul√©e et expos√©e au monde¬†!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-719">
<p>Ce n&#8217;est pas seulement une possibilit√© th√©orique. Nous avons vu ce probl√®me conduire √† l&#8217;exposition de cl√©s priv√©es dans quelques impl√©mentations diff√©rentes d&#8217;algorithmes de signature de transaction en bitcoin. Des personnes se sont fait voler des fonds en raison de la r√©utilisation par inadvertance d&#8217;une valeur <em>k</em>. La raison la plus courante de r√©utilisation d&#8217;une valeur <em>k</em> est un g√©n√©rateur de nombres al√©atoires mal initialis√©.</p>
</div>
<div class="paragraph data-line-721">
<p>Pour √©viter cette vuln√©rabilit√©, la meilleure pratique de l&#8217;industrie est de ne pas g√©n√©rer <em>k</em> avec un g√©n√©rateur de nombres al√©atoires sem√© d&#8217;entropie, mais plut√¥t d&#8217;utiliser un processus d√©terministe-al√©atoire sem√© avec les donn√©es de transaction elles-m√™mes. Cela garantit que chaque transaction produit un <em>k</em> diff√©rent. L&#8217;algorithme standard de l&#8217;industrie pour l&#8217;initialisation d√©terministe de <em>k</em> est d√©fini dans <a href="https://tools.ietf.org/html/rfc6979" data-href="https://tools.ietf.org/html/rfc6979">RFC 6979</a>, publi√© par l&#8217;Internet Engineering Task Force.</p>
</div>
<div class="paragraph data-line-723">
<p>Si vous impl√©mentez un algorithme pour signer des transactions en bitcoin, vous <em>devez</em> utiliser la RFC 6979 ou un algorithme d√©terministe-al√©atoire similaire pour vous assurer de g√©n√©rer un <em>k</em> diff√©rent pour chaque transaction.</p>
</div>
</div>
</div>
<div class="sect2 data-line-725">
<h3 id="_adresses_bitcoin_soldes_et_autres_abstractions">Adresses Bitcoin, soldes et autres abstractions</h3>
<div class="paragraph data-line-727">
<p>Nous avons commenc√© ce chapitre avec la d√©couverte que les transactions sont tr√®s diff√©rentes "dans les coulisses" de la fa√ßon dont elles sont pr√©sent√©es dans les portefeuilles, les explorateurs de cha√Æne de blocs, et d&#8217;autres applications destin√©es aux utilisateurs. De nombreux concepts simplistes et familiers des chapitres pr√©c√©dents, tels que les adresses et les soldes Bitcoin, semblent √™tre absents de la structure de transaction. Nous avons vu que les transactions ne contiennent pas d&#8217;adresses Bitcoin en soi, mais fonctionnent plut√¥t via des scripts qui verrouillent et d√©verrouillent des valeurs discr√®tes de bitcoin. Les soldes ne sont pr√©sents nulle part dans ce syst√®me et pourtant, chaque application de portefeuille affiche bien en √©vidence le solde du portefeuille de l&#8217;utilisateur.</p>
</div>
<div class="paragraph data-line-729">
<p>Maintenant que nous avons explor√© ce qui est r√©ellement inclus dans une transaction bitcoin, nous pouvons examiner comment les abstractions de niveau sup√©rieur sont d√©riv√©es des composants apparemment primitifs de la transaction.</p>
</div>
<div class="paragraph data-line-731">
<p>Regardons √† nouveau comment la transaction d&#8217;Alice a √©t√© pr√©sent√©e sur un explorateur de blocs populaire (<a href="#alice_transaction_to_bobs_cafe">Transaction d&#8217;Alice au Bob&#8217;s Caf√©</a>).</p>
</div>
<div id="alice_transaction_to_bobs_cafe" class="imageblock data-line-735">
<div class="content">
<img src="images/mbc2_0208.png" alt="Alice Coffee Transaction">
</div>
<div class="title">Figure 43. Transaction d&#8217;Alice au Bob&#8217;s Caf√©</div>
</div>
<div class="paragraph data-line-737">
<p>Sur le c√¥t√© gauche de la transaction, l&#8217;explorateur de explorateur de cha√Æne de blocs affiche l&#8217;adresse Bitcoin d&#8217;Alice comme "exp√©diteur". En fait, cette information n&#8217;est pas dans la transaction elle-m√™me. Lorsque l&#8217;explorateur de cha√Æne de blocs fait r√©f√©rence √† la transaction, il fait √©galement r√©f√©rence √† la transaction pr√©c√©dente associ√©e √† l&#8217;entr√©e et extrait la premi√®re sortie de cette transaction plus ancienne. Dans cette sortie se trouve un script de verrouillage qui verrouille l&#8217;UTXO sur le hachage de la cl√© publique d&#8217;Alice (un script P2PKH). L&#8217;explorateur de cha√Æne de blocs a extrait le hachage de la cl√© publique et l&#8217;a encod√© √† l&#8217;aide de l&#8217;encodage Base58Check pour produire et afficher l&#8217;adresse Bitcoin qui repr√©sente cette cl√© publique.</p>
</div>
<div class="paragraph data-line-739">
<p>De m√™me, sur le c√¥t√© droit, l&#8217;explorateur de cha√Æne de blocs affiche les deux sorties¬†; le premier √† l&#8217;adresse Bitcoin de Bob et le second √† l&#8217;adresse Bitcoin d&#8217;Alice (comme change). Encore une fois, pour cr√©er ces adresses Bitcoin, l&#8217;explorateur de cha√Æne de blocs a extrait le script de verrouillage de chaque sortie, l&#8217;a reconnu comme un script P2PKH et a extrait le hachage de cl√© publique de l&#8217;int√©rieur. Enfin, l&#8217;explorateur de cha√Æne de blocs a r√©encod√© chaque hachage de cl√© publique avec Base58Check pour produire et afficher les adresses Bitcoin.</p>
</div>
<div class="paragraph data-line-741">
<p>Si vous deviez cliquer sur l&#8217;adresse Bitcoin de Bob, l&#8217;explorateur de explorateur de cha√Æne de blocs vous montrerait la vue dans <a href="#the_balance_of_bobs_bitcoin_address">Le solde de l&#8217;adresse Bitcoin de Bob</a>.</p>
</div>
<div id="the_balance_of_bobs_bitcoin_address" class="imageblock data-line-745">
<div class="content">
<img src="images/mbc2_0608.png" alt="Le solde de l&#8217;adresse Bitcoin de Bob">
</div>
<div class="title">Figure 44. Le solde de l&#8217;adresse Bitcoin de Bob</div>
</div>
<div class="paragraph data-line-747">
<p>L&#8217;explorateur de la cha√Æne de blocs affiche le solde de l&#8217;adresse Bitcoin de Bob. Mais nulle part dans le syst√®me Bitcoin il n&#8217;y a un concept de "solde". Au lieu de cela, les valeurs affich√©es ici sont construites par l&#8217;explorateur de explorateur de cha√Æne de blocs comme suit.</p>
</div>
<div class="paragraph data-line-749">
<p>Pour construire le montant "Total re√ßu", l&#8217;explorateur de explorateur de la cha√Æne de blocs d√©codera d&#8217;abord l&#8217;encodage Base58Check de l&#8217;adresse Bitcoin pour r√©cup√©rer le hachage 160 bits de la cl√© publique de Bob qui est encod√© dans l&#8217;adresse. Ensuite, l&#8217;explorateur de cha√Æne de blocs recherchera dans la base de donn√©es des transactions, √† la recherche de sorties avec des scripts de verrouillage P2PKH contenant le hachage de la cl√© publique de Bob. En additionnant la valeur de toutes les sorties, l&#8217;explorateur de la cha√Æne de blocs peut produire la valeur totale re√ßue.</p>
</div>
<div class="paragraph data-line-751">
<p>Construire le solde actuel (affich√© comme "Solde final") n√©cessite un peu plus de travail. L&#8217;explorateur de la cha√Æne de blocs conserve une base de donn√©es distincte des sorties actuellement non d√©pens√©es, l&#8217;ensemble UTXO. Pour maintenir cette base de donn√©es, l&#8217;explorateur de la cha√Æne de blocs doit surveiller le r√©seau Bitcoin, ajouter les UTXO nouvellement cr√©√©s et supprimer les UTXO d√©pens√©s, en temps r√©el, tels qu&#8217;ils apparaissent dans les transactions non confirm√©es. Il s&#8217;agit d&#8217;un processus compliqu√© qui d√©pend du suivi des transactions au fur et √† mesure qu&#8217;elles se propagent, ainsi que du maintien d&#8217;un consensus avec le r√©seau Bitcoin pour s&#8217;assurer que la cha√Æne correcte est suivie. Parfois, l&#8217;explorateur de la cha√Æne de blocs est d√©synchronis√© et sa perspective de l&#8217;ensemble UTXO est incompl√®te ou incorrecte.</p>
</div>
<div class="paragraph data-line-753">
<p>√Ä partir de l&#8217;ensemble UTXO, l&#8217;explorateur de la cha√Æne de blocs r√©sume la valeur de toutes les sorties non d√©pens√©es faisant r√©f√©rence au hachage de la cl√© publique de Bob et produit le num√©ro "Solde final" affich√© √† l&#8217;utilisateur.</p>
</div>
<div class="paragraph data-line-755">
<p>Afin de produire cette image unique, avec ces deux "soldes", l&#8217;explorateur de la cha√Æne de blocs doit indexer et rechercher parmi des dizaines, des centaines, voire des centaines de milliers de transactions.</p>
</div>
<div class="paragraph data-line-757">
<p>En r√©sum√©, les informations pr√©sent√©es aux utilisateurs via les applications de portefeuille, les explorateurs de cha√Ænes de blocs et d&#8217;autres interfaces utilisateur Bitcoin sont souvent compos√©es d&#8217;abstractions de niveau sup√©rieur qui sont d√©riv√©es en recherchant de nombreuses transactions diff√©rentes, en inspectant leur contenu et en manipulant les donn√©es qu&#8217;elles contiennent. En pr√©sentant cette vision simpliste des transactions bitcoin qui ressemblent √† des ch√®ques bancaires d&#8217;un exp√©diteur √† un destinataire, ces applications doivent extraire de nombreux d√©tails sous-jacents. Ils se concentrent principalement sur les types de transactions courants¬†: P2PKH avec des signatures SIGHASH_ALL sur chaque entr√©e. Ainsi, alors que les applications bitcoin peuvent pr√©senter plus de 80¬†% de toutes les transactions de mani√®re facile √† lire, elles sont parfois bloqu√©es par des transactions qui s&#8217;√©cartent de la norme. Les transactions qui contiennent des scripts de verrouillage plus complexes, ou diff√©rents indicateurs SIGHASH, ou de nombreuses entr√©es et sorties, d√©montrent la simplicit√© et la faiblesse de ces abstractions.</p>
</div>
<div class="paragraph data-line-759">
<p>Chaque jour, des centaines de transactions qui ne contiennent pas de sorties P2PKH sont confirm√©es sur la cha√Æne de blocs. Les explorateurs de cha√Æne de blocs les pr√©sentent souvent avec des messages d&#8217;avertissement rouges indiquant qu&#8217;ils ne peuvent pas d√©coder une adresse.</p>
</div>
<div class="paragraph data-line-19">
<p>Comme nous le verrons au chapitre suivant, il ne s&#8217;agit pas n√©cessairement de transactions √©tranges. Ce sont des transactions qui contiennent des scripts de verrouillage plus complexes que le P2PKH commun. Nous apprendrons ensuite √† d√©coder et √† comprendre des scripts plus complexes et les applications qu&#8217;ils prennent en charge.</p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-3">
<h2 id="adv_transactions">Transactions et scripts avanc√©s</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-6">
<h3 id="ch07_intro">Pr√©sentation</h3>
<div class="paragraph data-line-8">
<p>Dans le chapitre pr√©c√©dent, nous avons pr√©sent√© les √©l√©ments de base des transactions bitcoin et examin√© le type de script de transaction le plus courant, le script P2PKH. Dans ce chapitre, nous examinerons des scripts plus avanc√©s et comment nous pouvons les utiliser pour cr√©er des transactions avec des conditions complexes.</p>
</div>
<div class="paragraph data-line-10">
<p>Tout d&#8217;abord, nous examinerons les scripts <em>multisignature</em>. Ensuite, nous examinerons le deuxi√®me script de transaction le plus courant, <em>Pay-to-Script-Hash</em>, qui ouvre tout un monde de scripts complexes. Ensuite, nous examinerons de nouveaux op√©rateurs de script qui ajoutent une dimension temporelle au bitcoin, via les <em>timelocks</em> (verrouillage temporel). Enfin, nous examinerons les <em>Segregated Witness</em> (t√©moins s√©par√©s), une modification architecturale de la structure des transactions.</p>
</div>
</div>
<div class="sect2 data-line-13">
<h3 id="multisig">Multisignature</h3>
<div class="paragraph data-line-15">
<p>Les scripts multisignatures d√©finissent une condition dans laquelle N cl√©s publiques sont enregistr√©es dans le script et au moins M d&#8217;entre elles doivent fournir des signatures pour d√©bloquer les fonds. Ceci est √©galement connu sous le nom de sch√©ma M-sur-N, o√π N est le nombre total de cl√©s et M est le seuil de signatures requises pour la validation. Par exemple, une multisignature 2 sur 3 est celle o√π trois cl√©s publiques sont r√©pertori√©es comme signataires potentiels et au moins deux d&#8217;entre elles doivent √™tre utilis√©es pour cr√©er des signatures pour une transaction valide afin de d√©penser les fonds.</p>
</div>
<div class="paragraph data-line-17">
<p>√Ä l&#8217;heure actuelle, les scripts multisignatures <em>standard</em> sont limit√©s √† un maximum de 3 cl√©s publiques r√©pertori√©es, ce qui signifie que vous pouvez faire n&#8217;importe quoi d&#8217;une multisignature 1 sur 1 jusqu&#8217;√† 3 sur 3 ou toute combinaison dans cette plage. La limitation √† 3 cl√©s r√©pertori√©es pourrait √™tre lev√©e au moment de la publication de ce livre, alors v√©rifiez la fonction <code>IsStandard()</code> pour voir ce qui est actuellement accept√© par le r√©seau. Notez que la limite de 3 cl√©s s&#8217;applique uniquement aux scripts multisignatures standard (√©galement appel√©s "nus (bare en anglais)"), et non aux scripts multisignatures envelopp√©s dans un script Pay-to-Script-Hash (P2SH). Les scripts multisignatures P2SH sont limit√©s √† 15 cl√©s, permettant jusqu&#8217;√† 15 multisignatures sur 15. Cette limitation est √©galement impos√©e par la fonction <code>IsStandard()</code>. Nous en apprendrons davantage sur P2SH dans <a href="#p2sh">Pay-to-Script-Hash (P2SH)</a>.</p>
</div>
<div class="paragraph data-line-19">
<p>La forme g√©n√©rale d&#8217;un script de verrouillage d√©finissant une condition multisignature M-de-N est¬†:</p>
</div>
<div class="listingblock data-line-21">
<div class="content">
<pre>M &lt;Public Key 1&gt; &lt;Public Key 2&gt; ... &lt;Public Key N&gt; N CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-25">
<p>o√π N est le nombre total de cl√©s publiques r√©pertori√©es et M est le seuil de signatures requises pour d√©penser la sortie.</p>
</div>
<div class="paragraph data-line-27">
<p>Un script de verrouillage d√©finissant une condition multisignature 2 sur 3 ressemble √† ceci¬†:</p>
</div>
<div class="listingblock data-line-29">
<div class="content">
<pre>2 &lt;Public Key A&gt; &lt;Public Key B&gt; &lt;Public Key C&gt; 3 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-33">
<p>Le script de verrouillage pr√©c√©dent peut se contenter d&#8217;un script de d√©verrouillage contenant n&#8217;importe quelle combinaison de deux signatures issues des cl√©s priv√©es correspondant aux trois cl√©s publiques list√©es :</p>
</div>
<div class="listingblock data-line-35">
<div class="content">
<pre>&lt;Signature B&gt; &lt;Signature C&gt;</pre>
</div>
</div>
<div class="paragraph data-line-39">
<p>Les deux scripts ensemble formeraient le script de validation combin√©¬†:</p>
</div>
<div class="listingblock data-line-41">
<div class="content">
<pre>&lt;Signature B&gt; &lt;Signature C&gt; 2 &lt;Public Key A&gt; &lt;Public Key B&gt; &lt;Public Key C&gt; 3 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-45">
<p>Lorsqu&#8217;il est ex√©cut√©, ce script combin√© sera √©valu√© √† TRUE si, et seulement si, le script de d√©verrouillage correspond aux conditions d√©finies par le script de verrouillage. Dans ce cas, la condition est de savoir si le script de d√©verrouillage poss√®de une signature valide √† partir des deux cl√©s priv√©es qui correspondent √† deux des trois cl√©s publiques d√©finies comme une charge.</p>
</div>
<div class="sect3 data-line-48">
<h4 id="multisig_bug">Un bogue dans l&#8217;ex√©cution de CHECKMULTISIG</h4>
<div class="paragraph data-line-50">
<p>Il y a un bug dans l&#8217;ex√©cution de <code>CHECKMULTISIG</code> qui n√©cessite une l√©g√®re solution de contournement. Lorsque <code>CHECKMULTISIG</code> s&#8217;ex√©cute, il doit consommer M`N`2 √©l√©ments sur la pile en tant que param√®tres. Cependant, en raison du bogue, <code>CHECKMULTISIG</code> affichera une valeur suppl√©mentaire ou une valeur de plus que pr√©vu.</p>
</div>
<div class="paragraph data-line-52">
<p>Examinons cela plus en d√©tail √† l&#8217;aide de l&#8217;exemple de validation pr√©c√©dent¬†:</p>
</div>
<div class="listingblock data-line-54">
<div class="content">
<pre>&lt;Signature B&gt; &lt;Signature C&gt; 2 &lt;Public Key A&gt; &lt;Public Key B&gt; &lt;Public Key C&gt; 3 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-58">
<p>Tout d&#8217;abord, <code>CHECKMULTISIG</code> affiche l&#8217;√©l√©ment sup√©rieur, qui est <code>N</code> (dans cet exemple "3"). Ensuite, il affiche <code>N</code> √©l√©ments, qui sont les cl√©s publiques pouvant signer. Dans cet exemple, les cl√©s publiques A, B et C. Ensuite, un √©l√©ment appara√Æt, qui est <code>M</code>, le quorum (combien de signatures sont n√©cessaires). Ici M = 2. √Ä ce stade, <code>CHECKMULTISIG</code> devrait faire appara√Ætre les √©l√©ments finaux <code>M</code>, qui sont les signatures, et voir s&#8217;ils sont valides. Cependant, malheureusement, un bogue dans l&#8217;impl√©mentation fait que <code>CHECKMULTISIG</code> affiche un √©l√©ment de plus (M+1 total) qu&#8217;il ne le devrait. L&#8217;√©l√©ment suppl√©mentaire n&#8217;est pas pris en compte lors de la v√©rification des signatures, il n&#8217;a donc aucun effet direct sur <code>CHECKMULTISIG</code> lui-m√™me. Cependant, une valeur suppl√©mentaire doit √™tre pr√©sente car si elle n&#8217;est pas pr√©sente, lorsque <code>CHECKMULTISIG</code> tente d&#8217;appara√Ætre sur une pile vide, cela provoquera une erreur de pile et un √©chec du script (marquant la transaction comme invalide). Comme l&#8217;√©l√©ment suppl√©mentaire n&#8217;est pas pris en compte, il peut s&#8217;agir de n&#8217;importe quoi, mais habituellement <code>0</code> est utilis√©.</p>
</div>
<div class="paragraph data-line-60">
<p>Parce que ce bogue est devenu une partie des r√®gles de consensus, il doit maintenant √™tre r√©pliqu√© pour toujours. Par cons√©quent, la validation correcte du script ressemblerait √† ceci¬†:</p>
</div>
<div class="listingblock data-line-62">
<div class="content">
<pre>0 &lt;Signature B&gt; &lt;Signature C&gt; 2 &lt;Public Key A&gt; &lt;Public Key B&gt; &lt;Public Key C&gt; 3 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-66">
<p>Ainsi le script de d√©verrouillage r√©ellement utilis√© en multisig n&#8217;est pas :</p>
</div>
<div class="listingblock data-line-68">
<div class="content">
<pre>&lt;Signature B&gt; &lt;Signature C&gt;</pre>
</div>
</div>
<div class="paragraph data-line-72">
<p>mais √† la place c&#8217;est :</p>
</div>
<div class="listingblock data-line-74">
<div class="content">
<pre>0 &lt;Signature B&gt; &lt;Signature C&gt;</pre>
</div>
</div>
<div class="paragraph data-line-78">
<p>√Ä partir de maintenant, si vous voyez un script de d√©verrouillage multisig, vous devriez vous attendre √† voir un <code>0</code> suppl√©mentaire au d√©but, dont le seul but est de contourner un bogue qui est accidentellement devenu une r√®gle de consensus.</p>
</div>
</div>
</div>
<div class="sect2 data-line-81">
<h3 id="p2sh">Pay-to-Script-Hash (P2SH)</h3>
<div class="paragraph data-line-83">
<p>Pay- to-Script-Hash (P2SH) a √©t√© introduit en 2012 en tant que nouveau type de transaction puissant qui simplifie grandement l&#8217;utilisation de scripts de transaction complexes. Pour expliquer le besoin de P2SH, regardons un exemple pratique.</p>
</div>
<div class="paragraph data-line-85">
<p>("Pay-to-Script-Hash (P2SH)", "exemple d&#8217;import/export")Dans <a href="#ch01_intro_what_is_bitcoin">Pr√©sentation</a> nous avons pr√©sent√© Mohammed, un importateur d&#8217;√©lectronique bas√© √† Duba√Ø. La soci√©t√© de Mohammed utilise largement la fonction multisignature de Bitcoin pour ses comptes d&#8217;entreprise. Les scripts multisignatures sont l&#8217;une des utilisations les plus courantes des capacit√©s de script avanc√©es de Bitcoin et constituent une fonctionnalit√© tr√®s puissante. La soci√©t√© de Mohammed utilise un script multisignature pour tous les paiements des clients, connu en termes comptables sous le nom de "comptes d√©biteurs ou recevables". Avec le sch√©ma multisignature, tous les paiements effectu√©s par les clients sont verrouill√©s de telle mani√®re qu&#8217;ils n√©cessitent au moins deux signatures pour √™tre lib√©r√©s, de Mohammed et de l&#8217;un de ses partenaires ou de son avocat qui dispose d&#8217;une cl√© de secours. Un syst√®me multisignature comme celui-ci offre des contr√¥les de gouvernance d&#8217;entreprise et prot√®ge contre le vol, le d√©tournement de fonds ou la perte.</p>
</div>
<div class="paragraph data-line-87">
<p>Le script r√©sultant est assez long et ressemble √† ceci¬†:</p>
</div>
<div class="listingblock data-line-89">
<div class="content">
<pre>2 &lt;Mohammed's Public Key&gt; &lt;Partner1 Public Key&gt; &lt;Partner2 Public Key&gt; &lt;Partner3 Public Key&gt; &lt;Attorney Public Key&gt; 5 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-93">
<p>Bien que les scripts multisignatures soient une fonctionnalit√© puissante, ils sont lourds √† utiliser. Compte tenu du script pr√©c√©dent, Mohammed devrait communiquer ce script √† chaque client avant le paiement. Chaque client devrait utiliser un logiciel sp√©cial de portefeuille bitcoin avec la possibilit√© de cr√©er des scripts de transaction personnalis√©s, et chaque client devrait comprendre comment cr√©er une transaction √† l&#8217;aide de scripts personnalis√©s. De plus, la transaction r√©sultante serait environ cinq fois plus importante qu&#8217;une simple transaction de paiement, car ce script contient des cl√©s publiques tr√®s longues. Le fardeau de cette transaction extra-large serait support√© par le client sous la forme de frais. Enfin, un gros script de transaction comme celui-ci serait transport√© dans l&#8217;UTXO d√©fini dans la RAM de chaque n≈ìud complet, jusqu&#8217;√† ce qu&#8217;il soit d√©pens√©. Tous ces probl√®mes rendent difficile l&#8217;utilisation de scripts de verrouillage complexes dans la pratique.</p>
</div>
<div class="paragraph data-line-95">
<p>P2SH a √©t√© d√©velopp√© pour r√©soudre ces difficult√©s pratiques et rendre l&#8217;utilisation de scripts complexes aussi simple qu&#8217;un paiement √† une adresse Bitcoin. Avec les paiements P2SH, le script de verrouillage complexe est remplac√© par son empreinte num√©rique, un hachage cryptographique. Lorsqu&#8217;une transaction tentant de d√©penser l&#8217;UTXO est pr√©sent√©e ult√©rieurement, elle doit contenir le script correspondant au hachage, en plus du script de d√©verrouillage. En termes simples, P2SH signifie "payer √† un script correspondant √† ce hachage, un script qui sera pr√©sent√© plus tard lorsque cette sortie sera d√©pens√©e".</p>
</div>
<div class="paragraph data-line-97">
<p>Dans les transactions P2SH, le script de verrouillage qui est remplac√© par un hachage est appel√© <em>redeem script</em> ou <em>script de rachat</em> car il est pr√©sent√© au syst√®me au moment du rachat plut√¥t que comme un script de verrouillage. <a href="#without_p2sh">Script complexe sans P2SH</a> affiche le script sans P2SH et <a href="#with_p2sh">Script complexe comme P2SH</a> montre le m√™me script encod√© avec P2SH.</p>
</div>
<table id="without_p2sh" class="tableblock frame-all grid-all stretch data-line-101">
<caption class="title">Table 21. Script complexe sans P2SH</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script de verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 PubKey1 PubKey2 PubKey3 PubKey4 PubKey5 5 CHECKMULTISIG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script de d√©verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 Sig1 Sig2</p></td>
</tr>
</tbody>
</table>
<table id="with_p2sh" class="tableblock frame-all grid-all stretch data-line-108">
<caption class="title">Table 22. Script complexe comme P2SH</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script de rachat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 PubKey1 PubKey2 PubKey3 PubKey4 PubKey5 5 CHECKMULTISIG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script de verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HASH160 &lt;20-byte hash of redeem script&gt; EQUAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script de d√©verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 Sig1 Sig2 &lt;redeem script&gt;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-114">
<p>Comme vous pouvez le voir dans les tableaux, avec P2SH, le script complexe qui d√©taille les conditions de d√©pense de la sortie (script de rachat) n&#8217;est pas pr√©sent√© dans le script de verrouillage. Au lieu de cela, seul un hachage de celui-ci se trouve dans le script de verrouillage et le script de rachat lui-m√™me est pr√©sent√© plus tard, dans le cadre du script de d√©verrouillage lorsque la sortie est d√©pens√©e. Cela d√©place le fardeau des frais et de la complexit√© de l&#8217;exp√©diteur (qui cr√©e la transaction) vers le destinataire (qui d√©verrouille et d√©pense la transaction).</p>
</div>
<div class="paragraph data-line-116">
<p>Examinons la soci√©t√© de Mohammed, le script multisignature complexe et les scripts P2SH qui en r√©sultent.</p>
</div>
<div class="paragraph data-line-118">
<p>Tout d&#8217;abord, le script multisignature que la soci√©t√© de Mohammed utilise pour tous les paiements entrants des clients¬†:</p>
</div>
<div class="listingblock data-line-120">
<div class="content">
<pre>2 &lt;Mohammed's Public Key&gt; &lt;Partner1 Public Key&gt; &lt;Partner2 Public Key&gt; &lt;Partner3 Public Key&gt; &lt;Attorney Public Key&gt; 5 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-124">
<p>Si les espaces r√©serv√©s sont remplac√©s par des cl√©s publiques r√©elles (affich√©es ici sous forme de nombres de 520¬†bits commen√ßant par 04), vous pouvez voir que ce script devient tr√®s long¬†:</p>
</div>
<div class="listingblock data-line-126">
<div class="content">
<pre>2
04C16B8698A9ABF84250A7C3EA7EEDEF9897D1C8C6ADF47F06CF73370D74DCCA01CDCA79DCC5C395D7EEC6984D83F1F50C900A24DD47F569FD4193AF5DE762C58704A2192968D8655D6A935BEAF2CA23E3FB87A3495E7AF308EDF08DAC3C1FCBFC2C75B4B0F4D0B1B70CD2423657738C0C2B1D5CE65C97D78D0E34224858008E8B49047E63248B75DB7379BE9CDA8CE5751D16485F431E46117B9D0C1837C9D5737812F393DA7D4420D7E1A9162F0279CFC10F1E8E8F3020DECDBC3C0DD389D99779650421D65CBD7149B255382ED7F78E946580657EE6FDA162A187543A9D85BAAA93A4AB3A8F044DADA618D087227440645ABE8A35DA8C5B73997AD343BE5C2AFD94A5043752580AFA1ECED3C68D446BCAB69AC0BA7DF50D56231BE0AABF1FDEEC78A6A45E394BA29A1EDF518C022DD618DA774D207D137AAB59E0B000EB7ED238F4D800 5 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-131">
<p>Ce script entier peut √† la place √™tre repr√©sent√© par un hachage cryptographique de 20 octets, en appliquant d&#8217;abord l&#8217;algorithme de hachage SHA256, puis en appliquant l&#8217;algorithme RIPEMD160 sur le r√©sultat.</p>
</div>
<div class="paragraph data-line-133">
<p>Nous utilisons <code>libbitcoin-explorer</code> (bx) sur la ligne de commande pour produire le hachage du script, comme suit¬†:</p>
</div>
<div class="listingblock data-line-135">
<div class="content">
<pre>echo \
2 \
[04C16B8698A9ABF84250A7C3EA7EEDEF9897D1C8C6ADF47F06CF73370D74DCCA01CDCA79DCC5C395D7EEC6984D83F1F50C900A24DD47F569FD4193AF5DE762C587] \
[04A2192968D8655D6A935BEAF2CA23E3FB87A3495E7AF308EDF08DAC3C1FCBFC2C75B4B0F4D0B1B70CD2423657738C0C2B1D5CE65C97D78D0E34224858008E8B49] \
[047E63248B75DB7379BE9CDA8CE5751D16485F431E46117B9D0C1837C9D5737812F393DA7D4420D7E1A9162F0279CFC10F1E8E8F3020DECDBC3C0DD389D9977965] \
[0421D65CBD7149B255382ED7F78E946580657EE6FDA162A187543A9D85BAAA93A4AB3A8F044DADA618D087227440645ABE8A35DA8C5B73997AD343BE5C2AFD94A5] \
[043752580AFA1ECED3C68D446BCAB69AC0BA7DF50D56231BE0AABF1FDEEC78A6A45E394BA29A1EDF518C022DD618DA774D207D137AAB59E0B000EB7ED238F4D800] \
5 CHECKMULTISIG \
| bx script-encode | bx sha256 | bx ripemd160
54c557e07dde5bb6cb791c7a540e0a4796f5e97e</pre>
</div>
</div>
<div class="paragraph data-line-148">
<p>La s√©rie de commandes ci-dessus encode d&#8217;abord le script de rachat multisig de Mohammed en tant que script bitcoin s√©rialis√© encod√© en hexad√©cimal. La commande <code>bx</code> suivante calcule le hachage SHA256 de cela. La prochaine commande <code>bx</code> hache √† nouveau avec RIPEMD160, produisant le hachage de script final¬†:</p>
</div>
<div class="paragraph data-line-150">
<p>Le hachage de 20¬†octets du script de rachat de Mohammed est¬†:</p>
</div>
<div class="listingblock data-line-152">
<div class="content">
<pre>54c557e07dde5bb6cb791c7a540e0a4796f5e97e</pre>
</div>
</div>
<div class="paragraph data-line-156">
<p>Une transaction P2SH verrouille la sortie sur ce hachage au lieu du script de rachat plus long, en utilisant le script de verrouillage¬†:</p>
</div>
<div class="listingblock data-line-158">
<div class="content">
<pre>HASH160 54c557e07dde5bb6cb791c7a540e0a4796f5e97e EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-162">
<p>qui, comme vous pouvez le voir, est beaucoup plus courte. Au lieu de "payer √† ce script multisignature √† 5¬†cl√©s", la transaction √©quivalente √† P2SH est "payer √† un script avec ce hachage". Un client effectuant un paiement √† la soci√©t√© de Mohammed n&#8217;a qu&#8217;√† inclure ce script de verrouillage beaucoup plus court dans son paiement. Lorsque Mohammed et ses partenaires veulent d√©penser cet UTXO, ils doivent pr√©senter le script de rachat original (celui dont le hachage a verrouill√© l&#8217;UTXO) et les signatures n√©cessaires pour le d√©verrouiller, comme ceci¬†:</p>
</div>
<div class="listingblock data-line-164">
<div class="content">
<pre>&lt;Sig1&gt; &lt;Sig2&gt; &lt;2 PK1 PK2 PK3 PK4 PK5 5 CHECKMULTISIG&gt;</pre>
</div>
</div>
<div class="paragraph data-line-168">
<p>Les deux scripts sont combin√©s en deux √©tapes. Tout d&#8217;abord, le script de rachat est v√©rifi√© par rapport au script de verrouillage pour s&#8217;assurer que le hachage correspond¬†:</p>
</div>
<div class="listingblock data-line-170">
<div class="content">
<pre>&lt;2 PK1 PK2 PK3 PK4 PK5 5 CHECKMULTISIG&gt; HASH160 &lt;redeem scriptHash&gt; EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-173">
<p>Si le hachage du script de rachat correspond, le script de d√©verrouillage est ex√©cut√© de lui-m√™me pour d√©verrouiller le script de rachat¬†:</p>
</div>
<div class="listingblock data-line-175">
<div class="content">
<pre>&lt;Sig1&gt; &lt;Sig2&gt; 2 PK1 PK2 PK3 PK4 PK5 5 CHECKMULTISIG</pre>
</div>
</div>
<div class="paragraph data-line-179">
<p>Presque tous les scripts d√©crits dans ce chapitre ne peuvent √™tre impl√©ment√©s qu&#8217;en tant que scripts P2SH. Par exemple, un script de verrouillage multisignature standard 2 sur 5 ne peut pas √™tre utilis√© directement dans le script de verrouillage d&#8217;un UTXO, car <code>IsStandard()</code> invaliderait la transaction. Pour se conformer, un script de verrouillage P2SH peut √™tre utilis√© √† la place, comme vu ci-dessus. Une transaction qui comprend alors un script de d√©verrouillage P2SH peut √™tre utilis√©e pour racheter cet UTXO et sera valide tant qu&#8217;elle ne contient pas plus de 15 cl√©s publiques. </p>
</div>
<div class="admonitionblock tip data-line-182">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-183">
<p>N&#8217;oubliez pas qu&#8217;en raison de la politique d√©finie par la fonction <code>IsStandard()</code> au moment de la r√©daction de cet article, les scripts multisignatures standard sont limit√©s √† 3 cl√©s publiques r√©pertori√©es au maximum, tandis que les scripts P2SH sont limit√©s √† 15 cl√©s publiques r√©pertori√©es au maximum. Les scripts multisignatures standard peuvent invalider les transactions au moyen de leur script de verrouillage <em>ou</em> de d√©verrouillage, tandis que les scripts P2SH peuvent invalider les transactions au moyen de leur script de d√©verrouillage <em>uniquement</em>. En effet, <code>IsStandard()</code> n&#8217;a aucun moyen de savoir si un hachage d&#8217;un script de rachat dans un script de verrouillage inclut plus de signatures que la limite de taille actuellement impos√©e, il ne peut donc observer que les scripts de d√©verrouillage dans les entr√©es de transaction.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 data-line-186">
<h4 id="_adresses_p2sh">Adresses P2SH</h4>
<div class="paragraph data-line-188">
<p>Une autre partie importante de la fonctionnalit√© P2SH est la possibilit√© d&#8217;encoder un hachage de script en tant qu&#8217;adresse, comme d√©fini dans BIP-13. Les adresses P2SH sont des encodages Base58Check du hachage de 20 octets d&#8217;un script, tout comme les adresses Bitcoin sont des encodages Base58Check du hachage de 20 octets d&#8217;une cl√© publique. Les adresses P2SH utilisent le pr√©fixe de version "5", ce qui donne des adresses encod√©es en Base58Check qui commencent par un "3".</p>
</div>
<div class="paragraph data-line-190">
<p>Par exemple, le script complexe de Mohammed, hach√© et encod√© en Base58Check comme une adresse P2SH, devient 39RF6JqABiHdYHkfChV6USGMe6Nsr66Gzw. Nous pouvons le confirmer avec la commande bx¬†:</p>
</div>
<div class="listingblock data-line-192">
<div class="content">
<pre>echo \
'54c557e07dde5bb6cb791c7a540e0a4796f5e97e'\
 | bx address-encode -v 5
39RF6JqABiHdYHkfChV6USGMe6Nsr66Gzw</pre>
</div>
</div>
<div class="paragraph data-line-200">
<p>Maintenant, Mohammed peut donner cette "adresse" √† ses clients et ils peuvent utiliser presque n&#8217;importe quel portefeuille bitcoin pour effectuer un paiement simple, comme s&#8217;il s&#8217;agissait d&#8217;une adresse Bitcoin. Le pr√©fixe 3 leur donne un indice qu&#8217;il s&#8217;agit d&#8217;un type d&#8217;adresse sp√©cial, celui correspondant √† un script au lieu d&#8217;une cl√© publique, mais sinon cela fonctionne exactement de la m√™me mani√®re qu&#8217;un paiement √† une adresse Bitcoin.</p>
</div>
<div class="paragraph data-line-202">
<p>Les adresses P2SH cachent toute la complexit√©, de sorte que la personne effectuant un paiement ne voit pas le script.</p>
</div>
</div>
<div class="sect3 data-line-204">
<h4 id="_avantages_du_p2sh">Avantages du P2SH</h4>
<div class="paragraph data-line-206">
<p>La fonction P2SH offre les avantages suivants par rapport √† l&#8217;utilisation directe de scripts complexes dans le verrouillage des sorties¬†:</p>
</div>
<div class="ulist data-line-208">
<ul>
<li class="data-line-208">
<p>Les scripts complexes sont remplac√©s par des empreintes digitales plus courtes dans la sortie de la transaction, ce qui r√©duit la taille de la transaction.</p>
</li>
<li class="data-line-209">
<p>Les scripts peuvent √™tre cod√©s comme une adresse, de sorte que l&#8217;exp√©diteur et le portefeuille de l&#8217;exp√©diteur n&#8217;ont pas besoin d&#8217;ing√©nierie complexe pour impl√©menter P2SH.</p>
</li>
<li class="data-line-210">
<p>P2SH transf√®re le fardeau de la construction du script au destinataire, pas √† l&#8217;exp√©diteur.</p>
</li>
<li class="data-line-211">
<p>P2SH d√©place la charge de stockage des donn√©es pour le script long de la sortie (qui en plus d&#8217;√™tre stock√©e sur la cha√Æne de blocs est dans l&#8217;ensemble UTXO) vers l&#8217;entr√©e (uniquement stock√©e sur la cha√Æne de blocs).</p>
</li>
<li class="data-line-212">
<p>P2SH d√©place la charge de stockage des donn√©es pour le script long du moment pr√©sent (paiement) √† un moment futur (lorsqu&#8217;il est d√©pens√©).</p>
</li>
<li class="data-line-213">
<p>P2SH transf√®re les frais de transaction plus √©lev√©s d&#8217;un long script de l&#8217;exp√©diteur au destinataire, qui doit inclure le long script d&#8217;√©change pour le d√©penser.</p>
</li>
</ul>
</div>
</div>
<div class="sect3 data-line-215">
<h4 id="_utiliser_le_script_et_la_validation">Utiliser le script et la validation</h4>
<div class="paragraph data-line-217">
<p>Avant la version 0.9.2 du client Bitcoin Core, Pay-to-Script-Hash √©tait limit√© aux types standard de scripts de transaction bitcoin, par la fonction IsStandard(). Cela signifie que le script d&#8217;√©change pr√©sent√© dans la transaction de d√©penses ne peut √™tre que l&#8217;un des types standard¬†: P2PK, P2PKH ou multisig.</p>
</div>
<div class="paragraph data-line-219">
<p>Depuis la version 0.9.2 du client Bitcoin Core, les transactions P2SH peuvent contenir n&#8217;importe quel script valide, ce qui rend la norme P2SH beaucoup plus flexible et permet d&#8217;exp√©rimenter de nombreux types de transactions nouveaux et complexes.</p>
</div>
<div class="paragraph data-line-221">
<p>Vous ne pouvez pas mettre un P2SH dans un script de rachat P2SH, car la sp√©cification P2SH n&#8217;est pas r√©cursive. Aussi, bien qu&#8217;il soit techniquement possible d&#8217;inclure <code>RETURN</code> (voir <a href="#op_return">Sortie d&#8217;enregistrement de donn√©es (RETURN)</a>) dans un script de rachat, comme rien dans les r√®gles ne vous emp√™che de le faire, cela n&#8217;a aucune utilit√© pratique car l&#8217;ex√©cution de <code>RETURN</code> lors de la validation entra√Ænera le marquage de la transaction comme invalide.</p>
</div>
<div class="paragraph data-line-223">
<p>Notez que, comme le script de rachat n&#8217;est pas pr√©sent√© au r√©seau tant que vous n&#8217;essayez pas de d√©penser une sortie P2SH, si vous verrouillez une sortie avec le hachage d&#8217;un script de rachat invalide, elle sera trait√©e malgr√© tout. L&#8217;UTXO sera verrouill√© avec succ√®s. Cependant, vous ne pourrez pas le d√©penser car la transaction de d√©pense, qui inclut le script d&#8217;√©change, ne sera pas accept√©e car il s&#8217;agit d&#8217;un script invalide. Cela cr√©e un risque, car vous pouvez verrouiller des bitcoins dans un P2SH qui ne pourra pas √™tre d√©pens√© plus tard. Le r√©seau acceptera le script de verrouillage P2SH m√™me s&#8217;il correspond √† un script de rachat invalide, car le hachage du script ne donne aucune indication sur le script qu&#8217;il repr√©sente.</p>
</div>
<div class="admonitionblock warning data-line-226">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-227">
<p>Les scripts de verrouillage P2SH contiennent le hachage d&#8217;un script de rachat, qui ne donne aucun indice quant au contenu du script de rachat lui-m√™me. La transaction P2SH sera consid√©r√©e comme valide et accept√©e m√™me si le script de rachat est invalide. Vous pourriez accidentellement verrouiller le bitcoin de telle sorte qu&#8217;il ne puisse plus √™tre d√©pens√©.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2 data-line-233">
<h3 id="op_return">Sortie d&#8217;enregistrement de donn√©es (RETURN)</h3>
<div class="paragraph data-line-235">
<p>Les bitcoins sont distribu√©s et Le grand livre horodat√©, la cha√Æne de blocs, a des utilisations potentielles bien au-del√† des paiements. De nombreux d√©veloppeurs ont essay√© d&#8217;utiliser le langage de script de transaction pour tirer parti de la s√©curit√© et de la r√©silience du syst√®me pour des applications telles que les services de notaire num√©rique, les certificats d&#8217;actions et les contrats intelligents. Les premi√®res tentatives d&#8217;utilisation du langage de script de bitcoin √† ces fins impliquaient la cr√©ation de sorties de transaction qui enregistraient des donn√©es sur la cha√Æne de blocs; par exemple, pour enregistrer une empreinte digitale d&#8217;un fichier de mani√®re √† ce que n&#8217;importe qui puisse √©tablir la preuve de l&#8217;existence de ce fichier √† une date pr√©cise par r√©f√©rence √† cette transaction.</p>
</div>
<div class="paragraph data-line-237">
<p>L&#8217;utilisation de la cha√Æne de blocs de Bitcoin pour stocker les donn√©es non li√©es aux paiements en bitcoins sont un sujet controvers√©. De nombreux d√©veloppeurs consid√®rent cette utilisation abusive et veulent la d√©courager. D&#8217;autres y voient une d√©monstration des puissantes capacit√©s de la technologie cha√Æne de blocs et souhaitent encourager une telle exp√©rimentation. Ceux qui s&#8217;opposent √† l&#8217;inclusion de donn√©es de non-paiement soutiennent que cela provoque un "gonflement de la cha√Æne de blocs", ce qui impose √† ceux qui ex√©cutent des n≈ìuds Bitcoin complets de supporter le co√ªt du stockage sur disque pour les donn√©es que la cha√Æne de blocs n&#8217;√©tait pas destin√©e √† transporter. De plus, de telles transactions cr√©ent des UTXO qui ne peuvent pas √™tre d√©pens√©s, en utilisant l&#8217;adresse Bitcoin de destination comme un champ libre de 20 octets. Parce que l&#8217;adresse est utilis√©e pour les donn√©es, elle ne correspond pas √† une cl√© priv√©e et l&#8217;UTXO r√©sultant ne peut <em>jamais</em> √™tre d√©pens√©¬†; c&#8217;est un faux paiement. Ces transactions qui ne peuvent jamais √™tre d√©pens√©es ne sont donc jamais supprim√©es de l&#8217;ensemble UTXO et entra√Ænent une augmentation permanente de la taille de la base de donn√©es UTXO, ou un "gonflement".</p>
</div>
<div class="paragraph data-line-239">
<p>Dans la version 0.9 du client Bitcoin Core, un compromis a √©t√© trouv√© avec l&#8217;introduction de l&#8217;op√©rateur RETURN. <code>RETURN</code> permet aux d√©veloppeurs d&#8217;ajouter 80¬†octets de donn√©es de non-paiement √† une sortie de transaction. Cependant, contrairement √† l&#8217;utilisation de "faux" UTXO, l&#8217;op√©rateur <code>RETURN</code> cr√©e une sortie explicitement et <em>manifestement ind√©pensable</em>, qui n&#8217;a pas besoin d&#8217;√™tre stock√©e dans l&#8217;ensemble UTXO. Les sorties <code>RETURN</code> sont enregistr√©es sur la cha√Æne de blocs, elles consomment donc de l&#8217;espace disque et contribuent √† l&#8217;augmentation de la taille de la cha√Æne de blocs, mais elles ne sont pas stock√©es dans l&#8217;ensemble UTXO et ne gonflent donc pas le bassin de m√©moire UTXO et ne surchargent pas les n≈ìuds complets avec plus de d√©penses en RAM.</p>
</div>
<div class="paragraph data-line-241">
<p>Les scripts <code>RETURN</code> ressemblent √† ceci¬†:</p>
</div>
<div class="listingblock data-line-243">
<div class="content">
<pre>RETURN &lt;data&gt;</pre>
</div>
</div>
<div class="paragraph data-line-247">
<p>La portion de donn√©es est limit√©e √† 80 octets et repr√©sente le plus souvent un hachage, comme la sortie de l&#8217;algorithme SHA256 (32 octets). De nombreuses applications mettent un pr√©fixe devant les donn√©es pour aider √† identifier l&#8217;application. Par exemple, le service de notarisation num√©rique <a href="https://proofofexistence.com" data-href="https://proofofexistence.com">Preuve d&#8217;existence</a> utilise le pr√©fixe de 8 octets DOCPROOF, qui est encod√© en ASCII sous la forme <code>44 4f 43 50 52 4f 4f 46</code> en hexad√©cimal.</p>
</div>
<div class="paragraph data-line-249">
<p>Gardez √† l&#8217;esprit qu&#8217;il n&#8217;y a pas de "script de d√©verrouillage" correspondant √† <code>RETURN</code> qui pourrait √©ventuellement √™tre utilis√© pour "passer" une sortie RETURN. L&#8217;int√©r√™t de <code>RETURN</code> est que vous ne pouvez pas d√©penser l&#8217;argent bloqu√© dans cette sortie, et donc il n&#8217;a pas besoin d&#8217;√™tre conserv√© dans l&#8217;ensemble UTXO comme potentiellement d√©pensable - <code>RETURN</code> est <em>manifestement ind√©pensable</em>. <code>RETURN</code> est g√©n√©ralement une sortie avec un montant de z√©ro bitcoin, car tout bitcoin attribu√© √† une telle sortie est effectivement perdu √† jamais. Si un <code>RETURN</code> est r√©f√©renc√© comme entr√©e dans une transaction, le moteur de validation de script arr√™tera l&#8217;ex√©cution du script de validation et marquera la transaction comme invalide. L&#8217;ex√©cution de <code>RETURN</code> provoque essentiellement le script "RETURN" avec un <code>FALSE</code> et s&#8217;arr√™te. Ainsi, si vous r√©f√©rencez accidentellement une sortie <code>RETURN</code> comme entr√©e dans une transaction, cette transaction n&#8217;est pas valide.</p>
</div>
<div class="paragraph data-line-251">
<p>Une transaction standard (c&#8217;est-√†-dire conforme aux v√©rifications IsStandard()) ne peut avoir qu&#8217;une seule sortie RETURN. Cependant, une seule sortie <code>RETURN</code> peut √™tre combin√©e dans une transaction avec des sorties de tout autre type.</p>
</div>
<div class="paragraph data-line-253">
<p>Deux nouvelles options de ligne de commande ont √©t√© ajout√©es dans Bitcoin Core √† partir de la version 0.10. L&#8217;option <code>datacarrier</code> contr√¥le le relais et l&#8217;exploration des transactions RETURN, avec la valeur par d√©faut d√©finie √† "1" pour les autoriser. L&#8217;option <code>datacarriersize</code> prend un argument num√©rique sp√©cifiant la taille maximale en octets du script RETURN, 83 octets par d√©faut, ce qui permet un maximum de 80 octets de donn√©es <code>RETURN</code> plus un octet d&#8217;opcode <code>RETURN</code> et deux octets de Opcode PUSHDATA.</p>
</div>
<div class="admonitionblock note data-line-256">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-257">
<p>RETURN a √©t√© initialement propos√© avec une limite de 80 octets, mais la limite a √©t√© r√©duite √† 40 octets lorsque la fonctionnalit√© a √©t√© publi√©e. En f√©vrier 2015, dans la version 0.10 de Bitcoin Core, la limite a √©t√© relev√©e √† 80 octets. Les n≈ìuds peuvent choisir de ne pas relayer ou exploiter RETURN, ou uniquement de relayer et d&#8217;exploiter <code>RETURN</code> contenant moins de 80 octets de donn√©es.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 data-line-260">
<h3 id="_verrous_temporels">Verrous temporels</h3>
<div class="paragraph data-line-262">
<p>Les verrous temporels (ou timelocks) sont des restrictions sur les transactions ou les sorties qui ne permettent de d√©penser qu&#8217;apr√®s un certain temps. Bitcoin a eu une fonction de verrouillage du temps au niveau de la transaction depuis le d√©but. Il est impl√©ment√© par le champ <code>nLocktime</code> dans une transaction. Deux nouvelles fonctionnalit√©s de verrou temporel ont √©t√© introduites fin 2015 et mi-2016 qui offrent des verrous temporels de niveau UTXO. Ce sont <code>CHECKLOCKTIMEVERIFY</code> et CHECKSEQUENCEVERIFY.</p>
</div>
<div class="paragraph data-line-264">
<p>Les verrous temporels sont utiles pour postdater les transactions et verrouiller les fonds √† une date future. Plus important encore, les verrous temporels √©tendent les scripts bitcoin dans la dimension du temps, ouvrant la porte √† des contrats intelligents complexes en plusieurs √©tapes.</p>
</div>
<div class="sect3 data-line-267">
<h4 id="transaction_locktime_nlocktime">Temps de verrouillage des transactions (nLocktime)</h4>
<div class="paragraph data-line-269">
<p>Depuis le d√©but, Bitcoin a eu une fonction de timelock au niveau de la transaction. L&#8217;heure de verrouillage de la transaction est un param√®tre au niveau de la transaction (un champ dans la structure des donn√©es de la transaction) qui d√©finit la premi√®re heure √† laquelle une transaction est valide et peut √™tre relay√©e sur le r√©seau ou ajout√©e √† la cha√Æne de blocs. Le verrou temporel est √©galement connu sous le nom de <code>nLocktime</code> √† partir du nom de variable utilis√© dans la base de code Bitcoin Core. Il est d√©fini sur z√©ro dans la plupart des transactions pour indiquer une propagation et une ex√©cution imm√©diates. Si <code>nLocktime</code> est diff√©rent de z√©ro et inf√©rieur √† 500 millions, il est interpr√©t√© comme une hauteur de bloc, ce qui signifie que la transaction n&#8217;est pas valide et n&#8217;est pas relay√©e ou incluse dans la cha√Æne de blocs avant la hauteur de bloc sp√©cifi√©e. S&#8217;il est sup√©rieur ou √©gal √† 500 millions, il est interpr√©t√© comme un horodatage Unix Epoch (secondes depuis le 1er janvier 1970) et la transaction n&#8217;est pas valide avant l&#8217;heure sp√©cifi√©e. Les transactions avec <code>nLocktime</code> sp√©cifiant un bloc ou une heure future doivent √™tre conserv√©es par le syst√®me d&#8217;origine et transmises au r√©seau Bitcoin uniquement apr√®s leur validit√©. Si une transaction est transmise au r√©seau avant le <code>nLocktime</code> sp√©cifi√©, la transaction sera rejet√©e par le premier n≈ìud comme invalide et ne sera pas relay√©e vers les autres n≈ìuds. L&#8217;utilisation de <code>nLocktime</code> √©quivaut √† postdater un ch√®que papier.</p>
</div>
<div class="sect4 data-line-272">
<h5 id="locktime_limitations">Limitations du temps de verrouillage des transactions</h5>
<div class="paragraph data-line-274">
<p>nLocktime a la limitation que s&#8217;il permet de d√©penser certaines sorties dans le futur, il ne rend pas impossible de les d√©penser jusqu&#8217;√† ce moment-l√†. Expliquons cela avec l&#8217;exemple suivant.</p>
</div>
<div class="paragraph data-line-276">
<p>Alice signe une transaction en d√©pensant l&#8217;une de ses sorties √† l&#8217;adresse de Bob, et fixe la transaction <code>nLocktime</code> √† 3 mois dans le futur. Alice envoie cette transaction √† Bob pour la conserver. Avec cette transaction, Alice et Bob savent que¬†:</p>
</div>
<div class="ulist data-line-278">
<ul>
<li class="data-line-278">
<p>Bob ne peut pas transmettre la transaction pour racheter les fonds avant que 3 mois ne se soient √©coul√©s.</p>
</li>
<li class="data-line-279">
<p>Bob peut transmettre la transaction apr√®s 3 mois.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-281">
<p>Toutefois:</p>
</div>
<div class="ulist data-line-283">
<ul>
<li class="data-line-283">
<p>Alice peut cr√©er une autre transaction, en d√©pensant deux fois les m√™mes entr√©es sans temps de verrouillage. Ainsi, Alice peut passer le m√™me UTXO avant que les 3 mois ne se soient √©coul√©s.</p>
</li>
<li class="data-line-284">
<p>Bob n&#8217;a aucune garantie qu&#8217;Alice ne le fera pas.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-286">
<p>Il est important de comprendre les limites de la transaction nLocktime. La seule garantie est que Bob ne pourra pas l&#8217;√©changer avant que 3 mois ne se soient √©coul√©s. Il n&#8217;y a aucune garantie que Bob obtiendra les fonds. Pour obtenir une telle garantie, la restriction de verrouillage temporel doit √™tre plac√©e sur l&#8217;UTXO lui-m√™me et faire partie du script de verrouillage, plut√¥t que sur la transaction. Ceci est r√©alis√© par la forme suivante de timelock, appel√©e Check Lock Time Verify.</p>
</div>
</div>
</div>
<div class="sect3 data-line-288">
<h4 id="_v√©rifier_lheure_de_verrouillage_cltv">V√©rifier l&#8217;heure de verrouillage (CLTV)</h4>
<div class="paragraph data-line-290">
<p>En d√©cembre 2015, une nouvelle forme de verrou temporel a √©t√© introduite dans le bitcoin en tant qu&#8217;embranchement convergent (soft fork) am√©lior√©. Bas√© sur une sp√©cification dans BIP-65, le nouvel op√©rateur de script appel√© <em>CHECKLOCKTIMEVERIFY</em> (<em>CLTV</em>) a √©t√© ajout√© au langage de script. <code>CLTV</code> et est un verrou temporel par sortie, plut√¥t qu&#8217;un verrou temporel par transaction comme c&#8217;est le cas avec nLocktime. Cela permet une plus grande flexibilit√© dans la mani√®re dont les verrous temporels sont appliqu√©s.</p>
</div>
<div class="paragraph data-line-292">
<p>En termes simples, en ajoutant l&#8217;opcode <code>CLTV</code> dans le script de rachat d&#8217;une sortie, cela restreint la sortie, de sorte qu&#8217;elle ne peut √™tre d√©pens√©e qu&#8217;une fois le temps sp√©cifi√© √©coul√©.</p>
</div>
<div class="admonitionblock tip data-line-295">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-296">
<p>Alors que <code>nLocktime</code> est un timelock au niveau de la transaction, <code>CLTV</code> est un timelock bas√© sur la sortie.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-299">
<p>CLTV ne remplace pas nLocktime, mais restreint plut√¥t des UTXO sp√©cifiques de sorte qu&#8217;ils ne peuvent √™tre d√©pens√©s que dans une future transaction avec <code>nLocktime</code> d√©fini sur une valeur sup√©rieure ou √©gale.</p>
</div>
<div class="paragraph data-line-301">
<p>L&#8217;opcode <code>CLTV</code> prend un param√®tre en entr√©e, exprim√© sous la forme d&#8217;un nombre au m√™me format que <code>nLocktime</code> (soit une hauteur de bloc, soit un temps d&#8217;√©poque Unix). Comme indiqu√© par le suffixe VERIFY, <code>CLTV</code> est le type d&#8217;opcode qui arr√™te l&#8217;ex√©cution du script si le r√©sultat est FALSE. Si le r√©sultat est TRUE, l&#8217;ex√©cution continue.</p>
</div>
<div class="paragraph data-line-303">
<p>Pour verrouiller une sortie avec CLTV, vous l&#8217;ins√©rez dans le script de rachat de la sortie dans la transaction qui cr√©e la sortie. Par exemple, si Alice paie l&#8217;adresse de Bob, la sortie contiendra normalement un script P2PKH comme celui-ci¬†:</p>
</div>
<div class="listingblock data-line-305">
<div class="content">
<pre>DUP HASH160 &lt;Hachage cl√© publique de Bob&gt; EQUALVERIFY CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-309">
<p>Pour le verrouiller √† un moment, disons dans 3 mois, la transaction serait une transaction P2SH avec un script de rachat comme celui-ci¬†:</p>
</div>
<div class="listingblock data-line-311">
<div class="content">
<pre>&lt;now + 3 months&gt; CHECKLOCKTIMEVERIFY DROP DUP HASH160&lt;Bob's Public Key Hash&gt; EQUALVERIFIER CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-315">
<p>o√π <code>&lt;now &#43; 3 months&gt;</code> est une hauteur de bloc ou une valeur temporelle estim√©e √† 3¬†mois √† partir du moment o√π la transaction est extraite¬†: hauteur de bloc actuelle &#43; 12¬†960 (blocs) ou heure d&#8217;√©poque Unix actuelle &#43; 7¬†760¬†000 (secondes). Pour l&#8217;instant, ne vous inqui√©tez pas de l&#8217;opcode <code>DROP</code> qui suit CHECKLOCKTIMEVERIFY¬†; cela sera expliqu√© sous peu.</p>
</div>
<div class="paragraph data-line-317">
<p>Lorsque Bob essaie de d√©penser cet UTXO, il construit une transaction qui fait r√©f√©rence √† l&#8217;UTXO comme entr√©e. Il utilise sa signature et sa cl√© publique dans le script de d√©verrouillage de cette entr√©e et d√©finit la transaction <code>nLocktime</code> pour qu&#8217;elle soit √©gale ou sup√©rieure au verrouillage temporel dans l&#8217;ensemble <code>CHECKLOCKTIMEVERIFY</code> Alice. Bob diffuse ensuite la transaction sur le r√©seau Bitcoin.</p>
</div>
<div class="paragraph data-line-319">
<p>La transaction de Bob est √©valu√©e comme suit. Si le param√®tre <code>CHECKLOCKTIMEVERIFY</code> d√©fini par Alice est inf√©rieur ou √©gal au <code>nLocktime</code> de la transaction d√©pensi√®re, l&#8217;ex√©cution du script continue (agit comme si un opcode "no operation" ou NOP √©tait ex√©cut√©). Sinon, l&#8217;ex√©cution du script s&#8217;arr√™te et la transaction est consid√©r√©e comme invalide.</p>
</div>
<div class="paragraph data-line-321">
<p>Plus pr√©cis√©ment, <code>CHECKLOCKTIMEVERIFY</code> √©choue et arr√™te l&#8217;ex√©cution, marquant la transaction invalide si (source¬†: BIP-65)¬†:</p>
</div>
<div class="olist arabic data-line-323">
<ol class="arabic">
<li class="data-line-323">
<p>la pile est vide ; ou</p>
</li>
<li class="data-line-324">
<p>l&#8217;√©l√©ment du haut de la pile est inf√©rieur √† 0¬†; ou</p>
</li>
<li class="data-line-325">
<p>le type de verrou temporel (hauteur versus horodatage) de l&#8217;√©l√©ment de la pile sup√©rieure et le champ <code>nLocktime</code> ne sont pas les m√™mes¬†; ou</p>
</li>
<li class="data-line-326">
<p>l&#8217;√©l√©ment sup√©rieur de la pile est sup√©rieur au champ <code>nLocktime</code> de la transaction¬†; ou</p>
</li>
<li class="data-line-327">
<p>le champ <code>nSequence</code> de l&#8217;entr√©e est 0xffffffff.</p>
</li>
</ol>
</div>
<div class="admonitionblock note data-line-330">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-331">
<p>CLTV et <code>nLocktime</code> utilisent le m√™me format pour d√©crire les verrous temporels, soit une hauteur de bloc, soit le temps √©coul√© en secondes depuis l&#8217;√©poque Unix. De mani√®re critique, lorsqu&#8217;ils sont utilis√©s ensemble, le format de <code>nLocktime</code> doit correspondre √† celui de <code>CLTV</code> dans les sorties - ils doivent tous deux r√©f√©rencer soit la hauteur de bloc, soit le temps en secondes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-334">
<p>Apr√®s l&#8217;ex√©cution, si <code>CLTV</code> est satisfait, le param√®tre de temps qui l&#8217;a pr√©c√©d√© reste l&#8217;√©l√©ment sup√©rieur de la pile et peut devoir √™tre supprim√©, avec DROP, pour une ex√©cution correcte des opcodes de script suivants. Vous verrez souvent <code>CHECKLOCKTIMEVERIFY</code> suivi de <code>DROP</code> dans les scripts pour cette raison.</p>
</div>
<div class="paragraph data-line-336">
<p>En utilisant <code>nLocktime</code> conjointement avec CLTV, le sc√©nario d√©crit dans <a href="#locktime_limitations">Limitations du temps de verrouillage des transactions</a> changements. Alice ne peut plus d√©penser l&#8217;argent (car il est verrouill√© avec la cl√© de Bob) et Bob ne peut pas le d√©penser avant l&#8217;expiration du temps de verrouillage de 3 mois.</p>
</div>
<div class="paragraph data-line-338">
<p>En introduisant la fonctionnalit√© timelock directement dans le langage de script, <code>CLTV</code> nous permet de d√©velopper des scripts complexes tr√®s int√©ressants.</p>
</div>
<div class="paragraph data-line-340">
<p>La norme est d√©finie dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP-65 (CHECKLOCKTIMEVERIFY)</a>.</p>
</div>
</div>
<div class="sect3 data-line-342">
<h4 id="_verrous_temporels_relatifs">Verrous temporels relatifs</h4>
<div class="paragraph data-line-344">
<p>nLocktime et <code>CLTV</code> sont les deux <em>verrous temporels absolus</em> en ce sens qu&#8217;ils sp√©cifient un point absolu dans le temps. Les deux prochaines fonctionnalit√©s de verrou temporel que nous examinerons sont des <em>verrous temporels relatifs</em> en ce sens qu&#8217;elles sp√©cifient, comme condition de d√©pense d&#8217;une sortie, un temps √©coul√© depuis la confirmation de la sortie dans la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-346">
<p>Les verrous temporels relatifs sont utiles car ils permettent de bloquer une cha√Æne de deux transactions interd√©pendantes ou plus, tout en imposant une contrainte de temps sur une transaction qui d√©pend du temps √©coul√© depuis la confirmation d&#8217;une transaction pr√©c√©dente. En d&#8217;autres termes, l&#8217;horloge ne commence pas √† compter tant que l&#8217;UTXO n&#8217;est pas enregistr√© sur la cha√Æne de blocs. Cette fonctionnalit√© est particuli√®rement utile dans les canaux d&#8217;√©tat bidirectionnels et les r√©seaux Lightning, comme nous le verrons dans <a href="#state_channels">Canaux de paiement et canaux d&#8217;√©tat</a>.</p>
</div>
<div class="paragraph data-line-348">
<p>Les verrous temporels relatifs, comme les verrous temporels absolus, sont impl√©ment√©s √† la fois avec une fonctionnalit√© au niveau de la transaction et un opcode au niveau du script. Le verrouillage temporel relatif au niveau de la transaction est impl√©ment√© comme une r√®gle de consensus sur la valeur de nSequence, un champ de transaction qui est d√©fini dans chaque entr√©e de transaction. Les verrous temporels relatifs au niveau du script sont impl√©ment√©s avec l&#8217;opcode <code>CHECKSEQUENCEVERIFY</code> (CSV).</p>
</div>
<div class="paragraph data-line-350">
<p>Les verrous temporels relatifs sont impl√©ment√©s conform√©ment aux sp√©cifications de <a href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki">BIP-68, Relative lock-time using consensus-enforced sequence numbers</a> et <a href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki">BIP-112, CHECKSEQUENCEVERIFY</a>.</p>
</div>
<div class="paragraph data-line-352">
<p>BIP-68 et BIP-112 ont √©t√© activ√©s en mai 2016 en tant que mise √† niveau soft fork des r√®gles de consensus.</p>
</div>
</div>
<div class="sect3 data-line-354">
<h4 id="_verrous_temporels_relatifs_avec_nsequence">Verrous temporels relatifs avec nSequence</h4>
<div class="paragraph data-line-356">
<p>Des verrous temporels relatifs peuvent √™tre d√©finis sur chaque entr√©e d&#8217;une transaction, en d√©finissant le champ <code>nSequence</code> dans chaque contribution.</p>
</div>
<div class="sect4 data-line-358">
<h5 id="_signification_originale_de_nsequence">Signification originale de nSequence</h5>
<div class="paragraph data-line-360">
<p>Le champ <code>nSequence</code> √©tait √† l&#8217;origine destin√© (mais jamais correctement impl√©ment√©) √† permettre la modification des transactions dans le mempool. Dans cette utilisation, une transaction contenant des entr√©es avec une valeur <code>nSequence</code> inf√©rieure √† 2<sup>32</sup> - 1 (0xFFFFFFFF) indiquait une transaction qui n&#8217;√©tait pas encore "finalis√©e". Une telle transaction serait conserv√©e dans le mempool jusqu&#8217;√† ce qu&#8217;elle soit remplac√©e par une autre transaction d√©pensant les m√™mes entr√©es avec une valeur <code>nSequence</code> plus √©lev√©e. Une fois qu&#8217;une transaction a √©t√© re√ßue dont les entr√©es avaient une valeur <code>nSequence</code> de 0xFFFFFFFF, elle serait consid√©r√©e comme "finalis√©e" et min√©e.</p>
</div>
<div class="paragraph data-line-362">
<p>La signification originale de <code>nSequence</code> n&#8217;a jamais √©t√© correctement impl√©ment√©e et la valeur de <code>nSequence</code> est habituellement d√©finie sur 0xFFFFFFFF dans les transactions qui n&#8217;utilisent pas de verrous temporels. Pour les transactions avec <code>nLocktime</code> ou CHECKLOCKTIMEVERIFY, la valeur <code>nSequence</code> doit √™tre inf√©rieure √† 2<sup>31</sup> pour que les gardes de verrou temporel aient un effet, comme expliqu√© ci-dessous.</p>
</div>
</div>
<div class="sect4 data-line-364">
<h5 id="_nsequence_comme_un_verrou_temporel_relatif_impos√©_par_consensus">nSequence comme un verrou temporel relatif impos√© par consensus</h5>
<div class="paragraph data-line-366">
<p>Depuis l&#8217;activation de BIP-68, de nouvelles r√®gles de consensus s&#8217;appliquent pour toute transaction contenant une entr√©e dont la valeur <code>nSequence</code> est inf√©rieure √† 2<sup>31</sup> (le bit 1&lt;&lt;31 n&#8217;est pas d√©fini). Par programmation, cela signifie que si le bit le plus significatif (bit 1&lt;&lt;31) n&#8217;est pas d√©fini, c&#8217;est un indicateur qui signifie "temps de verrouillage relatif". Sinon (bit 1&lt;&lt;31 d√©fini), la valeur <code>nSequence</code> est r√©serv√©e √† d&#8217;autres utilisations telles que l&#8217;activation de CHECKLOCKTIMEVERIFY, nLocktime, Opt-In-Replace-By-Fee et d&#8217;autres d√©veloppements futurs.</p>
</div>
<div class="paragraph data-line-368">
<p>Les entr√©es de transaction avec des valeurs <code>nSequence</code> inf√©rieures √† 2<sup>31</sup> sont interpr√©t√©es comme ayant un verrou temporel relatif. Une telle transaction n&#8217;est valide qu&#8217;une fois que l&#8217;entr√©e a vieilli du montant relatif du verrou temporel. Par exemple, une transaction avec une entr√©e et un verrou temporel relatif <code>nSequence</code> de 30 blocs n&#8217;est valide que lorsqu&#8217;au moins 30 blocs se sont √©coul√©s depuis le moment o√π l&#8217;UTXO r√©f√©renc√© dans l&#8217;entr√©e a √©t√© extrait. √âtant donn√© que <code>nSequence</code> est un champ par entr√©e, une transaction peut contenir n&#8217;importe quel nombre d&#8217;entr√©es verrouill√©es dans le temps, qui doivent toutes avoir suffisamment vieilli pour que la transaction soit valide. Une transaction peut inclure √† la fois des entr√©es √† verrouillage temporel (nSequence &lt; 2<sup>31</sup>) et des entr√©es sans verrouillage temporel relatif (nSequence &gt;= 2<sup>31</sup>).</p>
</div>
<div class="paragraph data-line-370">
<p>La valeur <code>nSequence</code> est sp√©cifi√©e en blocs ou en secondes, mais dans un format l√©g√®rement diff√©rent de celui que nous avons vu utilis√© dans nLocktime. Un indicateur de type est utilis√© pour diff√©rencier les valeurs comptant les blocs et les valeurs comptant le temps en secondes. Le drapeau de type est d√©fini dans le 23e bit le moins significatif (c&#8217;est-√†-dire la valeur 1&lt;&lt;22). Si le type-flag est d√©fini, alors la valeur <code>nSequence</code> est interpr√©t√©e comme un multiple de 512 secondes. Si le drapeau de type n&#8217;est pas d√©fini, la valeur <code>nSequence</code> est interpr√©t√©e comme un nombre de blocs.</p>
</div>
<div class="paragraph data-line-372">
<p>Lors de l&#8217;interpr√©tation de <code>nSequence</code> comme un timelock relatif, seuls les 16 bits les moins significatifs sont pris en compte. Une fois que les drapeaux (bits 32 et 23) sont √©valu√©s, la valeur <code>nSequence</code> est g√©n√©ralement "masqu√©e" avec un masque de 16 bits (par exemple, <code>nSequence</code> &amp; 0x0000FFFF).</p>
</div>
<div class="paragraph data-line-374">
<p><a href="#bip_68_def_of_nseq">D√©finition BIP-68 du codage nSequence (Source¬†: BIP-68)</a> montre la disposition binaire de la valeur nSequence, telle que d√©finie par BIP-68.</p>
</div>
<div id="bip_68_def_of_nseq" class="imageblock data-line-378">
<div class="content">
<img src="images/mbc2_0701.png" alt="D√©finition BIP-68 du codage nSequence">
</div>
<div class="title">Figure 45. D√©finition BIP-68 du codage nSequence (Source¬†: BIP-68)</div>
</div>
<div class="paragraph data-line-381">
<p>Les verrous temporels relatifs bas√©s sur l&#8217;application consensuelle de la valeur <code>nSequence</code> sont d√©finis dans BIP-68.</p>
</div>
<div class="paragraph data-line-383">
<p>La norme est d√©finie dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki">BIP-68, Relative lock-time using consensus-enforced sequence numbers</a>.</p>
</div>
</div>
</div>
<div class="sect3 data-line-385">
<h4 id="_verrous_temporels_relatifs_avec_csv">Verrous temporels relatifs avec CSV</h4>
<div class="paragraph data-line-387">
<p>Tout comme CLTV et nLocktime, il existe un opcode de script pour les verrous temporels relatifs qui exploite le Valeur <code>nSequence</code> dans les scripts. Cet opcode est CHECKSEQUENCEVERIFY, commun√©ment appel√© <code>CSV</code> en abr√©g√©.</p>
</div>
<div class="paragraph data-line-389">
<p>L&#8217;opcode CSV, lorsqu&#8217;il est √©valu√© dans le script de remboursement d&#8217;un UTXO, permet de d√©penser uniquement dans une transaction dont la valeur d&#8217;entr√©e <code>nSequence</code> est sup√©rieure ou √©gale au param√®tre CSV. Essentiellement, cela limite la d√©pense de l&#8217;UTXO jusqu&#8217;√† ce qu&#8217;un certain nombre de blocs ou de secondes se soient √©coul√©s par rapport au moment o√π l&#8217;UTXO a √©t√© min√©.</p>
</div>
<div class="paragraph data-line-391">
<p>Comme pour CLTV, la valeur dans <code>CSV</code> doit correspondre au format de la valeur <code>nSequence</code> correspondante. Si <code>CSV</code> est sp√©cifi√© en termes de blocs, il doit en √™tre de m√™me pour nSequence. Si <code>CSV</code> est sp√©cifi√© en termes de secondes, alors <code>nSequence</code> doit √©galement l&#8217;√™tre.</p>
</div>
<div class="paragraph data-line-393">
<p>Les timelocks relatifs avec <code>CSV</code> sont particuli√®rement utiles lorsque plusieurs transactions (cha√Æn√©es) sont cr√©√©es et sign√©es, mais non propag√©es, lorsqu&#8217;elles sont conserv√©es "hors cha√Æne". Une transaction enfant ne peut pas √™tre utilis√©e tant que la transaction parent n&#8217;a pas √©t√© propag√©e, extraite et vieillie au moment sp√©cifi√© dans le timelock relatif. Une application de ce cas d&#8217;utilisation peut √™tre vue dans <a href="#state_channels">Canaux de paiement et canaux d&#8217;√©tat</a> et <a href="#lightning_network">Canaux de paiement rout√©s (Lightning Network)</a>.</p>
</div>
<div class="paragraph data-line-395">
<p>CSV est d√©fini en d√©tail dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki">BIP-112, CHECKSEQUENCEVERIFY</a>.</p>
</div>
</div>
<div class="sect3 data-line-398">
<h4 id="_temps_m√©dian_pass√©">Temps m√©dian pass√©</h4>
<div class="paragraph data-line-400">
<p>Dans le cadre de l&#8217;activation des verrous temporels relatifs, il y a √©galement eu un changement dans la fa√ßon dont le "temps" est calcul√© pour les verrous temporels (√† la fois absolus et relatifs). Dans le bitcoin, il existe une diff√©rence subtile, mais tr√®s significative, entre le temps du mur et le temps du consensus. Bitcoin est un r√©seau d√©centralis√©, ce qui signifie que chaque participant a sa propre vision du temps. Les √©v√©nements sur le r√©seau ne se produisent pas instantan√©ment partout. La latence du r√©seau doit √™tre prise en compte dans la perspective de chaque n≈ìud. Finalement, tout est synchronis√© pour cr√©er un grand livre commun. Bitcoin atteint un consensus toutes les 10 minutes sur l&#8217;√©tat du grand livre tel qu&#8217;il existait dans le pass√©.</p>
</div>
<div class="paragraph data-line-402">
<p>Les horodatages d√©finis dans les en-t√™tes de bloc sont d√©finis par les mineurs. Il existe un certain degr√© de latitude autoris√© par les r√®gles de consensus pour tenir compte des diff√©rences de pr√©cision d&#8217;horloge entre les n≈ìuds d√©centralis√©s. Cependant, cela cr√©e une incitation malheureuse pour les mineurs √† mentir sur le temps pass√© dans un bloc afin de gagner des frais suppl√©mentaires en incluant des transactions verrouill√©es dans le temps qui ne sont pas encore matures. Voir la section suivante pour plus d&#8217;informations.</p>
</div>
<div class="paragraph data-line-404">
<p>Pour supprimer l&#8217;incitation au mensonge et renforcer la s√©curit√© des verrous temporels, un BIP a √©t√© propos√© et activ√© en m√™me temps que les BIP des verrous temporels relatifs. Il s&#8217;agit de BIP-113, qui d√©finit une nouvelle mesure consensuelle du temps appel√©e <em>Median-Time-Past</em> (temps-m√©dian-pass√©).</p>
</div>
<div class="paragraph data-line-406">
<p>Le Median-Time-Past est calcul√© en prenant les horodatages des 11 derniers blocs et en trouvant la m√©diane. Ce temps m√©dian devient alors le temps de consensus et est utilis√© pour tous les calculs de verrou temporel. En prenant le point m√©dian d&#8217;environ deux heures dans le pass√©, l&#8217;influence de l&#8217;horodatage de n&#8217;importe quel bloc est r√©duite. En incorporant 11 blocs, aucun mineur ne peut influencer les horodatages afin de gagner des frais sur les transactions avec un verrou temporel qui n&#8217;est pas encore arriv√© √† √©ch√©ance.</p>
</div>
<div class="paragraph data-line-408">
<p>Median-Time-Past modifie l&#8217;impl√©mentation des calculs de temps pour nLocktime, CLTV, <code>nSequence</code> et CSV. L&#8217;heure de consensus calcul√©e par Median-Time-Past est toujours d&#8217;environ une heure en retard sur l&#8217;heure de l&#8217;horloge murale. Si vous cr√©ez des transactions avec verrou temporel, vous devez en tenir compte lors de l&#8217;estimation de la valeur souhait√©e √† encoder dans nLocktime, nSequence, <code>CLTV</code> et CSV.</p>
</div>
<div class="paragraph data-line-410">
<p>Median-Time-Past est sp√©cifi√© dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki">BIP-113</a>.</p>
</div>
</div>
<div class="sect3 data-line-413">
<h4 id="fee_sniping">D√©fense contre le "sniping" avec un verrou temporel</h4>
<div class="paragraph data-line-415">
<p>Le "sniping" ou le "ciblage" est un sc√©nario d&#8217;attaque th√©orique, o√π les mineurs tentant de r√©√©crire des blocs pass√©s "snipe" ou "en ciblant" des frais plus √©lev√©s transactions des futurs blocs pour maximiser leur rentabilit√©.</p>
</div>
<div class="paragraph data-line-417">
<p>Par exemple, disons que le bloc le plus √©lev√© existant est le bloc #100 000. Si au lieu d&#8217;essayer d&#8217;exploiter le bloc #100 001 pour √©tendre la cha√Æne, certains mineurs tentent de r√©exploiter #100 000. Ces mineurs peuvent choisir d&#8217;inclure toute transaction valide (qui n&#8217;a pas encore √©t√© exploit√©e) dans leur bloc candidat #100 000. Ils n&#8217;ont pas √† reminer le bloc avec les m√™mes transactions. En fait, ils sont incit√©s √† s√©lectionner les transactions les plus rentables (frais les plus √©lev√©s par Ko) √† inclure dans leur bloc. Ils peuvent inclure toutes les transactions qui se trouvaient dans "l&#8217;ancien" bloc #100 000, ainsi que toutes les transactions du mempool actuel. Essentiellement, ils ont la possibilit√© d&#8217;extraire des transactions du "pr√©sent" vers le "pass√©" r√©√©crit lorsqu&#8217;ils recr√©ent le bloc #100 000.</p>
</div>
<div class="paragraph data-line-419">
<p>Aujourd&#8217;hui, cette attaque n&#8217;est pas tr√®s lucrative, car la r√©compense de bloc est bien sup√©rieure au total des frais par bloc. Mais √† un moment donn√© dans le futur, les frais de transaction repr√©senteront la majorit√© de la r√©compense mini√®re (ou m√™me l&#8217;int√©gralit√© de la r√©compense mini√®re). A ce moment-l√†, ce sc√©nario devient in√©vitable.</p>
</div>
<div class="paragraph data-line-421">
<p>Pour √©viter le "ciblage de frais", lorsque Bitcoin Core cr√©e des transactions, il utilise <code>nLocktime</code> pour les limiter au "bloc suivant", par d√©faut. Dans notre sc√©nario, Bitcoin Core d√©finirait <code>nLocktime</code> sur 100 001 sur toute transaction cr√©√©e. Dans des circonstances normales, ce <code>nLocktime</code> n&#8217;a aucun effet - les transactions ne peuvent √™tre incluses que dans le bloc #100 001 de toute fa√ßon¬†; c&#8217;est le bloc suivant.</p>
</div>
<div class="paragraph data-line-423">
<p>Mais dans le cadre d&#8217;une attaque enfourchement de la cha√Æne de blocs/double d√©pense, les mineurs ne seraient pas en mesure d&#8217;extraire des transactions √† frais √©lev√©s du mempool, car toutes ces transactions seraient bloqu√©es dans le temps pour bloquer #100 001. Ils ne peuvent reminer que #100 000 avec les transactions valides √† ce moment-l√†, ne gagnant essentiellement aucun nouveau frais.</p>
</div>
<div class="paragraph data-line-425">
<p>Pour ce faire, Bitcoin Core d√©finit le <code>nLocktime</code> sur toutes les nouvelles transactions √† &lt;current block # + 1&gt; et d√©finit la <code>nSequence</code> sur toutes les entr√©es √† 0xFFFFFFFE pour activer nLocktime.</p>
</div>
</div>
</div>
<div class="sect2 data-line-427">
<h3 id="_scripts_avec_contr√¥le_de_flux_clauses_conditionnelles">Scripts avec contr√¥le de flux (clauses conditionnelles)</h3>
<div class="paragraph data-line-429">
<p>L&#8217;une des fonctionnalit√©s les plus puissantes de Bitcoin Script est le contr√¥le de flux, √©galement connu sous le nom de clauses conditionnelles. Vous √™tes probablement familiaris√© avec le contr√¥le de flux dans divers langages de programmation qui utilisent la construction IF...THEN...ELSE. Les clauses conditionnelles Bitcoin semblent un peu diff√©rentes, mais sont essentiellement la m√™me construction.</p>
</div>
<div class="paragraph data-line-431">
<p>√Ä un niveau de base, les opcodes conditionnels bitcoin nous permettent de construire un script de rachat qui a deux fa√ßons d&#8217;√™tre d√©verrouill√©, en fonction d&#8217;un r√©sultat TRUE/FALSE d&#8217;√©valuation d&#8217;une condition logique. Par exemple, si x est TRUE, le script de rachat est A et le script de rachat ELSE est B.</p>
</div>
<div class="paragraph data-line-433">
<p>De plus, les expressions conditionnelles Bitcoin peuvent √™tre "imbriqu√©es" ind√©finiment, ce qui signifie qu&#8217;une clause conditionnelle peut en contenir une autre, qui en contient une autre, etc. Le contr√¥le de flux Bitcoin Script peut √™tre utilis√© pour construire des scripts tr√®s complexes avec des centaines voire des milliers de chemins d&#8217;ex√©cution possibles. Il n&#8217;y a pas de limite √† l&#8217;imbrication, mais les r√®gles de consensus imposent une limite √† la taille maximale, en octets, d&#8217;un script.</p>
</div>
<div class="paragraph data-line-435">
<p>Bitcoin impl√©mente le contr√¥le de flux √† l&#8217;aide des opcodes IF, ELSE, <code>ENDIF</code> et NOTIF. De plus, les expressions conditionnelles peuvent contenir des op√©rateurs bool√©ens tels que BOOLAND, <code>BOOLOR</code> et NOT.</p>
</div>
<div class="paragraph data-line-437">
<p>√Ä premi√®re vue, vous pouvez trouver les scripts de contr√¥le de flux du bitcoin d√©routants. En effet, Bitcoin Script est un langage de pile. De la m√™me mani√®re que <code>1 &#43; 1</code> semble "renvers√©" lorsqu&#8217;il est exprim√© comme 1 1 ADD, les clauses de contr√¥le de flux dans bitcoin semblent √©galement "renvers√©s".</p>
</div>
<div class="paragraph data-line-439">
<p>Dans la plupart des langages de programmation traditionnels (proc√©duraux), le contr√¥le de flux ressemble √† ceci¬†:</p>
</div>
<div class="listingblock data-line-442">
<div class="title">Pseudocode de contr√¥le de flux dans la plupart des langages de programmation</div>
<div class="content">
<pre>si (condition):
  code √† ex√©cuter lorsque la condition est vraie
autre:
  code √† ex√©cuter lorsque la condition est fausse
code √† ex√©cuter dans les deux cas</pre>
</div>
</div>
<div class="paragraph data-line-450">
<p>Dans un langage bas√© sur la pile comme Bitcoin Script, la condition logique vient avant le IF, ce qui le fait appara√Ætre "en arri√®re", comme ceci¬†:</p>
</div>
<div class="listingblock data-line-453">
<div class="title">Contr√¥le de flux Bitcoin Script</div>
<div class="content">
<pre>condition
IF
  code √† ex√©cuter lorsque la condition est vraie
ELSE
  code √† ex√©cuter lorsque la condition est fausse
ENDIF
code √† ex√©cuter dans les deux cas</pre>
</div>
</div>
<div class="paragraph data-line-463">
<p>Lors de la lecture du script Bitcoin, rappelez-vous que la condition √©valu√©e vient <em>avant</em> l&#8217;opcode IF.</p>
</div>
<div class="sect3 data-line-465">
<h4 id="_clauses_conditionnelles_avec_les_opcodes_verify">Clauses conditionnelles avec les opcodes VERIFY</h4>
<div class="paragraph data-line-467">
<p>Une autre forme de conditionnel dans Bitcoin Script est tout opcode qui se termine par VERIFY. Le suffixe <code>VERIFY</code> signifie que si la condition √©valu√©e n&#8217;est pas TRUE, l&#8217;ex√©cution du script se termine imm√©diatement et la transaction est consid√©r√©e comme invalide.</p>
</div>
<div class="paragraph data-line-469">
<p>Contrairement √† une clause IF, qui offre des chemins d&#8217;ex√©cution alternatifs, le suffixe <code>VERIFY</code> agit comme une <em>clause de garde</em>, ne continuant que si une condition pr√©alable est remplie.</p>
</div>
<div class="paragraph data-line-471">
<p>Par exemple, le script suivant n√©cessite la signature de Bob et une pr√©-image (secret) qui produit un hachage sp√©cifique. Les deux conditions doivent √™tre remplies pour le d√©verrouiller :</p>
</div>
<div class="listingblock data-line-474">
<div class="title">Un script de rachat avec une clause de garde EQUALVERIFY.</div>
<div class="content">
<pre>HASH160 &lt;expected hash&gt; EQUALVERIFY &lt;Bob's Pubkey&gt; CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-478">
<p>Pour racheter cela, Bob doit construire un script de d√©verrouillage qui pr√©sente une pr√©-image valide et une signature¬†:</p>
</div>
<div class="listingblock data-line-481">
<div class="title">Un script de d√©verrouillage pour satisfaire le script de rachat ci-dessus</div>
<div class="content">
<pre>&lt;Bob's Sig&gt; &lt;hash pre-image&gt;</pre>
</div>
</div>
<div class="paragraph data-line-485">
<p>Sans pr√©senter la pr√©-image, Bob ne peut pas acc√©der √† la partie du script qui v√©rifie sa signature.</p>
</div>
<div class="paragraph pagebreak-after data-line-488">
<p>Ce script peut √™tre √©crit avec un <code>IF</code> √† la place¬†:</p>
</div>
<div class="listingblock data-line-491">
<div class="title">Un script de rachat avec une clause de garde IF</div>
<div class="content">
<pre>HASH160 &lt;expected hash&gt; EQUAL
IF
   &lt;Bob's Pubkey&gt; CHECKSIG
ENDIF</pre>
</div>
</div>
<div class="paragraph data-line-498">
<p>Le script de d√©verrouillage de Bob est identique¬†:</p>
</div>
<div class="listingblock data-line-501">
<div class="title">Un script de d√©verrouillage pour satisfaire le script de rachat ci-dessus</div>
<div class="content">
<pre>&lt;Bob's Sig&gt; &lt;hash pre-image&gt;</pre>
</div>
</div>
<div class="paragraph data-line-505">
<p>Le script avec <code>IF</code> fait la m√™me chose que d&#8217;utiliser un opcode avec un suffixe <code>VERIFY</code> ; elles fonctionnent toutes deux comme des clauses de garde. Cependant, la construction <code>VERIFY</code> est plus efficace, utilisant deux opcodes de moins.</p>
</div>
<div class="paragraph data-line-507">
<p>Alors, quand utilisons-nous <code>VERIFY</code> et quand utilisons-nous IF¬†? Si tout ce que nous essayons de faire est d&#8217;attacher une condition pr√©alable (clause de garde), alors <code>VERIFY</code> est pr√©f√©rable. Si, toutefois, nous voulons avoir plus d&#8217;un chemin d&#8217;ex√©cution (contr√¥le de flux), nous avons besoin d&#8217;une clause de contr√¥le de flux IF...ELSE.</p>
</div>
<div class="admonitionblock tip data-line-510">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-511">
<p>Un opcode tel que <code>EQUAL</code> poussera le r√©sultat (TRUE/FALSE) sur la pile, le laissant l√† pour √©valuation par les opcodes suivants. En revanche, le suffixe de l&#8217;opcode <code>EQUALVERIFY</code> ne laisse rien sur la pile. Les opcodes qui se terminent par <code>VERIFY</code> ne laissent pas le r√©sultat sur la pile.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-514">
<h4 id="_utilisation_du_contr√¥le_de_flux_dans_les_scripts">Utilisation du contr√¥le de flux dans les scripts</h4>
<div class="paragraph data-line-516">
<p>Une utilisation tr√®s courante du contr√¥le de flux dans Bitcoin Script consiste √† construire un script de rachat qui offre plusieurs chemins d&#8217;ex√©cution, chacun une mani√®re diff√©rente de racheter l&#8217;UTXO.</p>
</div>
<div class="paragraph data-line-518">
<p>Regardons un exemple simple, o√π nous avons deux signataires, Alice et Bob, et l&#8217;un ou l&#8217;autre est en mesure de racheter. Avec multisig, cela serait exprim√© sous la forme d&#8217;un script multisig 1 sur 2. Pour des raisons de d√©monstration, nous ferons la m√™me chose avec une clause IF¬†:</p>
</div>
<div class="listingblock data-line-520">
<div class="content">
<pre>IF
 &lt;Alice's Pubkey&gt; CHECKSIG
ELSE
 &lt;Bob's Pubkey&gt; CHECKSIG
ENDIF</pre>
</div>
</div>
<div class="paragraph data-line-528">
<p>En regardant ce script de rachat, vous vous demandez peut-√™tre¬†: "O√π est la condition ? Il n&#8217;y a rien qui pr√©c√®de la clause <code>IF</code> !"</p>
</div>
<div class="paragraph data-line-530">
<p>La condition ne fait pas partie du script de rachat. Au lieu de cela, la condition sera propos√©e dans le script de d√©verrouillage, permettant √† Alice et Bob de "choisir" le chemin d&#8217;ex√©cution qu&#8217;ils souhaitent.</p>
</div>
<div class="paragraph data-line-532">
<p>Alice rach√®te cela avec le script de d√©verrouillage¬†:</p>
</div>
<div class="listingblock data-line-533">
<div class="content">
<pre>&lt;Alice's Sig&gt; 1</pre>
</div>
</div>
<div class="paragraph data-line-537">
<p>Le <code>1</code> √† la fin sert de condition (TRUE) qui fera que la clause <code>IF</code> ex√©cutera le premier chemin de rachat pour lequel Alice a une signature.</p>
</div>
<div class="paragraph data-line-539">
<p>Pour que Bob puisse racheter cela, il devrait choisir le deuxi√®me chemin d&#8217;ex√©cution en donnant une valeur <code>FALSE</code> √† la clause IF¬†:</p>
</div>
<div class="listingblock data-line-541">
<div class="content">
<pre>&lt;Bob's Sig&gt; 0</pre>
</div>
</div>
<div class="paragraph data-line-545">
<p>Le script de d√©verrouillage de Bob place un <code>0</code> sur la pile, ce qui oblige la clause <code>IF</code> √† ex√©cuter le deuxi√®me script (ELSE), qui n√©cessite la signature de Bob.</p>
</div>
<div class="paragraph data-line-547">
<p>Puisque les clauses <code>IF</code> peuvent √™tre imbriqu√©es, nous pouvons cr√©er un "labyrinthe" de chemins d&#8217;ex√©cution. Le script de d√©verrouillage peut fournir une "carte" s√©lectionnant le chemin d&#8217;ex√©cution r√©ellement ex√©cut√©¬†:</p>
</div>
<div class="listingblock data-line-549">
<div class="content">
<pre>IF
  script A
ELSE
  IF
    script B
  ELSE
    script C
  ENDIF
ENDIF</pre>
</div>
</div>
<div class="paragraph data-line-561">
<p>Dans ce sc√©nario, il existe trois chemins d&#8217;ex√©cution (script A, <code>script B</code> et script C). Le script de d√©verrouillage fournit un chemin sous la forme d&#8217;une s√©quence de valeurs <code>TRUE</code> ou FALSE. Pour s√©lectionner le chemin script B, par exemple, le script de d√©verrouillage doit se terminer par <code>1 0</code> (TRUE, FALSE). Ces valeurs seront pouss√©es sur la pile, de sorte que la deuxi√®me valeur (FALSE) se retrouve en haut de la pile. La clause <code>IF</code> externe extrait la valeur <code>FALSE</code> et ex√©cute la premi√®re clause ELSE. Ensuite, la valeur <code>TRUE</code> se d√©place vers le haut de la pile et est √©valu√©e par le <code>IF</code> interne (imbriqu√©), en s√©lectionnant le chemin d&#8217;ex√©cution B.</p>
</div>
<div class="paragraph data-line-563">
<p>En utilisant cette construction, nous pouvons cr√©er des scripts de rachat avec des dizaines ou des centaines de chemins d&#8217;ex√©cution, chacun offrant une mani√®re diff√©rente de racheter l&#8217;UTXO. Pour d√©penser, nous construisons un script de d√©verrouillage qui navigue dans le chemin d&#8217;ex√©cution en pla√ßant les valeurs <code>TRUE</code> et <code>FALSE</code> appropri√©es sur la pile √† chaque point de contr√¥le de flux.</p>
</div>
</div>
</div>
<div class="sect2 data-line-565">
<h3 id="_exemple_de_script_complexe">Exemple de script complexe</h3>
<div class="paragraph data-line-567">
<p>Dans cette section, nous combinons de nombreux concepts de ce chapitre en un seul exemple.</p>
</div>
<div class="paragraph data-line-569">
<p>Notre exemple utilise l&#8217;histoire de Mohammed, le propri√©taire d&#8217;une entreprise √† Duba√Ø qui exploite une entreprise d&#8217;import/export.</p>
</div>
<div class="paragraph data-line-571">
<p>Dans cet exemple, Mohammed souhaite construire un compte de capital d&#8217;entreprise avec des r√®gles flexibles. Le sch√©ma qu&#8217;il cr√©e n√©cessite diff√©rents niveaux d&#8217;autorisation en fonction des verrous temporels. Les participants au programme multisig sont Mohammed, ses deux partenaires Saeed et Zaira, et leur avocat Abdul. Les trois partenaires prennent des d√©cisions bas√©es sur une r√®gle de majorit√©, donc deux des trois doivent √™tre d&#8217;accord. Cependant, en cas de probl√®me avec leurs cl√©s, ils souhaitent que leur avocat puisse r√©cup√©rer les fonds avec l&#8217;une des trois signatures d&#8217;associ√©s. Enfin, si tous les associ√©s sont indisponibles ou inaptes pendant un certain temps, ils souhaitent que l&#8217;avocat puisse g√©rer directement le compte.</p>
</div>
<div class="paragraph data-line-573">
<p>Voici le script de rachat que Mohammed con√ßoit pour y parvenir (pr√©fixe de num√©ro de ligne en tant que XX)¬†:</p>
</div>
<div class="listingblock data-line-576">
<div class="title">Variable Multi-Signature avec verrou temporel</div>
<div class="content">
<pre>01  IF
02    IF
03      2
04    ELSE
05      &lt;30 days&gt; CHECKSEQUENCEVERIFY DROP
06      &lt;Abdul the Lawyer's Pubkey&gt; CHECKSIGVERIFY
07      1
08    ENDIF
09    &lt;Mohammed's Pubkey&gt; &lt;Saeed's Pubkey&gt; &lt;Zaira's Pubkey&gt; 3 CHECKMULTISIG
10  ELSE
11    &lt;90 days&gt; CHECKSEQUENCEVERIFY DROP
12    &lt;Abdul the Lawyer's Pubkey&gt; CHECKSIG
13  ENDIF</pre>
</div>
</div>
<div class="paragraph data-line-592">
<p>Le script de Mohammed impl√©mente trois chemins d&#8217;ex√©cution √† l&#8217;aide de clauses de contr√¥le de flux imbriqu√©es IF...ELSE.</p>
</div>
<div class="paragraph data-line-594">
<p>Dans le premier chemin d&#8217;ex√©cution, ce script fonctionne comme un simple multisig 2 sur 3 avec les trois partenaires. Ce chemin d&#8217;ex√©cution se compose des lignes 3 et 9. La ligne 3 d√©finit le quorum du multisig √† <code>2</code> (2-de-3). Ce chemin d&#8217;ex√©cution peut √™tre s√©lectionn√© en mettant <code>TRUE TRUE</code> √† la fin du script de d√©verrouillage¬†:</p>
</div>
<div class="listingblock data-line-597">
<div class="title">Script de d√©verrouillage pour le premier chemin d&#8217;ex√©cution (2-de-3 multisig)</div>
<div class="content">
<pre>0 &lt;Mohammed's Sig&gt; &lt;Zaira's Sig&gt; TRUE TRUE</pre>
</div>
</div>
<div class="admonitionblock tip data-line-603">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-604">
<p>Le <code>0</code> au d√©but de ce script de d√©verrouillage est d√ª √† un bogue dans <code>CHECKMULTISIG</code> qui extrait une valeur suppl√©mentaire de la pile. La valeur suppl√©mentaire est ignor√©e par le CHECKMULTISIG, mais elle doit √™tre pr√©sente ou le script √©choue. Pousser <code>0</code> (habituellement) est une solution de contournement au bogue, comme d√©crit dans <a href="#multisig_bug">Un bogue dans l&#8217;ex√©cution de CHECKMULTISIG</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-607">
<p>Le deuxi√®me chemin d&#8217;ex√©cution ne peut √™tre utilis√© qu&#8217;apr√®s 30 jours √† compter de la cr√©ation de l&#8217;UTXO. √Ä ce moment-l√†, il faut la signature d&#8217;Abdul l&#8217;avocat et de l&#8217;un des trois partenaires (un multisig 1 sur 3). Ceci est r√©alis√© par la ligne 7, qui fixe le quorum pour le multisig √† 1. Pour s√©lectionner ce chemin d&#8217;ex√©cution, le script de d√©verrouillage se terminerait par FALSE TRUE¬†:</p>
</div>
<div class="listingblock data-line-610">
<div class="title">Script de d√©verrouillage pour le deuxi√®me chemin d&#8217;ex√©cution (Avocat + 1 sur 3)</div>
<div class="content">
<pre>0 &lt;Abdul the Lawyer's Sig&gt; &lt;Saeed's Sig&gt; FALSE TRUE</pre>
</div>
</div>
<div class="admonitionblock tip data-line-615">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-616">
<p>Pourquoi FAUX VRAI¬†? N&#8217;est-ce pas √† l&#8217;envers ? Parce que les deux valeurs sont pouss√©es sur la pile, avec <code>FALSE</code> pouss√© en premier, puis <code>TRUE</code> pouss√© en second. <code>TRUE</code> est donc d√©pil√© <em>premier</em> par le premier opcode IF.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-619">
<p>Enfin, la troisi√®me voie d&#8217;ex√©cution permet √† Abdul l&#8217;avocat de d√©penser les fonds seul, mais seulement apr√®s 90 jours. Pour s√©lectionner ce chemin d&#8217;ex√©cution, le script de d√©verrouillage doit se terminer par FALSE¬†:</p>
</div>
<div class="listingblock data-line-622">
<div class="title">Script de d√©verrouillage pour le troisi√®me chemin d&#8217;ex√©cution (avocat uniquement)</div>
<div class="content">
<pre>&lt;Abdul the Lawyer's Sig&gt; FALSE</pre>
</div>
</div>
<div class="paragraph data-line-626">
<p>Essayez d&#8217;ex√©cuter le script sur papier pour voir comment il se comporte sur la pile.</p>
</div>
<div class="paragraph data-line-628">
<p>Quelques √©l√©ments suppl√©mentaires √† prendre en compte lors de la lecture de cet exemple. Voyez si vous pouvez trouver les r√©ponses¬†:</p>
</div>
<div class="ulist data-line-630">
<ul>
<li class="data-line-630">
<p>Pourquoi l&#8217;avocat ne peut-il pas racheter le troisi√®me chemin d&#8217;ex√©cution √† tout moment en le s√©lectionnant avec <code>FALSE</code> sur le script de d√©verrouillage¬†?</p>
</li>
<li class="data-line-632">
<p>Combien de chemins d&#8217;ex√©cution peuvent √™tre utilis√©s 5, 35 et 105 jours, respectivement, apr√®s le minage de l&#8217;UTXO¬†?</p>
</li>
<li class="data-line-634">
<p>Les fonds sont-ils perdus si l&#8217;avocat perd sa cl√© ? Votre r√©ponse change-t-elle si 91 jours se sont √©coul√©s¬†?</p>
</li>
<li class="data-line-636">
<p>Comment les associ√©s ¬´ remettent-ils √† z√©ro ¬ª l&#8217;horloge tous les 29 ou 89 jours pour emp√™cher l&#8217;avocat d&#8217;acc√©der aux fonds ?</p>
</li>
<li class="data-line-638">
<p>Pourquoi certains opcodes <code>CHECKSIG</code> dans ce script ont-ils le suffixe <code>VERIFY</code> alors que d&#8217;autres non¬†?</p>
</li>
</ul>
</div>
</div>
<div class="sect2 data-line-641">
<h3 id="segwit">T√©moin s√©par√©</h3>
<div class="paragraph data-line-643">
<p>Le Segregated Witness (segwit) ou le "t√©moin s√©par√©" est une mise √† niveau des r√®gles de consensus bitcoin et du protocole r√©seau, propos√©e et mise en ≈ìuvre en tant que embranchement convergent BIP-9 qui a √©t√© activ√© sur le r√©seau principal de bitcoin le 1er ao√ªt 2017.</p>
</div>
<div class="paragraph data-line-645">
<p>En cryptographie, le terme ¬´¬†t√©moin¬†¬ª est utilis√© pour d√©crire une solution √† un puzzle cryptographique. En termes de bitcoin, le t√©moin satisfait une condition cryptographique plac√©e sur une sortie de transaction non d√©pens√©e (UTXO).</p>
</div>
<div class="paragraph data-line-647">
<p>Dans le contexte du bitcoin, une signature num√©rique est <em>un type de t√©moin</em>, mais un t√©moin est plus largement toute solution qui peut satisfaire les conditions impos√©es √† un UTXO et d√©bloquer cet UTXO pour les d√©penses. Le terme "t√©moin" est un terme plus g√©n√©ral pour un "script de d√©verrouillage" ou "scriptSig".</p>
</div>
<div class="paragraph data-line-649">
<p>Avant l&#8217;introduction de segwit, chaque entr√©e d&#8217;une transaction √©tait suivie des donn√©es t√©moins qui la d√©verrouillaient. Les donn√©es t√©moins ont √©t√© int√©gr√©es √† la transaction dans le cadre de chaque entr√©e. Le terme <em>t√©moin s√©par√©</em>, ou <em>segwit</em> en abr√©g√©, signifie simplement s√©parer la signature ou le script de d√©verrouillage d&#8217;une sortie sp√©cifique. Pensez "scriptSig s√©par√©" ou "signature s√©par√©e" dans sa forme la plus simple.</p>
</div>
<div class="paragraph data-line-651">
<p>Le t√©moin s√©par√© (Segregated Witness) est donc une modification architecturale du bitcoin qui vise √† d√©placer les donn√©es t√©moins du champ <code>scriptSig</code> (script de d√©verrouillage) d&#8217;une transaction vers une structure de donn√©es <em>t√©moin</em> distincte qui accompagne une transaction. Les clients peuvent demander des donn√©es de transaction avec ou sans les donn√©es de t√©moin qui les accompagnent.</p>
</div>
<div class="paragraph data-line-653">
<p>Dans cette section, nous examinerons certains des avantages du t√©moin s√©par√©, d√©crirons le m√©canisme utilis√© pour d√©ployer et mettre en ≈ìuvre ce changement d&#8217;architecture et d√©montrerons l&#8217;utilisation du t√©moin s√©par√© dans les transactions et les adresses.</p>
</div>
<div class="paragraph data-line-655">
<p>Le t√©moin s√©par√© est d√©fini par les BIP suivants¬†:</p>
</div>
<div class="dlist data-line-657">
<dl>
<dt class="hdlist1"><a href="https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki">BIP-141</a> </dt>
<dd>
<p>La principale d√©finition du t√©moin s√©par√©.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/bitcoin/bips/blob/master/bip-0143.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0143.mediawiki">BIP-143</a> </dt>
<dd>
<p>V√©rification de la signature des transactions pour le programme t√©moin de la version 0</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki">BIP-144</a> </dt>
<dd>
<p>Services √† pair; Nouveaux messages r√©seau et formats de s√©rialisation</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/bitcoin/bips/blob/master/bip-0145.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0145.mediawiki">BIP-145</a> </dt>
<dd>
<p>Mises √† jour de getblocktemplate pour le t√©moin s√©par√© Segregated Witness (pour minage)</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki">BIP-173</a> </dt>
<dd>
<p>Format d&#8217;adresse Base32 pour les sorties t√©moins natives v0-16</p>
</dd>
</dl>
</div>
<div class="sect3 data-line-668">
<h4 id="_pourquoi_un_t√©moin_s√©par√©">Pourquoi un t√©moin s√©par√©¬†?</h4>
<div class="paragraph data-line-670">
<p>Le t√©moin s√©par√© est un changement architectural qui a plusieurs effets sur l&#8217;√©volutivit√©, la s√©curit√©, les incitations √©conomiques et les performances du bitcoin¬†:</p>
</div>
<div class="dlist data-line-672">
<dl>
<dt class="hdlist1">Mall√©abilit√© de transaction </dt>
<dd>
<p>En d√©pla√ßant le t√©moin en dehors des donn√©es de transaction, le hachage de transaction utilis√© comme identifiant n&#8217;inclut plus les donn√©es de t√©moin. √âtant donn√© que les donn√©es t√©moins sont la seule partie de la transaction qui peut √™tre modifi√©e par un tiers (voir <a href="#segwit_txid">Identifiants de transaction</a>), sa suppression supprime √©galement la possibilit√© d&#8217;attaques de mall√©abilit√© des transactions. Avec le t√©moin s√©par√©, les hachages de transaction deviennent immuables par toute personne autre que le cr√©ateur de la transaction, ce qui am√©liore consid√©rablement la mise en ≈ìuvre de nombreux autres protocoles qui reposent sur la construction avanc√©e de transactions bitcoin, tels que les canaux de paiement, les transactions cha√Æn√©es et les r√©seaux Lightning.</p>
</dd>
<dt class="hdlist1">Gestion des versions de script </dt>
<dd>
<p>Avec l&#8217;introduction des scripts Segregated Witness (t√©moin s√©par√©), chaque script de verrouillage est pr√©c√©d√© d&#8217;un num√©ro de <em>version de script</em>, similaire √† la fa√ßon dont les transactions et les blocs ont des num√©ros de version. L&#8217;ajout d&#8217;un num√©ro de version de script permet au langage de script d&#8217;√™tre mis √† niveau de mani√®re r√©trocompatible (c&#8217;est-√†-dire en utilisant des mises √† niveau d&#8217;embranchement convergent) pour introduire de nouvelles op√©randes de script, syntaxe ou s√©mantique. La possibilit√© de mettre √† niveau le langage de script de mani√®re non perturbatrice acc√©l√©rera consid√©rablement le taux d&#8217;innovation dans le bitcoin.</p>
</dd>
<dt class="hdlist1">Mise √† l&#8217;√©chelle du r√©seau et du stockage </dt>
<dd>
<p>Les donn√©es t√©moins contribuent souvent de mani√®re importante √† la taille totale d&#8217;une transaction. Les scripts plus complexes tels que ceux utilis√©s pour les canaux multisig ou de paiement sont tr√®s volumineux. Dans certains cas, ces scripts repr√©sentent la majorit√© (plus de 75¬†%) des donn√©es d&#8217;une transaction. En d√©pla√ßant les donn√©es t√©moins en dehors des donn√©es de transaction, le t√©moin s√©par√© am√©liore l&#8217;√©volutivit√© de Bitcoin. Les n≈ìuds peuvent √©laguer les donn√©es t√©moins apr√®s avoir valid√© les signatures, ou les ignorer compl√®tement lors de la v√©rification simplifi√©e des paiements. Les donn√©es t√©moins n&#8217;ont pas besoin d&#8217;√™tre transmises √† tous les n≈ìuds et n&#8217;ont pas besoin d&#8217;√™tre stock√©es sur disque par tous les n≈ìuds.</p>
</dd>
<dt class="hdlist1">Optimisation de la v√©rification de signature </dt>
<dd>
<p>Le t√©moin s√©par√© met √† niveau les fonctions de signature (CHECKSIG, CHECKMULTISIG, etc.) pour r√©duire la complexit√© de calcul de l&#8217;algorithme. Avant segwit, l&#8217;algorithme utilis√© pour produire une signature n√©cessitait un nombre d&#8217;op√©rations de hachage proportionnel √† la taille de la transaction. Les calculs de hachage de donn√©es ont augment√© en O(n<sup>2</sup>) par rapport au nombre d&#8217;op√©rations de signature, introduisant une charge de calcul substantielle sur tous les n≈ìuds v√©rifiant la signature. Avec segwit, l&#8217;algorithme est modifi√© pour r√©duire la complexit√© √† O(n).</p>
</dd>
<dt class="hdlist1">Am√©lioration de la signature hors ligne </dt>
<dd>
<p>Les signatures des t√©moins s√©par√©s incorporent la valeur (montant) r√©f√©renc√©e par chaque entr√©e dans le hachage qui est sign√©. Auparavant, un dispositif de signature hors ligne, tel qu&#8217;un portefeuille mat√©riel, devait v√©rifier le montant de chaque entr√©e avant de signer une transaction. Cela √©tait g√©n√©ralement accompli en diffusant une grande quantit√© de donn√©es sur les transactions pr√©c√©dentes r√©f√©renc√©es en tant qu&#8217;entr√©es. √âtant donn√© que le montant fait d√©sormais partie du hachage d&#8217;engagement qui est sign√©, un appareil hors ligne n&#8217;a pas besoin des transactions pr√©c√©dentes. Si les montants ne correspondent pas (sont mal repr√©sent√©s par un syst√®me en ligne compromis), la signature sera invalide.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3 data-line-682">
<h4 id="_comment_fonctionne_le_t√©moignage_s√©par√©">Comment fonctionne le t√©moignage s√©par√©</h4>
<div class="paragraph data-line-684">
<p>√Ä premi√®re vue, le t√©moignage s√©par√© semble √™tre un changement dans la fa√ßon dont les transactions sont construites et donc une fonctionnalit√© au niveau de la transaction, mais ce n&#8217;est pas le cas. Au lieu de cela, le t√©moin s√©par√© est un changement dans la fa√ßon dont les UTXO individuels sont d√©pens√©s et est donc une fonctionnalit√© par sortie.</p>
</div>
<div class="paragraph data-line-686">
<p>Une transaction peut d√©penser des sorties de t√©moin s√©par√© ou des sorties traditionnelles (t√©moin en ligne) ou les deux. Par cons√©quent, cela n&#8217;a pas beaucoup de sens de se r√©f√©rer √† une transaction comme une "transaction de t√©moin s√©par√©". Nous devrions plut√¥t faire r√©f√©rence √† des sorties de transaction sp√©cifiques en tant que "sorties de t√©moins s√©par√©s".</p>
</div>
<div class="paragraph data-line-688">
<p>Lorsqu&#8217;une transaction passe un UTXO, elle doit fournir un t√©moin. Dans un UTXO traditionnel, le script de verrouillage n√©cessite que les donn√©es t√©moins soient fournies <em>en ligne</em> dans la partie d&#8217;entr√©e de la transaction qui d√©pense l&#8217;UTXO. Un UTXO de t√©moin s√©par√©, cependant, sp√©cifie un script de verrouillage qui peut √™tre satisfait avec des donn√©es de t√©moin en dehors de l&#8217;entr√©e (s√©par√©es).</p>
</div>
</div>
<div class="sect3 data-line-690">
<h4 id="_embranchement_convergent_r√©trocompatibilit√©">Embranchement convergent (r√©trocompatibilit√©)</h4>
<div class="paragraph data-line-692">
<p>Le t√©moin s√©par√© est un changement significatif dans la mani√®re dont les sorties et les transactions sont architectur√©es. Un tel changement n√©cessiterait normalement un changement simultan√© de chaque n≈ìud et portefeuille Bitcoin pour modifier les r√®gles de consensus, ce que l&#8217;on appelle une fourche dure. Au lieu de cela, un t√©moin s√©par√© est introduit avec un changement beaucoup moins perturbateur, qui est r√©trocompatible, connu sous le nom d&#8217;embranchement convergent. Ce type de mise √† niveau permet aux logiciels non mis √† niveau d&#8217;ignorer les modifications et de continuer √† fonctionner sans aucune interruption.</p>
</div>
<div class="paragraph data-line-694">
<p>Les sorties de t√©moins s√©par√©s sont construites de mani√®re √† ce que les syst√®mes plus anciens qui ne sont pas sensibles au segwit puissent toujours les valider. Pour un ancien portefeuille ou n≈ìud, une sortie de t√©moin s√©par√© ressemble √† une sortie que <em>n&#8217;importe qui peut d√©penser</em>. De telles sorties peuvent √™tre d√©pens√©es avec une signature vide, donc le fait qu&#8217;il n&#8217;y ait pas de signature √† l&#8217;int√©rieur de la transaction (elle est s√©par√©e) n&#8217;invalide pas la transaction. Cependant, les portefeuilles et les n≈ìuds de minage plus r√©cents voient la sortie du t√©moin s√©par√© et s&#8217;attendent √† trouver un t√©moin valide pour celle-ci dans les donn√©es de t√©moin de la transaction.</p>
</div>
</div>
<div class="sect3 data-line-696">
<h4 id="_exemples_de_t√©moins_s√©par√©s_et_exemples_de_transactions">Exemples de t√©moins s√©par√©s et exemples de transactions</h4>
<div class="paragraph data-line-698">
<p>Examinons quelques-uns de nos exemples de transactions et voyons comment ils changeraient avec le t√©moin s√©par√©. Nous verrons d&#8217;abord comment un paiement Pay-to-Public-Key-Hash (P2PKH) est transform√© avec le programme de t√©moignage s√©par√©. Ensuite, nous examinerons l&#8217;√©quivalent des t√©moins s√©par√©s pour les scripts Pay-to-Script-Hash (P2SH). Enfin, nous verrons comment les deux programmes de t√©moignage s√©par√© pr√©c√©dents peuvent √™tre int√©gr√©s dans un script P2SH.</p>
</div>
<div class="sect4 data-line-701">
<h5 id="p2wpkh">Pay-to-Witness-Public-Key-Hash (P2WPKH)</h5>
<div class="paragraph data-line-703">
<p>Dans <a href="#cup_of_coffee">Acheter une tasse de caf√©</a>, Alice a cr√©√© une transaction pour payer Bob pour une tasse de caf√©. Cette transaction a cr√©√© une sortie P2PKH d&#8217;une valeur de 0,015 BTC pouvant √™tre d√©pens√©e par Bob. Le script de sortie ressemble √† ceci¬†:</p>
</div>
<div class="listingblock data-line-706">
<div class="title">Exemple de script de sortie P2PKH</div>
<div class="content">
<pre>DUP HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 EQUALVERIFY CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-710">
<p>Avec le t√©moin s√©par√©, Alice cr√©erait un script Pay-to-Witness-Public-Key-Hash (P2WPKH), qui ressemble √† ceci¬†:</p>
</div>
<div class="listingblock data-line-713">
<div class="title">Exemple de script de sortie P2WPKH</div>
<div class="content">
<pre>0 ab68025513c3dbd2f7b92a94e0581f5d50f654e7</pre>
</div>
</div>
<div class="paragraph data-line-717">
<p>Comme vous pouvez le voir, le script de verrouillage d&#8217;une sortie de t√©moin s√©par√© est beaucoup plus simple qu&#8217;une sortie traditionnelle. Il se compose de deux valeurs qui sont transmises √† la pile d&#8217;√©valuation du script. Pour un ancien client Bitcoin (non conscient de la technologie), les deux pouss√©es ressembleraient √† une sortie que n&#8217;importe qui peut d√©penser et ne n√©cessite pas de signature (ou plut√¥t, peut √™tre d√©pens√©e avec une signature vide). Pour un client segwit plus r√©cent, le premier chiffre (0) est interpr√©t√© comme un num√©ro de version (la <em>version t√©moin</em>) et la seconde partie (20 octets) est l&#8217;√©quivalent d&#8217;un script de verrouillage connu sous le nom de <em>programme t√©moin</em>. Le programme t√©moin de 20 octets est simplement le hachage de la cl√© publique, comme dans un script P2PKH.</p>
</div>
<div class="paragraph data-line-719">
<p>Examinons maintenant la transaction correspondante que Bob utilise pour d√©penser cette sortie. Pour le script d&#8217;origine (nonsegwit), la transaction de Bob devrait inclure une signature dans l&#8217;entr√©e de transaction¬†:</p>
</div>
<div class="listingblock data-line-722">
<div class="title">Transaction d√©cod√©e montrant une sortie P2PKH d√©pens√©e avec une signature</div>
<div class="content">
<pre>[...]
‚ÄúVin‚Äù : [
"txid": "0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2",
"vout": 0,
     	 "scriptSig": ‚Äú&lt;Bob‚Äôs scriptSig&gt;‚Äù,
]
[...]</pre>
</div>
</div>
<div class="paragraph data-line-732">
<p>Cependant, pour passer la sortie du t√©moin s√©par√©, la transaction n&#8217;a pas de signature dans la partie d&#8217;entr√©e. Au lieu de cela, la transaction de Bob a un <code>scriptSig</code> vide dans les donn√©es de transaction (la premi√®re partie d&#8217;une transaction, qui inclut la partie d&#8217;entr√©e) et inclut sa signature dans les donn√©es t√©moins (la deuxi√®me partie d&#8217;une transaction, qui est s√©par√©e des donn√©es de transaction ):</p>
</div>
<div class="listingblock data-line-735">
<div class="title">Transaction d√©cod√©e montrant une sortie P2WPKH d√©pens√©e avec des donn√©es t√©moins s√©par√©es</div>
<div class="content">
<pre>[...]
‚ÄúVin‚Äù : [
"txid": "0627052b6f28912f2703066a912ea577f2ce4da4caa5a5fbd8a57286c345c2f2",
"vout": 0,
     	 "scriptSig": ‚Äú‚Äù,
]
[...]
‚Äúwitness‚Äù: ‚Äú&lt;Bob‚Äôs witness data&gt;‚Äù
[...]</pre>
</div>
</div>
</div>
<div class="sect4 data-line-747">
<h5 id="_construction_de_portefeuille_de_p2wpkh">Construction de portefeuille de P2WPKH</h5>
<div class="paragraph data-line-749">
<p>Il est extr√™mement important de noter que P2WPKH ne doit √™tre cr√©√© que par le b√©n√©ficiaire (destinataire) et non converti par l&#8217;exp√©diteur √† partir d&#8217;une cl√© publique connue, d&#8217;un script P2PKH ou d&#8217;une adresse. Le destinataire n&#8217;a aucun moyen de savoir si le portefeuille de l&#8217;exp√©diteur a la capacit√© de construire des transactions segwit et de d√©penser les sorties P2WPKH.</p>
</div>
<div class="paragraph data-line-751">
<p>De plus, les sorties P2WPKH doivent √™tre construites √† partir du hachage d&#8217;une cl√© publique <em>compress√©e</em>. Les cl√©s publiques non compress√©es ne sont pas standard dans segwit et peuvent √™tre explicitement d√©sactiv√©es par un futur embranchement convergent. Si le hachage utilis√© dans le P2WPKH provient d&#8217;une cl√© publique non compress√©e, il peut √™tre inutilisable et vous risquez de perdre des fonds. Les sorties P2WPKH doivent √™tre cr√©√©es par le portefeuille du b√©n√©ficiaire en d√©rivant une cl√© publique compress√©e √† partir de sa cl√© priv√©e.</p>
</div>
<div class="admonitionblock warning data-line-754">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-755">
<p>P2WPKH doit √™tre construit par le b√©n√©ficiaire (destinataire) en convertissant une cl√© publique compress√©e en un hachage P2WPKH. Vous ne devez jamais transformer un script P2PKH, une adresse Bitcoin ou une cl√© publique non compress√©e en un script t√©moin P2WPKH.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 data-line-759">
<h5 id="p2wsh">Pay-to-Witness-Script-Hash (P2WSH)</h5>
<div class="paragraph data-line-761">
<p>Le deuxi√®me type de programme t√©moin correspond √† un script Pay-to-Script-Hash (P2SH). Nous avons vu ce type de script dans <a href="#p2sh">Pay-to-Script-Hash (P2SH)</a>. Dans cet exemple, P2SH a √©t√© utilis√© par la soci√©t√© de Mohammed pour exprimer un script multisignature. Les paiements √† l&#8217;entreprise de Mohammed √©taient encod√©s avec un script de verrouillage comme celui-ci¬†:</p>
</div>
<div class="listingblock data-line-764">
<div class="title">Exemple de script de sortie P2SH</div>
<div class="content">
<pre>HASH160 54c557e07dde5bb6cb791c7a540e0a4796f5e97e EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-768">
<p>Ce script P2SH fait r√©f√©rence au hachage d&#8217;un <em>script d&#8217;√©change</em> qui d√©finit une exigence multisignature 2 sur 5 pour d√©penser des fonds. Pour d√©penser cette sortie, la soci√©t√© de Mohammed pr√©senterait le script de rachat (dont le hachage correspond au hachage du script dans la sortie P2SH) et les signatures n√©cessaires pour satisfaire ce script de rachat, le tout dans l&#8217;entr√©e de transaction¬†:</p>
</div>
<div class="listingblock data-line-771">
<div class="title">Transaction d√©cod√©e montrant qu&#8217;une sortie P2SH est d√©pens√©e</div>
<div class="content">
<pre>[...]
‚ÄúVin‚Äù : [
"txid": "abcdef12345...",
"vout": 0,
     	 "scriptSig": ‚Äú&lt;SigA&gt; &lt;SigB&gt; &lt;2 PubA PubB PubC PubD PubE 5 CHECKMULTISIG&gt;‚Äù,
]</pre>
</div>
</div>
<div class="paragraph data-line-780">
<p>Maintenant, regardons comment cet exemple entier serait mis √† niveau vers segwit. Si les clients de Mohammed utilisaient un portefeuille compatible segwit, ils effectueraient un paiement, cr√©ant une sortie Pay-to-Witness-Script-Hash (P2WSH) qui ressemblerait √† ceci¬†:</p>
</div>
<div class="listingblock data-line-783">
<div class="title">Exemple de script de sortie P2WSH</div>
<div class="content">
<pre>0 a9b7b38d972cabc7961dbfbcb841ad4508d133c47ba87457b4a0e8aae86dbb89</pre>
</div>
</div>
<div class="paragraph data-line-787">
<p>Encore une fois, comme dans l&#8217;exemple de P2WPKH, vous pouvez voir que le script √©quivalent Segregated Witness est beaucoup plus simple et omet les diff√©rents op√©randes de script que vous voyez dans les scripts P2SH. Au lieu de cela, le programme de t√©moignage s√©par√© se compose de deux valeurs pouss√©es vers la pile¬†: une version t√©moin (0) et le hachage SHA256 de 32 octets du script de rachat.</p>
</div>
<div class="paragraph data-line-789">
<p>La soci√©t√© de Mohammed peut d√©penser la sortie P2WSH en pr√©sentant le bon script de rachat et suffisamment de signatures pour le satisfaire. Le script de rachat et les signatures seraient s√©par√©s <em>en dehors</em> des donn√©es de transaction de d√©penses dans le cadre des donn√©es de t√©moin. Dans l&#8217;entr√©e de transaction, le portefeuille de Mohammed mettrait un <code>scriptSig</code> vide¬†:</p>
</div>
<div class="listingblock data-line-792">
<div class="title">Transaction d√©cod√©e montrant une sortie P2WSH d√©pens√©e avec des donn√©es t√©moins s√©par√©es</div>
<div class="content">
<pre>[...]
‚ÄúVin‚Äù : [
"txid": "abcdef12345...",
"vout": 0,
     	 "scriptSig": ‚Äú‚Äù,
]
[...]
‚Äúwitness‚Äù: ‚Äú&lt;SigA&gt; &lt;SigB&gt; &lt;2 PubA PubB PubC PubD PubE 5 CHECKMULTISIG&gt;‚Äù
[...]</pre>
</div>
</div>
<div class="admonitionblock tip data-line-805">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-806">
<p>Alors que P2SH utilise le hachage <code>RIPEMD160(SHA256(script))</code> de 20 octets, le programme t√©moin P2WSH utilise un hachage <code>SHA256(script)</code> de 32 octets. Cette diff√©rence dans le choix de l&#8217;algorithme de hachage est d√©lib√©r√©e et offre une s√©curit√© renforc√©e √† P2WSH (128 bits de s√©curit√© dans P2WSH contre 80 bits de s√©curit√© dans P2SH). Il est √©galement utilis√© pour diff√©rencier les deux types de programmes t√©moins (P2WPKH et P2WSH) en utilisant la longueur du hachage (voir ci-dessous).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 data-line-810">
<h5 id="_diff√©renciation_entre_p2wpkh_et_p2wsh">Diff√©renciation entre P2WPKH et P2WSH</h5>
<div class="paragraph data-line-812">
<p>Dans les deux sections pr√©c√©dentes, nous avons pr√©sent√© deux types de programmes de t√©moins¬†: <a href="#p2wpkh">Pay-to-Witness-Public-Key-Hash (P2WPKH)</a> et <a href="#p2wsh">Pay-to-Witness-Script-Hash (P2WSH)</a>. Les deux types de programmes t√©moins se composent d&#8217;un num√©ro de version √† un seul octet suivi d&#8217;un hachage plus long. Ils se ressemblent beaucoup, mais sont interpr√©t√©s tr√®s diff√©remment¬†: l&#8217;un est interpr√©t√© comme un hachage de cl√© publique, qui est satisfait par une signature et l&#8217;autre comme un hachage de script, qui est satisfait par un script de rachat. La diff√©rence critique entre eux est la longueur du hachage¬†:</p>
</div>
<div class="ulist data-line-814">
<ul>
<li class="data-line-814">
<p>Le hachage de cl√© publique dans P2WPKH est de 20 octets</p>
</li>
<li class="data-line-815">
<p>Le hachage du script dans P2WSH est de 32 octets</p>
</li>
</ul>
</div>
<div class="paragraph data-line-817">
<p>C&#8217;est la seule diff√©rence qui permet √† un portefeuille de diff√©rencier les deux types de programmes de t√©moins. En examinant la longueur du hachage, un portefeuille peut d√©terminer de quel type de programme t√©moin il s&#8217;agit, P2WPKH ou P2WSH.</p>
</div>
</div>
</div>
<div class="sect3 data-line-819">
<h4 id="_mise_√†_niveau_vers_un_t√©moin_s√©par√©">Mise √† niveau vers un t√©moin s√©par√©</h4>
<div class="paragraph data-line-821">
<p>Comme nous pouvons le voir dans les exemples pr√©c√©dents, la mise √† niveau vers les t√©moins s√©par√©s est un processus en deux √©tapes. Tout d&#8217;abord, les portefeuilles doivent cr√©er des sorties sp√©ciales de type segwit. Ensuite, ces sorties peuvent √™tre d√©pens√©es par des portefeuilles qui savent comment construire des transactions de t√©moin s√©par√©. Dans les exemples, le portefeuille d&#8217;Alice √©tait sensible au segwit et capable de cr√©er des sorties sp√©ciales avec des scripts de t√©moignage s√©par√©s. Le portefeuille de Bob est √©galement sensible au segwit et capable de d√©penser ces sorties. Ce qui n&#8217;est peut-√™tre pas √©vident √† partir de l&#8217;exemple, c&#8217;est qu&#8217;en pratique, le portefeuille d&#8217;Alice doit <em>savoir</em> que Bob utilise un portefeuille sensible au segwit et peut d√©penser ces sorties. Sinon, si le portefeuille de Bob n&#8217;est pas mis √† niveau et qu&#8217;Alice essaie d&#8217;effectuer des paiements en segwit √† Bob, le portefeuille de Bob ne pourra pas d√©tecter ces paiements.</p>
</div>
<div class="admonitionblock tip data-line-824">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-825">
<p>Pour les types de paiement P2WPKH et P2WSH, les portefeuilles de l&#8217;exp√©diteur et du destinataire doivent √™tre mis √† niveau pour pouvoir utiliser segwit. De plus, le portefeuille de l&#8217;exp√©diteur doit savoir que le portefeuille du destinataire est sensible au segwit.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-828">
<p>Le t√©moin s√©par√© ne sera pas mis en ≈ìuvre simultan√©ment sur l&#8217;ensemble du r√©seau. Au lieu de cela, Segregated Witness est impl√©ment√© comme une mise √† niveau r√©trocompatible, o√π <em>les anciens et les nouveaux clients peuvent coexister</em>. Les d√©veloppeurs de portefeuille mettront ind√©pendamment √† niveau le logiciel de portefeuille pour ajouter des fonctionnalit√©s segwit. Les types de paiement P2WPKH et P2WSH sont utilis√©s lorsque l&#8217;exp√©diteur et le destinataire sont conscients de segwit. Les P2PKH et P2SH traditionnels continueront de fonctionner pour les portefeuilles non mis √† niveau. Cela laisse deux sc√©narios importants, qui sont abord√©s dans la section suivante¬†:</p>
</div>
<div class="ulist data-line-830">
<ul>
<li class="data-line-830">
<p>Capacit√© du portefeuille d&#8217;un exp√©diteur qui n&#8217;est pas conscient de segwit √† effectuer un paiement sur le portefeuille d&#8217;un destinataire qui peut traiter des transactions segwit</p>
</li>
<li class="data-line-832">
<p>Capacit√© du portefeuille d&#8217;un exp√©diteur qui est conscient de segwit √† reconna√Ætre et √† distinguer les destinataires qui sont conscients de segwit et ceux qui ne le sont pas, par leurs <em>adresses</em>.</p>
</li>
</ul>
</div>
<div class="sect4 data-line-834">
<h5 id="_int√©gration_dun_t√©moin_s√©par√©_dans_p2sh">Int√©gration d&#8217;un t√©moin s√©par√© dans P2SH</h5>
<div class="paragraph data-line-836">
<p>Supposons, par exemple, que le portefeuille d&#8217;Alice n&#8217;est pas mis √† niveau vers segwit, mais que le portefeuille de Bob est mis √† niveau et peut g√©rer les transactions segwit. Alice et Bob peuvent utiliser les "anciennes" transactions non-segwit. Mais Bob voudrait probablement utiliser segwit pour r√©duire les frais de transaction, en profitant de la remise qui s&#8217;applique aux donn√©es des t√©moins.</p>
</div>
<div class="paragraph data-line-838">
<p>Dans ce cas, le portefeuille de Bob peut construire une adresse P2SH qui contient un script segwit √† l&#8217;int√©rieur. Le portefeuille d&#8217;Alice consid√®re cela comme une adresse P2SH "normale" et peut y effectuer des paiements sans aucune connaissance de segwit. Le portefeuille de Bob peut ensuite d√©penser ce paiement avec une transaction segwit, tirant pleinement parti de segwit et r√©duisant les frais de transaction.</p>
</div>
<div class="paragraph data-line-840">
<p>Les deux formes de scripts t√©moins, P2WPKH et P2WSH, peuvent √™tre int√©gr√©es dans une adresse P2SH. Le premier est not√© P2SH(P2WPKH) et le second est not√© P2SH(P2WSH).</p>
</div>
</div>
<div class="sect4 data-line-842">
<h5 id="_pay_to_witness_public_key_hash_dans_pay_to_script_hash">Pay-to-Witness-Public-Key-Hash dans Pay-to-Script-Hash</h5>
<div class="paragraph data-line-844">
<p>La premi√®re forme de script t√©moin que nous examinerons est P2SH(P2WPKH). Il s&#8217;agit d&#8217;un programme t√©moin Pay-to-Witness-Public-Key-Hash, int√©gr√© dans un script Pay-to-Script-Hash, afin qu&#8217;il puisse √™tre utilis√© par un portefeuille qui n&#8217;est pas conscient de segwit.</p>
</div>
<div class="paragraph data-line-846">
<p>Le portefeuille de Bob construit un programme t√©moin P2WPKH avec la cl√© publique de Bob. Ce programme t√©moin est ensuite hach√© et le hachage r√©sultant est encod√© sous la forme d&#8217;un script P2SH. Le script P2SH est converti en une adresse Bitcoin, celle qui commence par un "3", comme nous l&#8217;avons vu dans le <a href="#p2sh">Pay-to-Script-Hash (P2SH)</a> rubrique.</p>
</div>
<div class="paragraph data-line-848">
<p>Le portefeuille de Bob commence par le programme t√©moin P2WPKH que nous avons vu plus t√¥t¬†:</p>
</div>
<div class="listingblock data-line-851">
<div class="title">Programme de t√©moins P2WPKH de Bob</div>
<div class="content">
<pre>0 ab68025513c3dbd2f7b92a94e0581f5d50f654e7</pre>
</div>
</div>
<div class="paragraph data-line-855">
<p>Le programme t√©moin P2WPKH se compose de la version t√©moin et du hachage de cl√© publique de 20 octets de Bob.</p>
</div>
<div class="paragraph data-line-857">
<p>Le portefeuille de Bob hache ensuite le programme t√©moin pr√©c√©dent, d&#8217;abord avec SHA256, puis avec RIPEMD160, produisant un autre hachage de 20 octets.</p>
</div>
<div class="paragraph data-line-859">
<p>Utilisons <code>bx</code> sur la ligne de commande pour r√©pliquer cela¬†:</p>
</div>
<div class="listingblock data-line-862">
<div class="title">HASH160 du programme t√©moin P2WPKH</div>
<div class="content">
<pre>echo \
'0 [ab68025513c3dbd2f7b92a94e0581f5d50f654e7]'\
 | bx script-encode | bx sha256 | bx ripemd160
3e0547268b3b19288b3adef9719ec8659f4b2b0b</pre>
</div>
</div>
<div class="paragraph data-line-870">
<p>Ensuite, le hachage du script de rachat est converti en une adresse Bitcoin. Utilisons √† nouveau <code>bx</code> sur la ligne de commande¬†:</p>
</div>
<div class="listingblock data-line-873">
<div class="title">Adresse P2SH</div>
<div class="content">
<pre>echo \
'3e0547268b3b19288b3adef9719ec8659f4b2b0b' \
| bx address-encode -v 5
37Lx99uaGn5avKBxiW26HjedQE3LrDCZru</pre>
</div>
</div>
<div class="paragraph data-line-880">
<p>Maintenant, Bob peut afficher cette adresse pour que les clients paient leur caf√©. Le portefeuille d&#8217;Alice peut effectuer un paiement au 37Lx99uaGn5avKBxiW26HjedQE3LrDCZru, comme il le ferait avec n&#8217;importe quelle autre adresse Bitcoin.</p>
</div>
<div class="paragraph data-line-882">
<p>Pour payer Bob, le portefeuille d&#8217;Alice verrouillerait la sortie avec un script P2SH¬†:</p>
</div>
<div class="listingblock data-line-883">
<div class="content">
<pre>HASH160 3e0547268b3b19288b3adef9719ec8659f4b2b0b EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-887">
<p>M√™me si le portefeuille d&#8217;Alice ne prend pas en charge segwit, le paiement qu&#8217;il cr√©e peut √™tre d√©pens√© par Bob avec une transaction segwit.</p>
</div>
</div>
<div class="sect4 data-line-889">
<h5 id="_pay_to_witness_script_hash_dans_pay_to_script_hash">Pay-to-Witness-Script-Hash dans Pay-to-Script-Hash</h5>
<div class="paragraph data-line-891">
<p>De m√™me, un programme t√©moin P2WSH pour un script multisig ou un autre script compliqu√© peut √™tre int√©gr√© dans un script et une adresse P2SH, permettant √† n&#8217;importe quel portefeuille d&#8217;effectuer des paiements compatibles avec segwit.</p>
</div>
<div class="paragraph data-line-893">
<p>Comme nous l&#8217;avons vu dans <a href="#p2wsh">Pay-to-Witness-Script-Hash (P2WSH)</a>, la soci√©t√© de Mohammed  utilise des paiements de t√©moins s√©par√©s avec des scripts multisignatures. Pour permettre √† tout client de payer son entreprise, que ses portefeuilles soient ou non mis √† niveau pour segwit, le portefeuille de Mohammed peut int√©grer le programme t√©moin P2WSH dans un script P2SH.</p>
</div>
<div class="paragraph data-line-895">
<p>Tout d&#8217;abord, le portefeuille de Mohammed hache le script de rachat avec SHA256 (une seule fois). Utilisons <code>bx</code> pour faire cela sur la ligne de commande¬†:</p>
</div>
<div class="listingblock data-line-898">
<div class="title">Le portefeuille de Mohammed cr√©e un programme t√©moin P2WSH</div>
<div class="content">
<pre>echo \
2 \ [04C16B8698A9ABF84250A7C3EA7EEDEF9897D1C8C6ADF47F06CF73370D74DCCA01CDCA79DCC5C395D7EEC6984D83F1F50C900A24DD47F569FD4193AF5DE762C587] \
[04A2192968D8655D6A935BEAF2CA23E3FB87A3495E7AF308EDF08DAC3C1FCBFC2C75B4B0F4D0B1B70CD2423657738C0C2B1D5CE65C97D78D0E34224858008E8B49] \
[047E63248B75DB7379BE9CDA8CE5751D16485F431E46117B9D0C1837C9D5737812F393DA7D4420D7E1A9162F0279CFC10F1E8E8F3020DECDBC3C0DD389D9977965] \
[0421D65CBD7149B255382ED7F78E946580657EE6FDA162A187543A9D85BAAA93A4AB3A8F044DADA618D087227440645ABE8A35DA8C5B73997AD343BE5C2AFD94A5] \
[043752580AFA1ECED3C68D446BCAB69AC0BA7DF50D56231BE0AABF1FDEEC78A6A45E394BA29A1EDF518C022DD618DA774D207D137AAB59E0B000EB7ED238F4D800] \
5 CHECKMULTISIG \
| bx script-encode | bx sha256
9592d601848d04b172905e0ddb0adde59f1590f1e553ffc81ddc4b0ed927dd73</pre>
</div>
</div>
<div class="paragraph data-line-910">
<p>Ensuite, le script de rachat hach√© est transform√© en un programme t√©moin P2WSH¬†:</p>
</div>
<div class="listingblock data-line-912">
<div class="content">
<pre>0 9592d601848d04b172905e0ddb0adde59f1590f1e553ffc81ddc4b0ed927dd73</pre>
</div>
</div>
<div class="paragraph data-line-916">
<p>Ensuite, le programme t√©moin lui-m√™me est hach√© avec SHA256 et RIPEMD160, produisant un nouveau hachage de 20 octets, tel qu&#8217;utilis√© dans le P2SH traditionnel. Utilisons <code>bx</code> sur la ligne de commande pour faire cela¬†:</p>
</div>
<div class="listingblock data-line-919">
<div class="title">Le HASH160 du programme t√©moin P2WSH</div>
<div class="content">
<pre> echo \
'0 [9592d601848d04b172905e0ddb0adde59f1590f1e553ffc81ddc4b0ed927dd73]'\
 | bx script-encode | bx sha256 | bx ripemd160
86762607e8fe87c0c37740cddee880988b9455b2</pre>
</div>
</div>
<div class="paragraph data-line-926">
<p>Ensuite, le portefeuille construit une adresse Bitcoin P2SH √† partir de ce hachage. Encore une fois, nous utilisons <code>bx</code> pour calculer sur la ligne de commande¬†:</p>
</div>
<div class="listingblock data-line-929">
<div class="title">P2SH Adresse bitcoin</div>
<div class="content">
<pre>echo \
'86762607e8fe87c0c37740cddee880988b9455b2'\
 | bx address-encode -v 5
3Dwz1MXhM6EfFoJChHCxh1jWHb8GQqRenG</pre>
</div>
</div>
<div class="paragraph data-line-936">
<p>D√©sormais, les clients de Mohammed peuvent effectuer des paiements √† cette adresse sans avoir besoin de prendre en charge segwit. Pour envoyer un paiement √† Mohammed, un portefeuille verrouillerait la sortie avec le script P2SH suivant¬†:</p>
</div>
<div class="listingblock data-line-939">
<div class="title">Script P2SH utilis√© pour verrouiller les paiements sur le multisig de Mohammed</div>
<div class="content">
<pre>HASH160 86762607e8fe87c0c37740cddee880988b9455b2 EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-943">
<p>La soci√©t√© de Mohammed peut alors construire des transactions segwit pour d√©penser ces paiements, en tirant parti des fonctionnalit√©s segwit, notamment des frais de transaction moins √©lev√©s.</p>
</div>
</div>
<div class="sect4 data-line-945">
<h5 id="_adresses_de_t√©moins_s√©par√©s">Adresses de t√©moins s√©par√©s</h5>
<div class="paragraph data-line-947">
<p>M√™me apr√®s l&#8217;activation de segwit, il faudra un certain temps avant que la plupart des portefeuilles soient mis √† niveau. Dans un premier temps, segwit sera int√©gr√© √† P2SH, comme nous l&#8217;avons vu dans la section pr√©c√©dente, pour faciliter la compatibilit√© entre les portefeuilles prenant en charge et ignorants de segwit.</p>
</div>
<div class="paragraph data-line-949">
<p>Cependant, une fois que les portefeuilles prennent largement en charge segwit, il est logique d&#8217;encoder les scripts t√©moins directement dans un format d&#8217;adresse natif con√ßu pour segwit, plut√¥t que de l&#8217;int√©grer dans P2SH.</p>
</div>
<div class="paragraph data-line-951">
<p>Le format d&#8217;adresse segwit natif est d√©fini dans BIP-173¬†:</p>
</div>
<div class="dlist data-line-953">
<dl>
<dt class="hdlist1"><a href="https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki">BIP-173</a> </dt>
<dd>
<p>Format d&#8217;adresse Base32 pour les sorties t√©moins natives v0-16</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-955">
<p>BIP-173 encode uniquement les scripts t√©moins (P2WPKH et P2WSH). Il n&#8217;est pas compatible avec les scripts P2PKH ou P2SH non-segwit. BIP-173 est un encodage Base32 √† somme de contr√¥le, par rapport √† l&#8217;encodage Base58 d&#8217;une adresse Bitcoin "traditionnelle". Les adresses BIP-173 sont √©galement appel√©es adresses <em>bech32</em>, prononc√©es "beh-ch trente-deux", faisant allusion √† l&#8217;utilisation d&#8217;un algorithme de d√©tection d&#8217;erreur "BCH" et d&#8217;un ensemble de codage √† 32 caract√®res.</p>
</div>
<div class="paragraph data-line-957">
<p>Les adresses BIP-173 utilisent un jeu de 32 caract√®res alphanum√©riques en minuscules uniquement, soigneusement s√©lectionn√©s pour r√©duire les erreurs de lecture ou de frappe. En choisissant un jeu de caract√®res en minuscules uniquement, bech32 est plus facile √† lire, √† parler et 45¬†% plus efficace pour encoder dans les codes QR.</p>
</div>
<div class="paragraph data-line-959">
<p>L&#8217;algorithme de d√©tection d&#8217;erreurs BCH est une grande am√©lioration par rapport √† l&#8217;algorithme de somme de contr√¥le pr√©c√©dent (de Base58Check), permettant non seulement la d√©tection mais aussi la <em>correction</em> des erreurs. Les interfaces de saisie d&#8217;adresse (telles que les champs de texte dans les formulaires) peuvent d√©tecter et mettre en √©vidence le caract√®re le plus susceptible d&#8217;√™tre mal saisi lorsqu&#8217;elles d√©tectent une erreur.</p>
</div>
<div class="paragraph data-line-961">
<p>De la sp√©cification BIP-173, voici quelques exemples d&#8217;adresses bech32¬†:</p>
</div>
<div class="dlist data-line-963">
<dl>
<dt class="hdlist1">Mainnet P2WPKH</dt>
<dd>
<p>bc1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4</p>
</dd>
<dt class="hdlist1">Testnet P2WPKH</dt>
<dd>
<p>tb1qw508d6qejxtdg4y5r3zarvary0c5xw7kxpjzsx</p>
</dd>
<dt class="hdlist1">Mainnet P2WSH</dt>
<dd>
<p>bc1qrp33g0q5c5txsp9arysrx4k6zdkfs4nce4xj0gdcccefvpysxf3qccfmv3</p>
</dd>
<dt class="hdlist1">Testnet P2WSH</dt>
<dd>
<p>tb1qrp33g0q5c5txsp9arysrx4k6zdkfs4nce4xj0gdcccefvpysxf3q0sl5k7</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-968">
<p>Comme vous pouvez le voir dans ces exemples, une cha√Æne segwit bech32 contient jusqu&#8217;√† 90 caract√®res et se compose de trois parties¬†:</p>
</div>
<div class="dlist data-line-970">
<dl>
<dt class="hdlist1">La partie lisible par l&#8217;homme</dt>
<dd>
<p>Ce pr√©fixe "bc" ou "tb" identifiant mainnet ou testnet</p>
</dd>
<dt class="hdlist1">Le s√©parateur</dt>
<dd>
<p>Le chiffre "1", qui ne fait pas partie du jeu de codage √† 32 caract√®res et ne peut appara√Ætre qu&#8217;√† cette position en tant que s√©parateur</p>
</dd>
<dt class="hdlist1">La partie donn√©es</dt>
<dd>
<p>Un minimum de 6 caract√®res alphanum√©riques, le script t√©moin encod√© par somme de contr√¥le</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-976">
<p>√Ä l&#8217;heure actuelle, seuls quelques portefeuilles acceptent ou produisent des adresses segwit bech32 natives, mais √† mesure que l&#8217;adoption de segwit augmente, vous les verrez de plus en plus souvent.</p>
</div>
<div class="paragraph data-line-978">
<p><a href="#segwit_addresses">Bitcoin non-segwit (h√©rit√©) et adresses segwit</a> affiche les adresses bitcoin non-segwit (h√©rit√©es) et segwit.</p>
</div>
<table id="segwit_addresses" class="tableblock frame-all grid-all stretch data-line-982">
<caption class="title">Table 23. Bitcoin non-segwit (h√©rit√©) et adresses segwit</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encodage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pr√©fixe</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse P2PKH h√©rit√©e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base58</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ancienne adresse Testnet P2PKH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base58</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m ou n</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ancienne adresse P2SH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base58</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ancienne adresse Testnet P2SH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base58</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse Segwit P2SH(P2WPKH) imbriqu√©e (int√©gr√©e)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base58</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse Segwit P2SH(P2WSH) imbriqu√©e (int√©gr√©e)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base58</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse native Segwit P2WPKH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bech32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bc1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse native Segwit Testnet P2WPKH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bech32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tb1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse native Segwit P2WSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bech32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bc1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adresse native Segwit Testnet P2WSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bech32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tb1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4 data-line-997">
<h5 id="segwit_txid">Identifiants de transaction</h5>
<div class="paragraph data-line-999">
<p>L&#8217;un des plus grands avantages des t√©moin s√©par√©s est qu&#8217;il √©limine la mall√©abilit√© des transactions tierces.</p>
</div>
<div class="paragraph data-line-1001">
<p>Avant segwit, les transactions pouvaient voir leurs signatures subtilement modifi√©es par des tiers, changeant leur ID de transaction (hachage) sans changer aucune propri√©t√© fondamentale (entr√©es, sorties, montants). Cela a cr√©√© des opportunit√©s d&#8217;attaques par d√©ni de service ainsi que des attaques contre des logiciels de portefeuille mal √©crits qui supposaient que les hachages de transaction non confirm√©s √©taient immuables.</p>
</div>
<div class="paragraph data-line-1003">
<p>Avec l&#8217;introduction des t√©moins s√©par√©s, les transactions ont deux identifiants, <code>txid</code> et wtxid. L&#8217;identifiant de transaction traditionnel <code>txid</code> est le hachage double SHA256 de la transaction s√©rialis√©e, sans les donn√©es t√©moins. Une transaction <code>wtxid</code> est le hachage double SHA256 du nouveau format de s√©rialisation de la transaction avec des donn√©es t√©moins.</p>
</div>
<div class="paragraph data-line-1005">
<p>Le <code>txid</code> traditionnel est calcul√© exactement de la m√™me mani√®re qu&#8217;avec une transaction non segwit. Cependant, √©tant donn√© qu&#8217;une transaction segwit pure (une transaction qui ne contient que des entr√©es segwit) a des <code>scriptSig</code> vides dans chaque entr√©e, aucune partie de la transaction ne peut √™tre modifi√©e par un tiers. Par cons√©quent, dans une transaction segwit pure, le <code>txid</code> est immuable par un tiers, m√™me lorsque la transaction n&#8217;est pas confirm√©e.</p>
</div>
<div class="paragraph data-line-1007">
<p>Le <code>wtxid</code> est comme un identifiant "√©tendu", en ce que le hachage incorpore √©galement les donn√©es du t√©moin. Si une transaction est transmise sans donn√©es t√©moins, alors le <code>wtxid</code> et le <code>txid</code> sont identiques. Notez que puisque le <code>wtxid</code> inclut des donn√©es t√©moins (signatures) et que les donn√©es t√©moins peuvent √™tre mall√©ables, le <code>wtxid</code> doit √™tre consid√©r√© comme mall√©able jusqu&#8217;√† ce que la transaction soit confirm√©e. Seul le <code>txid</code> d&#8217;une pure transaction segwit peut √™tre consid√©r√© comme immuable par des tiers.</p>
</div>
<div class="admonitionblock tip data-line-1010">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-1011">
<p>Les transactions de t√©moin s√©par√© ont deux identifiants¬†: <code>txid</code> et wtxid. Le <code>txid</code> est le hachage de la transaction sans les donn√©es t√©moins et le <code>wtxid</code> est le hachage incluant les donn√©es t√©moins. Seules les transactions segwit pures (transactions qui ne contiennent que des entr√©es segwit) ont un <code>txid</code> qui n&#8217;est pas sensible √† la mall√©abilit√© des transactions tierces.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3 data-line-1014">
<h4 id="_nouvel_algorithme_de_signature_des_t√©moins_s√©par√©s">Nouvel algorithme de signature des t√©moins s√©par√©s</h4>
<div class="paragraph data-line-1016">
<p>Le t√©moin s√©par√© modifie la s√©mantique des quatre fonctions de v√©rification de signature (CHECKSIG, CHECKSIGVERIFY, <code>CHECKMULTISIG</code> et CHECKMULTISIGVERIFY), changeant la fa√ßon dont un hachage d&#8217;engagement de transaction est calcul√©.</p>
</div>
<div class="paragraph data-line-1018">
<p>Les signatures dans les transactions bitcoin sont appliqu√©es sur un <em>hachage d&#8217;engagement</em>, qui est calcul√© √† partir des donn√©es de transaction, verrouillant des parties sp√©cifiques des donn√©es indiquant l&#8217;engagement du signataire envers ces valeurs. Par exemple, dans une signature de type <code>SIGHASH_ALL</code> simple, le hachage d&#8217;engagement inclut toutes les entr√©es et sorties.</p>
</div>
<div class="paragraph data-line-1020">
<p>Malheureusement, la fa√ßon dont le hachage d&#8217;engagement a √©t√© calcul√© a introduit la possibilit√© qu&#8217;un n≈ìud v√©rifiant la signature puisse √™tre forc√© d&#8217;effectuer un nombre important de calculs de hachage. Plus pr√©cis√©ment, les op√©rations de hachage augmentent en O(n<sup>2</sup>) par rapport au nombre d&#8217;op√©rations de signature dans la transaction. Un attaquant pourrait donc cr√©er une transaction avec un tr√®s grand nombre d&#8217;op√©rations de signature, obligeant l&#8217;ensemble du r√©seau Bitcoin √† effectuer des centaines ou des milliers d&#8217;op√©rations de hachage pour v√©rifier la transaction.</p>
</div>
<div class="paragraph data-line-1022">
<p>Segwit repr√©sentait une opportunit√© de r√©soudre ce probl√®me en modifiant la fa√ßon dont le hachage d&#8217;engagement est calcul√©. Pour les programmes t√©moins segwit version 0, la v√©rification de la signature se produit √† l&#8217;aide d&#8217;un algorithme de hachage d&#8217;engagement am√©lior√©, comme sp√©cifi√© dans BIP-143.</p>
</div>
<div class="paragraph data-line-1024">
<p>Le nouvel algorithme atteint deux objectifs importants. Premi√®rement, le nombre d&#8217;op√©rations de hachage augmente d&#8217;un O(n) beaucoup plus graduel au nombre d&#8217;op√©rations de signature, r√©duisant la possibilit√© de cr√©er des attaques par d√©ni de service avec des transactions trop complexes. Deuxi√®mement, le hachage d&#8217;engagement inclut d√©sormais √©galement la valeur (montants) de chaque entr√©e dans le cadre de l&#8217;engagement. Cela signifie qu&#8217;un signataire peut s&#8217;engager sur une valeur d&#8217;entr√©e sp√©cifique sans avoir besoin de "r√©cup√©rer" et de v√©rifier la transaction pr√©c√©dente r√©f√©renc√©e par l&#8217;entr√©e. Dans le cas d&#8217;appareils hors ligne, tels que les portefeuilles mat√©riels, cela simplifie grandement la communication entre l&#8217;h√¥te et le portefeuille mat√©riel, supprimant la n√©cessit√© de diffuser les transactions pr√©c√©dentes pour validation. Un portefeuille mat√©riel peut accepter la valeur d&#8217;entr√©e "telle qu&#8217;elle est indiqu√©e" par un h√¥te non approuv√©. √âtant donn√© que la signature n&#8217;est pas valide si cette valeur d&#8217;entr√©e n&#8217;est pas correcte, le portefeuille mat√©riel n&#8217;a pas besoin de valider la valeur avant de signer l&#8217;entr√©e.</p>
</div>
</div>
<div class="sect3 data-line-1026">
<h4 id="_incitations_√©conomiques_pour_les_t√©moins_isol√©s">Incitations √©conomiques pour les t√©moins isol√©s</h4>
<div class="paragraph data-line-1028">
<p>Les n≈ìuds miniers Bitcoin et les n≈ìuds complets entra√Ænent des co√ªts pour les ressources utilis√©es pour prendre en charge le r√©seau Bitcoin et la cha√Æne de blocs. √Ä mesure que le volume de transactions bitcoin augmente, le co√ªt des ressources (CPU, bande passante r√©seau, espace disque, m√©moire) augmente √©galement. Les mineurs sont indemnis√©s pour ces co√ªts par des frais proportionnels √† la taille (en octets) de chaque transaction. Les n≈ìuds complets non miniers ne sont pas r√©mun√©r√©s, ils encourent donc ces co√ªts parce qu&#8217;ils ont besoin d&#8217;ex√©cuter un n≈ìud d&#8217;index complet faisant autorit√©, peut-√™tre parce qu&#8217;ils utilisent le n≈ìud pour exploiter une entreprise bitcoin.</p>
</div>
<div class="paragraph data-line-1030">
<p>Sans frais de transaction, la croissance des donn√©es bitcoin augmenterait sans doute de fa√ßon spectaculaire. Les frais sont destin√©s √† aligner les besoins des utilisateurs de bitcoins sur le fardeau que leurs transactions imposent au r√©seau, gr√¢ce √† un m√©canisme de d√©couverte des prix bas√© sur le march√©.</p>
</div>
<div class="paragraph data-line-1032">
<p>Le calcul des frais en fonction de la taille de la transaction traite toutes les donn√©es de la transaction comme ayant un co√ªt √©gal. Mais du point de vue des n≈ìuds complets et des mineurs, certaines parties d&#8217;une transaction entra√Ænent des co√ªts beaucoup plus √©lev√©s. Chaque transaction ajout√©e au r√©seau Bitcoin affecte la consommation de quatre ressources sur les n≈ìuds¬†:</p>
</div>
<div class="dlist data-line-1034">
<dl>
<dt class="hdlist1">Espace disque </dt>
<dd>
<p>Chaque transaction est stock√©e dans la cha√Æne de blocs, ajoutant √† la taille totale de la cha√Æne de blocs. La cha√Æne de blocs est stock√©e sur disque, mais le stockage peut √™tre optimis√© en ¬´ √©laguant ¬ª (supprimant) les anciennes transactions.</p>
</dd>
<dt class="hdlist1">CPU </dt>
<dd>
<p>Chaque transaction doit √™tre valid√©e, ce qui n√©cessite du temps CPU.</p>
</dd>
<dt class="hdlist1">Bande passante </dt>
<dd>
<p>Chaque transaction est transmise (par propagation d&#8217;inondation) sur le r√©seau au moins une fois. Sans aucune optimisation du protocole de propagation de bloc, les transactions sont √† nouveau transmises dans le cadre d&#8217;un bloc, ce qui double l&#8217;impact sur la capacit√© du r√©seau.</p>
</dd>
<dt class="hdlist1">M√©moire </dt>
<dd>
<p>Les n≈ìuds qui valident les transactions conservent l&#8217;index UTXO ou l&#8217;int√©gralit√© de l&#8217;ensemble UTXO en m√©moire pour acc√©l√©rer la validation. √âtant donn√© que la m√©moire est au moins un ordre de grandeur plus ch√®re que le disque, la croissance de l&#8217;ensemble UTXO contribue de mani√®re disproportionn√©e au co√ªt d&#8217;ex√©cution d&#8217;un n≈ìud.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-1042">
<p>Comme vous pouvez le voir dans la liste, toutes les parties d&#8217;une transaction n&#8217;ont pas le m√™me impact sur le co√ªt d&#8217;ex√©cution d&#8217;un n≈ìud ou sur la capacit√© du bitcoin √† √©voluer pour prendre en charge davantage de transactions. La partie la plus co√ªteuse d&#8217;une transaction sont les sorties nouvellement cr√©√©es, car elles sont ajout√©es √† l&#8217;ensemble UTXO en m√©moire. En comparaison, les signatures (c&#8217;est-√†-dire les donn√©es t√©moins) ajoutent le moins de charge au r√©seau et au co√ªt d&#8217;ex√©cution d&#8217;un n≈ìud, car les donn√©es t√©moins ne sont valid√©es qu&#8217;une seule fois et ne sont jamais r√©utilis√©es. De plus, imm√©diatement apr√®s avoir re√ßu une nouvelle transaction et valid√© les donn√©es t√©moins, les n≈ìuds peuvent supprimer ces donn√©es t√©moins. Si les frais sont calcul√©s en fonction de la taille de la transaction, sans faire de distinction entre ces deux types de donn√©es, les incitations du march√© en mati√®re de frais ne sont pas align√©es sur les co√ªts r√©els impos√©s par une transaction. En fait, la structure tarifaire actuelle encourage en fait le comportement inverse, car les donn√©es des t√©moins constituent la plus grande partie d&#8217;une transaction.</p>
</div>
<div class="paragraph data-line-1044">
<p>Les incitations cr√©√©es par les frais sont importantes car elles affectent le comportement des portefeuilles. Tous les portefeuilles doivent mettre en ≈ìuvre une strat√©gie pour assembler les transactions qui prend en consid√©ration un certain nombre de facteurs, tels que la confidentialit√© (r√©duction de la r√©utilisation des adresses), la fragmentation (faire beaucoup de monnaie) et les frais. Si les frais motivent massivement les portefeuilles √† utiliser le moins d&#8217;entr√©es possible dans les transactions, cela peut conduire √† la s√©lection d&#8217;UTXO et √† la modification des strat√©gies d&#8217;adresse qui gonflent par inadvertance l&#8217;ensemble UTXO.</p>
</div>
<div class="paragraph data-line-1046">
<p>Les transactions consomment les UTXO dans leurs entr√©es et cr√©ent de nouveaux UTXO avec leurs sorties. Par cons√©quent, une transaction qui a plus d&#8217;entr√©es que de sorties entra√Ænera une diminution de l&#8217;ensemble UTXO, tandis qu&#8217;une transaction qui a plus de sorties que d&#8217;entr√©es entra√Ænera une augmentation de l&#8217;ensemble UTXO. Consid√©rons la <em>difference</em> entre les entr√©es et les sorties et appelons cela le "Net-new-UTXO". Il s&#8217;agit d&#8217;une mesure importante, car elle nous indique l&#8217;impact qu&#8217;une transaction aura sur la ressource la plus ch√®re √† l&#8217;√©chelle du r√©seau, l&#8217;ensemble UTXO en m√©moire. Une transaction avec Net-new-UTXO positif ajoute √† ce fardeau. Une transaction avec un Net-new-UTXO n√©gatif r√©duit la charge. Nous voudrions donc encourager les transactions qui sont soit Net-new-UTXO n√©gatives, soit neutres avec z√©ro Net-new-UTXO.</p>
</div>
<div class="paragraph data-line-1048">
<p>Examinons un exemple des incitations cr√©√©es par le calcul des frais de transaction, avec et sans t√©moin s√©par√©. Nous examinerons deux transactions diff√©rentes. La transaction A est une transaction √† 3 entr√©es et 2 sorties, qui a une m√©trique Net-new-UTXO de -1, ce qui signifie qu&#8217;elle consomme un UTXO de plus qu&#8217;elle n&#8217;en cr√©e, ce qui r√©duit l&#8217;UTXO d√©fini d&#8217;un. La transaction B est une transaction √† 2 entr√©es et 3 sorties, qui a une m√©trique Net-new-UTXO de 1, ce qui signifie qu&#8217;elle ajoute un UTXO √† l&#8217;ensemble UTXO, imposant un co√ªt suppl√©mentaire √† l&#8217;ensemble du r√©seau Bitcoin. Les deux transactions utilisent des scripts multisignatures (2 sur 3) pour d√©montrer comment des scripts complexes augmentent l&#8217;impact d&#8217;un t√©moin s√©par√© sur les frais. Supposons un taux de transaction de 30¬†satoshi par octet et une remise de 75¬†% sur les donn√©es des t√©moins¬†:</p>
</div>
<dl>
<dt>Sans t√©moin s√©par√©</dt>
<dd>
<p>Frais de transaction A¬†: 28 590 satoshi</p>
<p>Frais de transaction B¬†: 20 760 satoshi</p>
</dd>

<dt>Avec t√©moin s√©par√©</dt>
<dd>
<p>Frais de transaction A¬†: 12 255 satoshi</p>
<p>Frais de transaction B¬†: 10 425 satoshi</p>
</dd>
</dl>
<div class="paragraph data-line-1067">
<p>Les deux transactions sont moins co√ªteuses lorsque le t√©moin s√©par√© est mis en ≈ìuvre. En comparant les co√ªts entre les deux transactions, nous voyons qu&#8217;avant le t√©moin s√©par√©, la transaction avec le Net-new-UTXO positif permet de r√©aliser d&#8217;importantes √©conomies. Avec le t√©moin s√©par√©, la diff√©rence de co√ªt diminue consid√©rablement en termes absolus et relatifs. Bien qu&#8217;il faudrait que les intrants deviennent moins chers que les extrants pour inciter √† la consolidation de l&#8217;ensemble UTXO, cette remise r√©duit l&#8217;incitation √† cr√©er de nouveaux UTXO afin d&#8217;√©viter d&#8217;utiliser plus d&#8217;intrants.</p>
</div>
<div class="paragraph data-line-21">
<p>Le t√©moin s√©par√© a donc deux effets principaux sur les frais pay√©s par les utilisateurs de bitcoin. Premi√®rement, segwit r√©duit le co√ªt global des transactions en actualisant les donn√©es des t√©moins et en augmentant la capacit√© de la cha√Æne de blocs Bitcoin. Deuxi√®mement, la remise de segwit sur les donn√©es des t√©moins att√©nue partiellement un d√©salignement des incitations qui peut avoir cr√©√© par inadvertance plus de ballonnement dans l&#8217;ensemble UTXO.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="bitcoin_network_ch08">Le r√©seau Bitcoin</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-4">
<h3 id="_architecture_du_r√©seau_pair_√†_pair">Architecture du r√©seau pair √† pair</h3>
<div class="paragraph data-line-6">
<p>Bitcoin est structur√© comme une architecture de r√©seau pair √† pair au-dessus de l&#8217;Internet. Le terme pair √† pair, ou P2P, signifie que les ordinateurs qui participent au r√©seau sont des pairs les uns des autres, qu&#8217;ils sont tous √©gaux, qu&#8217;il n&#8217;y a pas de n≈ìuds "sp√©ciaux" et que tous les n≈ìuds partagent la charge de fournir services r√©seau. Les n≈ìuds du r√©seau s&#8217;interconnectent dans un r√©seau maill√© avec une topologie "plate". Il n&#8217;y a pas de serveur, pas de service centralis√© et pas de hi√©rarchie au sein du r√©seau. Les n≈ìuds d&#8217;un r√©seau P2P fournissent et consomment des services en m√™me temps, la r√©ciprocit√© agissant comme une incitation √† la participation. Les r√©seaux P2P sont intrins√®quement r√©silients, d√©centralis√©s et ouverts. Un exemple pr√©√©minent d&#8217;une architecture de r√©seau P2P √©tait le d√©but d&#8217;Internet lui-m√™me, o√π les n≈ìuds du r√©seau IP √©taient √©gaux. L&#8217;architecture Internet d&#8217;aujourd&#8217;hui est plus hi√©rarchique, mais le protocole Internet conserve toujours son essence de topologie plate. Au-del√† du bitcoin, l&#8217;application la plus importante et la plus r√©ussie des technologies P2P est le partage de fichiers, avec Napster comme pionnier et BitTorrent comme l&#8217;√©volution la plus r√©cente de l&#8217;architecture.</p>
</div>
<div class="paragraph data-line-8">
<p>L&#8217;architecture du r√©seau P2P de Bitcoin est bien plus qu&#8217;un choix de topologie. Bitcoin est un syst√®me de paiement num√©rique P2P de par sa conception, et l&#8217;architecture du r√©seau est √† la fois le reflet et le fondement de cette caract√©ristique essentielle. La d√©centralisation du contr√¥le est un principe de conception de base qui ne peut √™tre atteint et maintenu que par un r√©seau consensuel P2P plat et d√©centralis√©.</p>
</div>
<div class="paragraph data-line-10">
<p>Le terme "r√©seau Bitcoin" fait r√©f√©rence √† l&#8217;ensemble de n≈ìuds ex√©cutant le protocole bitcoin P2P. En plus du protocole bitcoin P2P, il existe d&#8217;autres protocoles tels que Stratum qui sont utilis√©s pour le minage et les portefeuilles l√©gers ou mobiles. Ces protocoles suppl√©mentaires sont fournis par des serveurs de routage de passerelle qui acc√®dent au r√©seau Bitcoin √† l&#8217;aide du protocole bitcoin P2P, puis √©tendent ce r√©seau aux n≈ìuds ex√©cutant d&#8217;autres protocoles. Par exemple, les serveurs Stratum connectent les n≈ìuds de minage Stratum via le protocole Stratum au r√©seau Bitcoin principal et relient le protocole Stratum au protocole bitcoin P2P. Nous utilisons le terme ¬´¬†r√©seau Bitcoin √©tendu¬†¬ª pour d√©signer le r√©seau global qui comprend le protocole Bitcoin P2P, les protocoles de minage de groupe, le protocole Stratum et tout autre protocole connexe reliant les composants du syst√®me Bitcoin.</p>
</div>
</div>
<div class="sect2 data-line-12">
<h3 id="_types_de_n≈ìuds_et_r√¥les">Types de n≈ìuds et r√¥les</h3>
<div class="paragraph data-line-14">
<p>Bien que les n≈ìuds dans le bitcoin Les r√©seaux P2P sont √©gaux, ils peuvent jouer diff√©rents r√¥les en fonction de la fonctionnalit√© qu&#8217;ils prennent en charge. Un n≈ìud Bitcoin est un ensemble de fonctions¬†: le routage, la base de donn√©es cha√Æne de blocs, le minage et les services de portefeuille. Un n≈ìud complet avec ces quatre fonctions est affich√© dans <a href="#full_node_reference">Un n≈ìud de r√©seau Bitcoin avec les quatre fonctions¬†: portefeuille, mineur, base de donn√©es cha√Æne de blocs compl√®te et routage r√©seau</a>.</p>
</div>
<div id="full_node_reference" class="imageblock smallerfifty data-line-19">
<div class="content">
<img src="images/mbc2_0801.png" alt="R√©f√©rence de n≈ìud client complet">
</div>
<div class="title">Figure 46. Un n≈ìud de r√©seau Bitcoin avec les quatre fonctions¬†: portefeuille, mineur, base de donn√©es cha√Æne de blocs compl√®te et routage r√©seau</div>
</div>
<div class="paragraph data-line-21">
<p>Tous les n≈ìuds incluent la fonction de routage pour participer au r√©seau et peuvent inclure d&#8217;autres fonctionnalit√©s. Tous les n≈ìuds valident et propagent les transactions et les blocs, et d√©couvrent et maintiennent les connexions aux pairs. Dans l&#8217;exemple de n≈ìud complet dans <a href="#full_node_reference">Un n≈ìud de r√©seau Bitcoin avec les quatre fonctions¬†: portefeuille, mineur, base de donn√©es cha√Æne de blocs compl√®te et routage r√©seau</a>, la fonction de routage est indiqu√©e par un cercle nomm√© "Network Routing Node" ou par la lettre "N".</p>
</div>
<div class="paragraph data-line-23">
<p>Certains n≈ìuds, appel√©s n≈ìuds complets, conservent √©galement une copie compl√®te et √† jour de la cha√Æne de blocs. Les n≈ìuds complets peuvent v√©rifier de mani√®re autonome et autoritaire toute transaction sans r√©f√©rence externe. Certains n≈ìuds ne conservent qu&#8217;un sous-ensemble de la cha√Æne de blocs et v√©rifient les transactions √† l&#8217;aide d&#8217;une m√©thode appel√©e <em>simplified-payment-verification</em>, ou SPV. Ces n≈ìuds sont appel√©s n≈ìuds SPV ou n≈ìuds l√©gers. Dans l&#8217;exemple de n≈ìud complet de la figure, la fonction de base de donn√©es cha√Æne de blocs de n≈ìud complet est indiqu√©e par un cercle appel√© "Full Blockchain" ou la lettre "B". Dans <a href="#bitcoin_network">Le r√©seau Bitcoin √©tendu montrant divers types de n≈ìuds, passerelles et protocoles</a>, les n≈ìuds SPV sont dessin√©s sans le cercle "B", montrant qu&#8217;ils n&#8217;ont pas une copie compl√®te de la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-25">
<p> Les n≈ìuds de minage se font concurrence pour cr√©er de nouveaux blocs en ex√©cutant du mat√©riel sp√©cialis√© pour r√©soudre l&#8217;algorithme de preuve de travail. Certains n≈ìuds de minage sont √©galement des n≈ìuds complets, conservant une copie compl√®te de la cha√Æne de blocs, tandis que d&#8217;autres sont des n≈ìuds l√©gers participant au minage de groupe et d√©pendant d&#8217;un serveur de groupe pour maintenir un n≈ìud complet. La fonction d&#8217;exploration de donn√©es est affich√©e dans le n≈ìud complet sous la forme d&#8217;un cercle appel√© "Miner" ou de la lettre "M".</p>
</div>
<div class="paragraph data-line-27">
<p>Les portefeuilles d&#8217;utilisateurs peuvent faire partie d&#8217;un n≈ìud complet, comme c&#8217;est g√©n√©ralement le cas avec les clients Bitcoin de bureau. De plus en plus, de nombreux portefeuilles d&#8217;utilisateurs, en particulier ceux fonctionnant sur des appareils √† ressources limit√©es tels que les smartphones, sont des n≈ìuds SPV. La fonction de portefeuille est affich√©e dans <a href="#full_node_reference">Un n≈ìud de r√©seau Bitcoin avec les quatre fonctions¬†: portefeuille, mineur, base de donn√©es cha√Æne de blocs compl√®te et routage r√©seau</a> comme un cercle appel√© "Wallet" ou la lettre "W."</p>
</div>
<div class="paragraph data-line-29">
<p>En plus des principaux types de n≈ìuds sur le protocole bitcoin P2P, il existe des serveurs et des n≈ìuds ex√©cutant d&#8217;autres protocoles, tels que des protocoles de groupe de minage sp√©cialis√©s et des protocoles d&#8217;acc√®s client l√©gers.</p>
</div>
<div class="paragraph data-line-31">
<p><a href="#node_type_ledgend">Diff√©rents types de n≈ìuds sur le r√©seau Bitcoin √©tendu</a> montre les types de n≈ìuds les plus courants sur le r√©seau Bitcoin √©tendu.</p>
</div>
</div>
<div class="sect2 data-line-33">
<h3 id="_le_r√©seau_bitcoin_√©tendu">Le r√©seau Bitcoin √©tendu</h3>
<div class="paragraph data-line-35">
<p>Le principal r√©seau Bitcoin, en cours d&#8217;ex√©cution le protocole bitcoin P2P, se compose de 5 000 √† 8 000 n≈ìuds d&#8217;√©coute ex√©cutant diff√©rentes versions du client de r√©f√©rence bitcoin (Bitcoin Core) et de quelques centaines de n≈ìuds ex√©cutant diverses autres impl√©mentations du protocole bitcoin P2P, telles que Bitcoin Classic, Bitcoin Unlimited, BitcoinJ, Libbitcoin, btcd et bcoin. Un petit pourcentage des n≈ìuds du r√©seau bitcoin P2P sont √©galement des n≈ìuds de minage, en concurrence dans le processus de minage, en validant les transactions et en cr√©ant de nouveaux blocs. Diverses grandes entreprises s&#8217;interfacent avec le r√©seau Bitcoin en ex√©cutant des clients √† n≈ìud complet bas√©s sur le client Bitcoin Core, avec des copies compl√®tes de la cha√Æne de blocs et un n≈ìud de r√©seau, mais sans fonctions de minage ou de portefeuille. Ces n≈ìuds agissent comme des routeurs de p√©riph√©rie de r√©seau, permettant √† divers autres services (√©changes, portefeuilles, explorateurs de blocs, traitement des paiements marchands) d&#8217;√™tre construits par-dessus.</p>
</div>
<div class="paragraph data-line-37">
<p>Le r√©seau Bitcoin √©tendu comprend le r√©seau ex√©cutant le protocole bitcoin P2P, d√©crit pr√©c√©demment, ainsi que des n≈ìuds ex√©cutant des protocoles sp√©cialis√©s. Un certain nombre de serveurs de groupe et de passerelles de protocole qui connectent des n≈ìuds ex√©cutant d&#8217;autres protocoles sont attach√©s au r√©seau principal bitcoin P2P. Ces autres n≈ìuds de protocole sont principalement des n≈ìuds de minage de groupe (voir <a href="#mining">Minage et Consensus</a>) et les clients de portefeuille l√©gers, qui ne portent pas une copie compl√®te de la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-39">
<p><a href="#bitcoin_network">Le r√©seau Bitcoin √©tendu montrant divers types de n≈ìuds, passerelles et protocoles</a> montre le r√©seau Bitcoin √©tendu avec les diff√©rents types de n≈ìuds, serveurs de passerelle, routeurs de p√©riph√©rie et clients de portefeuille et les diff√©rents protocoles qu&#8217;ils utilisent pour se connecter les uns aux autres.</p>
</div>
<div id="node_type_ledgend" class="imageblock data-line-43">
<div class="content">
<img src="images/mbc2_0802.png" alt="Types de n≈ìuds Bitcoin">
</div>
<div class="title">Figure 47. Diff√©rents types de n≈ìuds sur le r√©seau Bitcoin √©tendu</div>
</div>
<div id="bitcoin_network" class="imageblock data-line-47">
<div class="content">
<img src="images/mbc2_0803.png" alt="R√©seau Bitcoin">
</div>
<div class="title">Figure 48. Le r√©seau Bitcoin √©tendu montrant divers types de n≈ìuds, passerelles et protocoles</div>
</div>
</div>
<div class="sect2 data-line-49">
<h3 id="_r√©seaux_relais_bitcoin">R√©seaux relais Bitcoin</h3>
<div class="paragraph data-line-51">
<p>Alors que le r√©seau bitcoin P2P r√©pond aux besoins g√©n√©raux d&#8217;une grande vari√©t√© de types de n≈ìuds, il pr√©sente une latence de r√©seau trop √©lev√©e pour les besoins sp√©cialis√©s des n≈ìuds de minage de bitcoins.</p>
</div>
<div class="paragraph data-line-53">
<p>Les mineurs de Bitcoin sont engag√©s dans une comp√©tition urgente pour r√©soudre le probl√®me de la preuve de travail et √©tendre la cha√Æne de blocs (voir <a href="#mining">Minage et Consensus</a>). Tout en participant √† cette comp√©tition, les mineurs de bitcoins doivent minimiser le temps entre la propagation d&#8217;un bloc gagnant et le d√©but du prochain tour de comp√©tition. Dans le secteur minier, la latence du r√©seau est directement li√©e aux marges b√©n√©ficiaires.</p>
</div>
<div class="paragraph data-line-55">
<p>Un <em>Bitcoin Relay Network</em> ou (r√©seau de relais Bitcoin) est un r√©seau qui tente de minimiser la latence dans la transmission des blocs entre les mineurs. Le <a href="https://www.bitcoinrelaynetwork.org" class="undefined" data-href="https://www.bitcoinrelaynetwork.org">https://www.bitcoinrelaynetwork.org</a> [Bitcoin Relay Network] original a √©t√© cr√©√© par le d√©veloppeur principal Matt Corallo en 2015 pour permettre une synchronisation rapide des blocs entre les mineurs avec une latence tr√®s faible. Le r√©seau se composait de plusieurs n≈ìuds sp√©cialis√©s h√©berg√©s sur l&#8217;infrastructure Amazon Web Services √† travers le monde et servait √† connecter la majorit√© des mineurs et des pools de minage.</p>
</div>
<div class="paragraph data-line-57">
<p>Le r√©seau de relais Bitcoin d&#8217;origine a √©t√© remplac√© en 2016 par l&#8217;introduction du <em>Fast Internet Bitcoin Relay Engine</em> ou https:/ /bitcoinfibre.org[<em>FIBRE</em>], √©galement cr√©√© par le d√©veloppeur principal Matt Corallo. FIBRE est un r√©seau de relais bas√© sur UDP qui relaie les blocs au sein d&#8217;un r√©seau de n≈ìuds. FIBRE met en ≈ìuvre l&#8217;optimisation <em>bloc compact</em> pour r√©duire davantage la quantit√© de donn√©es transmises et la latence du r√©seau.</p>
</div>
<div class="paragraph data-line-59">
<p>Les r√©seaux de relais ne remplacent pas le r√©seau P2P de Bitcoin. Au lieu de cela, ce sont des r√©seaux superpos√©s qui fournissent une connectivit√© suppl√©mentaire entre les n≈ìuds ayant des besoins sp√©cialis√©s. Comme les autoroutes ne remplacent pas les routes rurales, mais plut√¥t des raccourcis entre deux points √† fort trafic, vous avez toujours besoin de petites routes pour vous connecter aux autoroutes.</p>
</div>
</div>
<div class="sect2 data-line-61">
<h3 id="_d√©couverte_du_r√©seau">D√©couverte du r√©seau</h3>
<div class="paragraph data-line-63">
<p>Lorsqu&#8217;un nouveau n≈ìud d√©marre, il doit d√©couvrir d&#8217;autres n≈ìuds Bitcoin sur le r√©seau afin de participer. Pour d√©marrer ce processus, un nouveau n≈ìud doit d√©couvrir au moins un n≈ìud existant sur le r√©seau et s&#8217;y connecter. L&#8217;emplacement g√©ographique des autres n≈ìuds n&#8217;est pas pertinent¬†; la topologie du r√©seau Bitcoin n&#8217;est pas d√©finie g√©ographiquement. Par cons√©quent, tous les n≈ìuds Bitcoin existants peuvent √™tre s√©lectionn√©s au hasard.</p>
</div>
<div class="paragraph data-line-65">
<p>Pour se connecter √† un pair connu, les n≈ìuds √©tablissent une connexion TCP, g√©n√©ralement au port 8333 (le port g√©n√©ralement connu comme celui utilis√© par bitcoin), ou un autre port s&#8217;il en existe un. Lors de l&#8217;√©tablissement d&#8217;une connexion, le n≈ìud commencera une "prise de contact" (voir <a href="#network_handshake">La poign√©e de main initiale entre pairs</a>) en transmettant un message <code>version</code>, qui contient des informations d&#8217;identification de base, notamment¬†:</p>
</div>
<div class="dlist data-line-67">
<dl>
<dt class="hdlist1"><code>nVersion</code></dt>
<dd>
<p>La version du protocole bitcoin P2P que le client "parle" (par exemple, 70002)</p>
</dd>
<dt class="hdlist1"><code>nLocalServices</code></dt>
<dd>
<p>Une liste des services locaux pris en charge par le n≈ìud, actuellement uniquement <code>NODE_NETWORK</code></p>
</dd>
<dt class="hdlist1"><code>nTime</code></dt>
<dd>
<p>L&#8217;heure actuelle</p>
</dd>
<dt class="hdlist1"><code>addrYou</code></dt>
<dd>
<p>L&#8217;adresse IP du n≈ìud distant vue depuis ce n≈ìud</p>
</dd>
<dt class="hdlist1"><code>addrMe</code></dt>
<dd>
<p>L&#8217;adresse IP du n≈ìud local, telle que d√©couverte par le n≈ìud local</p>
</dd>
<dt class="hdlist1"><code>subver</code></dt>
<dd>
<p>Une sous-version indiquant le type de logiciel ex√©cut√© sur ce n≈ìud (par exemple, <span class="keep-together"><code>/Satoshi:0.9.2.1/</code></span>)</p>
</dd>
<dt class="hdlist1"><code>BestHeight</code></dt>
<dd>
<p>La hauteur de bloc de la cha√Æne de blocs de ce n≈ìud</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-75">
<p>(Voir <a href="https://bit.ly/1qlsC7w" data-href="https://bit.ly/1qlsC7w">GitHub</a> pour un exemple du message de <code>version</code> du r√©seau.)</p>
</div>
<div class="paragraph data-line-77">
<p>Le message <code>version</code> est toujours le premier message envoy√© par un pair √† un autre pair. L&#8217;homologue local recevant un message <code>version</code> examinera la <code>nVersion</code> signal√©e par l&#8217;homologue distant et d√©cidera si l&#8217;homologue distant est compatible. Si le pair distant est compatible, le pair local accusera r√©ception du message <code>version</code> et √©tablira une connexion en envoyant un message <code>verack</code>.</p>
</div>
<div class="paragraph data-line-79">
<p>Comment un nouveau n≈ìud trouve-t-il des pairs¬†? La premi√®re m√©thode consiste √† interroger les DNS √† l&#8217;aide d&#8217;un certain nombre de d'"indexes DNS", qui sont des serveurs DNS fournissant une liste d&#8217;adresses IP de n≈ìuds Bitcoin. Certaines de ces indexes DNS fournissent une liste statique d&#8217;adresses IP de n≈ìuds d&#8217;√©coute bitcoin stables. Certaines des indexes DNS sont des impl√©mentations personnalis√©es de BIND (Berkeley Internet Name Daemon) qui renvoient un sous-ensemble al√©atoire √† partir d&#8217;une liste d&#8217;adresses de n≈ìuds Bitcoin collect√©es par un robot ou un n≈ìud Bitcoin de longue dur√©e. Le client Bitcoin Core contient les noms de neuf sources DNS diff√©rentes. La diversit√© de propri√©t√© et la diversit√© de mise en ≈ìuvre des diff√©rentes sources DNS offrent un haut niveau de fiabilit√© pour le processus d&#8217;amor√ßage initial. Dans le client Bitcoin Core, l&#8217;option d&#8217;utilisation des indexes DNS est contr√¥l√©e par le commutateur d&#8217;option <code>-dnsseed</code> (r√©gl√© sur 1 par d√©faut, pour utiliser la source DNS).</p>
</div>
<div class="paragraph data-line-81">
<p>Alternativement, un n≈ìud d&#8217;amor√ßage qui ne sait rien du r√©seau doit recevoir l&#8217;adresse IP d&#8217;au moins un n≈ìud Bitcoin, apr√®s quoi il peut √©tablir des connexions via d&#8217;autres introductions. L&#8217;argument de ligne de commande <code>-seednode</code> peut √™tre utilis√© pour se connecter √† un n≈ìud uniquement pour les introductions en l&#8217;utilisant comme source. Une fois que le n≈ìud de d√©part initial a √©t√© utilis√© pour former des pr√©sentations, le client s&#8217;en d√©connecte et utilise les pairs nouvellement d√©couverts.</p>
</div>
<div id="network_handshake" class="imageblock data-line-85">
<div class="content">
<img src="images/mbc2_0804.png" alt="Prise de contact r√©seau">
</div>
<div class="title">Figure 49. La poign√©e de main initiale entre pairs</div>
</div>
<div class="paragraph data-line-87">
<p>Une fois qu&#8217;une ou plusieurs connexions sont √©tablies, le nouveau n≈ìud enverra un message <code>addr</code> contenant sa propre adresse IP √† ses voisins. Les voisins transmettront √† leur tour le message <code>addr</code> √† leurs voisins, garantissant que le n≈ìud nouvellement connect√© devient bien connu et mieux connect√©. De plus, le n≈ìud nouvellement connect√© peut envoyer <code>getaddr</code> aux voisins, leur demandant de renvoyer une liste d&#8217;adresses IP d&#8217;autres pairs. De cette fa√ßon, un n≈ìud peut trouver des pairs auxquels se connecter et annoncer son existence sur le r√©seau pour que d&#8217;autres n≈ìuds le trouvent. <a href="#address_propagation">Propagation et d√©couverte d&#8217;adresses</a>  montre le protocole de d√©couverte d&#8217;adresse.</p>
</div>
<div id="address_propagation" class="imageblock data-line-92">
<div class="content">
<img src="images/mbc2_0805.png" alt="Propagation d&#8217;adresse">
</div>
<div class="title">Figure 50. Propagation et d√©couverte d&#8217;adresses</div>
</div>
<div class="paragraph data-line-94">
<p>Un n≈ìud doit se connecter √† quelques pairs diff√©rents afin d&#8217;√©tablir divers chemins dans le r√©seau Bitcoin. Les chemins ne sont pas persistants, les n≈ìuds vont et viennent, et le n≈ìud doit donc continuer √† d√©couvrir de nouveaux n≈ìuds √† mesure qu&#8217;il perd d&#8217;anciennes connexions et √† aider les autres n≈ìuds lors de leur d√©marrage. Une seule connexion est n√©cessaire pour d√©marrer, car le premier n≈ìud peut proposer des introductions √† ses n≈ìuds pairs et ces pairs peuvent proposer d&#8217;autres introductions. Il est √©galement inutile et gaspilleur de se connecter √† plus d&#8217;une poign√©e de n≈ìuds. Apr√®s le d√©marrage, un n≈ìud se souviendra de ses derni√®res connexions homologues r√©ussies, de sorte que s&#8217;il est red√©marr√©, il peut rapidement r√©tablir les connexions avec son ancien r√©seau homologue. Si aucun des anciens pairs ne r√©pond √† sa demande de connexion, le n≈ìud peut utiliser les n≈ìuds de d√©part pour red√©marrer.</p>
</div>
<div class="paragraph data-line-96">
<p>Sur un n≈ìud ex√©cutant le client Bitcoin Core, vous pouvez lister les connexions homologues avec la commande <code>getpeerinfo</code>¬†:</p>
</div>
<div class="listingblock data-line-99">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ bitcoin-cli getpeerinfo</code></pre>
</div>
</div>
<div class="listingblock data-line-103">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">[
    {
        "addr" : "85.213.199.39:8333",
        "services" : "00000001",
        "lastsend" : 1405634126,
        "lastrecv" : 1405634127,
        "bytessent" : 23487651,
        "bytesrecv" : 138679099,
        "conntime" : 1405021768,
        "pingtime" : 0.00000000,
        "version" : 70002,
        "subver" : "/Satoshi:0.9.2.1/",
        "inbound" : false,
        "startingheight" : 310131,
        "banscore" : 0,
        "syncnode" : true
    },
    {
        "addr" : "58.23.244.20:8333",
        "services" : "00000001",
        "lastsend" : 1405634127,
        "lastrecv" : 1405634124,
        "bytessent" : 4460918,
        "bytesrecv" : 8903575,
        "conntime" : 1405559628,
        "pingtime" : 0.00000000,
        "version" : 70001,
        "subver" : "/Satoshi:0.8.6/",
        "inbound" : false,
        "startingheight" : 311074,
        "banscore" : 0,
        "syncnode" : false
    }
]</code></pre>
</div>
</div>
<div class="paragraph data-line-140">
<p>Pour outrepasser la gestion automatique des pairs et sp√©cifier une liste d&#8217;adresses IP, les utilisateurs peuvent fournir l&#8217;option <code>-connect=&lt;IPAddress&gt;</code> et sp√©cifiez une ou plusieurs adresses IP. Si cette option est utilis√©e, le n≈ìud se connectera uniquement aux adresses IP s√©lectionn√©es, au lieu de d√©couvrir et de maintenir automatiquement les connexions homologues.</p>
</div>
<div class="paragraph data-line-142">
<p>S&#8217;il n&#8217;y a pas de trafic sur une connexion, les n≈ìuds enverront p√©riodiquement un message pour maintenir la connexion. Si un n≈ìud n&#8217;a pas communiqu√© sur une connexion pendant plus de 90 minutes, il est suppos√© √™tre d√©connect√© et un nouveau pair sera recherch√©. Ainsi, le r√©seau s&#8217;adapte dynamiquement aux n≈ìuds transitoires et aux probl√®mes de r√©seau, et peut cro√Ætre et r√©tr√©cir de mani√®re organique selon les besoins sans aucun contr√¥le central.</p>
</div>
</div>
<div class="sect2 data-line-144">
<h3 id="_n≈ìuds_complets">N≈ìuds complets</h3>
<div class="paragraph data-line-146">
<p>Les n≈ìuds complets sont des n≈ìuds qui maintiennent une cha√Æne de blocs compl√®te avec toutes les transactions. Plus pr√©cis√©ment, ils devraient probablement √™tre appel√©s "n≈ìuds de cha√Æne de blocs complets". Dans les premi√®res ann√©es de bitcoin, tous les n≈ìuds √©taient des n≈ìuds complets et actuellement, le client Bitcoin Core est un n≈ìud de cha√Æne de blocs complet. Au cours des deux derni√®res ann√©es, cependant, de nouvelles formes de clients Bitcoin ont √©t√© introduites qui ne maintiennent pas une cha√Æne de blocs compl√®te mais fonctionnent comme des clients l√©gers. Nous les examinerons plus en d√©tail dans la section suivante.</p>
</div>
<div class="paragraph data-line-148">
<p>Les n≈ìuds de cha√Æne de blocs complets maintiennent un copie √† jour de la cha√Æne de blocs Bitcoin avec toutes les transactions, qu&#8217;ils construisent et v√©rifient ind√©pendamment, en commen√ßant par le tout premier bloc (bloc de gen√®se) et en remontant jusqu&#8217;au dernier bloc connu du r√©seau. Un n≈ìud de cha√Æne de blocs complet peut v√©rifier de mani√®re ind√©pendante et autoritaire toute transaction sans recours √† aucun autre n≈ìud ou source d&#8217;informations. Le n≈ìud de la cha√Æne de blocs compl√®te s&#8217;appuie sur le r√©seau pour recevoir des mises √† jour sur les nouveaux blocs de transactions, qu&#8217;il v√©rifie ensuite et int√®gre dans sa copie locale de la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-150">
<p>L&#8217;ex√©cution d&#8217;un n≈ìud de cha√Æne de blocs complet vous offre l&#8217;exp√©rience bitcoin pure¬†: une v√©rification ind√©pendante de toutes les transactions sans avoir besoin de s&#8217;appuyer sur, ou de faire confiance, √† d&#8217;autres syst√®mes. Il est facile de savoir si vous ex√©cutez un n≈ìud complet car il n√©cessite plus de cent gigaoctets de stockage persistant (espace disque) pour stocker la cha√Æne de blocs compl√®te. Si vous avez besoin de beaucoup de disque et que la synchronisation avec le r√©seau prend deux √† trois jours, vous ex√©cutez un n≈ìud complet. C&#8217;est le prix d&#8217;une ind√©pendance totale et de la libert√© vis-√†-vis de l&#8217;autorit√© centrale.</p>
</div>
<div class="paragraph data-line-152">
<p>Il existe quelques impl√©mentations alternatives de clients Bitcoin √† cha√Æne compl√®te, construites √† l&#8217;aide de diff√©rents langages de programmation et architectures logicielles. Cependant, l&#8217;impl√©mentation la plus courante est le client de r√©f√©rence Bitcoin Core, √©galement connu sous le nom de client Satoshi. Plus de 75¬†% des n≈ìuds du r√©seau Bitcoin ex√©cutent diff√©rentes versions de Bitcoin Core. Il est identifi√© comme ¬´¬†Satoshi¬†¬ª dans la cha√Æne de sous-version envoy√©e dans le message <code>version</code> et affich√© par la commande <code>getpeerinfo</code> comme nous l&#8217;avons vu pr√©c√©demment¬†; par exemple, <code>/Satoshi:0.8.6/</code>.</p>
</div>
</div>
<div class="sect2 data-line-154">
<h3 id="_√©changer_linventaire">√âchanger "l&#8217;inventaire"</h3>
<div class="paragraph data-line-156">
<p>La premi√®re chose qu&#8217;un n≈ìud complet fera une fois qu&#8217;il se connecte √† des pairs est d&#8217;essayer de construire une cha√Æne de blocs compl√®te. S&#8217;il s&#8217;agit d&#8217;un tout nouveau n≈ìud et qu&#8217;il n&#8217;a aucune cha√Æne de blocs, il ne conna√Æt qu&#8217;un seul bloc, le bloc de gen√®se, qui est int√©gr√© de mani√®re statique dans le logiciel client. En commen√ßant par le bloc #0 (le bloc de gen√®se), le nouveau n≈ìud devra t√©l√©charger des centaines de milliers de blocs pour se synchroniser avec le r√©seau et r√©tablir la cha√Æne de blocs compl√®te.</p>
</div>
<div class="paragraph data-line-158">
<p>Le processus de synchronisation de la cha√Æne de blocs commence par le message <code>version</code>, car il contient <code>BestHeight</code>, l&#8217;hauteur actuelle d&#8217;un n≈ìud (nombre de blocs) de la cha√Æne de blocs. Un n≈ìud verra les messages <code>version</code> de ses pairs, saura combien de blocs ils ont chacun et pourra comparer avec le nombre de blocs qu&#8217;il a dans sa propre cha√Æne de blocs. Les n≈ìuds appair√©s √©changeront un message <code>getblocks</code> contenant le hachage (empreinte digitale) du bloc sup√©rieur sur leur cha√Æne de blocs locale. L&#8217;un des pairs pourra identifier le r√©sultat d&#8217;hachage re√ßu comme appartenant √† un bloc qui n&#8217;est pas au sommet, mais appartient plut√¥t √† un bloc plus ancien, en d√©duisant ainsi que sa propre cha√Æne de blocs locale est plus longue que celle de son pair.</p>
</div>
<div class="paragraph data-line-160">
<p>Le pair qui a la cha√Æne de blocs la plus longue a plus de blocs que l&#8217;autre n≈ìud et peut identifier les blocs dont l&#8217;autre n≈ìud a besoin pour "rattraper son retard". Il identifiera les 500 premiers blocs √† partager et transmettra leurs hachages √† l&#8217;aide d&#8217;un message <code>inv</code> (inventaire). Le n≈ìud manquant ces blocs les r√©cup√©rera ensuite, en √©mettant une s√©rie de messages <code>getdata</code> demandant les donn√©es compl√®tes du bloc et en identifiant les blocs demand√©s √† l&#8217;aide des hachages du message <code>inv</code>.</p>
</div>
<div class="paragraph data-line-162">
<p>Supposons, par exemple, qu&#8217;un n≈ìud n&#8217;ait que le bloc de gen√®se. Il recevra alors un message <code>inv</code> de ses pairs contenant les hachages des 500 prochains blocs de la cha√Æne. Il commencera √† demander des blocs √† tous ses pairs connect√©s, r√©partissant la charge et s&#8217;assurant qu&#8217;il ne submerge aucun pair de demandes. Le n≈ìud garde une trace du nombre de blocs "en transit" par connexion homologue, c&#8217;est-√†-dire des blocs qu&#8217;il a demand√©s mais non re√ßus, en v√©rifiant qu&#8217;il ne d√©passe pas une limite (<code>MAX_BLOCKS_IN_TRANSIT_PER_PEER</code>). De cette fa√ßon, s&#8217;il a besoin de beaucoup de blocs, il n&#8217;en demandera de nouveaux que lorsque les demandes pr√©c√©dentes seront satisfaites, permettant aux pairs de contr√¥ler le rythme des mises √† jour et de ne pas submerger le r√©seau. Au fur et √† mesure que chaque bloc est re√ßu, il est ajout√© √† la cha√Æne de blocs, comme nous le verrons dans <a href="#blockchain">La cha√Æne de blocs (La blockchain)</a>. Au fur et √† mesure que la cha√Æne de blocs locale se construit, davantage de blocs sont demand√©s et re√ßus, et le processus se poursuit jusqu&#8217;√† ce que le n≈ìud rattrape le reste du r√©seau.</p>
</div>
<div class="paragraph data-line-164">
<p>Ce processus de comparaison de la cha√Æne de blocs locale avec les pairs et de r√©cup√©ration des blocs manquants se produit chaque fois qu&#8217;un n≈ìud se d√©connecte pendant une p√©riode donn√©e. Qu&#8217;un n≈ìud soit hors ligne depuis quelques minutes et qu&#8217;il manque quelques blocs, ou un mois et qu&#8217;il manque quelques milliers de blocs, il commence par envoyer <code>getblocks</code>, re√ßoit une r√©ponse <code>inv</code> et commence √† t√©l√©charger les blocs manquants. <a href="#inventory_synchronization">N≈ìud synchronisant la cha√Æne de blocs en r√©cup√©rant les blocs d&#8217;un pair</a> affiche l&#8217;inventaire et le protocole de propagation des blocs.</p>
</div>
<div id="inventory_synchronization" class="imageblock smallerfifty data-line-169">
<div class="content">
<img src="images/mbc2_0806.png" alt="Synchronisation de l&#8217;inventaire">
</div>
<div class="title">Figure 51. N≈ìud synchronisant la cha√Æne de blocs en r√©cup√©rant les blocs d&#8217;un pair</div>
</div>
</div>
<div class="sect2 data-line-172">
<h3 id="spv_nodes">N≈ìuds de v√©rification simplifi√©e des paiements, ou Simplified Payment Verification (SPV)</h3>
<div class="paragraph data-line-174">
<p>Tous les n≈ìuds n&#8217;ont pas la capacit√© de stocker la cha√Æne de blocs compl√®te. De nombreux clients Bitcoin sont con√ßus pour fonctionner sur des appareils √† espace et puissance limit√©s, tels que les smartphones, les tablettes ou les syst√®mes embarqu√©s. Pour ces appareils, une m√©thode de <em>v√©rification de paiement simplifi√©e</em> (SPV) est utilis√©e pour leur permettre de fonctionner sans stocker la cha√Æne de blocs compl√®te. Ces types de clients sont appel√©s clients SPV ou clients l√©gers. √Ä mesure que l&#8217;adoption du bitcoin augmente, le n≈ìud SPV devient la forme la plus courante de n≈ìud Bitcoin, en particulier pour les portefeuilles bitcoin.</p>
</div>
<div class="paragraph data-line-176">
<p>Les n≈ìuds SPV t√©l√©chargent uniquement les en-t√™tes de bloc et ne t√©l√©chargent pas les transactions incluses dans chaque bloc. La cha√Æne de blocs qui en r√©sulte, sans transactions, est 1 000 fois plus petite que la cha√Æne de blocs compl√®te. Les n≈ìuds SPV ne peuvent pas construire une image compl√®te de tous les UTXO disponibles pour les d√©penses car ils ne connaissent pas toutes les transactions sur le r√©seau. Les n≈ìuds SPV v√©rifient les transactions en utilisant une m√©thode l√©g√®rement diff√©rente qui s&#8217;appuie sur des pairs pour fournir des vues partielles des parties pertinentes de la cha√Æne de blocs √† la demande.</p>
</div>
<div class="paragraph data-line-178">
<p>Par analogie, un n≈ìud complet est comme un touriste dans une ville √©trange, √©quip√© d&#8217;une carte d√©taill√©e de chaque rue et de chaque adresse. En comparaison, un n≈ìud SPV est comme un touriste dans une ville √©trange demandant √† des inconnus au hasard des indications d√©taill√©es tout en ne connaissant qu&#8217;une seule avenue principale. Bien que les deux touristes puissent v√©rifier l&#8217;existence d&#8217;une rue en la visitant, le touriste sans carte ne sait pas ce qui se trouve dans les rues lat√©rales et ne sait pas quelles autres rues existent. Positionn√© en face du 23 Church Street, le touriste sans carte ne peut pas savoir s&#8217;il existe une dizaine d&#8217;autres adresses ¬´ 23 Church Street ¬ª dans la ville et si celle-ci est la bonne. La meilleure chance pour le touriste sans carte est de demander √† suffisamment de gens et d&#8217;esp√©rer que certains d&#8217;entre eux n&#8217;essaient pas de l&#8217;agresser.</p>
</div>
<div class="paragraph data-line-180">
<p>SPV v√©rifie les transactions en se r√©f√©rant √† leur <em>profondeur</em> dans la cha√Æne de blocs au lieu de leur <em>hauteur</em>. Alors qu&#8217;un n≈ìud de cha√Æne de blocs complet construira une cha√Æne enti√®rement v√©rifi√©e de milliers de blocs et de transactions descendant dans la cha√Æne de blocs (remontant dans le temps) jusqu&#8217;au bloc de gen√®se, un n≈ìud SPV v√©rifiera la cha√Æne de tous les blocs (mais pas toutes les transactions) et lier cette cha√Æne √† la transaction d&#8217;int√©r√™t.</p>
</div>
<div class="paragraph data-line-182">
<p>Par exemple, lors de l&#8217;examen d&#8217;une transaction dans le bloc 300 000, un n≈ìud complet relie les 300 000 blocs au bloc de gen√®se et cr√©e une base de donn√©es compl√®te d&#8217;UTXO, √©tablissant la validit√© de la transaction en confirmant que l&#8217;UTXO reste non d√©pens√©. Un n≈ìud SPV ne peut pas valider si l&#8217;UTXO n&#8217;est pas d√©pens√©. Au lieu de cela, le n≈ìud SPV √©tablira un lien entre la transaction et le bloc qui la contient, en utilisant un <em>chemin de Merkle</em> (voir <a href="#merkle_trees">Arbres de Merkle</a>). Ensuite, le n≈ìud SPV attend de voir les six blocs 300 001 √† 300 006 empil√©s au-dessus du bloc contenant la transaction et le v√©rifie en √©tablissant sa profondeur sous les blocs 300 006 √† 300 001. Le fait que d&#8217;autres n≈ìuds du r√©seau aient accept√© le bloc 300 000 et aient ensuite effectu√© le travail n√©cessaire pour produire six autres blocs en plus est la preuve, par procuration, que la transaction n&#8217;√©tait pas une double d√©pense.</p>
</div>
<div class="paragraph data-line-184">
<p>Un n≈ìud SPV ne peut pas √™tre persuad√© qu&#8217;une transaction existe dans un bloc alors que la transaction n&#8217;existe pas en fait. Le n≈ìud SPV √©tablit l&#8217;existence d&#8217;une transaction dans un bloc en demandant une preuve de chemin Merkle et en validant la preuve de travail dans la cha√Æne de blocs. Cependant, l&#8217;existence d&#8217;une transaction peut √™tre "masqu√©e" √† un n≈ìud SPV. Un n≈ìud SPV peut certainement prouver qu&#8217;une transaction existe mais ne peut pas v√©rifier qu&#8217;une transaction, telle qu&#8217;une double d√©pense du m√™me UTXO, n&#8217;existe pas car il n&#8217;a pas d&#8217;enregistrement de toutes les transactions. Cette vuln√©rabilit√© peut √™tre utilis√©e dans une attaque par d√©ni de service ou pour une attaque √† double d√©pense contre les n≈ìuds SPV. Pour se d√©fendre contre cela, un n≈ìud SPV doit se connecter de mani√®re al√©atoire √† plusieurs n≈ìuds, pour augmenter la probabilit√© qu&#8217;il soit en contact avec au moins un n≈ìud honn√™te. Ce besoin de se connecter de mani√®re al√©atoire signifie que les n≈ìuds SPV sont √©galement vuln√©rables aux attaques de partitionnement de r√©seau ou aux attaques Sybil, o√π ils sont connect√©s √† de faux n≈ìuds ou √† de faux r√©seaux et n&#8217;ont pas acc√®s √† des n≈ìuds honn√™tes ou au vrai r√©seau Bitcoin.</p>
</div>
<div class="paragraph data-line-186">
<p>Dans la plupart des cas pratiques, les n≈ìuds SPV bien connect√©s sont suffisamment s√©curis√©s, trouvant un √©quilibre entre les besoins en ressources, l&#8217;aspect pratique et la s√©curit√©. Pour une s√©curit√© infaillible, cependant, rien ne vaut l&#8217;ex√©cution d&#8217;un n≈ìud de cha√Æne de blocs complet.</p>
</div>
<div class="admonitionblock tip data-line-189">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-190">
<p>Un n≈ìud de cha√Æne de blocs complet v√©rifie une transaction en v√©rifiant toute la cha√Æne de milliers de blocs en dessous afin de garantir que l&#8217;UTXO n&#8217;est pas d√©pens√©, tandis qu&#8217;un n≈ìud SPV v√©rifie √† quelle profondeur le bloc est enterr√© par une poign√©e de blocs au-dessus.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-193">
<p>Pour obtenir les en-t√™tes de bloc, les n≈ìuds SPV utilisent un message <code>getheaders</code> au lieu de <code>getblocks</code>. L&#8217;homologue qui r√©pond enverra jusqu&#8217;√† 2 000 en-t√™tes de bloc √† l&#8217;aide d&#8217;un seul message <code>headers</code>. Le processus est par ailleurs le m√™me que celui utilis√© par un n≈ìud complet pour r√©cup√©rer des blocs complets. Les n≈ìuds SPV d√©finissent √©galement un filtre sur la connexion aux pairs, pour filtrer le flux des futurs blocs et transactions envoy√©s par les pairs. Toutes les transactions int√©ressantes sont r√©cup√©r√©es √† l&#8217;aide d&#8217;une requ√™te <code>getdata</code>. Le pair g√©n√®re un message <code>tx</code> contenant les transactions, en r√©ponse. <a href="#spv_synchronization">N≈ìud SPV synchronisant les en-t√™tes de bloc</a> montre la synchronisation des en-t√™tes de bloc.</p>
</div>
<div class="paragraph data-line-195">
<p>√âtant donn√© que les n≈ìuds SPV doivent r√©cup√©rer des transactions sp√©cifiques afin de les v√©rifier de mani√®re s√©lective, ils cr√©ent √©galement un risque pour la confidentialit√©. Contrairement aux n≈ìuds de cha√Æne de blocs complets, qui collectent toutes les transactions au sein de chaque bloc, les demandes de donn√©es sp√©cifiques du n≈ìud SPV peuvent r√©v√©ler par inadvertance les adresses de leur portefeuille. Par exemple, un tiers surveillant un r√©seau pourrait suivre toutes les transactions demand√©es par un portefeuille sur un n≈ìud SPV et les utiliser pour associer des adresses Bitcoin √† l&#8217;utilisateur de ce portefeuille, d√©truisant ainsi la vie priv√©e de l&#8217;utilisateur.</p>
</div>
<div id="spv_synchronization" class="imageblock data-line-199">
<div class="content">
<img src="images/mbc2_0807.png" alt="Synchronisation SPV">
</div>
<div class="title">Figure 52. N≈ìud SPV synchronisant les en-t√™tes de bloc</div>
</div>
<div class="paragraph data-line-201">
<p>Peu de temps apr√®s l&#8217;introduction des n≈ìuds SPV/l√©gers, les d√©veloppeurs de bitcoins ont ajout√© une fonctionnalit√© appel√©e <em>filtres de Bloom</em> pour faire face aux risques de confidentialit√© des n≈ìuds SPV. Les filtres de Bloom permettent aux n≈ìuds SPV de recevoir un sous-ensemble des transactions sans r√©v√©ler pr√©cis√©ment les adresses qui les int√©ressent, gr√¢ce √† un m√©canisme de filtrage qui utilise des probabilit√©s plut√¥t que des mod√®les fixes.</p>
</div>
</div>
<div class="sect2 data-line-204">
<h3 id="bloom_filters">Filtres de Bloom</h3>
<div class="paragraph data-line-206">
<p>Un filtre de Bloom est un filtre de recherche probabiliste qui offre un moyen efficace d&#8217;exprimer un mod√®le de recherche tout en prot√©geant la confidentialit√©. Ils sont utilis√©s par les n≈ìuds SPV pour demander √† leurs pairs des transactions correspondant √† un mod√®le sp√©cifique, sans r√©v√©ler exactement quelles adresses, cl√©s ou transactions ils recherchent.</p>
</div>
<div class="paragraph data-line-208">
<p>Dans notre analogie pr√©c√©dente, un touriste sans carte demande son chemin vers une adresse sp√©cifique, "23 Church St." Si elle demande √† des inconnus son chemin vers cette rue, elle r√©v√®le par inadvertance sa destination. Un filtre de Bloom revient √† demander¬†: "Y a-t-il des rues dans ce quartier dont le nom se termine par RCH¬†?" Une question comme celle-l√† en dit un peu moins sur la destination souhait√©e que de demander "23 Church St." En utilisant cette technique, un touriste pourrait sp√©cifier l&#8217;adresse souhait√©e plus en d√©tail comme "se terminant par URCH" ou moins en d√©tail comme "se terminant par H". En faisant varier la pr√©cision de la recherche, le touriste r√©v√®le plus ou moins d&#8217;informations, au d√©triment d&#8217;obtenir des r√©sultats plus ou moins pr√©cis. Si elle demande un mod√®le moins sp√©cifique, elle obtient beaucoup plus d&#8217;adresses possibles et une meilleure confidentialit√©, mais de nombreux r√©sultats ne sont pas pertinents. Si elle demande un mod√®le tr√®s sp√©cifique, elle obtient moins de r√©sultats mais perd sa confidentialit√©.</p>
</div>
<div class="paragraph data-line-210">
<p>Les filtres de Bloom remplissent cette fonction en permettant √† un n≈ìud SPV de sp√©cifier un mod√®le de recherche pour les transactions qui peuvent √™tre r√©gl√©s vers la pr√©cision ou la confidentialit√©. Un filtre de Bloom plus sp√©cifique produira des r√©sultats pr√©cis, mais au d√©triment de la r√©v√©lation des mod√®les qui int√©ressent le n≈ìud SPV, r√©v√©lant ainsi les adresses d√©tenues par le portefeuille de l&#8217;utilisateur. Un filtre bloom moins sp√©cifique produira plus de donn√©es sur plus de transactions, dont beaucoup ne sont pas pertinentes pour le n≈ìud, mais permettra au n≈ìud de maintenir une meilleure confidentialit√©.</p>
</div>
<div class="sect3 data-line-212">
<h4 id="_comment_fonctionnent_les_filtres_de_bloom">Comment fonctionnent les filtres de Bloom</h4>
<div class="paragraph data-line-214">
<p>Les filtres de Bloom sont impl√©ment√©s sous la forme d&#8217;un tableau de taille variable de N chiffres binaires (un champ de bits) et d&#8217;un nombre variable de M fonctions de hachage. Les fonctions de hachage sont con√ßues pour produire toujours une sortie comprise entre 1 et N, correspondant au tableau de chiffres binaires. Les fonctions de hachage sont g√©n√©r√©es de mani√®re d√©terministe, de sorte que tout n≈ìud impl√©mentant un filtre de Bloom utilisera toujours les m√™mes fonctions de hachage et obtiendra les m√™mes r√©sultats pour une entr√©e sp√©cifique. En choisissant des filtres de Bloom de diff√©rentes longueurs (N) et un nombre diff√©rent (M) de fonctions de hachage, le filtres de Bloom peut √™tre r√©gl√©, en faisant varier le niveau de pr√©cision et donc de confidentialit√©.</p>
</div>
<div class="paragraph data-line-216">
<p>Dans <a href="#bloom1">Un exemple de filtre de Bloom simpliste, avec un champ 16 bits et trois fonctions de hachage</a>, nous utilisons un tr√®s petit tableau de 16 bits et un ensemble de trois fonctions de hachage pour d√©montrer le fonctionnement des filtres de Bloom.</p>
</div>
<div id="bloom1" class="imageblock data-line-220">
<div class="content">
<img src="images/mbc2_0808.png" alt="Bloom 1">
</div>
<div class="title">Figure 53. Un exemple de filtre de Bloom simpliste, avec un champ 16 bits et trois fonctions de hachage</div>
</div>
<div class="paragraph data-line-222">
<p>Le filtre de Bloom est initialis√© de sorte que le tableau de bits ne soit que des z√©ros. Pour ajouter un motif au filtre de Bloom, le motif est hach√© tour √† tour par chaque fonction de hachage. L&#8217;application de la premi√®re fonction de hachage √† l&#8217;entr√©e donne un nombre compris entre 1 et N. Le bit correspondant dans le tableau (index√© de 1 √† N) est trouv√© et d√©fini sur <code>1</code>, enregistrant ainsi la sortie de la fonction de hachage. Ensuite, la fonction de hachage suivante est utilis√©e pour d√©finir un autre bit et ainsi de suite. Une fois que toutes les fonctions de hachage M ont √©t√© appliqu√©es, le mod√®le de recherche sera "enregistr√©" dans le filtre de Bloom sous forme de M bits qui ont √©t√© modifi√©s de <code>0</code> √† <code>1</code>.</p>
</div>
<div class="paragraph data-line-224">
<p><a href="#bloom2">Ajout d&#8217;un motif "A" √† notre filtre de Bloom simple</a> est un exemple d&#8217;ajout d&#8217;un motif "A" au filtre de Bloom simple illustr√© dans <a href="#bloom1">Un exemple de filtre de Bloom simpliste, avec un champ 16 bits et trois fonctions de hachage</a>.</p>
</div>
<div class="paragraph data-line-226">
<p>L&#8217;ajout d&#8217;un deuxi√®me motif est aussi simple que de r√©p√©ter ce processus. Le motif est hach√© par chaque fonction de hachage tour √† tour et le r√©sultat est enregistr√© en r√©glant les bits sur <code>1</code>. Notez qu&#8217;√† mesure qu&#8217;un filtre bloom est rempli de plusieurs mod√®les, le r√©sultat d&#8217;une fonction de hachage peut co√Øncider avec un bit d√©j√† d√©fini sur <code>1</code>, auquel cas le bit n&#8217;est pas modifi√©. Essentiellement, √† mesure que davantage de motifs sont enregistr√©s sur des bits qui se chevauchent, le filtre de bloom commence √† √™tre satur√© avec davantage de bits r√©gl√©s sur <code>1</code> et la pr√©cision du filtre diminue. C&#8217;est pourquoi le filtre est une structure de donn√©es probabiliste - il devient moins pr√©cis √† mesure que d&#8217;autres mod√®les sont ajout√©s. La pr√©cision d√©pend du nombre de motifs ajout√©s par rapport √† la taille du tableau de bits (N) et du nombre de fonctions de hachage (M). Un tableau de bits plus grand et plus de fonctions de hachage peuvent enregistrer plus de mod√®les avec une plus grande pr√©cision. Un tableau de bits plus petit ou moins de fonctions de hachage enregistrera moins de mod√®les et produira moins de pr√©cision.</p>
</div>
<div id="bloom2" class="imageblock data-line-230">
<div class="content">
<img src="images/mbc2_0809.png" alt="Bloom 2">
</div>
<div class="title">Figure 54. Ajout d&#8217;un motif "A" √† notre filtre de Bloom simple</div>
</div>
<div class="paragraph data-line-232">
<p><a href="#bloom3">Ajout d&#8217;un deuxi√®me motif "B" √† notre filtre de Bloom simple</a> est un exemple d&#8217;ajout d&#8217;un deuxi√®me motif "B" au filtre de Bloom simple.</p>
</div>
<div id="bloom3" class="imageblock smallereighty data-line-237">
<div class="content">
<img src="images/mbc2_0810.png" alt="Bloom 3">
</div>
<div class="title">Figure 55. Ajout d&#8217;un deuxi√®me motif "B" √† notre filtre de Bloom simple</div>
</div>
<div class="paragraph data-line-239">
<p>Pour tester si un motif fait partie d&#8217;un filtre de Bloom, le motif est hach√© par chaque fonction de hachage et le motif de bits r√©sultant est test√© par rapport au tableau de bits. Si tous les bits index√©s par les fonctions de hachage sont mis √† <code>1</code>, alors le motif est <em>probablement</em> enregistr√© dans le filtre de Bloom. √âtant donn√© que les bits peuvent √™tre d√©finis en raison du chevauchement de plusieurs mod√®les, la r√©ponse n&#8217;est pas certaine, mais plut√¥t probabiliste. En termes simples, une correspondance positive du filtre de Bloom est un "Peut-√™tre, Oui".</p>
</div>
<div class="paragraph data-line-241">
<p><a href="#bloom4">Tester l&#8217;existence du motif "X" dans le filtre de Bloom. Le r√©sultat est une correspondance positive probabiliste, ce qui signifie "Peut-√™tre".</a> est un exemple de test de l&#8217;existence du motif "X" dans le filtre de Bloom simple. Les bits correspondants sont d√©finis sur <code>1</code>, donc le motif est probablement une correspondance.</p>
</div>
<div id="bloom4" class="imageblock smallereighty data-line-246">
<div class="content">
<img src="images/mbc2_0811.png" alt="Bloom 4">
</div>
<div class="title">Figure 56. Tester l&#8217;existence du motif "X" dans le filtre de Bloom. Le r√©sultat est une correspondance positive probabiliste, ce qui signifie "Peut-√™tre".</div>
</div>
<div class="paragraph data-line-248">
<p>Au contraire, si un motif est test√© par rapport au filtre bloom et que l&#8217;un des bits est mis √† <code>0</code>, cela prouve que le motif n&#8217;a pas √©t√© enregistr√© dans le filtre de Bloom. Un r√©sultat n√©gatif n&#8217;est pas une probabilit√©, c&#8217;est une certitude. En termes simples, une correspondance n√©gative sur un filtre de Bloom est un "D√©finitivement pas!"</p>
</div>
<div class="paragraph data-line-250">
<p><a href="#bloom5">Tester l&#8217;existence du motif "Y" dans le filtre de Bloom. Le r√©sultat est une correspondance n√©gative d√©finitive, ce qui signifie "D√©finitivement pas¬†!"</a> est un exemple de test de l&#8217;existence du motif "Y" dans le filtre de Bloom simple. L&#8217;un des bits correspondants est d√©fini sur <code>0</code>, donc le motif n&#8217;est certainement pas une correspondance.</p>
</div>
<div id="bloom5" class="imageblock data-line-254">
<div class="content">
<img src="images/mbc2_0812.png" alt="mbc2 0812">
</div>
<div class="title">Figure 57. Tester l&#8217;existence du motif "Y" dans le filtre de Bloom. Le r√©sultat est une correspondance n√©gative d√©finitive, ce qui signifie "D√©finitivement pas¬†!"</div>
</div>
</div>
</div>
<div class="sect2 data-line-256">
<h3 id="_comment_les_n≈ìuds_spv_utilisent_les_filtres_de_bloom">Comment les n≈ìuds SPV utilisent les filtres de Bloom</h3>
<div class="paragraph data-line-258">
<p>Les filtres de Bloom sont utilis√©s pour filtrer les transactions (et les blocs les contenant) qu&#8217;un n≈ìud SPV re√ßoit de ses pairs, en s√©lectionnant uniquement les transactions qui int√©ressent le n≈ìud SPV sans r√©v√©ler les adresses ou les cl√©s qui l&#8217;int√©ressent.</p>
</div>
<div class="paragraph data-line-260">
<p>Un n≈ìud SPV initialisera un filtre de Bloom comme "vide"¬†; dans cet √©tat, le filtre de Bloom ne correspondra √† aucun motif. Le n≈ìud SPV √©tablira ensuite une liste de toutes les adresses, cl√©s et hachages qui l&#8217;int√©ressent. Il le fera en extrayant le hachage de cl√© publique et le hachage de script et les ID de transaction de tout UTXO contr√¥l√© par son portefeuille. Le n≈ìud SPV ajoute ensuite chacun d&#8217;entre eux au filtre de Bloom, de sorte que le filtre de Bloom "correspondra" si ces mod√®les sont pr√©sents dans une transaction, sans r√©v√©ler les mod√®les eux-m√™mes.</p>
</div>
<div class="paragraph data-line-262">
<p>Le n≈ìud SPV enverra alors un message <code>filterload</code> au pair, contenant le filtres de Bloom √† utiliser sur la connexion. Sur le pair, les filtres de Bloom sont v√©rifi√©s par rapport √† chaque transaction entrante. Le n≈ìud complet v√©rifie plusieurs parties de la transaction par rapport au filtre de Bloom, √† la recherche d&#8217;une correspondance, notamment¬†:</p>
</div>
<div class="ulist data-line-264">
<ul>
<li class="data-line-264">
<p>L&#8217;identifiant de la transaction</p>
</li>
<li class="data-line-265">
<p>Les composants de donn√©es des scripts de verrouillage de chacune des sorties de transaction (chaque cl√© et hachage du script)</p>
</li>
<li class="data-line-266">
<p>Chacune des entr√©es de transaction</p>
</li>
<li class="data-line-267">
<p>Chacun des composants de donn√©es de signature d&#8217;entr√©e (ou scripts t√©moins)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-269">
<p>En comparant tous ces composants, les filtres Bloom peuvent √™tre utilis√©s pour faire correspondre les hachages de cl√©s publiques, les scripts, les valeurs <code>OP_RETURN</code>, les cl√©s publiques dans les signatures ou tout futur composant d&#8217;un contrat intelligent ou d&#8217;un script complexe.</p>
</div>
<div class="paragraph data-line-271">
<p>Une fois qu&#8217;un filtre est √©tabli, le pair teste ensuite la sortie de chaque transaction par rapport au filtre Bloom. Seules les transactions qui correspondent au filtre sont envoy√©es au n≈ìud.</p>
</div>
<div class="paragraph data-line-273">
<p>En r√©ponse √† un message <code>getdata</code> du n≈ìud, les pairs enverront un message <code>merkleblock</code> qui ne contient que des en-t√™tes de bloc pour les blocs correspondant au filtre et un chemin Merkle (voir <a href="#merkle_trees">Arbres de Merkle</a>) pour chaque transaction correspondante. Le pair enverra alors √©galement des messages <code>tx</code> contenant les transactions mises en correspondance par le filtre.</p>
</div>
<div class="paragraph data-line-275">
<p>Lorsque le n≈ìud complet envoie des transactions au n≈ìud SPV, le n≈ìud SPV rejette tous les faux positifs et utilise les transactions correctement appari√©es pour mettre √† jour son ensemble UTXO et le solde de son portefeuille. Au fur et √† mesure qu&#8217;il met √† jour sa propre vue de l&#8217;ensemble UTXO, il modifie √©galement le filtre de Bloom pour correspondre √† toutes les transactions futures faisant r√©f√©rence √† l&#8217;UTXO qu&#8217;il vient de trouver. Le n≈ìud complet utilise ensuite le nouveau filtre de Bloom pour faire correspondre les nouvelles transactions et l&#8217;ensemble du processus se r√©p√®te.</p>
</div>
<div class="paragraph data-line-277">
<p>Le n≈ìud d√©finissant le filtre de Bloom peut ajouter de mani√®re interactive des motifs au filtre en envoyant un message <code>filteradd</code>. Pour effacer le filtre de Bloom, le n≈ìud peut envoyer un message <code>filterclear</code>. Puisqu&#8217;il n&#8217;est pas possible de supprimer un mod√®le d&#8217;un filtre de Bloom, un n≈ìud doit effacer et renvoyer un nouveau filtre de Bloom si un mod√®le n&#8217;est plus souhait√©.</p>
</div>
<div class="paragraph data-line-279">
<p>Le protocole r√©seau et le m√©canisme de filtre de Bloom pour les n≈ìuds SPV sont d√©finis dans <a href="https://bit.ly/1x6qCiO" data-href="https://bit.ly/1x6qCiO">BIP-37 (Peer Services)</a>.</p>
</div>
</div>
<div class="sect2 data-line-282">
<h3 id="_n≈ìuds_spv_et_confidentialit√©">N≈ìuds SPV et confidentialit√©</h3>
<div class="paragraph data-line-284">
<p>Les n≈ìuds qui impl√©mentent SPV ont une confidentialit√© plus faible qu&#8217;un n≈ìud complet. Un n≈ìud complet re√ßoit toutes les transactions et ne r√©v√®le donc aucune information indiquant s&#8217;il utilise une adresse dans son portefeuille. Un n≈ìud SPV re√ßoit une liste filtr√©e des transactions li√©es aux adresses qui se trouvent dans son portefeuille. En cons√©quence, cela r√©duit la vie priv√©e du propri√©taire.</p>
</div>
<div class="paragraph data-line-286">
<p>Les filtres de Bloom sont un moyen de r√©duire la perte de confidentialit√©. Sans eux, un n≈ìud SPV devrait r√©pertorier explicitement les adresses qui l&#8217;int√©ressent, cr√©ant ainsi une grave violation de la vie priv√©e. Cependant, m√™me avec des filtres de Bloom, un adversaire surveillant le trafic d&#8217;un client SPV ou s&#8217;y connectant directement en tant que n≈ìud du r√©seau P2P peut collecter suffisamment d&#8217;informations au fil du temps pour apprendre les adresses dans le portefeuille du client SPV.</p>
</div>
</div>
<div class="sect2 data-line-288">
<h3 id="_connexions_crypt√©es_et_authentifi√©es">Connexions crypt√©es et authentifi√©es</h3>
<div class="paragraph data-line-290">
<p>La plupart des nouveaux utilisateurs de bitcoin supposent que les communications r√©seau d&#8217;un n≈ìud Bitcoin sont crypt√©es. En fait, la mise en ≈ìuvre originale du bitcoin communique enti√®rement en clair. Bien que ce ne soit pas un probl√®me majeur de confidentialit√© pour les n≈ìuds complets, c&#8217;est un gros probl√®me pour les n≈ìuds SPV.</p>
</div>
<div class="paragraph data-line-292">
<p>Afin d&#8217;augmenter la confidentialit√© et la s√©curit√© du r√©seau bitcoin P2P, il existe deux solutions qui fournissent le cryptage des communications¬†: <em>Tor Transport</em> et <em>P2P Authentication and Encryption</em> avec BIP-150/151.</p>
</div>
<div class="sect3 data-line-294">
<h4 id="_transport_tor">Transport Tor</h4>
<div class="paragraph data-line-296">
<p>Tor, qui signifie <em>The Onion Routing network</em>, est un projet logiciel et un r√©seau qui offre le cryptage et l&#8217;encapsulation des donn√©es via des chemins de r√©seau qui offrent l&#8217;anonymat, l&#8217;intra√ßabilit√© et la confidentialit√©.</p>
</div>
<div class="paragraph data-line-298">
<p>Bitcoin Core offre plusieurs options de configuration qui vous permettent d&#8217;ex√©cuter un n≈ìud Bitcoin avec son trafic transport√© sur le r√©seau Tor. De plus, Bitcoin Core peut √©galement offrir un service cach√© Tor permettant √† d&#8217;autres n≈ìuds Tor de se connecter √† votre n≈ìud directement via Tor.</p>
</div>
<div class="paragraph data-line-300">
<p>√Ä partir de la version 0.12 de Bitcoin Core, un n≈ìud proposera automatiquement un service Tor cach√© s&#8217;il est capable de se connecter √† un service Tor local. Si vous avez install√© Tor et que le processus Bitcoin Core s&#8217;ex√©cute en tant qu&#8217;utilisateur disposant des autorisations ad√©quates pour acc√©der au cookie d&#8217;authentification Tor, il devrait fonctionner automatiquement. Utilisez le drapeau <code>debug</code> pour activer le d√©bogage de Bitcoin Core pour le service Tor comme ceci¬†:</p>
</div>
<div class="listingblock data-line-302">
<div class="content">
<pre>$ bitcoind --daemon --debug=tor</pre>
</div>
</div>
<div class="paragraph data-line-306">
<p>Vous devriez voir "tor: ADD_ONION successful" dans les journaux, indiquant que Bitcoin Core a ajout√© un service cach√© au r√©seau Tor.</p>
</div>
<div class="paragraph data-line-308">
<p>Vous pouvez trouver plus d&#8217;instructions sur l&#8217;ex√©cution de Bitcoin Core en tant que service cach√© de Tor dans la documentation de Bitcoin Core (<em>docs/tor.md</em>) et divers didacticiels en ligne.</p>
</div>
</div>
<div class="sect3 data-line-310">
<h4 id="_authentification_et_cryptage_pair_√†_pair">Authentification et cryptage pair √† pair</h4>
<div class="paragraph data-line-312">
<p>Deux propositions d&#8217;am√©lioration Bitcoin, BIP-150 et BIP-151, ajoutent la prise en charge de l&#8217;authentification et du cryptage P2P dans le r√©seau bitcoin P2P. Ces deux BIP d√©finissent des services optionnels pouvant √™tre propos√©s par des n≈ìuds Bitcoin compatibles. BIP-151 active le chiffrement n√©goci√© pour toutes les communications entre deux n≈ìuds qui prennent en charge BIP-151. BIP-150 offre une authentification par les pairs en option qui permet aux n≈ìuds de s&#8217;authentifier mutuellement √† l&#8217;aide d&#8217;ECDSA et des cl√©s priv√©es. BIP-150 exige qu&#8217;avant l&#8217;authentification, les deux n≈ìuds aient √©tabli des communications crypt√©es conform√©ment √† BIP-151.</p>
</div>
<div class="paragraph data-line-314">
<p>Depuis f√©vrier 2021, BIP-150 et BIP-151 ne sont pas impl√©ment√©s dans Bitcoin Core. Cependant, les deux propositions ont √©t√© mises en ≈ìuvre par au moins un client Bitcoin alternatif nomm√© bcoin.</p>
</div>
<div class="paragraph data-line-316">
<p>BIP-150 et BIP-151 permettent aux utilisateurs d&#8217;ex√©cuter des clients SPV qui se connectent √† un n≈ìud complet de confiance, en utilisant le chiffrement et l&#8217;authentification pour prot√©ger la confidentialit√© du client SPV.</p>
</div>
<div class="paragraph data-line-318">
<p>De plus, l&#8217;authentification peut √™tre utilis√©e pour cr√©er des r√©seaux de n≈ìuds Bitcoin de confiance et emp√™cher les attaques Man-in-the-Middle (entre-deux). Enfin, le cryptage P2P, s&#8217;il est d√©ploy√© √† grande √©chelle, renforcerait la r√©sistance du bitcoin √† l&#8217;analyse du trafic et √† la surveillance portant atteinte √† la vie priv√©e, en particulier dans les pays totalitaires o√π l&#8217;utilisation d&#8217;Internet est fortement contr√¥l√©e et surveill√©e.</p>
</div>
<div class="paragraph data-line-320">
<p>La norme est d√©finie dans https:/ /github.com/bitcoin/bips/blob/master/bip-0150.mediawiki[BIP-150 (authentification par les pairs)] et <a href="https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki"> BIP-151 (chiffrement des communications poste √† poste)</a>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-322">
<h3 id="_groupes_de_transactions">Groupes de transactions</h3>
<div class="paragraph data-line-324">
<p>Presque tous les n≈ìuds du r√©seau Bitcoin maintiennent une liste temporaire de transactions non confirm√©es appel√©es <em>bassin de m√©moire</em>, <em>mempool</em> ou <em>bassin de transaction</em>. Les n≈ìuds utilisent ce bassin pour suivre les transactions connues du r√©seau mais qui ne sont pas encore incluses dans la cha√Æne de blocs. Par exemple, un n≈ìud de portefeuille utilisera le bassin de transactions pour suivre les paiements entrants dans le portefeuille de l&#8217;utilisateur qui ont √©t√© re√ßus sur le r√©seau mais qui n&#8217;ont pas encore √©t√© confirm√©s.</p>
</div>
<div class="paragraph data-line-326">
<p>Au fur et √† mesure que les transactions sont re√ßues et v√©rifi√©es, elles sont ajout√©es au bassin de transactions et relay√©es aux n≈ìuds voisins pour se propager sur le r√©seau.</p>
</div>
<div class="paragraph data-line-328">
<p>Certaines impl√©mentations de n≈ìuds maintiennent √©galement un bassin s√©par√© de transactions orphelines. Si les entr√©es d&#8217;une transaction font r√©f√©rence √† une transaction qui n&#8217;est pas encore connue, comme un parent manquant, la transaction orpheline sera stock√©e temporairement dans le bassin orphelin jusqu&#8217;√† ce que la transaction parent arrive.</p>
</div>
<div class="paragraph data-line-330">
<p>Lorsqu&#8217;une transaction est ajout√©e au bassin de transactions, le bassin orphelin est v√©rifi√© pour tous les orphelins qui r√©f√©rencent les sorties de cette transaction (ses enfants). Tous les orphelins correspondants sont ensuite valid√©s. S&#8217;ils sont valides, ils sont supprim√©s du bassin orphelin et ajout√©s au bassin de transactions, compl√©tant ainsi la cha√Æne qui a commenc√© avec la transaction parent. √Ä la lumi√®re de la transaction nouvellement ajout√©e, qui n&#8217;est plus orpheline, le processus est r√©p√©t√© de mani√®re r√©cursive √† la recherche de tout autre descendant, jusqu&#8217;√† ce qu&#8217;aucun autre descendant ne soit trouv√©. Gr√¢ce √† ce processus, l&#8217;arriv√©e d&#8217;une transaction parente d√©clenche une reconstruction en cascade de toute une cha√Æne de transactions interd√©pendantes en r√©unissant les orphelins avec leurs parents tout au long de la cha√Æne.</p>
</div>
<div class="paragraph data-line-332">
<p>Le bassin de transactions et le bassin orphelin (le cas √©ch√©ant) sont stock√©s dans la m√©moire locale et ne sont pas enregistr√©s sur le stockage persistant¬†; ils sont plut√¥t renseign√©s dynamiquement √† partir des messages r√©seau entrants. Lorsqu&#8217;un n≈ìud d√©marre, les deux bassins sont vides et se remplissent progressivement avec les nouvelles transactions re√ßues sur le r√©seau.</p>
</div>
<div class="paragraph data-line-334">
<p>Certaines impl√©mentations du client Bitcoin maintiennent √©galement une base de donn√©es ou un bassin UTXO, qui est l&#8217;ensemble de toutes les sorties non d√©pens√©es sur la cha√Æne de blocs. Les utilisateurs de Bitcoin Core le trouveront dans le dossier <code>chainstate/</code> du r√©pertoire de donn√©es de leur client. Bien que le nom "bassin UTXO" ressemble au bassin de transactions, il repr√©sente un ensemble de donn√©es diff√©rent. Contrairement aux bassins de transactions et orphelins, le bassin UTXO n&#8217;est pas initialis√© vide mais contient √† la place des millions d&#8217;entr√©es de sorties de transactions non d√©pens√©es, tout ce qui n&#8217;est pas d√©pens√© depuis le bloc de gen√®se. Le bassin UTXO peut √™tre h√©berg√© dans la m√©moire locale ou sous la forme d&#8217;une table de base de donn√©es index√©e sur un stockage persistant.</p>
</div>
<div class="paragraph data-line-23">
<p>Alors que les bassins de transactions et orphelins repr√©sentent la perspective locale d&#8217;un seul n≈ìud et peuvent varier consid√©rablement d&#8217;un n≈ìud √† l&#8217;autre en fonction du moment o√π le n≈ìud a √©t√© d√©marr√© ou red√©marr√©, le bassin UTXO repr√©sente le consensus √©mergent du r√©seau et variera donc peu entre les n≈ìuds. De plus, les bassins de transactions et orphelins ne contiennent que des transactions non confirm√©es, tandis que le pool UTXO ne contient que des sorties confirm√©es.</p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="blockchain">La cha√Æne de blocs (La blockchain)</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-4">
<h3 id="_pr√©sentation_2">Pr√©sentation</h3>
<div class="paragraph data-line-6">
<p>La structure de donn√©es de la cha√Æne de blocs est une liste ordonn√©e et r√©tro-li√©e aux blocs de transactions. La cha√Æne de blocs peut √™tre stock√©e sous forme de fichier plat ou dans une simple base de donn√©es. Le client Bitcoin Core stocke les m√©tadonn√©es de la cha√Æne de blocs √† l&#8217;aide de la base de donn√©es LevelDB de Google. Les blocs sont "r√©tro-li√©s", chacun se r√©f√©rant au bloc pr√©c√©dent dans la cha√Æne. La cha√Æne de blocs est souvent visualis√©e comme une pile verticale, avec des blocs superpos√©s les uns sur les autres et le premier bloc servant de base √† la pile. La visualisation de blocs empil√©s les uns sur les autres entra√Æne l&#8217;utilisation de termes tels que "hauteur" pour d√©signer la distance par rapport au premier bloc, et "sommet" ou "pointe" pour d√©signer le bloc le plus r√©cemment ajout√©.</p>
</div>
<div class="paragraph data-line-8">
<p>Chaque bloc de la cha√Æne de blocs est identifi√© par un hachage, g√©n√©r√© √† l&#8217;aide de l&#8217;algorithme de hachage cryptographique SHA256 sur l&#8217;en-t√™te du bloc. Chaque bloc fait √©galement r√©f√©rence √† un bloc pr√©c√©dent, connu sous le nom de bloc <em>parent</em>, via le champ "hachage de bloc pr√©c√©dent" dans l&#8217;en-t√™te de bloc. En d&#8217;autres termes, chaque bloc contient le hachage de son parent dans sa propre en-t√™te. La s√©quence de hachages reliant chaque bloc √† son parent cr√©e une cha√Æne remontant jusqu&#8217;au premier bloc jamais cr√©√©, connu sous le nom de <em>bloc de gen√®se</em>.</p>
</div>
<div class="paragraph data-line-10">
<p>Bien qu&#8217;un bloc n&#8217;ait qu&#8217;un seul parent, il peut temporairement avoir plusieurs enfants. Chacun des enfants fait r√©f√©rence au m√™me bloc que son parent et contient le m√™me hachage (parent) dans le champ "hachage du bloc pr√©c√©dent". Plusieurs enfants apparaissent lors d&#8217;une "fourche" de cha√Æne de blocs, une situation temporaire qui se produit lorsque diff√©rents blocs sont d√©couverts presque simultan√©ment par diff√©rents mineurs (voir <a href="#forks">Fourches de cha√Æne de blocs</a>). Finalement, un seul bloc enfant devient une partie de la cha√Æne de blocs et la "fourche" est r√©solu. M√™me si un bloc peut avoir plusieurs enfants, chaque bloc ne peut avoir qu&#8217;un seul parent. En effet, un bloc a un seul champ "hachage de bloc pr√©c√©dent" faisant r√©f√©rence √† son parent unique.</p>
</div>
<div class="paragraph data-line-12">
<p>Le champ "hachage du bloc pr√©c√©dent" se trouve √† l&#8217;int√©rieur de l&#8217;en-t√™te du bloc et affecte ainsi le hachage du bloc <em>courant</em>. La propre identit√© de l&#8217;enfant change si l&#8217;identit√© du parent change. Lorsque le parent est modifi√© de quelque mani√®re que ce soit, le hachage du parent change. Le hachage modifi√© du parent n√©cessite une modification du pointeur "hachage de bloc pr√©c√©dent" de l&#8217;enfant. Cela entra√Æne √† son tour la modification du hachage de l&#8217;enfant, ce qui n√©cessite une modification du pointeur du petit-enfant, qui √† son tour modifie le petit-enfant, et ainsi de suite. Cet effet de cascade garantit qu&#8217;une fois qu&#8217;un bloc est suivi de plusieurs g√©n√©rations, il ne peut pas √™tre modifi√© sans forcer un recalcul de tous les blocs suivants. Parce qu&#8217;un tel recalcul n√©cessiterait un calcul √©norme (et donc une consommation d&#8217;√©nergie), l&#8217;existence d&#8217;une longue cha√Æne de blocs rend immuable l&#8217;historique profond de la cha√Æne de blocs, ce qui est une caract√©ristique cl√© de la s√©curit√© du bitcoin.</p>
</div>
<div class="paragraph data-line-14">
<p>Une fa√ßon de penser √† la cha√Æne de blocs est comme des couches dans une formation g√©ologique ou un √©chantillon de carotte de glacier. Les couches de surface peuvent changer avec les saisons, voire √™tre souffl√©es avant d&#8217;avoir le temps de s&#8217;installer. Mais d√®s que l&#8217;on descend √† quelques centim√®tres de profondeur, les couches g√©ologiques deviennent de plus en plus stables. Au moment o√π vous regardez quelques centaines de m√®tres plus bas, vous regardez un instantan√© du pass√© qui est rest√© intact pendant des millions d&#8217;ann√©es. Dans la cha√Æne de blocs, les quelques blocs les plus r√©cents peuvent √™tre r√©vis√©s s&#8217;il y a un recalcul en cha√Æne d√ª √† une fourche. Les six premiers blocs sont comme quelques centim√®tres de terre arable. Mais une fois que vous allez plus profond√©ment dans la cha√Æne de blocs, au-del√† de six blocs, les blocs sont de moins en moins susceptibles de changer. Apr√®s 100 blocs de retour, il y a tellement de stabilit√© que la transaction coinbase - la transaction contenant le bitcoin nouvellement extrait - peut √™tre d√©pens√©e. Quelques milliers de blocs en arri√®re (un mois) et la cha√Æne de blocs est une histoire √©tablie, √† toutes fins pratiques. Alors que le protocole permet toujours √† une cha√Æne d&#8217;√™tre annul√©e par une cha√Æne plus longue et alors que la possibilit√© qu&#8217;un bloc soit invers√© existe toujours, la probabilit√© d&#8217;un tel √©v√©nement diminue au fil du temps jusqu&#8217;√† ce qu&#8217;elle devienne infinit√©simale.</p>
</div>
</div>
<div class="sect2 data-line-16">
<h3 id="_structure_dun_bloc">Structure d&#8217;un bloc</h3>
<div class="paragraph data-line-18">
<p>Un bloc est une structure de donn√©es de conteneur qui agr√®ge les transactions pour les inclure dans le grand livre public, la cha√Æne de blocs. Le bloc est compos√© d&#8217;un en-t√™te, contenant des m√©tadonn√©es, suivi d&#8217;une longue liste de transactions qui constituent l&#8217;essentiel de sa taille. L&#8217;en-t√™te de bloc est de 80 octets, alors que la transaction moyenne est d&#8217;au moins 400 octets et que le bloc moyen contient plus de 1900 transactions. Un bloc complet, avec toutes les transactions, est donc 10 000 fois plus grand que l&#8217;en-t√™te du bloc. <a href="#block_structure1">La structure d&#8217;un bloc</a> d√©crit la structure d&#8217;un bloc.</p>
</div>
<table id="block_structure1" class="tableblock frame-all grid-all stretch pagebreak-before data-line-24">
<caption class="title">Table 24. La structure d&#8217;un bloc</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille de bloc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La taille du bloc, en octets, suivant ce champ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">80 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">En-t√™te de bloc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plusieurs champs forment l&#8217;en-t√™te du bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1‚Äì9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compteur de transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Combien de transactions suivent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Les transactions enregistr√©es dans ce bloc</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-33">
<h3 id="block_header">En-t√™te de bloc</h3>
<div class="paragraph data-line-35">
<p>L&#8217;en-t√™te de bloc se compose de trois ensembles de m√©tadonn√©es de bloc. Tout d&#8217;abord, il y a une r√©f√©rence √† un hachage de bloc pr√©c√©dent, qui connecte ce bloc au bloc pr√©c√©dent dans la cha√Æne de blocs. Le deuxi√®me ensemble de m√©tadonn√©es, √† savoir <em>difficulty</em>, <em>timestamp</em> et <em>nonce</em>, concerne la concurrence mini√®re, comme d√©taill√© dans <a href="#mining">Minage et Consensus</a>. La troisi√®me m√©tadonn√©e est la racine de l&#8217;arbre Merkle, une structure de donn√©es utilis√©e pour r√©sumer efficacement toutes les transactions du bloc. <a href="#block_header_structure_ch09">La structure de l&#8217;ent√™te du bloc</a> d√©crit la structure d&#8217;un en-t√™te de bloc.</p>
</div>
<table id="block_header_structure_ch09" class="tableblock frame-all grid-all stretch data-line-41">
<caption class="title">Table 25. La structure de l&#8217;ent√™te du bloc</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un num√©ro de version pour suivre les mises √† niveau du logiciel/protocole</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de bloc pr√©c√©dent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Une r√©f√©rence au hachage du bloc pr√©c√©dent (parent) dans la cha√Æne</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Racine de Merkle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un hachage de la racine de l&#8217;arbre Merkle des transactions de ce bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Horodatage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le temps de cr√©ation approximatif de ce bloc (en secondes √©coul√©es depuis Unix Epoch)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cible de difficult√©</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La cible de difficult√© de l&#8217;algorithme Proof-of-Work (ou Preuve de travail) pour ce bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un compteur utilis√© pour l&#8217;algorithme de preuve de travail</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-51">
<p>Le nonce, la cible de difficult√© et l&#8217;horodatage sont utilis√©s dans le processus d&#8217;extraction et seront discut√©s plus en d√©tail dans <a href="#mining">Minage et Consensus</a>.</p>
</div>
</div>
<div class="sect2 data-line-54">
<h3 id="block_hash">Identificateurs de bloc¬†: hachage d&#8217;en-t√™te de bloc et hauteur de bloc</h3>
<div class="paragraph data-line-56">
<p>L&#8217;identifiant primaire d&#8217;un bloc est son hachage cryptographique, une empreinte digitale, r√©alis√©e en hachant deux fois l&#8217;en-t√™te du bloc via l&#8217;algorithme SHA256. Le hachage de 32¬†octets r√©sultant est appel√© <em>hachage de bloc</em> mais est plus pr√©cis√©ment le <em>hachage d&#8217;en-t√™te de bloc</em>, <span role="keep-together">car seul l'en-t√™te de bloc est utilis√© pour le calculer. Par exemple,</span> <code>000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</code> est le hachage de bloc du premier bloc bitcoin jamais cr√©√©. Le hachage de bloc identifie un bloc de mani√®re unique et sans ambigu√Øt√© et peut √™tre d√©riv√© ind√©pendamment par n&#8217;importe quel n≈ìud en double hachant simplement l&#8217;en-t√™te de bloc avec l&#8217;algorithme SHA256.</p>
</div>
<div class="paragraph data-line-58">
<p>Notez que le hachage de bloc n&#8217;est pas r√©ellement inclus dans la structure de donn√©es du bloc, ni lorsque le bloc est transmis sur le r√©seau, ni lorsqu&#8217;il est stock√© sur le stockage de persistance d&#8217;un n≈ìud dans le cadre de la cha√Æne de blocs. Au lieu de cela, le hachage du bloc est calcul√© par chaque n≈ìud lorsque le bloc est re√ßu du r√©seau. Le hachage de bloc peut √™tre stock√© dans une table de base de donn√©es distincte dans le cadre des m√©tadonn√©es du bloc, pour faciliter l&#8217;indexation et une r√©cup√©ration plus rapide des blocs √† partir du disque.</p>
</div>
<div class="paragraph data-line-60">
<p>Une deuxi√®me fa√ßon d&#8217;identifier un bloc est par sa position dans la cha√Æne de blocs, appel√©e le <span role="keep-together"><em>hauteur de bloc</em>. Le premier bloc jamais cr√©√© est √† la hauteur de bloc 0 (z√©ro) et est le</span> <span role="keep-together">m√™me bloc qui √©tait pr√©c√©demment r√©f√©renc√© par le hachage de bloc suivant</span> <code>000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</code>. Un bloc peut ainsi √™tre identifi√© de deux mani√®res¬†: en r√©f√©ren√ßant le hachage du bloc ou en r√©f√©ren√ßant la hauteur du bloc. Chaque bloc suivant ajout√© "au-dessus" de ce premier bloc est une position "plus √©lev√©e" dans la cha√Æne de blocs, comme des bo√Ætes empil√©es les unes sur les autres.</p>
</div>
<div class="paragraph data-line-62">
<p>De plus, le terme <em>hauteur de bloc actuelle</em> indique la taille de la cha√Æne de blocs en blocs √† un moment donn√©. Par exemple, la hauteur actuelle du bloc au 1er mars 2021 √©tait d&#8217;environ 672 722, ce qui signifie qu&#8217;il y avait 672 722 blocs empil√©s au-dessus du premier bloc cr√©√© en janvier 2009.</p>
</div>
<div class="paragraph data-line-64">
<p>Contrairement au hachage de bloc, la hauteur de bloc n&#8217;est pas un identifiant unique. Bien qu&#8217;un seul bloc ait toujours une hauteur de bloc sp√©cifique et invariante, l&#8217;inverse n&#8217;est pas vrai¬†: la hauteur de bloc n&#8217;identifie pas toujours un seul bloc. Deux ou plusieurs blocs peuvent avoir la m√™me hauteur de bloc, en concurrence pour la m√™me position dans la cha√Æne de blocs. Ce sc√©nario est d√©crit en d√©tail dans la section <a href="#forks">Fourches de cha√Æne de blocs</a>. La hauteur de bloc ne fait pas non plus partie de la structure de donn√©es du bloc¬†; il n&#8217;est pas stock√© dans le bloc. Chaque n≈ìud identifie dynamiquement la position (hauteur) d&#8217;un bloc dans la cha√Æne de blocs lorsqu&#8217;il est re√ßu du r√©seau Bitcoin. La hauteur de bloc peut √©galement √™tre stock√©e sous forme de m√©tadonn√©es dans une table de base de donn√©es index√©e pour une r√©cup√©ration plus rapide.</p>
</div>
<div class="admonitionblock tip data-line-67">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-68">
<p>Le <em>hachage de bloc</em> d&#8217;un bloc identifie toujours un seul bloc de mani√®re unique. Un bloc a √©galement toujours une <em>hauteur de bloc</em> sp√©cifique. Cependant, il n&#8217;est pas toujours vrai qu&#8217;une hauteur de bloc sp√©cifique puisse identifier un seul bloc. Au contraire, deux blocs ou plus pourraient se disputer une seule position dans la cha√Æne de blocs.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 data-line-71">
<h3 id="_le_bloc_dorigine_ou_de_gen√®se">Le bloc d&#8217;origine (ou de gen√®se)</h3>
<div class="paragraph data-line-73">
<p> Le premier bloc de la cha√Æne de blocs est appel√© le bloc d&#8217;origine (ou de gen√®se) et a √©t√© cr√©√© en 2009. Il est l&#8217;anc√™tre commun de tous les blocs de la cha√Æne de blocs, ce qui signifie que si vous commencez √† n&#8217;importe quel bloc et suivez la cha√Æne en arri√®re dans le temps, vous finirez par arriver au bloc de gen√®se.</p>
</div>
<div class="paragraph data-line-75">
<p>Chaque n≈ìud commence toujours par une cha√Æne de blocs d&#8217;au moins un bloc car le bloc de gen√®se est encod√© de mani√®re statique dans le logiciel client Bitcoin, de sorte qu&#8217;il ne peut pas √™tre modifi√©. Chaque n≈ìud "conna√Æt" toujours le hachage et la structure du bloc de gen√®se, l&#8217;heure fixe √† laquelle il a √©t√© cr√©√© et m√™me la transaction unique qu&#8217;il contient. Ainsi, chaque n≈ìud a le point de d√©part de la cha√Æne de blocs, une "racine" s√©curis√©e √† partir de laquelle construire une cha√Æne de blocs de confiance.</p>
</div>
<div class="paragraph data-line-77">
<p>Voir le bloc de gen√®se encod√© statiquement √† l&#8217;int√©rieur du client Bitcoin Core, dans <a href="https://bit.ly/1x6rcwP" data-href="https://bit.ly/1x6rcwP"><em>chainparams.cpp</em></a>.</p>
</div>
<div class="paragraph data-line-79">
<p>Le hachage d&#8217;identifiant suivant appartient au bloc genesis¬†:</p>
</div>
<div class="listingblock data-line-81">
<div class="content">
<pre>000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</pre>
</div>
</div>
<div class="paragraph data-line-85">
<p>Vous pouvez rechercher ce hachage de bloc sur n&#8217;importe quel site web d&#8217;explorateur de blocs, tel que <em>Blockchain.com</em>, et vous trouverez une page d√©crivant le contenu de ce bloc, avec une URL contenant ce hachage¬†:</p>
</div>
<div class="paragraph data-line-87">
<p><a href="https://www.blockchain.com/btc/block/000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f" class="undefined" data-href="https://www.blockchain.com/btc/block/000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f">https://www.blockchain.com/btc/block/000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</a></p>
</div>
<div class="paragraph data-line-89">
<p>Utilisation du client de r√©f√©rence Bitcoin Core sur la ligne de commande¬†:</p>
</div>
<div class="listingblock data-line-91">
<div class="content">
<pre>$ bitcoin-cli getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</pre>
</div>
</div>
<div class="listingblock data-line-95">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "hash" : "000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f",
    "confirmations" : 308321,
    "size" : 285,
    "height" : 0,
    "version" : 1,
    "merkleroot" : "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",
    "tx" : [
        "4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b"
    ],
    "time" : 1231006505,
    "nonce" : 2083236893,
    "bits" : "1d00ffff",
    "difficulty" : 1.00000000,
    "nextblockhash" : "00000000839a8e6886ab5951d76f411475428afc90947ee320161bbf18eb6048"
}</code></pre>
</div>
</div>
<div class="paragraph data-line-114">
<p>Le bloc de gen√®se contient un message cach√© en son sein. L&#8217;entr√©e de transaction coinbase contient le texte "The Times 03/Jan/2009 Chancellor on brink of second bailout for banks.". Ce message √©tait destin√© √† offrir une preuve de la date la plus ancienne de cr√©ation de ce bloc, en faisant r√©f√©rence au titre du journal britannique <em>The Times</em>. Il sert √©galement de rappel ironique de l&#8217;importance d&#8217;un syst√®me mon√©taire ind√©pendant, le lancement du bitcoin se produisant en m√™me temps qu&#8217;une crise mon√©taire mondiale sans pr√©c√©dent. Le message a √©t√© int√©gr√© dans le premier bloc par Satoshi Nakamoto, le cr√©ateur de Bitcoin.</p>
</div>
</div>
<div class="sect2 data-line-116">
<h3 id="_relier_les_blocs_dans_la_cha√Æne_de_blocs">Relier les blocs dans la cha√Æne de blocs</h3>
<div class="paragraph data-line-118">
<p>Les n≈ìuds complets Bitcoin conservent une copie locale de la cha√Æne de blocs, √† partir du bloc de gen√®se. La copie locale de la cha√Æne de blocs est constamment mise √† jour au fur et √† mesure que de nouveaux blocs sont trouv√©s et utilis√©s pour √©tendre la cha√Æne. Lorsqu&#8217;un n≈ìud re√ßoit des blocs entrants du r√©seau, il validera ces blocs, puis les reliera √† la cha√Æne de blocs existante. Pour √©tablir un lien, un n≈ìud examinera l&#8217;en-t√™te de bloc entrant et recherchera le "hachage de bloc pr√©c√©dent".</p>
</div>
<div class="paragraph data-line-120">
<p>Supposons, par exemple, qu&#8217;un n≈ìud ait 277 314 blocs dans la copie locale de la cha√Æne de blocs. Le dernier bloc dont le n≈ìud a connaissance est le bloc 277¬†314, avec un hachage d&#8217;en-t√™te de bloc¬†:</p>
</div>
<div class="listingblock data-line-122">
<div class="content">
<pre>00000000000000027e7ba6fe7bad39faf3b5a83daed765f05f7d1b71a1632249</pre>
</div>
</div>
<div class="paragraph data-line-126">
<p>Le n≈ìud Bitcoin re√ßoit alors un nouveau bloc du r√©seau, qu&#8217;il analyse comme suit :</p>
</div>
<div class="listingblock data-line-129">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "size" : 43560,
    "version" : 2,
    "previousblockhash" :
        "00000000000000027e7ba6fe7bad39faf3b5a83daed765f05f7d1b71a1632249",
    "merkleroot" :
        "5e049f4030e0ab2debb92378f53c0a6e09548aea083f3ab25e1d94ea1155e29d",
    "time" : 1388185038,
    "difficulty" : 1180923195.25802612,
    "nonce" : 4215469401,
    "tx" : [
        "257e7497fb8bc68421eb2c7b699dbab234831600e7352f0d9e6522c7cf3f6c77",

 #[... beaucoup plus de transactions omises ...]

        "05cfd38f6ae6aa83674cc99e4d75a1458c165b7ab84725eda41d018a09176634"
    ]
}</code></pre>
</div>
</div>
<div class="paragraph data-line-150">
<p>En regardant ce nouveau bloc, le n≈ìud trouve le champ <code>previousblockhash</code>, qui contient le hachage de son bloc parent. Il s&#8217;agit d&#8217;un hachage connu du n≈ìud, celui du dernier bloc de la cha√Æne √† la hauteur 277,314. Par cons√©quent, ce nouveau bloc est un enfant du dernier bloc de la cha√Æne et √©tend la cha√Æne de blocs existante. Le n≈ìud ajoute ce nouveau bloc √† la fin de la cha√Æne, rendant la cha√Æne de blocs plus longue avec une nouvelle hauteur de 277 315. <a href="#chain_of_blocks">Blocs li√©s dans une cha√Æne par r√©f√©rence au hachage d&#8217;en-t√™te de bloc pr√©c√©dent</a> montre la cha√Æne de trois blocs, li√©s par des r√©f√©rences dans le champ <code>previousblockhash</code>.</p>
</div>
</div>
<div class="sect2 data-line-154">
<h3 id="merkle_trees">Arbres de Merkle</h3>
<div class="paragraph data-line-156">
<p>Chaque bloc de la cha√Æne de blocs Bitcoin contient un r√©sum√© de tous les transactions dans le bloc √† l&#8217;aide d&#8217;un <em>arbre de Merkle</em>.</p>
</div>
<div class="paragraph data-line-158">
<p>Un <em>arbre de Merkle</em>, √©galement appel√© <em>arbre de hachage binaire</em>, est une structure de donn√©es utilis√©e pour r√©sumer et v√©rifier efficacement l&#8217;int√©grit√© de grands ensembles de donn√©es. Les arbres de Merkle sont des arbres binaires contenant des hachages cryptographiques. Le terme "arbre" est utilis√© en informatique pour d√©crire une structure de donn√©es ramifi√©e, mais ces arbres sont g√©n√©ralement affich√©s √† l&#8217;envers avec la "racine" en haut et les "feuilles" en bas d&#8217;un diagramme, comme vous le verrez dans les exemples qui suivent.</p>
</div>
<div id="chain_of_blocks" class="imageblock smallerfourtyfive data-line-163">
<div class="content">
<img src="images/mbc2_0901.png" alt="mbc2 0901">
</div>
<div class="title">Figure 58. Blocs li√©s dans une cha√Æne par r√©f√©rence au hachage d&#8217;en-t√™te de bloc pr√©c√©dent</div>
</div>
<div class="paragraph data-line-165">
<p>Les arbres de Merkle sont utilis√©s dans Bitcoin pour r√©sumer toutes les transactions d&#8217;un bloc, produisant une empreinte num√©rique globale de l&#8217;ensemble des transactions, fournissant un processus tr√®s efficace pour v√©rifier si une transaction est incluse dans un bloc. Un arbre Merkle est construit en hachant r√©cursivement des paires de n≈ìuds jusqu&#8217;√† ce qu&#8217;il n&#8217;y ait qu&#8217;un seul hachage, appel√© <em>racine</em>, ou <em>racine de Merkle</em>. L&#8217;algorithme de hachage cryptographique utilis√© dans les arbres de Merkle de Bitcoin est SHA256 appliqu√© deux fois, √©galement connu sous le nom de double-SHA256.</p>
</div>
<div class="paragraph data-line-167">
<p>Lorsque N √©l√©ments de donn√©es sont hach√©s et r√©sum√©s dans un arbre de Merkle, vous pouvez v√©rifier si un √©l√©ment de donn√©es est inclus dans l&#8217;arbre avec au plus <code>2*log<sub>2</sub>(N)</code> calculs, ce qui en fait une donn√©e tr√®s efficace structure.</p>
</div>
<div class="paragraph data-line-169">
<p>L&#8217;arbre de Merkle est construit de bas en haut. Dans l&#8217;exemple suivant, nous commen√ßons avec quatre transactions, A, B, C et D, qui forment les <em>feuilles</em> de l&#8217;arbre de Merkle, comme indiqu√© dans <a href="#simple_merkle">Calcul des n≈ìuds dans un arbre de Merkle</a>. Les transactions ne sont pas stock√©es dans l&#8217;arborescence de Merkle ; √† la place, leurs donn√©es sont hach√©es et le hachage r√©sultant est stock√© dans chaque n≈ìud feuille sous la forme H<sub>A</sub>, H<sub>B</sub>, H<sub>C</sub> et H<sub>D</sub>¬†:</p>
</div>
<div class="listingblock data-line-171">
<div class="content">
<pre>H&lt;sub&gt;A&lt;/sub&gt; = SHA256(SHA256(Transaction A))</pre>
</div>
</div>
<div class="paragraph data-line-175">
<p>Des paires cons√©cutives de n≈ìuds feuilles sont ensuite r√©sum√©es dans un n≈ìud parent, en concat√©nant les deux hachages et en les hachant ensemble. Par exemple, pour construire le n≈ìud parent H<sub>AB</sub>, les deux hachages de 32¬†octets des enfants sont concat√©n√©s pour cr√©er une cha√Æne de 64¬†octets. Cette cha√Æne est ensuite doublement hach√©e pour produire le hachage du n≈ìud parent¬†:</p>
</div>
<div class="listingblock data-line-177">
<div class="content">
<pre>H&lt;sub&gt;AB&lt;/sub&gt; = SHA256(SHA256(H&lt;sub&gt;A&lt;/sub&gt; + H&lt;sub&gt;B&lt;/sub&gt;))</pre>
</div>
</div>
<div class="paragraph data-line-181">
<p>Le processus se poursuit jusqu&#8217;√† ce qu&#8217;il n&#8217;y ait qu&#8217;un seul n≈ìud au sommet, le n≈ìud connu sous le nom de racine de Merkle. Ce hachage de 32 octets est stock√© dans l&#8217;en-t√™te du bloc et r√©sume toutes les donn√©es des quatre transactions. <a href="#simple_merkle">Calcul des n≈ìuds dans un arbre de Merkle</a> montre comment la racine est calcul√©e par hachages par paires des n≈ìuds.</p>
</div>
<div id="simple_merkle" class="imageblock data-line-185">
<div class="content">
<img src="images/mbc2_0902.png" alt="Arbre de Merkle">
</div>
<div class="title">Figure 59. Calcul des n≈ìuds dans un arbre de Merkle</div>
</div>
<div class="paragraph data-line-187">
<p>Parce que l&#8217;arbre de Merkle est un arbre binaire, il a besoin d&#8217;un nombre pair de n≈ìuds feuilles. S&#8217;il y a un nombre impair de transactions √† r√©sumer, le dernier hachage de transaction sera dupliqu√© pour cr√©er un nombre pair de n≈ìuds feuilles, √©galement appel√©s <em>arbre √©quilibr√©</em>. Ceci est montr√© dans <a href="#merkle_tree_odd">La duplication d&#8217;un √©l√©ment de donn√©es permet d&#8217;obtenir un nombre pair d&#8217;√©l√©ments de donn√©es</a>, o√π la transaction C est dupliqu√©e.</p>
</div>
<div id="merkle_tree_odd" class="imageblock data-line-191">
<div class="content">
<img src="images/mbc2_0903.png" alt="Arbre de Merkle impair">
</div>
<div class="title">Figure 60. La duplication d&#8217;un √©l√©ment de donn√©es permet d&#8217;obtenir un nombre pair d&#8217;√©l√©ments de donn√©es</div>
</div>
<div class="paragraph data-line-193">
<p>La m√™me m√©thode de construction d&#8217;un arbre √† partir de quatre transactions peut √™tre g√©n√©ralis√©e pour construire des arbres de n&#8217;importe quelle taille. Dans le Bitcoin, il est courant d&#8217;avoir plusieurs centaines √† plus d&#8217;un millier de transactions dans un seul bloc, qui sont r√©sum√©es exactement de la m√™me mani√®re, produisant seulement 32 octets de donn√©es en tant que racine de Merkle unique. Dans <a href="#merkle_tree_large">Un arbre Merkle r√©sumant de nombreux √©l√©ments de donn√©es</a>, vous verrez un arbre construit √† partir de 16 transactions. Notez que bien que la racine semble plus grande que les n≈ìuds feuilles dans le diagramme, elle a exactement la m√™me taille, seulement 32 octets. Qu&#8217;il y ait une transaction ou cent mille transactions dans le bloc, la racine de Merkle les r√©sume toujours en 32 octets.</p>
</div>
<div class="paragraph data-line-195">
<p>Pour prouver qu&#8217;une transaction sp√©cifique est incluse dans un bloc, un n≈ìud n&#8217;a besoin que de produire <code>log<sub>2</sub>(N)</code> hachages de 32¬†octets, constituant un <em>chemin d&#8217;authentification</em> ou <em>chemin de Merkle</em> se connectant la transaction sp√©cifique √† la racine de l&#8217;arborescence. Ceci est particuli√®rement important lorsque le nombre de transactions augmente, car le logarithme en base 2 du nombre de transactions augmente beaucoup plus lentement. Cela permet aux n≈ìuds Bitcoin de produire efficacement des chemins de 10 ou 12 hachages (320 √† 384 octets), qui peuvent fournir la preuve d&#8217;une seule transaction parmi plus de mille transactions dans un bloc de la taille d&#8217;un m√©gaoctet.</p>
</div>
<div id="merkle_tree_large" class="imageblock data-line-199">
<div class="content">
<img src="images/mbc2_0904.png" alt="Grand arbre de Merkle">
</div>
<div class="title">Figure 61. Un arbre Merkle r√©sumant de nombreux √©l√©ments de donn√©es</div>
</div>
<div class="paragraph data-line-201">
<p>Dans <a href="#merkle_tree_path">Un chemin (ou trajet) de Merkle utilis√© pour prouver l&#8217;inclusion d&#8217;un √©l√©ment de donn√©es</a>, un n≈ìud peut prouver qu&#8217;une transaction K est incluse dans le bloc en produisant un chemin de Merkle qui ne fait que quatre hachages de 32 octets (128 octets au total). Le chemin se compose des quatre hachages (affich√©s avec un arri√®re-plan ombr√© dans <a href="#merkle_tree_path">Un chemin (ou trajet) de Merkle utilis√© pour prouver l&#8217;inclusion d&#8217;un √©l√©ment de donn√©es</a>) H<sub>L</sub>, H<sub>IJ</sub>, H<sub>MNOP</sub> et H<sub>ABCDEFGH</sub>. Avec ces quatre hachages fournis comme chemin d&#8217;authentification, n&#8217;importe quel n≈ìud peut prouver que H<sub>K</sub> (avec un fond noir au bas du diagramme) est inclus dans la racine de Merkle en calculant quatre hachages suppl√©mentaires par paires H<sub>KL</sub>, H<sub>IJKL</sub>, H<sub>IJKLMNOP</sub> et la racine de l&#8217;arbre de Merkle (indiqu√©e par une ligne pointill√©e dans le diagramme).</p>
</div>
<div id="merkle_tree_path" class="imageblock data-line-205">
<div class="content">
<img src="images/mbc2_0905.png" alt="Chemin d&#8217;arbre de Merkle">
</div>
<div class="title">Figure 62. Un chemin (ou trajet) de Merkle utilis√© pour prouver l&#8217;inclusion d&#8217;un √©l√©ment de donn√©es</div>
</div>
<div class="paragraph data-line-208">
<p>Le code dans <a href="#merkle_example">Construire un arbre de Merkle</a> illustre le processus de cr√©ation d&#8217;un arbre de Merkle depuis les hachages de n≈ìud feuille jusqu&#8217;√† la racine, en utilisant la biblioth√®que libbitcoin pour certaines fonctions d&#8217;assistance.</p>
</div>
<div id="merkle_example" class="exampleblock pagebreak-before data-line-213">
<div class="title">Example 20. Construire un arbre de Merkle</div>
<div class="content">
<div class="listingblock data-line-215">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;bitcoin/bitcoin.hpp&gt;

bc::hash_digest create_merkle(bc::hash_list&amp; merkle)
{
    // Arr√™te si la liste de hachage est vide.
    if (merkle.empty())
        return bc::null_hash;
    else if (merkle.size() == 1)
        return merkle[0];

    // Tant qu'il y a plus d'un hachage dans la liste, continuez √† boucler...
    while (merkle.size() &gt; 1)
    {
        // Si le nombre de hachages est impair, dupliquez le dernier hachage de la liste.
        if (merkle.size() % 2 != 0)
            merkle.push_back(merkle.back());
        // La taille de la liste est d√©sormais √©gale.
        assert(merkle.size() % 2 == 0);

        // Nouvelle liste de hachage.
        bc::hash_list new_merkle;
        // Parcourez les hachages 2 √† la fois.
        for (auto it = merkle.begin(); it != merkle.end(); it += 2)
        {
            // Joindre les deux hachages actuels ensemble (concat√©ner).
            bc::data_chunk concat_data(bc::hash_size * 2);
            auto concat = bc::serializer&lt;
                decltype(concat_data.begin())&gt;(concat_data.begin());
            concat.write_hash(*it);
            concat.write_hash(*(it + 1));
            // Hachez les deux hachages.
            bc::hash_digest new_root = bc::bitcoin_hash(concat_data);
            // Ajoutez ceci √† la nouvelle liste.
            new_merkle.push_back(new_root);
        }
        // C'est la nouvelle liste.
        merkle = new_merkle;

        // DEBUG output -------------------------------------
        std::cout &lt;&lt; "Current merkle hash list:" &lt;&lt; std::endl;
        for (const auto&amp; hash: merkle)
            std::cout &lt;&lt; "  " &lt;&lt; bc::encode_base16(hash) &lt;&lt; std::endl;
        std::cout &lt;&lt; std::endl;
        // --------------------------------------------------
    }
    // Finalement, nous nous retrouvons avec un seul √©l√©ment.
    return merkle[0];
}

int main()
{
    // Remplacez ces hachages par ceux d'un bloc pour reproduire la m√™me racine merkle.
    bc::hash_list tx_hashes{{
        bc::hash_literal("0000000000000000000000000000000000000000000000000000000000000000"),
        bc::hash_literal("0000000000000000000000000000000000000000000000000000000000000011"),
        bc::hash_literal("0000000000000000000000000000000000000000000000000000000000000022"),
    }};
    const bc::hash_digest merkle_root = create_merkle(tx_hashes);
    std::cout &lt;&lt; "Result: " &lt;&lt; bc::encode_base16(merkle_root) &lt;&lt; std::endl;
    return 0;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-220">
<p><a href="#merkle_example_run">Compilation et ex√©cution de l&#8217;exemple de code de Merkle</a> montre le r√©sultat de la compilation et de l&#8217;ex√©cution du code de Merkle.</p>
</div>
<div id="merkle_example_run" class="exampleblock data-line-224">
<div class="title">Example 21. Compilation et ex√©cution de l&#8217;exemple de code de Merkle</div>
<div class="content">
<div class="listingblock data-line-226">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Compiler le code merkle.cpp
$ g++ -o merkle merkle.cpp $(pkg-config --cflags --libs libbitcoin)
# Ex√©cutez l'ex√©cutable merkle
$ ./merkle
Liste de hachage Merkle actuelle¬†:
  32650049a0418e4380db0af81788635d8b65424d397170b8499cdc28c4d27006
  30861db96905c8dc8b99398ca1cd5bd5b84ac3264a4e1b3e65afa1bcee7540c4

Liste de hachage Merkle actuelle¬†:
  d47780c084bad3830bcdaf6eace035e4c6cbf646d103795d22104fb105014ba3

Result: d47780c084bad3830bcdaf6eace035e4c6cbf646d103795d22104fb105014ba3</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-243">
<p>L&#8217;efficacit√© des arbres de Merkle devient √©vidente √† mesure que l&#8217;√©chelle augmente. <a href="#block_structure2">Efficacit√© de l&#8217;arbre de Merkle</a> montre la quantit√© de donn√©es qui doit √™tre √©chang√©e sous forme de chemin de Merkle pour prouver qu&#8217;une transaction fait partie d&#8217;un bloc.</p>
</div>
<table id="block_structure2" class="tableblock frame-all grid-all stretch data-line-248">
<caption class="title">Table 26. Efficacit√© de l&#8217;arbre de Merkle</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nombre de transactions</th>
<th class="tableblock halign-left valign-top">Environ. taille du bloc</th>
<th class="tableblock halign-left valign-top">Taille du chemin (hachages)</th>
<th class="tableblock halign-left valign-top">Taille du chemin (octets)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 op√©rations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 kilo-octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 hachages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128 octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">512 op√©rations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128 kilo-octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9 hachages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">288 octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2048 op√©rations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512 kilo-octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11 hachages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">352 octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">65 535 op√©rations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 m√©gaoctets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 hachages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512 octets</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-256">
<p>Comme vous pouvez le voir dans le tableau, alors que la taille de bloc augmente rapidement, de 4¬†Ko avec 16¬†transactions √† une taille de bloc de 16¬†Mo pour 65¬†535¬†transactions, le chemin de Merkle requis pour prouver l&#8217;inclusion d&#8217;une transaction augmente beaucoup plus lentement, de 128 octets √† seulement 512 octets. Avec les arbres de Merkle, un n≈ìud peut t√©l√©charger uniquement les en-t√™tes de bloc (80 octets par bloc) et √™tre toujours en mesure d&#8217;identifier l&#8217;inclusion d&#8217;une transaction dans un bloc en r√©cup√©rant un petit chemin Merkle √† partir d&#8217;un n≈ìud complet, sans stocker ni transmettre la grande majorit√© des cha√Ænes de blocs, qui peut avoir une taille de plusieurs gigaoctets. Les n≈ìuds qui ne maintiennent pas une cha√Æne de blocs compl√®te, appel√©s n≈ìuds de v√©rification simplifi√©e des paiements (SPV), utilisent des chemins de Merkle pour v√©rifier les transactions sans t√©l√©charger des blocs complets.</p>
</div>
</div>
<div class="sect2 data-line-258">
<h3 id="_arbres_de_merkle_et_v√©rification_simplifi√©e_des_paiements_spv">Arbres de Merkle et v√©rification simplifi√©e des paiements (SPV)</h3>
<div class="paragraph data-line-260">
<p>Les arbres Merkle sont largement utilis√©s par les n≈ìuds SPV. Les n≈ìuds SPV n&#8217;ont pas toutes les transactions et ne t√©l√©chargent pas les blocs complets, juste les en-t√™tes de bloc. Afin de v√©rifier qu&#8217;une transaction est incluse dans un bloc, sans avoir √† t√©l√©charger toutes les transactions du bloc, ils utilisent un chemin d&#8217;authentification, ou chemin de Merkle.</p>
</div>
<div class="paragraph data-line-262">
<p>Consid√©rons, par exemple, un n≈ìud SPV qui est int√©ress√© par les paiements entrants √† une adresse contenue dans son portefeuille. Le n≈ìud SPV √©tablira un filtre de Bloom (voir <a href="#bloom_filters">Filtres de Bloom</a>) sur ses connexions √† des pairs pour limiter les transactions re√ßues uniquement √† celles contenant des adresses d&#8217;int√©r√™t. Lorsqu&#8217;un pair voit une transaction qui correspond au filtre de Bloom, il enverra ce bloc √† l&#8217;aide d&#8217;un message <code>merkleblock</code>. Le message <code>merkleblock</code> contient l&#8217;en-t√™te du bloc ainsi qu&#8217;un chemin de Merkle qui relie la transaction d&#8217;int√©r√™t √† la racine de Merkle dans le bloc. Le n≈ìud SPV peut utiliser ce chemin de Merkle pour connecter la transaction au bloc et v√©rifier que la transaction est incluse dans le bloc. Le n≈ìud SPV utilise √©galement l&#8217;en-t√™te de bloc pour lier le bloc au reste de la cha√Æne de blocs. La combinaison de ces deux liens, entre la transaction et le bloc, et entre le bloc et la cha√Æne de blocs, prouve que la transaction est enregistr√©e dans la cha√Æne de blocs. Au total, le n≈ìud SPV aura re√ßu moins d&#8217;un kilo-octet de donn√©es pour l&#8217;en-t√™te de bloc et le chemin de Merkle, une quantit√© de donn√©es plus de mille fois inf√©rieure √† un bloc complet (environ 1 m√©gaoctet actuellement).</p>
</div>
</div>
<div class="sect2 data-line-264">
<h3 id="_cha√Ænes_de_blocs_de_test_de_bitcoin">Cha√Ænes de blocs de test de Bitcoin</h3>
<div class="paragraph data-line-266">
<p>Vous pourriez √™tre surpris d&#8217;apprendre qu&#8217;il existe plus d&#8217;une cha√Æne de blocs Bitcoin. La cha√Æne de blocs Bitcoin "principale", celle cr√©√©e par Satoshi Nakamoto le 3 janvier 2009, celle avec le bloc de gen√®se que nous avons √©tudi√© dans ce chapitre, s&#8217;appelle <em>mainnet</em>. Il existe d&#8217;autres cha√Ænes de blocs Bitcoin qui sont utilis√©es √† des fins de test¬†: actuellement <em>testnet</em>, <em>segnet</em> et <em>regtest</em>. Regardons chacun √† son tour.</p>
</div>
<div class="sect3 data-line-269">
<h4 id="_testnet_le_terrain_de_test_de_bitcoin">Testnet¬†: Le terrain de test de Bitcoin</h4>
<div class="paragraph data-line-271">
<p>Testnet est le nom de la cha√Æne de blocs, du r√©seau et de la devise de test utilis√©s √† des fins de test. Le testnet est un r√©seau P2P en direct complet, avec des portefeuilles, des bitcoins de test (pi√®ces de testnet), l&#8217;exploitation mini√®re et toutes les autres fonctionnalit√©s du r√©seau principal. Il n&#8217;y a vraiment que deux diff√©rences¬†: les pi√®ces testnet sont cens√©es √™tre sans valeur et la difficult√© d&#8217;extraction doit √™tre suffisamment faible pour que n&#8217;importe qui puisse extraire des pi√®ces testnet relativement facilement (en les gardant sans valeur).</p>
</div>
<div class="paragraph data-line-273">
<p>Tout d√©veloppement logiciel destin√© √† une utilisation en production sur le r√©seau principal de Bitcoin doit d&#8217;abord √™tre test√© sur testnet avec des pi√®ces de test. Cela prot√®ge √† la fois les d√©veloppeurs des pertes financi√®res dues aux bogues et le r√©seau des comportements involontaires dus aux bogues.</p>
</div>
<div class="paragraph data-line-275">
<p>Garder les pi√®ces sans valeur et l&#8217;exploitation mini√®re facile, cependant, n&#8217;est pas facile. Malgr√© les appels des d√©veloppeurs, certaines personnes utilisent des √©quipements de minage avanc√©s (GPU et ASIC) pour miner sur testnet. Cela augmente la difficult√©, rend impossible l&#8217;extraction avec un processeur et rend finalement assez difficile l&#8217;obtention de pi√®ces de test pour que les gens commencent √† les √©valuer, de sorte qu&#8217;elles ne sont pas sans valeur. En cons√©quence, de temps en temps, le testnet doit √™tre supprim√© et red√©marr√© √† partir d&#8217;un nouveau bloc de gen√®se, r√©initialisant la difficult√©.</p>
</div>
<div class="paragraph data-line-277">
<p>Le testnet actuel s&#8217;appelle <em>testnet3</em>, la troisi√®me it√©ration de testnet, red√©marr√© en f√©vrier 2011 pour r√©initialiser la difficult√© du testnet pr√©c√©dent.</p>
</div>
<div class="paragraph data-line-279">
<p>Gardez √† l&#8217;esprit que testnet3 est une grande cha√Æne de blocs, d√©passant 25 Go en 2021. Il faudra environ un jour pour se synchroniser compl√®tement et utiliser les ressources de votre ordinateur. Pas autant que le r√©seau principal, mais pas exactement "l√©ger" non plus. Une bonne fa√ßon d&#8217;ex√©cuter un n≈ìud testnet est d&#8217;utiliser une image de machine virtuelle (par exemple, VirtualBox, Docker, Cloud Server, etc.) d√©di√©e √† cet effet.</p>
</div>
<div class="sect4 data-line-281">
<h5 id="_utiliser_testnet">Utiliser testnet</h5>
<div class="paragraph data-line-283">
<p>Bitcoin Core, comme presque tous les autres logiciels bitcoin, prend enti√®rement en charge le fonctionnement sur testnet au lieu du r√©seau principal. Toutes les fonctions de Bitcoin Core fonctionnent sur testnet, y compris le portefeuille, l&#8217;extraction de pi√®ces testnet et la synchronisation d&#8217;un n≈ìud testnet complet.</p>
</div>
<div class="paragraph data-line-285">
<p>Pour d√©marrer Bitcoin Core sur testnet au lieu du r√©seau principal, vous utilisez le commutateur <code>testnet</code>¬†:</p>
</div>
<div class="listingblock data-line-287">
<div class="content">
<pre>$ bitcoind -testnet</pre>
</div>
</div>
<div class="paragraph data-line-291">
<p>Dans les journaux, vous devriez voir que bitcoind construit une nouvelle cha√Æne de blocs dans le sous-r√©pertoire <code>testnet3</code> du r√©pertoire bitcoind par d√©faut¬†:</p>
</div>
<div class="listingblock data-line-293">
<div class="content">
<pre>bitcoind¬†: Utilisation du r√©pertoire de donn√©es /home/username/.bitcoin/testnet3</pre>
</div>
</div>
<div class="paragraph data-line-297">
<p>Pour vous connecter √† bitcoind, vous utilisez l&#8217;outil de ligne de commande <code>bitcoin-cli</code>, mais vous devez √©galement le passer en mode testnet¬†:</p>
</div>
<div class="listingblock data-line-299">
<div class="content">
<pre>$ bitcoin-cli -testnet getblockchaininfo
{
  "chain": "test",
  "blocks": 1088,
  "headers": 139999,
  "bestblockhash": "0000000063d29909d475a1c4ba26da64b368e56cce5d925097bf3a2084370128",
  "difficulty": 1,
  "mediantime": 1337966158,
  "verificationprogress": 0.001644065914099759,
  "chainwork": "0000000000000000000000000000000000000000000000000000044104410441",
  "pruned": false,
  "softforks": [

  [...]</pre>
</div>
</div>
<div class="paragraph data-line-316">
<p>Vous pouvez √©galement ex√©cuter sur testnet3 avec d&#8217;autres impl√©mentations de n≈ìud complet, telles que <code>btcd</code> (√©crit en Go) et <code>bcoin</code> (√©crit en JavaScript), pour exp√©rimenter et apprendre dans d&#8217;autres langages et environnements de programmation.</p>
</div>
<div class="paragraph data-line-318">
<p>En 2021, testnet3 prend en charge toutes les fonctionnalit√©s du r√©seau principal, y compris le t√©moin s√©par√© (voir <a href="#segwit">T√©moin s√©par√©</a>). Par cons√©quent, testnet3 peut √©galement √™tre utilis√© pour tester les fonctionnalit√©s de t√©moin s√©par√©.</p>
</div>
</div>
</div>
<div class="sect3 data-line-320">
<h4 id="_segnet_le_r√©seau_de_test_des_t√©moins_s√©par√©s">Segnet¬†: Le r√©seau de test des t√©moins s√©par√©s</h4>
<div class="paragraph data-line-323">
<p>En 2016, un testnet √† usage sp√©cial a √©t√© lanc√© pour aider au d√©veloppement et aux tests de Segregated Witness ou T√©moin s√©par√© (alias segwit; voir <a href="#segwit">T√©moin s√©par√©</a>). Cette cha√Æne de blocs de test s&#8217;appelle <code>segnet</code> et peut √™tre rejointe en ex√©cutant une version sp√©ciale (branche) de Bitcoin Core.</p>
</div>
<div class="paragraph data-line-325">
<p>Depuis que segwit a √©t√© ajout√© √† testnet3, il n&#8217;est plus n√©cessaire d&#8217;utiliser segnet pour tester les fonctionnalit√©s de segwit.</p>
</div>
<div class="paragraph data-line-327">
<p>√Ä l&#8217;avenir, il est probable que nous verrons d&#8217;autres cha√Ænes de blocs testnet sp√©cialement con√ßues pour tester une seule fonctionnalit√© ou un changement architectural majeur, comme segnet.</p>
</div>
</div>
<div class="sect3 data-line-329">
<h4 id="_regtest_la_cha√Æne_de_blocs_locale">Regtest¬†: La cha√Æne de blocs locale</h4>
<div class="paragraph data-line-331">
<p>Regtest, qui signifie "Regression Testing", (ou tests de r√©gressions) est une fonctionnalit√© de Bitcoin Core qui vous permet de cr√©er une cha√Æne de blocs locale √† des fins de test. Contrairement √† testnet3, qui est une cha√Æne de blocs de test publique et partag√©e, les cha√Ænes de blocs regtest sont destin√©es √† √™tre ex√©cut√©es comme des syst√®mes ferm√©s pour les tests locaux. Vous lancez une cha√Æne de blocs regtest √† partir de z√©ro, en cr√©ant un bloc de gen√®se local. Vous pouvez ajouter d&#8217;autres n≈ìuds au r√©seau ou l&#8217;ex√©cuter avec un seul n≈ìud uniquement pour tester le logiciel Bitcoin Core.</p>
</div>
<div class="paragraph data-line-333">
<p>Pour d√©marrer Bitcoin Core en mode regtest, vous utilisez le drapeau <code>regtest</code>¬†:</p>
</div>
<div class="listingblock data-line-335">
<div class="content">
<pre>$ bitcoind -regtest</pre>
</div>
</div>
<div class="paragraph data-line-339">
<p>Tout comme avec testnet, Bitcoin Core initialisera une nouvelle cha√Æne de blocs sous le sous-r√©pertoire <em>regtest</em> de votre r√©pertoire par d√©faut bitcoind :</p>
</div>
<div class="listingblock data-line-341">
<div class="content">
<pre>bitcoind: Using data directory /home/username/.bitcoin/regtest</pre>
</div>
</div>
<div class="paragraph data-line-345">
<p>Pour utiliser l&#8217;outil de ligne de commande, vous devez √©galement sp√©cifier l&#8217;indicateur <code>regtest</code>. Essayons la commande <code>getblockchaininfo</code> pour inspecter la cha√Æne de blocs regtest¬†:</p>
</div>
<div class="listingblock data-line-347">
<div class="content">
<pre>$ bitcoin-cli -regtest getblockchaininfo
{
  "chain": "regtest",
  "blocks": 0,
  "headers": 0,
  "bestblockhash": "0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206",
  "difficulty": 4.656542373906925e-10,
  "mediantime": 1296688602,
  "verificationprogress": 1,
  "chainwork": "0000000000000000000000000000000000000000000000000000000000000002",
  "pruned": false,
  [...]</pre>
</div>
</div>
<div class="paragraph data-line-362">
<p>Comme vous pouvez le voir, il n&#8217;y a pas encore de blocs. Exploitons-en quelques-uns (500 blocs) et gagnons la r√©compense¬†:</p>
</div>
<div class="listingblock data-line-364">
<div class="content">
<pre>$ bitcoin-cli -regtest generate 500
[
  "7afed70259f22c2bf11e406cb12ed5c0657b6e16a6477a9f8b28e2046b5ba1ca",
  "1aca2f154a80a9863a9aac4c72047a6d3f385c4eec5441a4aafa6acaa1dada14",
  "4334ecf6fb022f30fbd764c3ee778fabbd53b4a4d1950eae8a91f1f5158ed2d1",
  "5f951d34065efeaf64e54e91d00b260294fcdfc7f05dbb5599aec84b957a7766",
  "43744b5e77c1dfece9d05ab5f0e6796ebe627303163547e69e27f55d0f2b9353",
   [...]
  "6c31585a48d4fc2b3fd25521f4515b18aefb59d0def82bd9c2185c4ecb754327"
]</pre>
</div>
</div>
<div class="paragraph data-line-377">
<p>Cela ne prendra que quelques secondes pour miner tous ces blocs, ce qui facilite certainement les tests. Si vous v√©rifiez le solde de votre portefeuille, vous verrez que vous avez gagn√© une r√©compense pour les 400 premiers blocs (les r√©compenses coinbase doivent avoir une profondeur de 100 blocs avant que vous puissiez les d√©penser) :</p>
</div>
<div class="listingblock data-line-379">
<div class="content">
<pre>$ bitcoin-cli -regtest getbalance
12462.50000000</pre>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-384">
<h3 id="_utiliser_des_cha√Ænes_de_blocs_de_test_pour_le_d√©veloppement">Utiliser des cha√Ænes de blocs de test pour le d√©veloppement</h3>
<div class="paragraph data-line-386">
<p>Les diff√©rentes cha√Ænes de blocs de Bitcoin (<code>regtest</code>, <code>segnet</code>, <code>testnet3</code>, <code>mainnet</code>) offrent une gamme d&#8217;environnements de test pour le d√©veloppement de bitcoin. Utilisez les cha√Ænes de blocs de test, que vous d√©veloppiez pour Bitcoin Core ou un autre client de consensus √† n≈ìud complet¬†; une application telle qu&#8217;un portefeuille, un √©change, un site de commerce √©lectronique¬†; ou m√™me d√©velopper de nouveaux contrats intelligents et des scripts complexes.</p>
</div>
<div class="paragraph data-line-25">
<p>Vous pouvez utiliser les cha√Ænes de blocs de test pour √©tablir un pipeline de d√©veloppement. Testez votre code localement sur un <code>regtest</code> au fur et √† mesure que vous le d√©veloppez. Une fois que vous √™tes pr√™t √† l&#8217;essayer sur un r√©seau public, passez √† <code>testnet</code> pour exposer votre code √† un environnement plus dynamique avec plus de diversit√© de code et d&#8217;applications. Enfin, une fois que vous √™tes s√ªr que votre code fonctionne comme pr√©vu, passez √† <code>mainnet</code> pour le d√©ployer en production. Au fur et √† mesure que vous apportez des modifications, des am√©liorations, des corrections de bogues, etc., red√©marrez le pipeline, en d√©ployant d&#8217;abord chaque modification sur <code>regtest</code>, puis sur <code>testnet</code>, et enfin en production.</p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="mining">Minage et Consensus</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="sect2 data-line-5">
<h3 id="_pr√©sentation_3">Pr√©sentation</h3>
<div class="paragraph data-line-7">
<p>Le mot "exploitation mini√®re" ou "minage" est quelque peu trompeur. En √©voquant l&#8217;extraction de m√©taux pr√©cieux, il focalise notre attention sur la r√©compense du minage, le nouveau bitcoin cr√©√© dans chaque bloc. Bien que l&#8217;exploitation mini√®re soit incit√©e par cette r√©compense, l&#8217;objectif principal de l&#8217;exploitation mini√®re n&#8217;est pas la r√©compense ou la g√©n√©ration de nouvelles pi√®ces. Si vous consid√©rez l&#8217;exploitation mini√®re uniquement comme le processus par lequel les pi√®ces sont cr√©√©es, vous confondez les moyens (incitations) avec le but du processus. Le minage est le m√©canisme qui sous-tend la chambre de compensation d√©centralis√©e, par laquelle les transactions sont valid√©es et compens√©es. Le minage est l&#8217;invention qui rend le bitcoin sp√©cial, un m√©canisme de s√©curit√© d√©centralis√© qui est √† la base de l&#8217;argent num√©rique P2P.</p>
</div>
<div class="paragraph data-line-9">
<p>L&#8217;exploitation mini√®re <em>s√©curise le syst√®me Bitcoin</em> et permet l&#8217;√©mergence d&#8217;un <em>consensus √† l&#8217;√©chelle du r√©seau sans autorit√© centrale</em>. La r√©compense des pi√®ces nouvellement frapp√©es et des frais de transaction est un syst√®me d&#8217;incitation qui aligne les actions des mineurs sur la s√©curit√© du r√©seau, tout en mettant en ≈ìuvre simultan√©ment l&#8217;offre mon√©taire.</p>
</div>
<div class="admonitionblock tip data-line-12">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-13">
<p>Le but du minage n&#8217;est pas la cr√©ation de nouveaux bitcoins. C&#8217;est le syst√®me d&#8217;incitation. Le minage est le m√©canisme par lequel la <em>s√©curit√©</em> du bitcoin est <em>d√©centralis√©e</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-16">
<p>Les mineurs valident les nouvelles transactions et les enregistrent dans le grand livre mondial. Un nouveau bloc, contenant les transactions qui se sont produites depuis le dernier bloc, est "min√©" toutes les 10 minutes en moyenne, ajoutant ainsi ces transactions √† la cha√Æne de blocs. Les transactions qui font partie d&#8217;un bloc et ajout√©es √† la cha√Æne de blocs sont consid√©r√©es comme "confirm√©es", ce qui permet aux nouveaux propri√©taires de bitcoin de d√©penser le bitcoin qu&#8217;ils ont re√ßu dans ces transactions.</p>
</div>
<div class="paragraph data-line-18">
<p>Les mineurs re√ßoivent deux types de r√©compenses en √©change de la s√©curit√© fournie par le minage¬†: de nouvelles pi√®ces cr√©√©es avec chaque nouveau bloc, √©galement appel√©es <em>r√©compense de bloc</em> ou <em>r√©compense de coinbase</em>, et les frais de transaction de toutes les transactions incluses dans le bloc. Pour gagner cette r√©compense, les mineurs s&#8217;affrontent pour r√©soudre un probl√®me math√©matique difficile bas√© sur un algorithme de hachage cryptographique. La solution au probl√®me, appel√©e Proof-of-Work (ou preuve de travail), est incluse dans le nouveau bloc et agit comme preuve que le mineur a d√©ploy√© des efforts informatiques importants. La comp√©tition pour r√©soudre l&#8217;algorithme de preuve de travail pour gagner la r√©compense et le droit d&#8217;enregistrer les transactions sur la cha√Æne de blocs est la base du mod√®le de s√©curit√© de Bitcoin.</p>
</div>
<div class="paragraph data-line-20">
<p>Le processus est appel√© minage parce que la r√©compense (nouvelle g√©n√©ration de pi√®ces) est con√ßue pour simuler des rendements d√©croissants, tout comme le minage de m√©taux pr√©cieux. La masse mon√©taire de Bitcoin est cr√©√©e par l&#8217;exploitation mini√®re, de la m√™me mani√®re qu&#8217;une banque centrale √©met de la nouvelle monnaie en imprimant des billets de banque. La quantit√© maximale de bitcoins nouvellement cr√©√©s qu&#8217;un mineur peut ajouter √† un bloc diminue environ tous les quatre ans (ou pr√©cis√©ment tous les 210 000 blocs). Il a commenc√© √† 50 bitcoins par bloc en janvier 2009 et a √©t√© r√©duit de moiti√© √† 25 bitcoins par bloc en novembre 2012. Il a √©t√© r√©duit de moiti√© √† 12,5 bitcoins en juillet 2016 et de nouveau √† 6,25 bitcoins en mai 2020. Sur la base de cette formule, les r√©compenses de minage de bitcoins diminuent de fa√ßon exponentielle. jusqu&#8217;√† environ l&#8217;an 2140, lorsque tous les bitcoins (20,99999998 millions) auront √©t√© √©mis. Apr√®s 2140, aucun nouveau bitcoin ne sera √©mis.</p>
</div>
<div class="paragraph data-line-22">
<p>Les mineurs de Bitcoin gagnent √©galement des frais sur les transactions. Chaque transaction comprend g√©n√©ralement des frais de transaction, sous la forme d&#8217;un surplus de bitcoin entre les entr√©es et les sorties de la transaction. Le mineur de bitcoin gagnant peut "garder la monnaie" sur les transactions incluses dans le bloc gagnant. Aujourd&#8217;hui, les frais repr√©sentent 0,5¬†% ou moins des revenus d&#8217;un mineur de bitcoin, la grande majorit√© provenant du bitcoin nouvellement cr√©√©. Cependant, √† mesure que la r√©compense de bloc diminue avec le temps et que le nombre de transactions par bloc augmente, une plus grande proportion des revenus de minage de bitcoins proviendra des frais. Progressivement, la r√©compense mini√®re sera domin√©e par les frais de transaction, qui constitueront la principale incitation pour les mineurs. Apr√®s 2140, la quantit√© de nouveaux bitcoins dans chaque bloc tombe √† z√©ro et l&#8217;extraction de bitcoins ne sera encourag√©e que par les frais de transaction.</p>
</div>
<div class="paragraph data-line-24">
<p>Dans ce chapitre, nous examinerons d&#8217;abord l&#8217;exploitation mini√®re en tant que m√©canisme d&#8217;approvisionnement mon√©taire, puis nous examinerons la fonction la plus importante de l&#8217;exploitation mini√®re¬†: le m√©canisme de consensus d√©centralis√© qui sous-tend la s√©curit√© du bitcoin.</p>
</div>
<div class="paragraph data-line-26">
<p>Pour comprendre l&#8217;exploitation mini√®re et le consensus, nous suivrons la transaction d&#8217;Alice telle qu&#8217;elle est re√ßue et ajout√©e √† un bloc par l&#8217;√©quipement minier de Jing. Ensuite, nous suivrons le bloc tel qu&#8217;il est extrait, ajout√© √† la cha√Æne de blocs et accept√© par le r√©seau Bitcoin √† travers le processus de consensus √©mergent.</p>
</div>
<div class="sect3 data-line-28">
<h4 id="_√©conomie_bitcoin_et_cr√©ation_de_devises">√âconomie Bitcoin et cr√©ation de devises</h4>
<div class="paragraph data-line-30">
<p>Les Bitcoins sont "frapp√©s" lors de la cr√©ation de chaque bloc √† un taux fixe et d√©croissant. Chaque bloc, g√©n√©r√© en moyenne toutes les 10 minutes, contient des bitcoins enti√®rement nouveaux, cr√©√©s √† partir de rien. Tous les 210 000 blocs, soit environ tous les quatre ans, le taux d&#8217;√©mission des devises est diminu√© de 50 %. Pendant les quatre premi√®res ann√©es de fonctionnement du r√©seau, chaque bloc contenait 50 nouveaux bitcoins.</p>
</div>
<div class="paragraph data-line-32">
<p>En novembre 2012, le nouveau taux d&#8217;√©mission de bitcoins a √©t√© r√©duit √† 25 bitcoins par bloc. En juillet 2016, il a √©t√© r√©duit √† 12,5 bitcoins par bloc, et en mai 2020, il a de nouveau √©t√© r√©duit √† 6,25 bitcoins par bloc. Le taux de nouvelles pi√®ces diminue ainsi de mani√®re exponentielle sur 32 "halvings" (ou "r√©ductions de moiti√©") jusqu&#8217;au bloc 6 720 000 (min√© environ en 2137), lorsqu&#8217;il atteint l&#8217;unit√© mon√©taire minimale de 1 satoshi. Enfin, apr√®s 6,93 millions de blocs, en 2140 environ, pr√®s de 2 099 999 997 690 000 satoshis, soit pr√®s de 21 millions de bitcoins, seront √©mis. Par la suite, les blocs ne contiendront plus de nouveaux bitcoins et les mineurs seront r√©compens√©s uniquement par les frais de transaction. <a href="#bitcoin_money_supply">Offre de monnaie bitcoin au fil du temps bas√©e sur un taux d&#8217;√©mission g√©om√©triquement d√©croissant</a> montre le bitcoin total en circulation au fil du temps, √† mesure que l&#8217;√©mission de devises diminue.</p>
</div>
<div id="bitcoin_money_supply" class="imageblock data-line-36">
<div class="content">
<img src="images/mbc2_1001.png" alt="Masse mon√©taire Bitcoin">
</div>
<div class="title">Figure 63. Offre de monnaie bitcoin au fil du temps bas√©e sur un taux d&#8217;√©mission g√©om√©triquement d√©croissant</div>
</div>
<div class="admonitionblock note data-line-39">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-40">
<p>Le nombre maximum de pi√®ces min√©es est la <em>limite sup√©rieure</em> des r√©compenses mini√®res possibles pour le bitcoin. En pratique, un mineur peut intentionnellement exploiter un bloc en prenant moins que la r√©compense compl√®te. Ces blocs ont d√©j√† √©t√© extraits et d&#8217;autres pourraient l&#8217;√™tre √† l&#8217;avenir, ce qui entra√Ænerait une √©mission totale inf√©rieure de la monnaie.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-43">
<p>Dans l&#8217;exemple de code dans <a href="#max_money">Un script pour calculer la quantit√© totale de bitcoins qui sera √©mise</a>, nous calculons le montant total de bitcoin qui sera √©mis.</p>
</div>
<div id="max_money" class="exampleblock data-line-47">
<div class="title">Example 22. Un script pour calculer la quantit√© totale de bitcoins qui sera √©mise</div>
<div class="content">
<div class="listingblock data-line-49">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># La r√©compense de bloc originale pour les mineurs √©tait de 50 BTC
start_block_reward = 50
# 210000 est d'environ tous les 4 ans avec un intervalle de bloc de 10 minutes
reward_interval = 210000

def max_money():
    # 50 BTC = 50 0000 0000 Satoshis
    current_reward = 50 * 10**8
    total = 0
    while current_reward &gt; 0:
        total += reward_interval * current_reward
        current_reward /= 2
    return total

print "Total BTC to ever be created:", max_money(), "Satoshis"</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-54">
<p><a href="#max_money_run">Ex√©cuter le script max_money.py</a> affiche la sortie produite en ex√©cutant ce script.</p>
</div>
<div id="max_money_run" class="exampleblock data-line-58">
<div class="title">Example 23. Ex√©cuter le script max_money.py</div>
<div class="content">
<div class="listingblock data-line-60">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python max_money.py
Total BTC to ever be created: 2100000000000000.0 Satoshis</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-66">
<p>L&#8217;√©mission finie et d√©croissante cr√©e une masse mon√©taire fixe qui r√©siste √† l&#8217;inflation. Contrairement √† une monnaie fiduciaire, qui peut √™tre imprim√©e en nombre infini par une banque centrale, le bitcoin ne peut jamais √™tre gonfl√© par l&#8217;impression.</p>
</div>
<div class="sidebarblock data-line-69">
<div class="content">
<div class="title">Argent d√©flationniste</div>
<div class="paragraph data-line-70">
<p>La cons√©quence la plus importante et la plus d√©battue d&#8217;une √©mission mon√©taire fixe et d√©croissante est que la monnaie a tendance √† √™tre intrins√®quement d√©flationniste. La d√©flation est le ph√©nom√®ne d&#8217;appr√©ciation de la valeur due √† une inad√©quation entre l&#8217;offre et la demande qui fait monter la valeur (et le taux de change) d&#8217;une monnaie. Le contraire de l&#8217;inflation, la d√©flation des prix, signifie que l&#8217;argent a plus de pouvoir d&#8217;achat au fil du temps.</p>
</div>
<div class="paragraph data-line-72">
<p>De nombreux √©conomistes soutiennent qu&#8217;une √©conomie d√©flationniste est une catastrophe qu&#8217;il faut √©viter √† tout prix. En effet, en p√©riode de d√©flation rapide, les gens ont tendance √† accumuler de l&#8217;argent au lieu de le d√©penser, en esp√©rant que les prix chuteront. Un tel ph√©nom√®ne s&#8217;est d√©roul√© au cours de la ¬´¬†d√©cennie perdue¬†¬ª du Japon, lorsqu&#8217;un effondrement complet de la demande a pouss√© la monnaie dans une spirale d√©flationniste.</p>
</div>
<div class="paragraph data-line-74">
<p>Les experts du Bitcoin affirment que la d√©flation n&#8217;est pas mauvaise en soi. La d√©flation est plut√¥t associ√©e √† un effondrement de la demande car c&#8217;est le seul exemple de d√©flation que nous ayons √† √©tudier. Dans une monnaie fiduciaire avec possibilit√© d&#8217;impression illimit√©e, il est tr√®s difficile d&#8217;entrer dans une spirale d√©flationniste √† moins qu&#8217;il n&#8217;y ait un effondrement complet de la demande et une r√©ticence √† imprimer de l&#8217;argent. La d√©flation du bitcoin n&#8217;est pas caus√©e par un effondrement de la demande, mais par une offre limit√©e de mani√®re pr√©visible.</p>
</div>
<div class="paragraph data-line-76">
<p>L&#8217;aspect positif de la d√©flation, bien s√ªr, c&#8217;est qu&#8217;elle est le contraire de l&#8217;inflation. L&#8217;inflation provoque une d√©pr√©ciation lente mais in√©vitable de la monnaie, se traduisant par une forme de taxation cach√©e qui punit les √©pargnants afin de renflouer les d√©biteurs (y compris les plus gros d√©biteurs, les gouvernements eux-m√™mes). Les monnaies sous contr√¥le gouvernemental souffrent de l&#8217;al√©a moral d&#8217;une √©mission facile de dette qui peut ensuite √™tre effac√©e par la d√©pr√©ciation aux d√©pens des √©pargnants.</p>
</div>
<div class="paragraph data-line-78">
<p>Il reste √† voir si l&#8217;aspect d√©flationniste de la monnaie est un probl√®me lorsqu&#8217;il n&#8217;est pas entra√Æn√© par une r√©traction √©conomique rapide, ou un avantage parce que la protection contre l&#8217;inflation et l&#8217;avilissement l&#8217;emporte largement sur les risques de d√©flation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-81">
<h3 id="_consensus_d√©centralis√©">Consensus d√©centralis√©</h3>
<div class="paragraph data-line-83">
<p>Dans le chapitre pr√©c√©dent, nous avons examin√© la cha√Æne de blocs, le registre public mondial (liste) de tous transactions, que tout le monde dans le r√©seau Bitcoin accepte comme enregistrement de propri√©t√© faisant autorit√©.</p>
</div>
<div class="paragraph data-line-85">
<p>Mais comment tout le monde dans le r√©seau peut-il s&#8217;entendre sur une seule ¬´ v√©rit√© ¬ª universelle sur qui poss√®de quoi, sans avoir √† faire confiance √† personne ? Tous les syst√®mes de paiement traditionnels d√©pendent d&#8217;un mod√®le de confiance qui a une autorit√© centrale fournissant un service de chambre de compensation, v√©rifiant et compensant essentiellement toutes les transactions. Bitcoin n&#8217;a pas d&#8217;autorit√© centrale, mais d&#8217;une mani√®re ou d&#8217;une autre, chaque n≈ìud complet poss√®de une copie compl√®te d&#8217;un grand livre public auquel il peut faire confiance en tant qu&#8217;enregistrement faisant autorit√©. La cha√Æne de blocs n&#8217;est pas cr√©√©e par une autorit√© centrale, mais est assembl√©e ind√©pendamment par chaque n≈ìud du r√©seau. D&#8217;une mani√®re ou d&#8217;une autre, chaque n≈ìud du r√©seau, agissant sur les informations transmises via des connexions r√©seau non s√©curis√©es, peut arriver √† la m√™me conclusion et assembler une copie du m√™me registre public que tout le monde. Ce chapitre examine le processus par lequel le r√©seau Bitcoin parvient √† un consensus mondial sans autorit√© centrale.</p>
</div>
<div class="paragraph data-line-87">
<p>La principale invention de Satoshi Nakamoto est le m√©canisme d√©centralis√© de <em>consensus √©mergent</em>. Emergent, parce que le consensus n&#8217;est pas atteint explicitement - il n&#8217;y a pas d&#8217;√©lection ou de moment fixe o√π le consensus se produit. Au lieu de cela, le consensus est un artefact √©mergent de l&#8217;interaction asynchrone de milliers de n≈ìuds ind√©pendants, qui suivent tous des r√®gles simples. Toutes les propri√©t√©s du bitcoin, y compris la monnaie, les transactions, les paiements et le mod√®le de s√©curit√© qui ne d√©pend pas de l&#8217;autorit√© centrale ou de la confiance, d√©coulent de cette invention.</p>
</div>
<div class="paragraph data-line-89">
<p>Le consensus d√©centralis√© de Bitcoin √©merge de l&#8217;interaction de quatre processus qui se produisent ind√©pendamment sur les n≈ìuds du r√©seau¬†:</p>
</div>
<div class="ulist pagebreak-before data-line-92">
<ul>
<li class="data-line-92">
<p>V√©rification ind√©pendante de chaque transaction, par chaque n≈ìud complet, sur la base d&#8217;une liste compl√®te de crit√®res</p>
</li>
<li class="data-line-93">
<p>Agr√©gation ind√©pendante de ces transactions dans de nouveaux blocs par des n≈ìuds de minage, associ√©e √† un calcul d√©montr√© via un algorithme de preuve de travail</p>
</li>
<li class="data-line-94">
<p>V√©rification ind√©pendante des nouveaux blocs par chaque n≈ìud et assemblage dans une cha√Æne</p>
</li>
<li class="data-line-95">
<p>S√©lection ind√©pendante, par chaque n≈ìud, de la cha√Æne avec le calcul le plus cumulatif d√©montr√© par la preuve de travail</p>
</li>
</ul>
</div>
<div class="paragraph data-line-97">
<p>Dans les prochaines sections, nous examinerons ces processus et la mani√®re dont ils interagissent pour cr√©er la propri√©t√© √©mergente du consensus √† l&#8217;√©chelle du r√©seau qui permet √† n&#8217;importe quel n≈ìud Bitcoin d&#8217;assembler sa propre copie du grand livre public mondial faisant autorit√©.</p>
</div>
</div>
<div class="sect2 data-line-100">
<h3 id="tx_verification">V√©rification ind√©pendante des transactions</h3>
<div class="paragraph data-line-102">
<p>Dans <a href="#transactions">Op√©rations</a>, nous avons vu comment un logiciel de portefeuille cr√©e des transactions en collectant des UTXO, en fournissant les scripts de d√©verrouillage appropri√©s, puis en construisant de nouvelles sorties attribu√©es √† un nouveau propri√©taire. La transaction r√©sultante est ensuite envoy√©e aux n≈ìuds voisins du r√©seau Bitcoin afin qu&#8217;elle puisse √™tre propag√©e sur l&#8217;ensemble du r√©seau Bitcoin.</p>
</div>
<div class="paragraph data-line-104">
<p>Cependant, avant de transmettre les transactions √† ses voisins, chaque n≈ìud Bitcoin qui re√ßoit une transaction v√©rifiera d&#8217;abord la transaction. Cela garantit que seules les transactions valides sont propag√©es sur le r√©seau, tandis que les transactions non valides sont rejet√©es au premier n≈ìud qui les rencontre.</p>
</div>
<div class="paragraph data-line-106">
<p>Chaque n≈ìud v√©rifie chaque transaction par rapport √† une longue liste de crit√®res¬†:</p>
</div>
<div class="ulist data-line-108">
<ul>
<li class="data-line-108">
<p>La syntaxe et la structure des donn√©es de la transaction doivent √™tre correctes.</p>
</li>
<li class="data-line-109">
<p>Ni les listes d&#8217;entr√©es ni de sorties ne sont vides.</p>
</li>
<li class="data-line-110">
<p>La taille de la transaction est inf√©rieure √† la taille maximale autoris√©e pour un bloc excluant les donn√©es t√©moins, comme indiqu√© dans <a href="https://bit.ly/3t623VL" data-href="https://bit.ly/3t623VL"><em>tx_check.cpp</em></a>.</p>
</li>
<li class="data-line-111">
<p>Chaque valeur de sortie, ainsi que le total, doit √™tre dans la plage de valeurs autoris√©e (moins de 21 millions de pi√®ces, plus que le seuil de <em>poussi√®re</em>).</p>
</li>
<li class="data-line-112">
<p>Aucune des entr√©es n&#8217;a hash=0, N=‚Äì1 (les transactions coinbase ne doivent pas √™tre relay√©es).</p>
</li>
<li class="data-line-113">
<p><code>nLocktime</code> est √©gal √† <code>INT_MAX</code>, ou les valeurs <code>nLocktime</code> et <code>nSequence</code> sont satisfaites selon <code>MedianTimePast</code>.</p>
</li>
<li class="data-line-114">
<p>La taille de la transaction en octets est sup√©rieure ou √©gale √† 82.</p>
</li>
<li class="data-line-115">
<p>Le nombre d&#8217;op√©rations de signature (SIGOPS) contenues dans la transaction est inf√©rieur √† la limite d&#8217;op√©rations de signature.</p>
</li>
<li class="data-line-116">
<p>Le script de d√©verrouillage (<code>scriptSig</code>) ne peut pousser que des nombres sur la pile, et le script de verrouillage (<code>scriptPubkey</code>) doit correspondre aux formes <code>IsStandard</code> (cela rejette les transactions "non standard").</p>
</li>
<li class="data-line-117">
<p>Une transaction correspondante dans le bassin ou dans un bloc de la branche principale doit exister.</p>
</li>
<li class="data-line-118">
<p>Pour chaque entr√©e, si la sortie r√©f√©renc√©e existe dans une autre transaction du bassin, la transaction doit √™tre rejet√©e.</p>
</li>
<li class="data-line-119">
<p>Pour chaque entr√©e, regardez dans la branche principale et le bassin de transactions pour trouver sa transaction parente. Si la transaction parent est manquante pour une entr√©e, il s&#8217;agira d&#8217;une transaction orpheline. Ajouter au bassin de transactions orphelines, si une transaction correspondante n&#8217;est pas d√©j√† dans le bassin.</p>
</li>
<li class="data-line-120">
<p>Pour chaque entr√©e, si sa transaction parente est une transaction coinbase, elle doit avoir au moins <code>COINBASE_MATURITY</code> (100) confirmations.</p>
</li>
<li class="data-line-121">
<p>Pour chaque entr√©e, la sortie r√©f√©renc√©e doit exister et ne peut pas d√©j√† √™tre d√©pens√©e.</p>
</li>
<li class="data-line-122">
<p>En utilisant les transactions parentes pour obtenir les valeurs d&#8217;entr√©e, v√©rifiez que chaque valeur d&#8217;entr√©e, ainsi que la somme, se situent dans la plage de valeurs autoris√©e (moins de 21 millions de pi√®ces, plus de 0).</p>
</li>
<li class="data-line-123">
<p>Rejeter si la somme des valeurs d&#8217;entr√©e est inf√©rieure √† la somme des valeurs de sortie.</p>
</li>
<li class="data-line-124">
<p>Rejeter si les frais de transaction seraient trop bas (<code>minRelayTxFee</code>) pour entrer dans un bloc vide.</p>
</li>
<li class="data-line-125">
<p>Les scripts de d√©verrouillage pour chaque entr√©e doivent √™tre valid√©s par rapport aux scripts de verrouillage de sortie correspondants.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-127">
<p>Ces conditions peuvent √™tre vues en d√©tail dans les fonctions <code>AcceptToMemoryPool</code>, <code>CheckTransaction</code> et <code>CheckInputs</code> dans Bitcoin Core. Notez que les conditions changent avec le temps, pour faire face √† de nouveaux types d&#8217;attaques par d√©ni de service ou parfois pour assouplir les r√®gles afin d&#8217;inclure davantage de types de transactions.</p>
</div>
<div class="paragraph data-line-129">
<p>En v√©rifiant ind√©pendamment chaque transaction lors de sa r√©ception et avant de la propager, chaque n≈ìud cr√©e un bassin de transactions valides (mais non confirm√©es) connu sous le nom de <em>bassin de transaction</em>, <em>bassin de m√©moire</em> ou <em>mempool</em>.</p>
</div>
</div>
<div class="sect2 data-line-131">
<h3 id="_n≈ìuds_miniers">N≈ìuds miniers</h3>
<div class="paragraph data-line-133">
<p>Certains des n≈ìuds du r√©seau Bitcoin sont des n≈ìuds sp√©cialis√©s appel√©s <em>mineurs</em>. Dans <a href="#ch01_intro_what_is_bitcoin">Pr√©sentation</a> nous avons pr√©sent√© Jing, un √©tudiant en g√©nie informatique √† Shanghai, en Chine, est un mineur de bitcoin. Jing gagne du bitcoin en ex√©cutant une "plate-forme mini√®re", qui est un syst√®me informatique sp√©cialis√© con√ßu pour exploiter le bitcoin. Le mat√©riel minier sp√©cialis√© de Jing est connect√© √† un serveur ex√©cutant un n≈ìud Bitcoin complet. Contrairement √† Jing, certains mineurs minent sans n≈ìud complet, comme nous le verrons dans <a href="#mining_pools">Groupes miniers</a>. Comme tous les autres n≈ìuds complets, le n≈ìud de Jing re√ßoit et propage les transactions non confirm√©es sur le r√©seau Bitcoin. Le n≈ìud de Jing, cependant, agr√®ge √©galement ces transactions dans de nouveaux blocs.</p>
</div>
<div class="paragraph data-line-135">
<p>Le n≈ìud de Jing est √† l&#8217;√©coute de nouveaux blocs, propag√©s sur le r√©seau Bitcoin, comme tous les n≈ìuds. Cependant, l&#8217;arriv√©e d&#8217;un nouveau bloc a une signification particuli√®re pour un n≈ìud minier. La comp√©tition entre mineurs se termine effectivement par la propagation d&#8217;un nouveau bloc qui fait office d&#8217;annonce d&#8217;un gagnant. Pour les mineurs, recevoir un nouveau bloc valide signifie que quelqu&#8217;un d&#8217;autre a gagn√© la comp√©tition et qu&#8217;il (on) a perdu. Cependant, la fin d&#8217;un tour d&#8217;une comp√©tition est aussi le d√©but du tour suivant. Le nouveau bloc n&#8217;est pas seulement un drapeau √† damier, marquant la fin de la course; c&#8217;est aussi le pistolet de d√©part dans la course pour le bloc suivant.</p>
</div>
</div>
<div class="sect2 data-line-137">
<h3 id="_agr√©ger_les_transactions_en_blocs">Agr√©ger les transactions en blocs</h3>
<div class="paragraph data-line-139">
<p>Apr√®s avoir valid√© les transactions, un n≈ìud Bitcoin les ajoutera au <em>bassin de m√©moire</em>, ou <em>bassin de transaction</em>, o√π les transactions attendent jusqu&#8217;√† ce qu&#8217;elles puissent √™tre incluses (exploit√©es) dans un bloc. Le n≈ìud de Jing collecte, valide et relaie les nouvelles transactions comme n&#8217;importe quel autre n≈ìud. Contrairement aux autres n≈ìuds, cependant, le n≈ìud de Jing regroupera ensuite ces transactions dans un <em>bloc candidat</em>.</p>
</div>
<div class="paragraph data-line-141">
<p>Suivons les blocs qui ont √©t√© cr√©√©s √† l&#8217;√©poque o√π Alice achetait une tasse de caf√© au Bob&#8217;s Cafe (voir <a href="#cup_of_coffee">Acheter une tasse de caf√©</a>). La transaction d&#8217;Alice a √©t√© incluse dans le bloc 277 316. Dans le but de d√©montrer les concepts de ce chapitre, supposons que ce bloc a √©t√© min√© par le syst√®me de minage de Jing et suivons la transaction d&#8217;Alice au fur et √† mesure qu&#8217;elle fait partie de ce nouveau bloc.</p>
</div>
<div class="paragraph data-line-143">
<p>Le n≈ìud minier de Jing maintient une copie locale de la cha√Æne de blocs. Au moment o√π Alice ach√®te la tasse de caf√©, le n≈ìud de Jing a assembl√© une cha√Æne jusqu&#8217;au bloc 277 314. Le n≈ìud de Jing √©coute les transactions, essaie d&#8217;extraire un nouveau bloc et √©coute √©galement les blocs d√©couverts par d&#8217;autres n≈ìuds. Comme le n≈ìud de Jing est en train d&#8217;exploiter, il re√ßoit le bloc 277 315 via le r√©seau Bitcoin. L&#8217;arriv√©e de ce bloc signifie la fin de la comp√©tition pour le bloc 277 315 et le d√©but de la comp√©tition pour cr√©er le bloc 277 316.</p>
</div>
<div class="paragraph data-line-145">
<p>Au cours des 10 minutes pr√©c√©dentes, alors que le n≈ìud de Jing cherchait une solution au bloc 277 315, il collectait √©galement des transactions en vue du bloc suivant. √Ä ce jour, il a collect√© quelques centaines de transactions dans le bassin de m√©moire. Lors de la r√©ception du bloc 277 315 et de sa validation, le n≈ìud de Jing le comparera √©galement √† toutes les transactions du pool de m√©moire et supprimera celles qui √©taient incluses dans le bloc 277 315. Quelles que soient les transactions restantes dans le bassin de m√©moire, elles ne sont pas confirm√©es et attendent d&#8217;√™tre enregistr√©es dans un nouveau bloc.</p>
</div>
<div class="paragraph data-line-147">
<p>Le n≈ìud de Jing construit imm√©diatement un nouveau bloc vide, un candidat pour le bloc 277 316. Ce bloc est appel√© <em>bloc candidat</em> car ce n&#8217;est pas encore un bloc valide, car il ne contient pas de preuve de travail valide. Le bloc ne devient valide que si le mineur r√©ussit √† trouver une solution √† l&#8217;algorithme de preuve de travail.</p>
</div>
<div class="paragraph data-line-149">
<p>Lorsque le n≈ìud de Jing regroupe toutes les transactions du bassin de m√©moire, le nouveau bloc candidat contient 418 transactions avec des frais de transaction totaux de 0,09094928 bitcoin. Vous pouvez voir ce bloc dans la cha√Æne de blocs √† l&#8217;aide de l&#8217;interface de ligne de commande du client Bitcoin Core, comme indiqu√© dans <a href="#block277316">Utiliser la ligne de commande pour r√©cup√©rer le bloc 277,316</a>.</p>
</div>
<div id="block277316" class="exampleblock data-line-153">
<div class="title">Example 24. Utiliser la ligne de commande pour r√©cup√©rer le bloc 277,316</div>
<div class="content">
<div class="listingblock data-line-155">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ bitcoin-cli getblockhash 277316

0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4

$ bitcoin-cli getblock 0000000000000001b6b9a13b095e96db41c4a928b97ef2d9\
44a9b31b2cc7bdc4</code></pre>
</div>
</div>
<div class="listingblock data-line-166">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "hash" : "0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4",
    "confirmations" : 35561,
    "size" : 218629,
    "height" : 277316,
    "version" : 2,
    "merkleroot" : "c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e",
    "tx" : [
        "d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f",
        "b268b45c59b39d759614757718b9918caf0ba9d97c56f3b91956ff877c503fbe",

        ... 417 more transactions ...

       ],
    "time" : 1388185914,
    "nonce" : 924591752,
    "bits" : "1903a30c",
    "difficulty" : 1180923195.25802612,
    "chainwork" : "000000000000000000000000000000000000000000000934695e92aaf53afa1a",
    "previousblockhash" : "0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 data-line-191">
<h4 id="_la_transaction_coinbase">La transaction Coinbase</h4>
<div class="paragraph data-line-193">
<p>La premi√®re transaction d&#8217;un bloc est une transaction sp√©ciale, appel√©e <em>transaction coinbase</em>. Cette transaction est construite par le n≈ìud de Jing et contient sa <em>r√©compense</em> pour l&#8217;effort de minage.</p>
</div>
<div class="admonitionblock note data-line-196">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-197">
<p>Lorsque le bloc 277 316 a √©t√© min√©, la r√©compense √©tait de 25 bitcoins par bloc. Depuis, deux p√©riodes de "halving" (ou "r√©duction de moiti√©") se sont √©coul√©es. La r√©compense globale est pass√©e √† 12,5 bitcoins en juillet 2016 et √† 6,25 bitcoins en mai 2020.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-200">
<p>Le n≈ìud de Jing cr√©e la transaction coinbase en tant que paiement sur son propre portefeuille¬†: "Pay Jing&#8217;s address 25.09094928 bitcoin." Le montant total de la r√©compense que Jing collecte pour l&#8217;extraction d&#8217;un bloc est la somme de la r√©compense coinbase (25 nouveaux bitcoins) et des frais de transaction (0,09094928) de toutes les transactions incluses dans le bloc, comme indiqu√© dans <a href="#generation_tx_example">Transaction coinbase</a>.</p>
</div>
<div id="generation_tx_example" class="exampleblock data-line-205">
<div class="title">Example 25. Transaction coinbase</div>
<div class="content">
<div class="listingblock data-line-206">
<div class="content">
<pre>$ bitcoin-cli getrawtransaction d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f 1</pre>
</div>
</div>
<div class="listingblock c_less_space data-line-212">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "hex" : "01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0f03443b0403858402062f503253482fffffffff0110c08d9500000000232102aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21ac00000000",
    "txid" : "d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f",
    "version" : 1,
    "locktime" : 0,
    "vin" : [
        {
            "coinbase" : "03443b0403858402062f503253482f",
            "sequence" : 4294967295
        }
    ],
    "vout" : [
        {
            "value" : 25.09094928,
            "n" : 0,
            "scriptPubKey" : {
                "asm" : "02aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21OP_CHECKSIG",
                "hex" : "2102aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21ac",
                "reqSigs" : 1,
                "type" : "pubkey",
                "addresses" : [
                    "1MxTkeEP2PmHSMze5tUZ1hAV3YTKu2Gh1N"
                ]
            }
        }
    ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-243">
<p>Contrairement aux transactions r√©guli√®res, la transaction coinbase ne consomme pas (ne d√©pense pas) d&#8217;UTXO comme entr√©es. Au lieu de cela, il n&#8217;a qu&#8217;une seule entr√©e, appel√©e <em>coinbase</em>, qui cr√©e du bitcoin √† partir de rien. La transaction coinbase a une sortie, payable √† la propre adresse Bitcoin du mineur. La sortie de la transaction coinbase envoie la valeur de 25,09094928 bitcoin √† l&#8217;adresse Bitcoin du mineur ; dans ce cas c&#8217;est <code>1MxTkeEP2PmHSMze5tUZ1hAV3YTKu2Gh1N</code>.</p>
</div>
</div>
<div class="sect3 data-line-245">
<h4 id="_r√©compense_et_frais_coinbase">R√©compense et frais coinbase</h4>
<div class="paragraph data-line-247">
<p>Pour construire la transaction coinbase, le n≈ìud de Jing calcule d&#8217;abord le montant total des frais de transaction en ajoutant toutes les entr√©es et sorties des 418 transactions qui ont √©t√© ajout√©es au bloc. Les frais sont calcul√©s comme suit :</p>
</div>
<div class="listingblock data-line-249">
<div class="content">
<pre>Frais totaux = Somme(entr√©es) - Somme(sorties)</pre>
</div>
</div>
<div class="paragraph data-line-253">
<p>Dans le bloc 277 316, le total des frais de transaction est de 0,09094928 bitcoin.</p>
</div>
<div class="paragraph data-line-255">
<p>Ensuite, le n≈ìud de Jing calcule la r√©compense correcte pour le nouveau bloc. La r√©compense est calcul√©e en fonction de la hauteur du bloc, √† partir de 50 bitcoins par bloc et r√©duite de moiti√© tous les 210 000 blocs. Parce que ce bloc est √† la hauteur 277 316, la r√©compense correcte est de 25 bitcoins.</p>
</div>
<div class="paragraph data-line-257">
<p>Le calcul peut √™tre vu dans la fonction <code>GetBlockSubsidy</code> dans le client Bitcoin Core, comme indiqu√© dans <a href="#getblocksubsidy_source">Calcul de la r√©compense de bloc‚ÄîFonction GetBlockSubsidy, Client Bitcoin Core, main.cpp</a>.</p>
</div>
<div id="getblocksubsidy_source" class="exampleblock data-line-261">
<div class="title">Example 26. Calcul de la r√©compense de bloc‚ÄîFonction GetBlockSubsidy, Client Bitcoin Core, main.cpp</div>
<div class="content">
<div class="listingblock c_less_space data-line-264">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">CAmount GetBlockSubsidy(int nHeight, const Consensus::Params&amp; consensusParams)
{
    int halvings = nHeight / consensusParams.nSubsidyHalvingInterval;
    // Force la r√©compense du bloc √† z√©ro lorsque le d√©calage vers la droite n'est pas d√©fini.
    if (halvings &gt;= 64)
        return 0;

    CAmount nSubsidy = 50 * COIN;
    // La subvention est r√©duite de moiti√© tous les 210 000 blocs, ce qui se produira environ tous les 4 ans.
    nSubsidy &gt;&gt;= halvings;
    return nSubsidy;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-280">
<p>La subvention initiale est calcul√©e en satoshis en multipliant 50 par la constante <code>COIN</code> (100 000 000 satoshis). Cela fixe la r√©compense initiale (<code>nSubsidy</code>) √† 5 milliards de satoshis.</p>
</div>
<div class="paragraph data-line-282">
<p>Ensuite, la fonction calcule le nombre de <code>halvings</code> qui se sont produits en divisant la hauteur actuelle du bloc par l&#8217;intervalle de halving (ou r√©duction de moiti√©) (<code>SubsidyHalvingInterval</code>). Dans le cas du bloc 277 316, avec un intervalle de moiti√© tous les 210 000 blocs, le r√©sultat est 1 moiti√©.</p>
</div>
<div class="paragraph data-line-284">
<p>Le nombre maximum de moiti√©s autoris√© est de 64, donc le code impose une r√©compense nulle (ne renvoie que les frais) si les 64 moiti√©s sont d√©pass√©es.</p>
</div>
<div class="paragraph data-line-286">
<p>Ensuite, la fonction utilise l&#8217;op√©rateur binaire de d√©calage vers la droite pour diviser la r√©compense (<code>nSubsidy</code>) par deux pour chaque cycle de r√©duction de moiti√©. Dans le cas du bloc 277 316, cela entra√Ænerait un d√©calage binaire vers la droite de la r√©compense de 5 milliards de satoshis une fois (une r√©duction de moiti√©) et donnerait 2,5 milliards de satoshis, soit 25 bitcoins. L&#8217;op√©rateur de d√©calage binaire vers la droite est utilis√© car il est plus efficace que plusieurs divisions r√©p√©t√©es. Pour √©viter un bogue potentiel, l&#8217;op√©ration de d√©calage est ignor√©e apr√®s 63 moiti√©s et la subvention est d√©finie sur 0.</p>
</div>
<div class="paragraph data-line-288">
<p>Enfin, la r√©compense coinbase (<code>nSubsidy</code>) est ajout√©e aux frais de transaction (<code>nFees</code>), et la somme est restitu√©e.</p>
</div>
<div class="admonitionblock tip data-line-291">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-292">
<p>Si le n≈ìud minier de Jing √©crit la transaction coinbase, qu&#8217;est-ce qui emp√™che Jing de se "r√©compenser" lui-m√™me 100 ou 1000 bitcoins ? La r√©ponse est qu&#8217;une r√©compense incorrecte aurait pour cons√©quence que le bloc serait consid√©r√© comme invalide par tout le monde, gaspillant l&#8217;√©lectricit√© de Jing utilis√©e pour la preuve de travail. Jing ne peut d√©penser la r√©compense que si le bloc est accept√© par tout le monde.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-295">
<h4 id="_structure_de_la_transaction_coinbase">Structure de la transaction coinbase</h4>
<div class="paragraph data-line-297">
<p>Avec ces calculs, le n≈ìud de Jing construit ensuite la transaction coinbase pour se payer 25,09094928 bitcoins.</p>
</div>
<div class="paragraph data-line-299">
<p>Comme vous pouvez le voir dans <a href="#generation_tx_example">Transaction coinbase</a>, la transaction coinbase a un format sp√©cial. Au lieu d&#8217;une entr√©e de transaction sp√©cifiant un UTXO pr√©c√©dent √† d√©penser, il a une entr√©e "coinbase". Nous avons examin√© les entr√©es de transaction dans <a href="#tx_in_structure">S√©rialisation des entr√©es de transaction</a>. Comparons une entr√©e de transaction r√©guli√®re avec une entr√©e de transaction coinbase. <a href="#table_8-1">La structure d&#8217;une entr√©e de transaction "normale"</a> montre la structure d&#8217;une entr√©e de transaction normale, tandis que <a href="#table_8-2">La structure d&#8217;une entr√©e de transaction coinbase</a> montre la structure de l&#8217;entr√©e de la transaction coinbase.</p>
</div>
<table id="table_8-1" class="tableblock frame-all grid-all stretch data-line-304">
<caption class="title">Table 27. La structure d&#8217;une entr√©e de transaction "normale"</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pointeur vers la transaction contenant l&#8217;UTXO √† d√©penser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indice de sortie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le num√©ro d&#8217;index de l&#8217;UTXO √† d√©penser, le premier est 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1‚Äì9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille du script de d√©verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur du script de d√©verrouillage en octets, √† suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©verrouillage-Script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un script remplissant les conditions du script de verrouillage UTXO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Num√©ro de s√©quence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G√©n√©ralement d√©fini sur 0xFFFFFFFF pour d√©sactiver BIP 125 et BIP 68</p></td>
</tr>
</tbody>
</table>
<table id="table_8-2" class="tableblock frame-all grid-all stretch data-line-316">
<caption class="title">Table 28. La structure d&#8217;une entr√©e de transaction coinbase</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tous les bits sont √† z√©ro¬†: pas une r√©f√©rence de hachage de transaction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indice de sortie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tous les bits sont des uns¬†: 0xFFFFFFFF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1‚Äì9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille des donn√©es coinbase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur des donn√©es coinbase, de 2 √† 100 octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Donn√©es coinbase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Donn√©es arbitraires utilis√©es pour les nonce suppl√©mentaires et les balises mini√®res. Dans les blocs v2¬†; doit commencer par la hauteur du bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Num√©ro de s√©quence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R√©gl√© sur 0xFFFFFFFF</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-325">
<p>Dans une transaction coinbase, les deux premiers champs sont d√©finis sur des valeurs qui ne repr√©sentent pas une r√©f√©rence UTXO. Au lieu d&#8217;un "hachage de transaction", le premier champ est rempli de 32 octets tous mis √† z√©ro. "L&#8217;index de sortie" est rempli de 4 octets tous mis √† 0xFF (255 d√©cimal). Le "script de d√©verrouillage" (<code>scriptSig</code>) est remplac√© par les donn√©es coinbase, un champ de donn√©es utilis√© par les mineurs, comme nous le verrons ensuite.</p>
</div>
</div>
<div class="sect3 data-line-327">
<h4 id="_donn√©es_coinbase">Donn√©es coinbase</h4>
<div class="paragraph data-line-329">
<p>Les transactions coinbase n&#8217;ont pas de champ de script de d√©verrouillage (aka, <code>scriptSig</code>). Au lieu de cela, ce champ est remplac√© par des donn√©es coinbase, qui doivent √™tre comprises entre 2 et 100 octets. √Ä l&#8217;exception des premiers octets, le reste des donn√©es de coinbase peut √™tre utilis√© par les mineurs comme ils le souhaitent ; ce sont des donn√©es arbitraires.</p>
</div>
<div class="paragraph data-line-331">
<p>Dans le bloc de gen√®se, par exemple, Satoshi Nakamoto a ajout√© le texte "The Times 03/Jan/2009 Chancellor on bound of second bailout for banks" dans les donn√©es coinbase, l&#8217;utilisant comme preuve de la date et pour transmettre un message. Actuellement, les mineurs utilisent les donn√©es coinbase pour inclure des valeurs nonce suppl√©mentaires et des cha√Ænes identifiant le bassin de minage.</p>
</div>
<div class="paragraph data-line-333">
<p>Les premiers octets de la coinbase √©taient auparavant arbitraires, mais ce n&#8217;est plus le cas. Conform√©ment √† BIP-34, les blocs de version 2 (blocs avec le champ de version d√©fini sur 2) doivent contenir l&#8217;index de hauteur de bloc en tant qu&#8217;op√©ration "push" (pousser) de script au d√©but du champ coinbase.</p>
</div>
<div class="paragraph data-line-335">
<p>Dans le bloc 277 316, nous voyons que le coinbase (voir <a href="#generation_tx_example">Transaction coinbase</a>), qui se trouve dans le script de d√©verrouillage ou le champ <code>scriptSig</code> de l&#8217;entr√©e de transaction, contient la valeur hexad√©cimale <code>03443b0403858402062f503253482f</code>. D√©codons cette valeur.</p>
</div>
<div class="paragraph data-line-337">
<p>Le premier octet, <code>03</code>, indique au moteur d&#8217;ex√©cution de script de pousser les trois octets suivants sur la pile de script (voir <a href="#tx_script_ops_table_pushdata">Pousser la valeur sur la pile</a>). Les trois octets suivants, <code>0x443b04</code>, sont la hauteur de bloc encod√©e au format little-endian (petit-boutiste, octet le moins significatif en premier). Inversez l&#8217;ordre des octets et le r√©sultat est <code>0x043b44</code>, soit 277 316 en d√©cimal.</p>
</div>
<div class="paragraph data-line-339">
<p>Les quelques chiffres hexad√©cimaux suivants (<code>0385840206</code>) sont utilis√©s pour coder un <em>nonce</em> suppl√©mentaire (voir <a href="#extra_nonce">La solution nonce (nombre al√©atoire) suppl√©mentaire</a>), ou valeur al√©atoire, utilis√©e pour trouver une solution de preuve de travail appropri√©e.</p>
</div>
<div class="paragraph data-line-341">
<p>La partie finale de la donn√©e coinbase (<code>2f503253482f</code>) est une cha√Æne de caract√®res ASCII encod√©es <span class="keep-together"><code>/P2SH/</code></span>, ce qui indique que le n≈ìud de minage qui a min√© ce bloc prend en charge l&#8217;am√©lioration P2SH d√©finie dans BIP-16. L&#8217;introduction de la capacit√© P2SH a n√©cessit√© une signalisation par les mineurs pour approuver le BIP-16 ou le BIP-17. Ceux qui approuvaient la mise en ≈ìuvre du BIP-16 devaient inclure la cha√Æne <code>/P2SH/</code> dans leurs donn√©es coinbase. Ceux qui approuvaient l&#8217;impl√©mentation BIP-17 de P2SH devaient inclure la cha√Æne <code>p2sh/CHV</code> dans leurs donn√©es coinbase. Enfin, le BIP-16 a √©t√© √©lu vainqueur, et de nombreux mineurs ont continu√© √† inclure la cha√Æne <code>/P2SH/</code> dans leur coinbase pour indiquer qu&#8217;ils prennent en charge cette fonctionnalit√©.</p>
</div>
<div class="paragraph data-line-343">
<p><a href="#satoshi_words">Extraire les donn√©es coinbase du bloc genesis</a> utilise la biblioth√®que libbitcoin introduite dans <a href="#alt_libraries">Clients, biblioth√®ques et bo√Ætes √† outils alternatifs</a> pour extraire les donn√©es coinbase du bloc de gen√®se, affichant le message de Satoshi. Notez que la biblioth√®que libbitcoin contient une copie statique du bloc de gen√®se, de sorte que l&#8217;exemple de code peut r√©cup√©rer le bloc de gen√®se directement √† partir de la biblioth√®que.</p>
</div>
<div id="satoshi_words" class="exampleblock data-line-347">
<div class="title">Example 27. Extraire les donn√©es coinbase du bloc genesis</div>
<div class="content">
<div class="listingblock data-line-349">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">/*
  Affichez le message du bloc de gen√®se de Satoshi.
*/
#include &lt;iostream&gt;
#include &lt;bitcoin/bitcoin.hpp&gt;

int main()
{
    // Cr√©er un bloc de gen√®se.
    bc::chain::block block = bc::chain::block::genesis_mainnet();
    // Le bloc de gen√®se contient une seule transaction coinbase.
    assert(block.transactions().size() == 1);
    // Obtenez la premi√®re transaction du bloc (coinbase).
    const bc::chain::transaction&amp; coinbase_tx = block.transactions()[0];
    // Coinbase tx a une seule entr√©e.
    assert(coinbase_tx.inputs().size() == 1);
    const bc::chain::input&amp; coinbase_input = coinbase_tx.inputs()[0];
    // Convertissez le script d'entr√©e dans son format brut.
    const auto prefix = false;
    const bc::data_chunk&amp; raw_message = coinbase_input.script().to_data(prefix);
    // Convertissez ceci en std::string.
    std::string message(raw_message.begin(), raw_message.end());
    // Affichez le message du bloc de gen√®se.
    std::cout &lt;&lt; message &lt;&lt; std::endl;
    return 0;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-354">
<p>Nous compilons le code avec le compilateur GNU C++ et ex√©cutons l&#8217;ex√©cutable r√©sultant, comme indiqu√© dans <a href="#satoshi_words_run">Compilation et ex√©cution de l&#8217;exemple de code satoshi-words</a>.</p>
</div>
<div id="satoshi_words_run" class="exampleblock data-line-358">
<div class="title">Example 28. Compilation et ex√©cution de l&#8217;exemple de code satoshi-words</div>
<div class="content">
<div class="listingblock data-line-360">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Compiler le code
$  g++ -o satoshi-words satoshi-words.cpp $(pkg-config --cflags --libs libbitcoin)
# Lancer l'ex√©cutable
$ ./satoshi-words
^DÔøΩÔøΩ&lt;GS&gt;^A^DEThe Times 03/Jan/2009 Chancellor on brink of second bailout for banks</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-369">
<h3 id="_construction_de_len_t√™te_de_bloc">Construction de l&#8217;en-t√™te de bloc</h3>
<div class="paragraph data-line-371">
<p> Pour construire l&#8217;en-t√™te de bloc, le n≈ìud d&#8217;exploration de donn√©es doit remplir six champs, comme indiqu√© dans <a href="#block_header_structure_ch10">La structure de l&#8217;ent√™te du bloc</a>.</p>
</div>
<table id="block_header_structure_ch10" class="tableblock frame-all grid-all stretch data-line-376">
<caption class="title">Table 29. La structure de l&#8217;ent√™te du bloc</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un num√©ro de version pour suivre les mises √† niveau du logiciel/protocole</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de bloc pr√©c√©dent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Une r√©f√©rence au hachage du bloc pr√©c√©dent (parent) dans la cha√Æne</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Racine de Merkle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un hachage de la racine de l&#8217;arbre de Merkle des transactions de ce bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Horodatage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le temps de cr√©ation approximatif de ce bloc (secondes √† partir d&#8217;Unix Epoch)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La cible de l&#8217;algorithme de preuve de travail pour ce bloc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un compteur utilis√© pour l&#8217;algorithme de preuve de travail</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-386">
<p>Au moment o√π le bloc 277 316 a √©t√© min√©, le num√©ro de version d√©crivant la structure du bloc est la version 2, qui est cod√©e au format petit-boutiste sur 4 octets sous la forme <code>0x02000000</code>.</p>
</div>
<div class="paragraph data-line-388">
<p>Ensuite, le n≈ìud de minage doit ajouter le "Previous Block Hash" (hachage de bloc pr√©c√©dent, √©galement appel√© <code>prevhash</code>). C&#8217;est le hachage de l&#8217;en-t√™te de bloc du bloc 277,315, le bloc pr√©c√©dent re√ßu du r√©seau, que le n≈ìud de Jing a accept√© et s√©lectionn√© comme <em>parent</em> du bloc candidat 277,316. Le hachage d&#8217;en-t√™te de bloc pour le bloc 277¬†315 est¬†:</p>
</div>
<div class="listingblock data-line-390">
<div class="content">
<pre>0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569</pre>
</div>
</div>
<div class="admonitionblock tip data-line-395">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-396">
<p>En s√©lectionnant le bloc <em>parent</em> sp√©cifique, indiqu√© par le champ Hash du bloc pr√©c√©dent dans l&#8217;en-t√™te du bloc candidat, Jing engage sa puissance mini√®re √† √©tendre la cha√Æne qui se termine dans ce bloc sp√©cifique. En substance, c&#8217;est ainsi que Jing "vote" avec son pouvoir minier pour la cha√Æne valide la plus longue.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-399">
<p>L&#8217;√©tape suivante consiste √† r√©sumer toutes les transactions avec un arbre de Merkle, afin d&#8217;ajouter la racine de Merkle √† la en-t√™te de bloc. La transaction coinbase est r√©pertori√©e comme la premi√®re transaction du bloc. Ensuite, 418 transactions suppl√©mentaires sont ajout√©es apr√®s, pour un total de 419 transactions dans le bloc. Comme nous l&#8217;avons vu dans le <a href="#merkle_trees">Arbres de Merkle</a>, il doit y avoir un nombre pair de n≈ìuds "feuilles" dans l&#8217;arbre, donc la derni√®re transaction est dupliqu√©e, cr√©ant 420 n≈ìuds, chacun contenant le hachage d&#8217;une transaction. Les hachages de transaction sont ensuite combin√©s, par paires, cr√©ant chaque niveau de l&#8217;arbre, jusqu&#8217;√† ce que toutes les transactions soient r√©sum√©es en un n≈ìud √† la "racine" de l&#8217;arbre. La racine de l&#8217;arborescence de Merkle r√©sume toutes les transactions en une seule valeur de 32 octets, que vous pouvez voir r√©pertori√©e comme "racine de Merkle" dans <a href="#block277316">Utiliser la ligne de commande pour r√©cup√©rer le bloc 277,316</a>, et ici :</p>
</div>
<div class="listingblock data-line-401">
<div class="content">
<pre>c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e</pre>
</div>
</div>
<div class="paragraph data-line-405">
<p>Le n≈ìud minier de Jing ajoutera alors un horodatage de 4 octets, cod√© comme un horodatage "d&#8217;√©poque" Unix, qui est bas√© sur le nombre de secondes √©coul√©es depuis minuit UTC, le jeudi 1er janvier 1970. L&#8217;heure <code>1388185914</code> est √©gale √† vendredi , 27 d√©cembre 2013, 23:11:54 UTC.</p>
</div>
<div class="paragraph data-line-407">
<p>Le n≈ìud de Jing remplit ensuite la cible, qui d√©finit la preuve de travail requise pour en faire un bloc valide. La cible est stock√©e dans le bloc en tant que m√©trique de "bits cibles", qui est un codage d&#8217;exposant de mantisse de la cible. Le codage a un exposant de 1 octet, suivi d&#8217;une mantisse de 3 octets (coefficient). Dans le bloc 277 316, par exemple, la valeur des bits cibles est <code>0x1903a30c</code>. La premi√®re partie <code>0x19</code> est un exposant hexad√©cimal, tandis que la partie suivante, <code>0x03a30c</code>, est le coefficient. Le concept de cible est expliqu√© dans <a href="#target">Reciblage pour ajuster la difficult√©</a> et la repr√©sentation des "bits cibles" est expliqu√©e dans <a href="#target_bits">Repr√©sentation cible</a>.</p>
</div>
<div class="paragraph data-line-409">
<p>Le dernier champ est le nonce, qui est initialis√© √† z√©ro.</p>
</div>
<div class="paragraph data-line-411">
<p>Une fois tous les autres champs remplis, l&#8217;en-t√™te du bloc est maintenant termin√© et le processus d&#8217;extraction peut commencer. L&#8217;objectif est maintenant de trouver une valeur pour le nonce qui se traduit par un hachage d&#8217;en-t√™te de bloc √©gal ou inf√©rieur √† la cible. Le n≈ìud de minage devra tester des milliards ou des billions de valeurs de nonce avant de trouver un nonce qui r√©ponde √† l&#8217;exigence.</p>
</div>
</div>
<div class="sect2 data-line-413">
<h3 id="_miner_le_bloc">Miner le bloc</h3>
<div class="paragraph data-line-415">
<p>Maintenant qu&#8217;un bloc candidat a √©t√© construit par le n≈ìud de Jing, il est temps pour la plate-forme de minage mat√©riel de Jing de "miner" le bloc, pour trouver une solution √† l&#8217;algorithme de preuve de travail qui rend le bloc valide. Tout au long de ce livre, nous avons √©tudi√© les fonctions de hachage cryptographique utilis√©es dans divers aspects du syst√®me Bitcoin. La fonction de hachage SHA256 est la fonction utilis√©e dans le processus d&#8217;extraction de bitcoin.</p>
</div>
<div class="paragraph data-line-417">
<p> Dans les termes les plus simples, le minage est le processus de hachage r√©p√©t√© de l&#8217;en-t√™te de bloc, en modifiant un param√®tre, jusqu&#8217;√† ce que le hachage r√©sultant corresponde √† une cible sp√©cifique. Le r√©sultat de la fonction de hachage ne peut pas √™tre d√©termin√© √† l&#8217;avance, pas plus qu&#8217;un mod√®le ne peut √™tre cr√©√© qui produira une valeur de hachage sp√©cifique. Cette caract√©ristique des fonctions de hachage signifie que la seule fa√ßon de produire un r√©sultat de hachage correspondant √† une cible sp√©cifique est d&#8217;essayer encore et encore, en modifiant de mani√®re al√©atoire l&#8217;entr√©e jusqu&#8217;√† ce que le r√©sultat de hachage souhait√© apparaisse par hasard.</p>
</div>
<div class="sect3 data-line-419">
<h4 id="_algorithme_de_preuve_de_travail">Algorithme de preuve de travail</h4>
<div class="paragraph data-line-421">
<p>Un algorithme de hachage prend une entr√©e de donn√©es de longueur arbitraire et produit un r√©sultat d√©terministe de longueur fixe, c-√†-d une empreinte num√©rique de l&#8217;entr√©e. Pour toute entr√©e sp√©cifique, le hachage r√©sultant sera toujours le m√™me et peut √™tre facilement calcul√© et v√©rifi√© par toute personne mettant en ≈ìuvre le m√™me algorithme de hachage. La principale caract√©ristique d&#8217;un algorithme de hachage cryptographique est qu&#8217;il est impossible de trouver deux entr√©es diff√©rentes qui produisent la m√™me empreinte digitale (appel√©e <em>collision</em>). En corollaire, il est √©galement pratiquement impossible de s√©lectionner une entr√©e de mani√®re √† produire une empreinte digitale souhait√©e, autrement qu&#8217;en essayant des entr√©es al√©atoires.</p>
</div>
<div class="paragraph data-line-423">
<p>Avec SHA256, la sortie a toujours une longueur de 256 bits, quelle que soit la taille de l&#8217;entr√©e. Dans <a href="#sha256_example1">Exemple SHA256</a>, nous utiliserons l&#8217;interpr√©teur Python pour calculer le hachage SHA256 de la phrase "Je suis Satoshi Nakamoto".</p>
</div>
<div id="sha256_example1" class="exampleblock data-line-427">
<div class="title">Example 29. Exemple SHA256</div>
<div class="content">
<div class="listingblock data-line-429">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python</code></pre>
</div>
</div>
<div class="listingblock data-line-433">
<div class="content">
<pre class="highlight"><code class="language-pycon" data-lang="pycon">Python 3.7.3
&gt;&gt;&gt; import hashlib
&gt;&gt;&gt; hashlib.sha256(b"I am Satoshi Nakamoto").hexdigest()
'5d7c7ba21cbbcd75d14800b100252d5b428e5b1213d27c385bc141ca6b47989e'</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-441">
<p><a href="#sha256_example1">Exemple SHA256</a> montre le r√©sultat du calcul du hachage de <code>"Je suis Satoshi Nakamoto"</code>¬†: <code>5d7c7ba21cbbcd75d14800b100252d5b428e5b1213d27c385bc141ca6b47989e</code>. Ce nombre de 256 bits est le r√©sultat de <em>hachage</em> ou <em>pr√©traitement</em> de la phrase et d√©pend de chaque partie de la phrase. L&#8217;ajout d&#8217;une seule lettre, d&#8217;un signe de ponctuation ou de tout autre caract√®re produira un hachage diff√©rent.</p>
</div>
<div class="paragraph data-line-443">
<p>Maintenant, si nous changeons la phrase, nous devrions nous attendre √† voir des hachages compl√®tement diff√©rents. Essayons cela en ajoutant un nombre √† la fin de notre phrase, en utilisant le script Python simple dans <a href="#sha256_example_generator">Script SHA256 pour g√©n√©rer de nombreux hachages en it√©rant sur un nonce</a>.</p>
</div>
<div id="sha256_example_generator" class="exampleblock data-line-447">
<div class="title">Example 30. Script SHA256 pour g√©n√©rer de nombreux hachages en it√©rant sur un nonce</div>
<div class="content">
<div class="listingblock c_less_space data-line-450">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># exemple d'it√©ration d'un nonce dans l'entr√©e d'un algorithme de hachage

import hashlib

text = "I am Satoshi Nakamoto"

# it√©rer nonce de 0 √† 19
for nonce in xrange(20):

    # ajouter le nonce √† la fin du texte
    input = text + str(nonce)

    # calculer le hachage SHA-256 de l'entr√©e (texte + nonce)
    hash = hashlib.sha256(input).hexdigest()

    # afficher l'entr√©e et le r√©sultat du hachage
    print input, '=&gt;',  hash </code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-455">
<p>L&#8217;ex√©cution de ceci produira les hachages de plusieurs phrases, rendues diff√©rentes en ajoutant un nombre √† la fin du texte. En incr√©mentant le nombre, nous pouvons obtenir diff√©rents hachages, comme indiqu√© dans <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour g√©n√©rer de nombreux hachages en it√©rant sur un nombre al√©atoire</a>.</p>
</div>
<div id="sha256_example_generator_output" class="exampleblock data-line-459">
<div class="title">Example 31. Sortie SHA256 d&#8217;un script pour g√©n√©rer de nombreux hachages en it√©rant sur un nombre al√©atoire</div>
<div class="content">
<div class="listingblock data-line-461">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python hash_example.py</code></pre>
</div>
</div>
<div class="listingblock data-line-465">
<div class="content">
<pre>I am Satoshi Nakamoto0 =&gt; a80a81401765c8eddee25df36728d732...
I am Satoshi Nakamoto1 =&gt; f7bc9a6304a4647bb41241a677b5345f...
I am Satoshi Nakamoto2 =&gt; ea758a8134b115298a1583ffb80ae629...
I am Satoshi Nakamoto3 =&gt; bfa9779618ff072c903d773de30c99bd...
I am Satoshi Nakamoto4 =&gt; bce8564de9a83c18c31944a66bde992f...
I am Satoshi Nakamoto5 =&gt; eb362c3cf3479be0a97a20163589038e...
I am Satoshi Nakamoto6 =&gt; 4a2fd48e3be420d0d28e202360cfbaba...
I am Satoshi Nakamoto7 =&gt; 790b5a1349a5f2b909bf74d0d166b17a...
I am Satoshi Nakamoto8 =&gt; 702c45e5b15aa54b625d68dd947f1597...
I am Satoshi Nakamoto9 =&gt; 7007cf7dd40f5e933cd89fff5b791ff0...
I am Satoshi Nakamoto10 =&gt; c2f38c81992f4614206a21537bd634a...
I am Satoshi Nakamoto11 =&gt; 7045da6ed8a914690f087690e1e8d66...
I am Satoshi Nakamoto12 =&gt; 60f01db30c1a0d4cbce2b4b22e88b9b...
I am Satoshi Nakamoto13 =&gt; 0ebc56d59a34f5082aaef3d66b37a66...
I am Satoshi Nakamoto14 =&gt; 27ead1ca85da66981fd9da01a8c6816...
I am Satoshi Nakamoto15 =&gt; 394809fb809c5f83ce97ab554a2812c...
I am Satoshi Nakamoto16 =&gt; 8fa4992219df33f50834465d3047429...
I am Satoshi Nakamoto17 =&gt; dca9b8b4f8d8e1521fa4eaa46f4f0cd...
I am Satoshi Nakamoto18 =&gt; 9989a401b2a3a318b01e9ca9a22b0f3...
I am Satoshi Nakamoto19 =&gt; cda56022ecb5b67b2bc93a2d764e75f...</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-489">
<p>Chaque phrase produit un r√©sultat de hachage compl√®tement diff√©rent. Ils semblent compl√®tement al√©atoires, mais vous pouvez reproduire les r√©sultats exacts de cet exemple sur n&#8217;importe quel ordinateur avec Python et voir les m√™mes hachages exacts.</p>
</div>
<div class="paragraph data-line-491">
<p>Le nombre utilis√© comme variable dans un tel sc√©nario est appel√© un <em>nonce</em> (ou nombre al√©atoire). Le nonce est utilis√© pour faire varier la sortie d&#8217;une fonction cryptographique, dans ce cas pour faire varier l&#8217;empreinte SHA256 de la phrase.</p>
</div>
<div class="paragraph data-line-493">
<p>Pour relever le d√©fi de cet algorithme, fixons-nous un objectif¬†: trouver une phrase qui produit un hachage hexad√©cimal commen√ßant par un z√©ro. Heureusement, ce n&#8217;est pas difficile ! <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour g√©n√©rer de nombreux hachages en it√©rant sur un nombre al√©atoire</a> montre que la phrase "I am Satoshi Nakamoto13" produit le hash <code>0ebc56d59a34f5082aaef3d66b37a661696c2b618e62432727216ba9531041a5</code>, ce qui correspond √† nos crit√®res. Il a fallu 13 tentatives pour le trouver. En termes de probabilit√©s, si la sortie de la fonction de hachage est uniform√©ment distribu√©e, nous nous attendrions √† trouver un r√©sultat avec un 0 comme pr√©fixe hexad√©cimal une fois tous les 16 hachages (un sur 16 chiffres hexad√©cimaux de 0 √† F). En termes num√©riques, cela signifie trouver une valeur de hachage inf√©rieure √† <code>0x100000000000000000000000000000000000000000000000000000000000</code>. Nous appelons ce seuil la <em>cible</em> et le but est de trouver un hachage qui est num√©riquement √©gal ou inf√©rieur √† la cible. Si nous diminuons la cible, la t√¢che de trouver un hachage inf√©rieur √† la cible devient de plus en plus difficile.</p>
</div>
<div class="paragraph data-line-495">
<p>Pour donner une analogie simple, imaginez un jeu o√π les joueurs lancent une paire de d√©s √† plusieurs reprises, en essayant de lancer autant ou moins qu&#8217;une cible sp√©cifi√©e. Au premier tour, l&#8217;objectif est de 11. √Ä moins que vous ne lanciez un double-six, vous gagnez. Au tour suivant, l&#8217;objectif est de 10. Les joueurs doivent lancer 10 ou moins pour gagner, encore une fois une t√¢che facile. Disons que quelques tours plus tard, l&#8217;objectif est tomb√© √† 5. Maintenant, plus de la moiti√© des lancers de d√©s d√©passeront l&#8217;objectif et seront donc invalides. Il faut exponentiellement plus de lancers de d√©s pour gagner, plus la cible est basse. Finalement, lorsque l&#8217;objectif est de 2 (le minimum possible), un seul lancer sur 36, soit 2¬†% d&#8217;entre eux, produira un r√©sultat gagnant.</p>
</div>
<div class="paragraph data-line-497">
<p>Du point de vue d&#8217;un observateur qui sait que la cible du jeu de d√©s est 2, si quelqu&#8217;un a r√©ussi √† lancer un lancer gagnant, on peut supposer qu&#8217;il a tent√©, en moyenne, 36 lancers. En d&#8217;autres termes, on peut estimer la quantit√© de travail n√©cessaire pour r√©ussir √† partir de la difficult√© impos√©e par la cible. Lorsque l&#8217;algorithme est bas√© sur une fonction d√©terministe telle que SHA256, l&#8217;entr√©e elle-m√™me constitue la <em>preuve</em> qu&#8217;une certaine quantit√© de <em>travail</em> a √©t√© effectu√©e pour produire un r√©sultat √©gal ou inf√©rieur √† la cible. Par cons√©quent, la <em>Preuve de travail</em>.</p>
</div>
<div class="admonitionblock tip data-line-500">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-501">
<p>M√™me si chaque tentative produit un r√©sultat al√©atoire, la probabilit√© de tout r√©sultat possible peut √™tre calcul√©e √† l&#8217;avance. Par cons√©quent, un r√©sultat d&#8217;une difficult√© sp√©cifi√©e constitue la preuve d&#8217;une quantit√© de travail sp√©cifique.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-504">
<p>Dans <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour g√©n√©rer de nombreux hachages en it√©rant sur un nombre al√©atoire</a>, le "nonce" gagnant est 13 et ce r√©sultat peut √™tre confirm√© par n&#8217;importe qui ind√©pendamment. N&#8217;importe qui peut ajouter le nombre 13 comme suffixe √† la phrase "Je suis Satoshi Nakamoto" et calculer le hachage, en v√©rifiant qu&#8217;il est inf√©rieur √† la cible. Le r√©sultat r√©ussi est √©galement une preuve de travail, car cela prouve que nous avons fait le travail pour trouver ce nonce. Alors qu&#8217;il ne faut qu&#8217;un seul calcul de hachage pour v√©rifier, il nous a fallu 13 calculs de hachage pour trouver un nonce qui a fonctionn√©. Si nous avions une cible inf√©rieure (difficult√© plus √©lev√©e), il faudrait beaucoup plus de calculs de hachage pour trouver un nonce appropri√©, mais un seul calcul de hachage pour que quiconque puisse le v√©rifier. De plus, en connaissant la cible, n&#8217;importe qui peut estimer la difficult√© √† l&#8217;aide de statistiques et donc savoir combien de travail a √©t√© n√©cessaire pour trouver un tel nonce.</p>
</div>
<div class="admonitionblock tip data-line-507">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-508">
<p>La preuve de travail doit produire un hachage qui est <em>√©gal ou inf√©rieur √†</em> la cible. Une cible plus √©lev√©e signifie qu&#8217;il est moins difficile de trouver un hachage √©gal ou inf√©rieur √† la cible. Une cible inf√©rieure signifie qu&#8217;il est plus difficile de trouver un hachage √©gal ou inf√©rieur √† la cible. La cible et la difficult√© sont inversement li√©es.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-512">
<p> La preuve de travail de Bitcoin est tr√®s similaire au d√©fi pr√©sent√© dans <a href="#sha256_example_generator_output">Sortie SHA256 d&#8217;un script pour g√©n√©rer de nombreux hachages en it√©rant sur un nombre al√©atoire</a>. Le mineur construit un bloc candidat rempli de transactions. Ensuite, le mineur calcule le hachage de l&#8217;en-t√™te de ce bloc et voit s&#8217;il est √©gal ou inf√©rieur √† la <em>cible</em> actuelle. Si le hachage est sup√©rieur √† la cible, le mineur modifiera le nonce (g√©n√©ralement en l&#8217;incr√©mentant simplement de un) et r√©essayera. √Ä la difficult√© actuelle du r√©seau Bitcoin, les mineurs doivent essayer des quadrillions de fois avant de trouver un nonce qui se traduit par un hachage d&#8217;en-t√™te de bloc suffisamment bas.</p>
</div>
<div class="paragraph data-line-514">
<p>Un algorithme de preuve de travail tr√®s simplifi√© est impl√©ment√© en Python dans <a href="#pow_example1">Mise en ≈ìuvre simplifi√©e de la preuve de travail</a>.</p>
</div>
<div id="pow_example1" class="exampleblock data-line-518">
<div class="title">Example 32. Mise en ≈ìuvre simplifi√©e de la preuve de travail</div>
<div class="content">
<div class="listingblock data-line-520">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# exemple d'algorithme de preuve de travail

import hashlib
import time

max_nonce = 2 ** 32 # 4 billion

def proof_of_work(header, difficulty_bits):

    # calculer l'objectif de difficult√©
    target = 2 ** (256-difficulty_bits)

    for nonce in xrange(max_nonce):
        hash_result = hashlib.sha256(str(header)+str(nonce)).hexdigest()

        # v√©rifier s'il s'agit d'un r√©sultat valide, en dessous de la cible
        if long(hash_result, 16) &lt; target:
            print "Success with nonce %d" % nonce
            print "Hash is %s" % hash_result
            return (hash_result,nonce)

    print "Failed after %d (max_nonce) tries" % nonce
    return nonce


if __name__ == '__main__':

    nonce = 0
    hash_result = ''

    # difficult√© de 0 √† 31 bits
    for difficulty_bits in xrange(32):

        difficulty = 2 ** difficulty_bits
        print "Difficulty: %ld (%d bits)" % (difficulty, difficulty_bits)

        print "Starting search..."

        # point de contr√¥le de l'heure actuelle
        start_time = time.time()

        # faire un nouveau bloc qui inclut le hachage du bloc pr√©c√©dent nous simulons un bloc de transactions - juste une cha√Æne
        new_block = 'test block with transactions' + hash_result

        # trouver un nonce valide pour le nouveau bloc
        (hash_result, nonce) = proof_of_work(new_block, difficulty_bits)

        # point de contr√¥le combien de temps il a fallu pour trouver un r√©sultat
        end_time = time.time()

        elapsed_time = end_time - start_time
        print "Elapsed Time: %.4f seconds" % elapsed_time

        if elapsed_time &gt; 0:

            # estimer les hachages par seconde
            hash_power = float(long(nonce)/elapsed_time)
            print "Hashing Power: %ld hashes per second" % hash_power</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-525">
<p>En ex√©cutant ce code, vous pouvez d√©finir la difficult√© souhait√©e (en bits, combien de bits de t√™te doivent √™tre nuls) et voir combien de temps il faut √† votre ordinateur pour trouver une solution. Dans <a href="#pow_example_outputs">Ex√©cution de l&#8217;exemple de preuve de travail pour diverses difficult√©s</a>, vous pouvez voir comment cela fonctionne sur un ordinateur portable moyen.</p>
</div>
<div id="pow_example_outputs" class="exampleblock data-line-529">
<div class="title">Example 33. Ex√©cution de l&#8217;exemple de preuve de travail pour diverses difficult√©s</div>
<div class="content">
<div class="listingblock data-line-531">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ python proof-of-work-example.py*</code></pre>
</div>
</div>
<div class="listingblock data-line-535">
<div class="content">
<pre>Difficulty: 1 (0 bits)

[...]

Difficulty: 8 (3 bits)
Starting search...
Success with nonce 9
Hash is 1c1c105e65b47142f028a8f93ddf3dabb9260491bc64474738133ce5256cb3c1
Elapsed Time: 0.0004 seconds
Hashing Power: 25065 hashes per second
Difficulty: 16 (4 bits)
Starting search...
Success with nonce 25
Hash is 0f7becfd3bcd1a82e06663c97176add89e7cae0268de46f94e7e11bc3863e148
Elapsed Time: 0.0005 seconds
Hashing Power: 52507 hashes per second
Difficulty: 32 (5 bits)
Starting search...
Success with nonce 36
Hash is 029ae6e5004302a120630adcbb808452346ab1cf0b94c5189ba8bac1d47e7903
Elapsed Time: 0.0006 seconds
Hashing Power: 58164 hashes per second

[...]

Difficulty: 4194304 (22 bits)
Starting search...
Success with nonce 1759164
Hash is 0000008bb8f0e731f0496b8e530da984e85fb3cd2bd81882fe8ba3610b6cefc3
Elapsed Time: 13.3201 seconds
Hashing Power: 132068 hashes per second
Difficulty: 8388608 (23 bits)
Starting search...
Success with nonce 14214729
Hash is 000001408cf12dbd20fcba6372a223e098d58786c6ff93488a9f74f5df4df0a3
Elapsed Time: 110.1507 seconds
Hashing Power: 129048 hashes per second
Difficulty: 16777216 (24 bits)
Starting search...
Success with nonce 24586379
Hash is 0000002c3d6b370fccd699708d1b7cb4a94388595171366b944d68b2acce8b95
Elapsed Time: 195.2991 seconds
Hashing Power: 125890 hashes per second

[...]

Difficulty: 67108864 (26 bits)
Starting search...
Success with nonce 84561291
Hash is 0000001f0ea21e676b6dde5ad429b9d131a9f2b000802ab2f169cbca22b1e21a
Elapsed Time: 665.0949 seconds
Hashing Power: 127141 hashes per second</pre>
</div>
</div>
</div>
</div>
<div class="paragraph data-line-591">
<p>Comme vous pouvez le constater, augmenter la difficult√© de 1 bit entra√Æne un doublement du temps n√©cessaire pour trouver une solution. Si vous pensez √† l&#8217;ensemble de l&#8217;espace num√©rique de 256 bits, chaque fois que vous contraignez un bit de plus √† z√©ro, vous r√©duisez l&#8217;espace de recherche de moiti√©. Dans <a href="#pow_example_outputs">Ex√©cution de l&#8217;exemple de preuve de travail pour diverses difficult√©s</a>, il faut 84 millions de tentatives de hachage pour trouver un nonce qui produit un hachage avec 26 bits de t√™te en z√©ro. M√™me √† une vitesse de plus de 120 000 hachages par seconde, il faut tout de m√™me 10 minutes sur un portable pour trouver cette solution.</p>
</div>
<div class="paragraph data-line-593">
<p>Au moment de la r√©daction, le r√©seau tente de trouver un bloc dont le hachage d&#8217;en-t√™te est √©gal ou inf√©rieur √†¬†:</p>
</div>
<div class="listingblock data-line-595">
<div class="content">
<pre>0000000000000000029AB900000000000000000000000000000000000000000</pre>
</div>
</div>
<div class="paragraph data-line-599">
<p>Comme vous pouvez le voir, il y a beaucoup de z√©ros au d√©but de cette cible, ce qui signifie que la plage acceptable de hachages est beaucoup plus petite, il est donc plus difficile de trouver un hachage valide. Il faudra en moyenne plus de 1,8 z√™ta de hachages (mille milliards de milliards de hachages) pour que le r√©seau d√©couvre le bloc suivant. Cela semble √™tre une t√¢che impossible, mais heureusement, le r√©seau apporte 3 exa-hachages par seconde (EH/sec) de puissance de traitement, ce qui permettra de trouver un bloc en environ 10 minutes en moyenne.</p>
</div>
</div>
<div class="sect3 data-line-602">
<h4 id="target_bits">Repr√©sentation cible</h4>
<div class="paragraph data-line-604">
<p>Dans <a href="#block277316">Utiliser la ligne de commande pour r√©cup√©rer le bloc 277,316</a>, nous avons vu que le bloc contient la cible, dans une notation appel√©e "bits cible" ou simplement "bits", qui dans le bloc 277 316 a la valeur <code>0x1903a30c</code>. Cette notation exprime la cible de preuve de travail sous la forme d&#8217;un format coefficient/exposant, avec les deux premiers chiffres hexad√©cimaux pour l&#8217;exposant et les six chiffres hexad√©cimaux suivants pour le coefficient. Dans ce bloc, par cons√©quent, l&#8217;exposant est <code>0x19</code> et le coefficient est <code>0x03a30c</code>.</p>
</div>
<div class="paragraph data-line-606">
<p>La formule pour calculer la cible de difficult√© √† partir de cette repr√©sentation est :</p>
</div>
<ul class="simplelist">
  <li>cible = coefficient * 2 <sup>(8*(exposant‚Äì3))</sup></li>
</ul>
<div class="paragraph data-line-614">
<p>En utilisant cette formule et la valeur des bits de difficult√© 0x1903a30c, nous obtenons¬†:</p>
</div>
<ul class="simplelist">
  <li>cible = 0x03a30c * 2 <sup>0x08*(0x19-0x03)</sup></li>
  <li>=> cible = 0x03a30c * 2 <sup>(0x08*0x16)</sup></li>
  <li>=> cible = 0x03a30c * 2 <sup>0xB0</sup></li>
</ul>
<div class="paragraph data-line-624">
<p>qui en d√©cimal est :</p>
</div>
<ul class="simplelist">
  <li>=> cible = 238 348 * 2 <sup>176</sup></li>
  <li>=> cible =<br/> 22 829 202 948 393 929 850 749 706 076 701 368 331 072 452 018 388 575 715 328</li>
</ul>
<div class="paragraph data-line-633">
<p>retour en hexad√©cimal :</p>
</div>
<ul class="simplelist">
  <li>=> cible =<br/> 0x0000000000000003A30C000000000000000000000000000000000000000000</li>
</ul>
<div class="paragraph data-line-641">
<p>Cela signifie qu&#8217;un bloc valide pour la hauteur 277 316 est celui qui a un hachage d&#8217;en-t√™te de bloc inf√©rieur √† cette cible. En binaire, ce nombre doit avoir plus de 60 bits de t√™te mis √† z√©ro. Avec ce niveau de difficult√©, un seul mineur traitant 1 billion de hachages par seconde (1 terahash par seconde ou 1 TH/sec) ne trouverait une solution qu&#8217;une fois tous les 8 496 blocs ou une fois tous les 59 jours, en moyenne.</p>
</div>
</div>
<div class="sect3 data-line-644">
<h4 id="target">Reciblage pour ajuster la difficult√©</h4>
<div class="paragraph data-line-646">
<p> Comme nous l&#8217;avons vu, la cible d√©termine la difficult√© et affecte donc le temps qu&#8217;il faut pour trouver une solution √† l&#8217;algorithme de preuve de travail. Cela conduit √† des questions √©videntes¬†: pourquoi la difficult√© est-elle ajustable, qui l&#8217;ajuste et comment¬†?</p>
</div>
<div class="paragraph data-line-648">
<p>Les blocs de Bitcoin sont g√©n√©r√©s toutes les 10 minutes, en moyenne. C&#8217;est le battement de c≈ìur de bitcoin et sous-tend la fr√©quence d&#8217;√©mission de devises et la rapidit√© de r√®glement des transactions. Il doit rester constant non seulement √† court terme, mais sur une p√©riode de plusieurs d√©cennies. Au cours de cette p√©riode, on s&#8217;attend √† ce que la puissance des ordinateurs continue d&#8217;augmenter √† un rythme rapide. De plus, le nombre de participants √† l&#8217;exploitation mini√®re et les ordinateurs qu&#8217;ils utilisent changeront √©galement constamment. Pour maintenir le temps de g√©n√©ration de bloc √† 10 minutes, la difficult√© de minage doit √™tre ajust√©e pour tenir compte de ces changements. En fait, la cible de preuve de travail est un param√®tre dynamique qui est p√©riodiquement ajust√© pour atteindre un objectif d&#8217;intervalle de bloc de 10 minutes. En termes simples, l&#8217;objectif est d√©fini de sorte que la puissance mini√®re actuelle se traduise par un intervalle de bloc de 10 minutes.</p>
</div>
<div class="paragraph data-line-650">
<p>Comment, alors, un tel ajustement s&#8217;effectue-t-il dans un r√©seau totalement d√©centralis√© ? Le reciblage se produit automatiquement et sur chaque n≈ìud ind√©pendamment. Tous les 2 016 blocs, tous les n≈ìuds reciblent la preuve de travail. L&#8217;√©quation de reciblage mesure le temps qu&#8217;il a fallu pour trouver les 2 016 derniers blocs et le compare au temps pr√©vu de 20 160 minutes (2 016 blocs multipli√©s par l&#8217;intervalle de bloc de 10 minutes souhait√©). Le rapport entre la dur√©e r√©elle et la dur√©e souhait√©e est calcul√© et un ajustement proportionnel (√† la hausse ou √† la baisse) est apport√© √† la cible. En termes simples¬†: si le r√©seau trouve des blocs plus rapidement que toutes les 10¬†minutes, la difficult√© augmente (la cible diminue). Si la d√©couverte de blocs est plus lente que pr√©vu, la difficult√© diminue (la cible augmente).</p>
</div>
<div class="paragraph data-line-652">
<p>L&#8217;√©quation peut se r√©sumer ainsi :</p>
</div>
<div class="listingblock data-line-654">
<div class="content">
<pre>Nouvel objectif = Ancien objectif * (Heure r√©elle des 2016 derniers blocs / 20160 minutes)</pre>
</div>
</div>
<div class="paragraph data-line-658">
<p><a href="#retarget_code">Reciblage de la preuve de travail avec CalculateNextWorkRequired() dans pow.cpp</a> montre le code utilis√© dans le client Bitcoin Core.</p>
</div>
<div id="retarget_code" class="exampleblock data-line-662">
<div class="title">Example 34. Reciblage de la preuve de travail avec CalculateNextWorkRequired() dans pow.cpp</div>
<div class="content">
<div class="listingblock data-line-664">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">   // Limiter le pas de r√©glage
    int64_t nActualTimespan = pindexLast-&gt;GetBlockTime() - nFirstBlockTime;
    LogPrintf("  nActualTimespan = %d  before bounds\n", nActualTimespan);
    if (nActualTimespan &lt; params.nPowTargetTimespan/4)
        nActualTimespan = params.nPowTargetTimespan/4;
    if (nActualTimespan &gt; params.nPowTargetTimespan*4)
        nActualTimespan = params.nPowTargetTimespan*4;

    // Recibler
    const arith_uint256 bnPowLimit = UintToArith256(params.powLimit);
    arith_uint256 bnNew;
    arith_uint256 bnOld;
    bnNew.SetCompact(pindexLast-&gt;nBits);
    bnOld = bnNew;
    bnNew *= nActualTimespan;
    bnNew /= params.nPowTargetTimespan;

    if (bnNew &gt; bnPowLimit)
        bnNew = bnPowLimit;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note data-line-690">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-691">
<p>Bien que l&#8217;√©talonnage cible se produise tous les 2 016 blocs, en raison d&#8217;une erreur de un par un dans le client Bitcoin Core d&#8217;origine, il est bas√© sur le temps total des 2 015 blocs pr√©c√©dents (et non 2 016 comme il se doit), ce qui entra√Æne un biais de reciblage vers une difficult√© plus √©lev√©e de 0,05¬†%.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-695">
<p>Les param√®tres <code>Interval</code> (2 016 blocs) et <code>TargetTimespan</code> (deux semaines en 1 209 600 secondes) sont d√©finis dans <em>chainparams.cpp</em>.</p>
</div>
<div class="paragraph data-line-697">
<p>Pour √©viter une volatilit√© extr√™me de la difficult√©, l&#8217;ajustement de reciblage doit √™tre inf√©rieur √† un facteur quatre (4) par cycle. Si l&#8217;ajustement cible requis est sup√©rieur √† un facteur de quatre, il sera ajust√© d&#8217;un facteur de 4 et pas plus. Tout autre ajustement sera effectu√© au cours de la prochaine p√©riode de reciblage, car le d√©s√©quilibre persistera au cours des 2 016 prochains blocs. Par cons√©quent, des √©carts importants entre la puissance de hachage et la difficult√© peuvent n√©cessiter plusieurs cycles de blocs de 2 016 pour s&#8217;√©quilibrer.</p>
</div>
<div class="admonitionblock tip data-line-700">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-701">
<p>La difficult√© d&#8217;extraction d&#8217;un bloc de bitcoins est d&#8217;environ '10 minutes de traitement' pour l&#8217;ensemble du r√©seau, sur la base du temps qu&#8217;il a fallu pour extraire les 2 016 blocs pr√©c√©dents, ajust√© tous les 2 016 blocs. Ceci est r√©alis√© en abaissant ou en √©levant la cible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-704">
<p>Notez que la cible est ind√©pendante du nombre de transactions ou de la valeur des transactions. Cela signifie que la quantit√© de puissance de hachage et donc d&#8217;√©lectricit√© d√©pens√©e pour s√©curiser le bitcoin est √©galement enti√®rement ind√©pendante du nombre de transactions. Bitcoin peut √©voluer et parvenir √† une adoption plus large et rester s√©curis√© sans aucune augmentation de la puissance de hachage par rapport au niveau actuel. L&#8217;augmentation de la puissance de hachage repr√©sente les forces du march√© alors que de nouveaux mineurs entrent sur le march√© pour concourir pour la r√©compense. Tant qu&#8217;une puissance de hachage suffisante est sous le contr√¥le des mineurs agissant honn√™tement √† la recherche de la r√©compense, cela suffit pour emp√™cher les attaques de "prise de contr√¥le" et, par cons√©quent, il en est suffisant pour s√©curiser le bitcoin.</p>
</div>
<div class="paragraph data-line-706">
<p>La difficult√© du minage est √©troitement li√©e au co√ªt de l&#8217;√©lectricit√© et au taux de change du bitcoin vis-√†-vis de la monnaie utilis√©e pour payer l&#8217;√©lectricit√©. Les syst√®mes de minage hautes performances sont √† peu pr√®s aussi efficaces que possible avec la g√©n√©ration actuelle de fabrication de silicium, convertissant l&#8217;√©lectricit√© en calcul de hachage au taux le plus √©lev√© possible. La principale influence sur le march√© minier est le prix d&#8217;un kilowattheure d&#8217;√©lectricit√© en bitcoin, car cela d√©termine la rentabilit√© du minage et donc les incitations √† entrer ou √† sortir du march√© minier.</p>
</div>
</div>
</div>
<div class="sect2 data-line-708">
<h3 id="_r√©ussir_√†_miner_le_bloc">R√©ussir √† miner le bloc</h3>
<div class="paragraph data-line-710">
<p>Comme nous l&#8217;avons vu pr√©c√©demment, le n≈ìud de Jing a construit un bloc candidat et l&#8217;a pr√©par√© pour le minage. Jing poss√®de plusieurs plates-formes de minage mat√©riel avec des circuits int√©gr√©s sp√©cifiques √† l&#8217;application, o√π des centaines de milliers de circuits int√©gr√©s ex√©cutent l&#8217;algorithme SHA256 en parall√®le √† des vitesses incroyables. Beaucoup de ces machines sp√©cialis√©es sont connect√©es √† son n≈ìud minier via USB ou un r√©seau local. Ensuite, le n≈ìud de minage ex√©cut√© sur le bureau de Jing transmet l&#8217;en-t√™te de bloc √† son mat√©riel de minage, qui commence √† tester des milliards de nonces par seconde. Parce que le nonce n&#8217;est que de 32 bits, apr√®s avoir √©puis√© toutes les possibilit√©s de nonce (environ 4 milliards), le mat√©riel de minage modifie l&#8217;en-t√™te de bloc (en ajustant l&#8217;espace ou l&#8217;horodatage suppl√©mentaire du nonce coinbase) et r√©initialise le compteur de nonce, en testant de nouvelles combinaisons.</p>
</div>
<div class="paragraph data-line-712">
<p>Pr√®s de 11 minutes apr√®s avoir commenc√© √† miner le bloc 277 316, l&#8217;une des machines de minage de mat√©riel trouve une solution et la renvoie au n≈ìud de minage.</p>
</div>
<div class="paragraph data-line-714">
<p>Lorsqu&#8217;il est ins√©r√© dans l&#8217;en-t√™te de bloc, le nonce 924 591 752 produit un hachage de bloc de¬†:</p>
</div>
<div class="listingblock data-line-716">
<div class="content">
<pre>0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4</pre>
</div>
</div>
<div class="paragraph data-line-720">
<p>qui est inf√©rieur √† la cible¬†:</p>
</div>
<div class="listingblock data-line-722">
<div class="content">
<pre>0000000000000003A30C000000000000000000000000000000000000000000</pre>
</div>
</div>
<div class="paragraph data-line-726">
<p>Imm√©diatement, le n≈ìud minier de Jing transmet le bloc √† tous ses pairs. Ils re√ßoivent, valident puis propagent le nouveau bloc. Au fur et √† mesure que le bloc se r√©pand sur le r√©seau, chaque n≈ìud l&#8217;ajoute √† sa propre copie de la cha√Æne de blocs, l&#8217;√©tendant √† une nouvelle hauteur de 277 316 blocs. Au fur et √† mesure que les n≈ìuds miniers re√ßoivent et valident le bloc, ils abandonnent leurs efforts pour trouver un bloc √† la m√™me hauteur et commencent imm√©diatement √† calculer le bloc suivant dans la cha√Æne, en utilisant le bloc de Jing comme "parent". En construisant sur le bloc nouvellement d√©couvert de Jing, les autres mineurs "votent" essentiellement avec leur puissance mini√®re et approuvent le bloc de Jing et la cha√Æne qu&#8217;il prolonge.</p>
</div>
<div class="paragraph data-line-728">
<p>Dans la section suivante, nous examinerons le processus utilis√© par chaque n≈ìud pour valider un bloc et s√©lectionner la cha√Æne la plus longue, cr√©ant ainsi le consensus qui forme la cha√Æne de blocs d√©centralis√©e.</p>
</div>
</div>
<div class="sect2 data-line-730">
<h3 id="_validation_dun_nouveau_bloc">Validation d&#8217;un nouveau bloc</h3>
<div class="paragraph data-line-732">
<p>La troisi√®me √©tape du m√©canisme de consensus de bitcoin est l&#8217;ind√©pendante validation de chaque nouveau bloc par chaque n≈ìud du r√©seau. Au fur et √† mesure que le bloc nouvellement r√©solu se d√©place sur le r√©seau, chaque n≈ìud effectue une s√©rie de tests pour le valider avant de le propager √† ses pairs. Cela garantit que seuls les blocs valides sont propag√©s sur le r√©seau. La validation ind√©pendante garantit √©galement que les mineurs qui agissent honn√™tement obtiennent leurs blocs incorpor√©s dans la cha√Æne de blocs, gagnant ainsi la r√©compense. Les mineurs qui agissent de mani√®re malhonn√™te voient leurs blocs rejet√©s et non seulement perdent la r√©compense, mais gaspillent √©galement les efforts d√©ploy√©s pour trouver une solution de preuve de travail, encourant ainsi le co√ªt de l&#8217;√©lectricit√© sans compensation.</p>
</div>
<div class="paragraph data-line-734">
<p>Lorsqu&#8217;un n≈ìud re√ßoit un nouveau bloc, il valide le bloc en le comparant √† une longue liste de crit√®res qui doivent tous √™tre remplis¬†; sinon, le bloc est rejet√©. Ces crit√®res peuvent √™tre vus dans le client Bitcoin Core dans les fonctions <code>CheckBlock</code> et <code>CheckBlockHeader</code> et incluent :</p>
</div>
<div class="ulist data-line-736">
<ul>
<li class="data-line-736">
<p>La structure de donn√©es du bloc est syntaxiquement valide</p>
</li>
<li class="data-line-737">
<p>Le hachage de l&#8217;en-t√™te de bloc est √©gal ou inf√©rieur √† la cible (applique la preuve de travail)</p>
</li>
<li class="data-line-738">
<p>L&#8217;horodatage du bloc est inf√©rieur √† deux heures dans le futur (en tenant compte des erreurs de temps)</p>
</li>
<li class="data-line-739">
<p>La taille du bloc est dans les limites acceptables</p>
</li>
<li class="data-line-740">
<p>La premi√®re transaction (et seulement la premi√®re) est une transaction coinbase</p>
</li>
<li class="data-line-741">
<p>Toutes les transactions dans le bloc sont valides en utilisant la liste de contr√¥le des transactions d√©crite dans <a href="#tx_verification">V√©rification ind√©pendante des transactions</a></p>
</li>
</ul>
</div>
<div class="paragraph data-line-743">
<p>La validation ind√©pendante de chaque nouveau bloc par chaque n≈ìud du r√©seau garantit que les mineurs ne peuvent pas tricher. Dans les sections pr√©c√©dentes, nous avons vu comment les mineurs peuvent √©crire une transaction qui leur attribue le nouveau bitcoin cr√©√© dans le bloc et r√©clamer les frais de transaction. Pourquoi les mineurs n&#8217;√©crivent-ils pas eux-m√™mes une transaction pour mille bitcoins au lieu de la bonne r√©compense ? Parce que chaque n≈ìud valide les blocs selon les m√™mes r√®gles. Une transaction coinbase invalide rendrait l&#8217;ensemble du bloc invalide, ce qui entra√Ænerait le rejet du bloc et, par cons√©quent, cette transaction ne ferait jamais partie du grand livre. Les mineurs doivent construire un bloc parfait, bas√© sur les r√®gles partag√©es que tous les n≈ìuds suivent, et l&#8217;exploiter avec une solution correcte √† la preuve de travail. Pour ce faire, ils d√©pensent beaucoup d&#8217;√©lectricit√© dans l&#8217;exploitation mini√®re, et s&#8217;ils trichent, toute l&#8217;√©lectricit√© et les efforts sont gaspill√©s. C&#8217;est pourquoi la validation ind√©pendante est un √©l√©ment cl√© du consensus d√©centralis√©.</p>
</div>
</div>
<div class="sect2 data-line-745">
<h3 id="_assemblage_et_s√©lection_de_cha√Ænes_de_blocs">Assemblage et s√©lection de cha√Ænes de blocs</h3>
<div class="paragraph data-line-747">
<p>La derni√®re √©tape du m√©canisme de consensus d√©centralis√© de Bitcoin est l&#8217;assemblage de blocs en cha√Ænes et la s√©lection de la cha√Æne avec le plus de preuves de travail. Une fois qu&#8217;un n≈ìud a valid√© un nouveau bloc, il tentera alors d&#8217;assembler une cha√Æne en connectant le bloc √† la cha√Æne de blocs existante.</p>
</div>
<div class="paragraph data-line-749">
<p>Les n≈ìuds maintiennent trois ensembles de blocs¬†: ceux connect√©s √† la cha√Æne de blocs principale, ceux qui forment des branches de la cha√Æne de blocs principale (cha√Ænes secondaires) et enfin, les blocs qui n&#8217;ont pas de parent connu dans les cha√Ænes connues (orphelins). Les blocs invalides sont rejet√©s d√®s que l&#8217;un des crit√®res de validation √©choue et ne sont donc inclus dans aucune cha√Æne.</p>
</div>
<div class="paragraph data-line-751">
<p>La "cha√Æne principale" √† tout moment est la cha√Æne de blocs <em>valide</em> √† laquelle est associ√©e la preuve de travail la plus cumulative. Dans la plupart des cas, il s&#8217;agit √©galement de la cha√Æne contenant le plus de blocs, √† moins qu&#8217;il n&#8217;y ait deux cha√Ænes de longueur √©gale et que l&#8217;une ait plus de preuve de travail. La cha√Æne principale aura √©galement des branches avec des blocs qui sont des "fr√®res et s≈ìurs" des blocs de la cha√Æne principale. Ces blocs sont valides mais ne font pas partie de la cha√Æne principale. Elles sont conserv√©es pour r√©f√©rence future, au cas o√π l&#8217;une de ces cha√Ænes serait √©tendue au-del√† de la cha√Æne principale en cours. Dans la section suivante (<a href="#forks">Fourches de cha√Æne de blocs</a>), nous verrons comment des cha√Ænes secondaires se produisent √† la suite d&#8217;une extraction quasi simultan√©e de blocs √† la m√™me hauteur.</p>
</div>
<div class="paragraph data-line-753">
<p>Lorsqu&#8217;un nouveau bloc est re√ßu, un n≈ìud essaie de l&#8217;ins√©rer dans la cha√Æne de blocs existante. Le n≈ìud examinera le champ "hachage du bloc pr√©c√©dent" du bloc, qui est la r√©f√©rence au parent du bloc. Ensuite, le n≈ìud tentera de trouver ce parent dans la cha√Æne de blocs existante. La plupart du temps, le parent sera la "pointe" de la cha√Æne principale, ce qui signifie que ce nouveau bloc √©tend la cha√Æne principale. Par exemple, le nouveau bloc 277,316 a une r√©f√©rence au hachage de son bloc parent 277,315. La plupart des n≈ìuds qui re√ßoivent 277 316 auront d√©j√† le bloc 277 315 comme pointe de leur cha√Æne principale et relieront donc le nouveau bloc et √©tendront cette cha√Æne.</p>
</div>
<div class="paragraph data-line-755">
<p>Parfois, comme nous le verrons dans <a href="#forks">Fourches de cha√Æne de blocs</a>, le nouveau bloc prolonge une cha√Æne qui n&#8217;est pas la cha√Æne principale. Dans ce cas, le n≈ìud attachera le nouveau bloc √† la cha√Æne secondaire qu&#8217;il prolonge, puis comparera le travail de la cha√Æne secondaire √† la cha√Æne principale. Si la cha√Æne secondaire a plus de travail cumul√© que la cha√Æne principale, le n≈ìud <em>reconvergera</em> sur la cha√Æne secondaire, ce qui signifie qu&#8217;il s√©lectionnera la cha√Æne secondaire comme sa nouvelle cha√Æne principale, faisant de l&#8217;ancienne cha√Æne principale une cha√Æne secondaire. Si le n≈ìud est un mineur, il construira maintenant un bloc √©tendant cette nouvelle cha√Æne plus longue.</p>
</div>
<div class="paragraph data-line-757">
<p>Si un bloc valide est re√ßu et qu&#8217;aucun parent n&#8217;est trouv√© dans les cha√Ænes existantes, ce bloc est consid√©r√© comme "orphelin". Les blocs orphelins sont enregistr√©s dans le bassin de blocs orphelins o√π ils resteront jusqu&#8217;√† ce que leur parent soit re√ßu. Une fois que le parent est re√ßu et li√© aux cha√Ænes existantes, l&#8217;orphelin peut √™tre retir√© du bassin d&#8217;orphelins et li√© au parent, ce qui en fait une partie d&#8217;une cha√Æne. Les blocs orphelins se produisent g√©n√©ralement lorsque deux blocs extraits dans un court laps de temps sont re√ßus dans l&#8217;ordre inverse (enfant avant parent).</p>
</div>
<div class="paragraph data-line-759">
<p>En s√©lectionnant la cha√Æne valide de plus grand travail cumul√©, tous les n≈ìuds finissent par parvenir √† un consensus √† l&#8217;√©chelle du r√©seau. Les divergences temporaires entre les cha√Ænes sont finalement r√©solues au fur et √† mesure que du travail est ajout√©, √©tendant l&#8217;une des cha√Ænes possibles. Les n≈ìuds de minage ¬´ votent ¬ª avec leur puissance de minage en choisissant quelle cha√Æne √©tendre en minant le bloc suivant. Lorsqu&#8217;ils exploitent un nouveau bloc et √©tendent la cha√Æne, le nouveau bloc lui-m√™me repr√©sente leur vote.</p>
</div>
<div class="paragraph data-line-761">
<p>Dans la section suivante, nous verrons comment les divergences entre les cha√Ænes concurrentes (les fourches) sont r√©solues par la s√©lection ind√©pendante de la cha√Æne de plus grand travail cumulatif.</p>
</div>
<div class="sect3 data-line-764">
<h4 id="forks">Fourches de cha√Æne de blocs</h4>
<div class="paragraph data-line-766">
<p>Parce que la cha√Æne de blocs est une structure de donn√©es d√©centralis√©e, diff√©rentes copies de celle-ci ne sont pas toujours coh√©rentes. Les blocs peuvent arriver √† diff√©rents n≈ìuds √† des moments diff√©rents, ce qui am√®ne les n≈ìuds √† avoir diff√©rentes perspectives de la cha√Æne de blocs. Pour r√©soudre ce probl√®me, chaque n≈ìud s√©lectionne et tente toujours d&#8217;√©tendre la cha√Æne de blocs qui repr√©sente le plus de preuve de travail, √©galement connue sous le nom de cha√Æne la plus longue ou de cha√Æne de travail cumulative la plus importante. En additionnant le travail enregistr√© dans chaque bloc d&#8217;une cha√Æne, un n≈ìud peut calculer la quantit√© totale de travail qui a √©t√© d√©pens√©e pour cr√©er cette cha√Æne. Tant que tous les n≈ìuds s√©lectionnent la plus grande cha√Æne de travail cumulatif, le r√©seau mondial Bitcoin finit par converger vers un √©tat coh√©rent. Les fourches se produisent sous forme d&#8217;incoh√©rences temporaires entre les versions de la cha√Æne de blocs, qui sont r√©solues par une √©ventuelle reconvergence √† mesure que d&#8217;autres blocs sont ajout√©s √† l&#8217;une des fourches.</p>
</div>
<div class="admonitionblock tip data-line-769">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-770">
<p>Les fourches de cha√Æne de blocs d√©crites dans cette section se produisent naturellement (accidentellement) en raison de retards de transmission dans le r√©seau mondial. Plus loin dans ce chapitre, nous verrons √©galement les fourches d√©lib√©r√©ment induites (embranchements divergents et embranchements convergents), qui sont utilis√©s pour modifier les r√®gles de consensus.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-773">
<p>Dans les quelques diagrammes suivants, nous suivons la progression d&#8217;un √©v√©nement d'"embranchement" (ou de fourche) √† travers le r√©seau. Le diagramme est une repr√©sentation simplifi√©e du r√©seau Bitcoin. √Ä des fins d&#8217;illustration, diff√©rents blocs sont repr√©sent√©s sous diff√©rentes formes (√©toile, triangle, triangle invers√©, losange), r√©partis sur le r√©seau. Chaque n≈ìud du r√©seau est repr√©sent√© par un cercle.</p>
</div>
<div class="paragraph data-line-775">
<p>Chaque n≈ìud a sa propre perspective de la cha√Æne de blocs mondiale. Au fur et √† mesure que chaque n≈ìud re√ßoit des blocs de ses voisins, il met √† jour sa propre copie de la cha√Æne de blocs, en s√©lectionnant la plus grande cha√Æne de travail cumul√©e. √Ä des fins d&#8217;illustration, chaque n≈ìud contient une forme qui repr√©sente le bloc qui, selon lui, est actuellement la pointe de la cha√Æne principale. Donc, si vous voyez une forme d&#8217;√©toile dans le n≈ìud, cela signifie que le bloc en √©toile est la pointe de la cha√Æne principale, en ce qui concerne ce n≈ìud.</p>
</div>
<div class="paragraph data-line-777">
<p>Dans le premier diagramme (<a href="#fork1">Avant la bifurcation, tous les n≈ìuds ont la m√™me perspective</a>), le r√©seau a une perspective unifi√©e de la cha√Æne de blocs, avec le bloc √©toile comme pointe de la cha√Æne principale.</p>
</div>
<div id="fork1" class="imageblock smallereighty data-line-782">
<div class="content">
<img src="images/mbc2_1002.png" alt="Avant la bifurcation - tous les n≈ìuds ont la m√™me perspective">
</div>
<div class="title">Figure 64. Avant la bifurcation, tous les n≈ìuds ont la m√™me perspective</div>
</div>
<div class="paragraph data-line-784">
<p>Un "embranchement" (ou une "fourche") se produit chaque fois qu&#8217;il y a deux blocs valides diff√©rents √† la m√™me hauteur de bloc en comp√©tition pour former la cha√Æne de blocs la plus longue. Cela se produit dans des conditions normales chaque fois que deux mineurs r√©solvent l&#8217;algorithme de preuve de travail dans un court laps de temps l&#8217;un de l&#8217;autre. Alors que les deux mineurs d√©couvrent une solution pour leurs blocs candidats respectifs, ils diffusent imm√©diatement leur propre bloc "gagnant" √† leurs voisins imm√©diats qui commencent √† propager le bloc sur le r√©seau. Chaque n≈ìud qui re√ßoit un bloc valide l&#8217;incorpore dans sa cha√Æne de blocs, √©tendant la cha√Æne de blocs d&#8217;un bloc. Si ce n≈ìud voit plus tard un autre bloc valide √©tendre le m√™me parent (√† la m√™me hauteur de bloc), il connecte le deuxi√®me bloc sur une cha√Æne secondaire, bifurquant sa cha√Æne principale. En cons√©quence, certains n≈ìuds "verront" un bloc gagnant en premier, tandis que d&#8217;autres n≈ìuds verront l&#8217;autre bloc gagnant en premier, et deux versions concurrentes de la cha√Æne de blocs √©mergeront.</p>
</div>
<div class="paragraph data-line-786">
<p>Dans <a href="#fork2">Visualisation d&#8217;un √©v√©nement d&#8217;embranchement (fourche) de la cha√Æne de blocs: deux blocs trouv√©s simultan√©ment</a>, on voit deux mineurs (N≈ìud X et N≈ìud Y) qui minent deux blocs diff√©rents presque simultan√©ment. Ces deux blocs sont des enfants du bloc √©toile et √©tendent la cha√Æne en s&#8217;appuyant sur le bloc √©toile. Pour nous aider √† le suivre, l&#8217;un est visualis√© comme un bloc triangulaire provenant du n≈ìud X, et l&#8217;autre est repr√©sent√© comme un bloc triangulaire invers√© provenant du n≈ìud Y.</p>
</div>
<div id="fork2" class="imageblock smallersixty data-line-791">
<div class="content">
<img src="images/mbc2_1003.png" alt="Visualisation d&#8217;un √©v√©nement d&#8217;embranchement (fourche) de la cha√Æne de blocs¬†: deux blocs trouv√©s simultan√©ment">
</div>
<div class="title">Figure 65. Visualisation d&#8217;un √©v√©nement d&#8217;embranchement (fourche) de la cha√Æne de blocs: deux blocs trouv√©s simultan√©ment</div>
</div>
<div class="paragraph data-line-793">
<p>Supposons, par exemple, que le mineur N≈ìud X trouve une solution de preuve de travail pour un bloc "triangle" qui √©tend la cha√Æne de blocs, en s&#8217;appuyant sur le bloc parent "√©toile". Presque simultan√©ment, le mineur N≈ìud Y qui √©tendait √©galement la cha√Æne du bloc "√©toile" trouve une solution pour le bloc "triangle invers√©", son bloc candidat. Maintenant, il y a deux blocs possibles¬†; un que nous appelons "triangle", originaire du N≈ìud X¬†; et un que nous appelons "triangle invers√©", originaire du n≈ìud Y. Les deux blocs ont √©t√© extraits avec succ√®s, les deux blocs sont valides (contiennent une solution valide √† la preuve de travail), et les deux blocs √©tendent le m√™me parent (bloc "√©toile"). Les deux blocs contiennent probablement la plupart des m√™mes transactions, avec seulement peut-√™tre quelques diff√©rences dans l&#8217;ordre des transactions.</p>
</div>
<div class="paragraph data-line-795">
<p>Au fur et √† mesure que les deux blocs se propagent, certains n≈ìuds re√ßoivent d&#8217;abord le bloc "triangle" et d&#8217;autres re√ßoivent le bloc "triangle invers√©" en premier. Comme indiqu√© dans <a href="#fork3">Visualisation d&#8217;un √©v√©nement d&#8217;embranchement de la cha√Æne de blocs¬†: deux blocs se propagent, divisant le r√©seau</a>, le r√©seau se scinde en deux perspectives diff√©rentes de la cha√Æne de blocs; un c√¥t√© surmont√© du bloc triangle, l&#8217;autre du bloc triangle renvers√©.</p>
</div>
<div id="fork3" class="imageblock smallersixty data-line-800">
<div class="content">
<img src="images/mbc2_1004.png" alt="Visualisation d&#8217;un √©v√©nement d&#8217;embranchement de la cha√Æne de blocs¬†: deux blocs se propagent, divisant le r√©seau">
</div>
<div class="title">Figure 66. Visualisation d&#8217;un √©v√©nement d&#8217;embranchement de la cha√Æne de blocs¬†: deux blocs se propagent, divisant le r√©seau</div>
</div>
<div class="paragraph data-line-802">
<p>Dans <a href="#fork3">Visualisation d&#8217;un √©v√©nement d&#8217;embranchement de la cha√Æne de blocs¬†: deux blocs se propagent, divisant le r√©seau</a>, le mineur N≈ìud X a extrait (cr√©√©) le bloc triangulaire et a √©tendu la cha√Æne d&#8217;√©toiles avec. Par cons√©quent, le N≈ìud X consid√®re initialement la cha√Æne avec le bloc "triangle" comme la cha√Æne principale. Plus tard, le N≈ìud X a √©galement re√ßu le bloc "triangle invers√©" qui a √©t√© extrait par le N≈ìud Y. Puisqu&#8217;il a √©t√© re√ßu en deuxi√®me, il est suppos√© avoir "perdu" la course. Pourtant, le bloc "triangle invers√©" n&#8217;est pas √©cart√©. Il est li√© au bloc parent "√©toile" et forme une cha√Æne secondaire. Alors que le N≈ìud X suppose que sa cha√Æne principale est la cha√Æne gagnante, il conserve la cha√Æne "perdante" afin qu&#8217;il dispose des informations n√©cessaires pour reconverger si la cha√Æne "perdante" finit par "gagner".</p>
</div>
<div class="paragraph data-line-804">
<p>De l&#8217;autre c√¥t√© du r√©seau, le mineur N≈ìud Y construit une cha√Æne de blocs bas√©e sur sa propre perspective de la s√©quence des √©v√©nements. Le mineur N≈ìud Y a extrait (cr√©√©) le "triangle invers√©" et consid√®re initialement cette cha√Æne comme la cha√Æne principale (la cha√Æne "gagnante"). Lorsqu&#8217;il a ensuite re√ßu le bloc "triangle" extrait par le N≈ìud X, il l&#8217;a connect√© au parent du bloc "√©toile" en tant que cha√Æne secondaire.</p>
</div>
<div class="paragraph data-line-806">
<p>Aucun des deux c√¥t√©s n&#8217;est "correct" ou "incorrect". Les deux sont des perspectives valables de la cha√Æne de blocs. Ce n&#8217;est qu&#8217;avec le recul qu&#8217;une seule l&#8217;emportera, en fonction de la fa√ßon dont ces deux cha√Ænes concurrentes sont prolong√©es par des travaux suppl√©mentaires.</p>
</div>
<div class="paragraph data-line-808">
<p>Chaque n≈ìud de minage dont la perspective ressemble au N≈ìud X commencera imm√©diatement √† miner un bloc candidat qui √©tend la cha√Æne avec un "triangle" comme pointe. En liant "triangle" en tant que parent de leurs blocs de candidats, ils votent avec leur pouvoir de hachage. Leur vote soutient la cha√Æne qu&#8217;ils ont √©lue comme cha√Æne principale.</p>
</div>
<div class="paragraph data-line-810">
<p>Tout n≈ìud minier dont la perspective ressemble au N≈ìud Y commencera √† construire un bloc candidat avec un "triangle invers√©" comme parent, √©tendant la cha√Æne qu&#8217;ils croient √™tre la cha√Æne principale. Et voil√†, la course recommence.</p>
</div>
<div class="paragraph data-line-812">
<p>Les fourches sont presque toujours r√©solues en un bloc de temps (10 minutes en moyenne). Alors qu&#8217;une partie de la puissance de hachage du r√©seau est d√©di√©e √† la construction au-dessus du "triangle" en tant que parent, une autre partie de la puissance de hachage est concentr√©e sur la construction au-dessus du "triangle invers√©". M√™me si la puissance de hachage est presque √©galement r√©partie, il est probable qu&#8217;un groupe de mineurs trouvera une solution et la propagera avant que l&#8217;autre groupe de mineurs ait trouv√© des solutions. Disons, par exemple, que les mineurs construisant au-dessus du "triangle" trouvent un nouveau bloc "losange" qui prolonge la cha√Æne (par exemple, √©toile-triangle-losange). Ils propagent imm√©diatement ce nouveau bloc et l&#8217;ensemble du r√©seau le consid√®re comme une solution valide, comme indiqu√© dans <a href="#fork4">Visualisation d&#8217;un √©v√©nement d&#8217;un embranchement de la cha√Æne de blocs¬†: un nouveau bloc √©tend une fourche, reconvergeant le r√©seau. Le N≈ìud X et le N≈ìud Y consid√®rent maintenant le bloc "triangle invers√©" comme un bloc obsol√®te.</a>.</p>
</div>
<div class="paragraph data-line-814">
<p>Tous les n≈ìuds qui avaient choisi "triangle" comme vainqueur au tour pr√©c√©dent √©tendront simplement la cha√Æne d&#8217;un bloc suppl√©mentaire. Cependant, les n≈ìuds qui ont choisi "triangle invers√©" comme gagnant verront d√©sormais deux cha√Ænes¬†: √©toile-triangle-losange et √©toile-triangle invers√©. La cha√Æne √©toile-triangle-losange est maintenant plus longue (plus de travail cumul√©) que l&#8217;autre cha√Æne. En cons√©quence, ces n≈ìuds d√©finiront la cha√Æne √©toile-triangle-losange comme cha√Æne principale et transformeront la cha√Æne √©toile-triangle invers√© en une cha√Æne secondaire, comme indiqu√© dans <a href="#fork5">Visualisation d&#8217;un √©v√©nement d&#8217;embranchement de la cha√Æne de blocs¬†: le r√©seau reconverge sur une nouvelle cha√Æne la plus longue</a>. Il s&#8217;agit d&#8217;une reconvergence en cha√Æne, car ces n≈ìuds sont oblig√©s de revoir leur vision de la cha√Æne de blocs pour int√©grer les nouvelles preuves d&#8217;une cha√Æne plus longue. Tous les mineurs travaillant √† l&#8217;extension de la cha√Æne √©toile-invers√©e-triangle arr√™teront d√©sormais ce travail car leur bloc candidat est d√©sormais consid√©r√© comme un enfant d&#8217;un bloc p√©rim√©, car son parent "triangle-invers√©" n&#8217;est plus sur la cha√Æne la plus longue . √âtant donn√© que le bloc triangle invers√© est d√©sormais obsol√®te, le mineur N≈ìud Y (qui a min√© ce bloc) ne pourra pas d√©penser la r√©compense de minage pour ce bloc, m√™me si ce bloc √©tait valide et a √©t√© min√© avec succ√®s. Les transactions dans le "triangle invers√©" qui ne sont pas dans le "triangle" sont r√©ins√©r√©es dans le mempool pour √™tre incluses dans le bloc suivant pour devenir une partie de la cha√Æne principale. L&#8217;ensemble du r√©seau reconverge sur une seule cha√Æne de blocs √©toile-triangle-losange, avec "losange" comme dernier bloc de la cha√Æne. Tous les mineurs commencent imm√©diatement √† travailler sur des blocs candidats qui font r√©f√©rence √† "losange" comme parent pour √©tendre la cha√Æne √©toile-triangle-losange.</p>
</div>
<div id="fork4" class="imageblock smallereighty data-line-819">
<div class="content">
<img src="images/mbc2_1005.png" alt="Visualisation d&#8217;un √©v√©nement d&#8217;un embranchement de la cha√Æne de blocs¬†: un nouveau bloc √©tend une fourche">
</div>
<div class="title">Figure 67. Visualisation d&#8217;un √©v√©nement d&#8217;un embranchement de la cha√Æne de blocs¬†: un nouveau bloc √©tend une fourche, reconvergeant le r√©seau. Le N≈ìud X et le N≈ìud Y consid√®rent maintenant le bloc "triangle invers√©" comme un bloc obsol√®te.</div>
</div>
<div id="fork5" class="imageblock smallereighty data-line-824">
<div class="content">
<img src="images/mbc2_1006.png" alt="Visualisation d&#8217;un √©v√©nement d&#8217;un embranchement de la cha√Æne de blocs¬†: le r√©seau reconverge sur la nouvelle cha√Æne la plus longue">
</div>
<div class="title">Figure 68. Visualisation d&#8217;un √©v√©nement d&#8217;embranchement de la cha√Æne de blocs¬†: le r√©seau reconverge sur une nouvelle cha√Æne la plus longue</div>
</div>
<div class="paragraph data-line-826">
<p>Il est th√©oriquement possible qu&#8217;une fourche s&#8217;√©tende √† deux blocs, si deux blocs sont trouv√©s presque simultan√©ment par des mineurs sur les "c√¥t√©s" oppos√©s d&#8217;une fourche pr√©c√©dente. Cependant, la probabilit√© que cela se produise est tr√®s faible. Alors qu&#8217;une fourche √† un bloc peut se produire tous les jours, une fourche √† deux blocs se produit au plus une fois toutes les quelques semaines.</p>
</div>
<div class="paragraph data-line-828">
<p>L&#8217;intervalle de bloc de Bitcoin de 10 minutes est un compromis de conception entre des temps de confirmation rapides (r√®glement des transactions) et la probabilit√© d&#8217;une fourche. Un temps de bloc plus rapide rendrait les transactions plus rapides mais conduirait √† des fourches de cha√Æne de blocs plus fr√©quentes, tandis qu&#8217;un temps de bloc plus lent r√©duirait le nombre de fourches mais ralentirait le r√®glement.</p>
</div>
</div>
</div>
<div class="sect2 data-line-830">
<h3 id="_lexploitation_mini√®re_et_la_course_au_hachage">L&#8217;exploitation mini√®re et la course au hachage</h3>
<div class="paragraph data-line-832">
<p>L&#8217;exploitation mini√®re de Bitcoin est une industrie extr√™mement comp√©titive. La puissance de hachage a augment√© de fa√ßon exponentielle chaque ann√©e d&#8217;existence du bitcoin. Certaines ann√©es, la croissance a refl√©t√© un changement complet de technologie, comme en 2010 et 2011, lorsque de nombreux mineurs sont pass√©s de l&#8217;exploitation de processeurs CPU √† l&#8217;exploitation de GPU et √† l&#8217;exploitation de r√©seau pr√©diffus√© programmable par l&#8217;utilisateur (FPGA). En 2013, l&#8217;introduction de l&#8217;exploitation mini√®re ASIC a conduit √† un autre bond de g√©ant dans la puissance mini√®re, en pla√ßant la fonction SHA256 directement sur des puces de silicium sp√©cialis√©es √† des fins d&#8217;exploitation mini√®re. Les premi√®res puces de ce type pourraient fournir plus de puissance de minage dans une seule bo√Æte que l&#8217;ensemble du r√©seau Bitcoin en 2010.</p>
</div>
<div class="paragraph data-line-834">
<p>La liste suivante montre la puissance de hachage totale du r√©seau Bitcoin en terahachages/sec (TH/sec), depuis sa cr√©ation en 2009 (source¬†: Blockchain.com) :</p>
</div>
<div class="dlist data-line-836">
<dl>
<dt class="hdlist1">2009 </dt>
<dd>
<p>0,000004 ‚Äì 0,00001 TH/sec (croissance 2,40√ó)</p>
</dd>
<dt class="hdlist1">2010 </dt>
<dd>
<p>0,00001 ‚Äì 0,14 TH/sec (14 247√ó croissance)</p>
</dd>
<dt class="hdlist1">2011 </dt>
<dd>
<p>0,14 ‚Äì 9,49 TH/sec (croissance de 63,92√ó)</p>
</dd>
<dt class="hdlist1">2012 </dt>
<dd>
<p>9,49 ‚Äì 22 TH/sec (croissance 2,32√ó)</p>
</dd>
<dt class="hdlist1">2013 </dt>
<dd>
<p>22.04 ‚Äì 15 942 TH/sec (croissance de 723,32√ó)</p>
</dd>
<dt class="hdlist1">2014 </dt>
<dd>
<p>15 942 ‚Äì 306 333 TH/sec (croissance de 19,21√ó)</p>
</dd>
<dt class="hdlist1">2015 </dt>
<dd>
<p>306 333 ‚Äì 881 232 TH/sec (croissance de 2,87√ó)</p>
</dd>
<dt class="hdlist1">2016 </dt>
<dd>
<p>881 232 ‚Äì 2 807 540 TH/sec (croissance 3,18√ó)</p>
</dd>
<dt class="hdlist1">2017 </dt>
<dd>
<p>2 807 540 ‚Äì 18 206 558 TH/sec (6,48√ó croissance)</p>
</dd>
<dt class="hdlist1">2018 </dt>
<dd>
<p>18 206 558 ‚Äì 41 801 528 TH/sec (croissance de 2,29√ó)</p>
</dd>
<dt class="hdlist1">2019 </dt>
<dd>
<p>41 801 528 ‚Äì 109 757 127 TH/sec (croissance de 2,62√ó)</p>
</dd>
<dt class="hdlist1">2020 </dt>
<dd>
<p>109 757 127 ‚Äì 149 064 869 TH/sec (croissance de 1,35√ó)</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-849">
<p>Dans le graphique en <a href="#network_hashing_power">Puissance de hachage totale, terahachages par seconde (TH/sec) (graphique sur une √©chelle lin√©aire)</a>, nous pouvons voir que la puissance de hachage du r√©seau Bitcoin a augment√© au cours des deux derni√®res ann√©es. Comme vous pouvez le constater, la concurrence entre les mineurs et la croissance du bitcoin ont entra√Æn√© une augmentation exponentielle de la puissance de hachage (total des hachages par seconde sur le r√©seau).</p>
</div>
<div id="network_hashing_power" class="imageblock data-line-853">
<div class="content">
<img src="images/mbc2_1007.png" alt="Taux de hachage du r√©seau">
</div>
<div class="title">Figure 69. Puissance de hachage totale, terahachages par seconde (TH/sec) (graphique sur une √©chelle lin√©aire)</div>
</div>
<div class="paragraph data-line-855">
<p>Alors que la quantit√© de puissance de hachage appliqu√©e √† l&#8217;extraction de bitcoins a explos√©, la difficult√© a augment√© pour l&#8217;√©galer. La m√©trique de difficult√© dans le graphique affich√© dans <a href="#bitcoin_difficulty">M√©trique de la difficult√© de minage de Bitcoin (graphique sur une √©chelle logarithmique)</a> est mesur√© comme un rapport de la difficult√© actuelle sur la difficult√© minimale (la difficult√© du premier bloc).</p>
</div>
<div id="bitcoin_difficulty" class="imageblock data-line-859">
<div class="content">
<img src="images/mbc2_1008.png" alt="Difficult√© Bitcoin">
</div>
<div class="title">Figure 70. M√©trique de la difficult√© de minage de Bitcoin (graphique sur une √©chelle logarithmique)</div>
</div>
<div class="paragraph data-line-861">
<p>Au cours des deux derni√®res ann√©es, les puces mini√®res ASIC sont devenues de plus en plus denses, se rapprochant de la pointe de la fabrication de silicium avec une taille de caract√©ristique (r√©solution) de 7 nanom√®tres (nm). Actuellement, les fabricants d&#8217;ASIC visent √† d√©passer les fabricants de puces CPU √† usage g√©n√©ral, en concevant des puces avec une taille de fonctionnalit√© de 5 nm, car la rentabilit√© de l&#8217;exploitation mini√®re fait avancer cette industrie encore plus rapidement que l&#8217;informatique g√©n√©rale. Il n&#8217;y a plus de pas de g√©ant dans l&#8217;extraction de bitcoins, car l&#8217;industrie a atteint l&#8217;avant-garde de la loi de Moore, qui stipule que la densit√© de calcul doublera environ tous les 18 mois. Pourtant, la puissance mini√®re du r√©seau continue de progresser √† un rythme exponentiel alors que la course aux puces √† plus haute densit√© s&#8217;accompagne d&#8217;une course aux centres de donn√©es √† plus haute densit√© o√π des milliers de ces puces peuvent √™tre d√©ploy√©es. Il ne s&#8217;agit plus de savoir combien d&#8217;extraction peut √™tre effectu√©e avec une seule puce, mais combien de puces peuvent √™tre ins√©r√©es dans un b√¢timent, tout en dissipant la chaleur et en fournissant une puissance ad√©quate.</p>
</div>
<div class="sect3 data-line-864">
<h4 id="extra_nonce">La solution nonce (nombre al√©atoire) suppl√©mentaire</h4>
<div class="paragraph data-line-866">
<p>Depuis 2012, l&#8217;extraction de bitcoins a √©volu√© pour r√©soudre une limitation fondamentale dans la structure de l&#8217;en-t√™te de bloc. Au d√©but du bitcoin, un mineur pouvait trouver un bloc en parcourant le nonce jusqu&#8217;√† ce que le hachage r√©sultant soit √©gal ou inf√©rieur √† la cible. Au fur et √† mesure que la difficult√© augmentait, les mineurs parcouraient souvent les 4 milliards de valeurs du nonce sans trouver de bloc. Cependant, cela a √©t√© facilement r√©solu en mettant √† jour l&#8217;horodatage du bloc pour tenir compte du temps √©coul√©. √âtant donn√© que l&#8217;horodatage fait partie de l&#8217;en-t√™te, la modification permettrait aux mineurs de parcourir √† nouveau les valeurs du nonce avec des r√©sultats diff√©rents. Cependant, une fois que le mat√©riel de minage a d√©pass√© 4 GH/sec, cette approche est devenue de plus en plus difficile car les valeurs nonce ont √©t√© √©puis√©es en moins d&#8217;une seconde. Alors que l&#8217;√©quipement de minage ASIC commen√ßait √† pousser puis √† d√©passer le taux de hachage TH/sec, le logiciel de minage avait besoin de plus d&#8217;espace pour les valeurs nonce afin de trouver des blocs valides. L&#8217;horodatage pourrait √™tre un peu √©tir√©, mais le d√©placer trop loin dans le futur rendrait le bloc invalide. Une nouvelle source de "changement" √©tait n√©cessaire dans l&#8217;en-t√™te du bloc. La solution consistait √† utiliser la transaction coinbase comme source de valeurs nonce suppl√©mentaires. √âtant donn√© que le script coinbase peut stocker entre 2 et 100 octets de donn√©es, les mineurs ont commenc√© √† utiliser cet espace comme espace nonce suppl√©mentaire, leur permettant d&#8217;explorer une gamme beaucoup plus large de valeurs d&#8217;en-t√™te de bloc pour trouver des blocs valides. La transaction coinbase est incluse dans l&#8217;arborescence de Merkle, ce qui signifie que tout changement dans le script coinbase entra√Æne la modification de la racine de Merkle. Huit octets de nonce suppl√©mentaires, plus les 4 octets de nonce "standard" permettent aux mineurs d&#8217;explorer un total de 2<sup>96</sup> (8 suivis de 28 z√©ros) possibilit√©s <em>par seconde</em> sans avoir √† modifier l&#8217;horodatage. Si, √† l&#8217;avenir, les mineurs pouvaient parcourir toutes ces possibilit√©s, ils pourraient alors modifier l&#8217;horodatage. Il y a √©galement plus d&#8217;espace dans le script coinbase pour l&#8217;expansion future de l&#8217;espace nonce suppl√©mentaire.</p>
</div>
</div>
<div class="sect3 data-line-869">
<h4 id="mining_pools">Groupes miniers</h4>
<div class="paragraph data-line-871">
<p>Dans cet environnement hautement concurrentiel, les mineurs travaillant seuls (√©galement appel√©s mineurs solo) n&#8217;ont aucune chance. La probabilit√© qu&#8217;ils trouvent un bloc pour compenser leurs co√ªts d&#8217;√©lectricit√© et de mat√©riel est si faible que cela repr√©sente un pari, comme jouer √† la loterie. M√™me le syst√®me minier ASIC grand public le plus rapide ne peut pas suivre les syst√®mes commerciaux qui empilent des dizaines de milliers de ces puces dans des entrep√¥ts g√©ants √† proximit√© de centrales hydro√©lectriques. Les mineurs collaborent d√©sormais pour former des groupes de minage, mettant en commun leur pouvoir de hachage et partageant la r√©compense entre des milliers de participants. En participant √† un groupe, les mineurs obtiennent une plus petite part de la r√©compense globale, mais sont g√©n√©ralement r√©compens√©s tous les jours, ce qui r√©duit l&#8217;incertitude.</p>
</div>
<div class="paragraph data-line-873">
<p>Prenons un exemple pr√©cis. Supposons qu&#8217;un mineur ait achet√© du mat√©riel de minage avec un taux de hachage combin√© de 14 000 gigahachages par seconde (GH/s), soit 14 TH/s. En 2017, cet √©quipement co√ªte environ 2 500¬†$ US. Le mat√©riel consomme 1375 watts (1,3 kW) d&#8217;√©lectricit√© lorsqu&#8217;il fonctionne, 33 kW-heures par jour, √† un co√ªt de 1¬†$ √† 2¬†$ par jour √† des tarifs d&#8217;√©lectricit√© tr√®s bas. √Ä la difficult√© actuelle du bitcoin, le mineur pourra extraire un bloc en solo environ une fois tous les 4 ans. Comment calcule-t-on cette probabilit√© ? Il est bas√© sur un taux de hachage √† l&#8217;√©chelle du r√©seau de 3 EH/sec (en 2017) et le taux du mineur de 14 TH/sec :</p>
</div>
<ul class="simplelist">
  <li>P = (14 * 10<sup>12</sup> / 3 * 10<sup>18</sup> ) * 210 240 = 0,98</li>
</ul>
<div class="paragraph data-line-881">
<p>&#8230;&#8203;o√π 210 240 est le nombre de blocs en quatre ans. Le mineur a une probabilit√© de 98¬†% de trouver un bloc sur quatre ans, sur la base du taux de hachage global au d√©but de la p√©riode.</p>
</div>
<div class="paragraph data-line-883">
<p>Si le mineur trouve un seul bloc dans ce d√©lai, le paiement de 6,25 bitcoins, √† environ 1 000¬†$ par bitcoin, se traduira par un paiement unique de 6 250 $, ce qui produira un b√©n√©fice net d&#8217;environ 750 $. Cependant, la chance de trouver un bloc dans une p√©riode de 4 ans d√©pend de la chance du mineur. Il pourrait trouver deux blocs en 4 ans et faire un profit plus important. Ou il pourrait ne pas trouver de bloc pendant 5 ans et subir une grosse perte financi√®re. Pire encore, la difficult√© de l&#8217;algorithme Bitcoin de preuve de travail est susceptible d&#8217;augmenter consid√©rablement au cours de cette p√©riode, au rythme actuel de croissance de la puissance de hachage, ce qui signifie que le mineur a au plus un an pour atteindre le seuil de rentabilit√© avant que le mat√©riel soit effectivement obsol√®te et que ce dernier soit remplac√© par du mat√©riel de minage plus puissant. Financi√®rement, cela n&#8217;a de sens qu&#8217;√† tr√®s faible co√ªt d&#8217;√©lectricit√© (moins de 1 cent par kWh) et uniquement √† tr√®s grande √©chelle.</p>
</div>
<div class="paragraph data-line-885">
<p>Les "pools" ou groupes de minage coordonnent plusieurs centaines ou milliers de mineurs, sur des protocoles de minage de groupe sp√©cialis√©s. Les mineurs individuels configurent leur √©quipement minier pour se connecter √† un serveur de pool et sp√©cifient une adresse Bitcoin, qui recevra leur part des r√©compenses. Leur mat√©riel de minage reste connect√© au serveur du pool pendant le minage, synchronisant leurs efforts avec les autres mineurs. Ainsi, les mineurs du pool partagent l&#8217;effort d&#8217;extraction d&#8217;un bloc, puis partagent les r√©compenses.</p>
</div>
<div class="paragraph data-line-887">
<p>Les blocs r√©ussis paient la r√©compense √† une adresse Bitcoin de groupe, plut√¥t qu&#8217;√† des mineurs individuels. Le serveur de groupe effectuera p√©riodiquement des paiements aux adresses Bitcoin des mineurs, une fois que leur part des r√©compenses aura atteint un certain seuil. En r√®gle g√©n√©rale, le serveur de groupe facture un pourcentage des r√©compenses pour la fourniture du service de minage de groupe.</p>
</div>
<div class="paragraph data-line-889">
<p>Les mineurs participant √† un groupe se partagent le travail de recherche d&#8217;une solution √† un bloc candidat, gagnant des "actions" pour leur contribution mini√®re. Le groupe de minage fixe un objectif plus √©lev√© (difficult√© moindre) pour gagner une part, g√©n√©ralement plus de 1 000 fois plus facile que l&#8217;objectif du r√©seau Bitcoin. Lorsqu&#8217;un membre du groupe exploite avec succ√®s un bloc, la r√©compense est gagn√©e par le groupe, puis partag√©e avec tous les mineurs proportionnellement au nombre d&#8217;actions qu&#8217;ils ont contribu√© √† l&#8217;effort.</p>
</div>
<div class="paragraph data-line-891">
<p>Les groupes sont ouvertes √† tout mineur, grand ou petit, professionnel ou amateur. Un groupe aura donc certains participants avec une seule petite machine de minage, et d&#8217;autres avec un garage rempli de mat√©riel de minage haut de gamme. Certains exploiteront quelques dizaines de kilowatts d&#8217;√©lectricit√©, d&#8217;autres exploiteront un centre de donn√©es consommant un m√©gawatt d&#8217;√©lectricit√©. Comment un groupe de minage mesure-t-il les contributions individuelles, de mani√®re √† r√©partir √©quitablement les r√©compenses, sans possibilit√© de tricherie ? La r√©ponse est d&#8217;utiliser l&#8217;algorithme de preuve de travail de Bitcoin pour mesurer la contribution de chaque mineur du groupe, mais avec une difficult√© inf√©rieure afin que m√™me les plus petits mineurs du groupe gagnent une part suffisamment fr√©quemment pour qu&#8217;il soit int√©ressant de contribuer au groupe. En fixant une difficult√© inf√©rieure pour gagner des actions, le groupe mesure la quantit√© de travail effectu√© par chaque mineur. Chaque fois qu&#8217;un mineur de groupe trouve un hachage d&#8217;en-t√™te de bloc √©gal ou inf√©rieur √† la cible du groupe, il prouve qu&#8217;il a effectu√© le travail de hachage pour trouver ce r√©sultat. Plus important encore, le travail de recherche de parts contribue, de mani√®re statistiquement mesurable, √† l&#8217;effort global pour trouver un hachage √©gal ou inf√©rieur √† la cible du r√©seau Bitcoin. Des milliers de mineurs essayant de trouver des hachages de faible valeur finiront par en trouver un suffisamment bas pour satisfaire la cible du r√©seau Bitcoin.</p>
</div>
<div class="paragraph data-line-893">
<p>Revenons √† l&#8217;analogie d&#8217;un jeu de d√©s. Si les joueurs de d√©s lancent des d√©s avec un objectif de lancer √©gal ou inf√©rieur √† quatre (la difficult√© globale du r√©seau), un groupe fixerait un objectif plus facile, en comptant combien de fois les joueurs du groupe ont r√©ussi √† lancer √©gal ou inf√©rieur √† huit. Lorsque les joueurs du pool lancent un nombre √©gal ou inf√©rieur √† huit (l&#8217;objectif de partage du groupe) mais sup√©rieur √† quatre (sup√©rieur √† la difficult√© globale du r√©seau), ils gagnent des parts, mais ni eux ni le groupe ne gagnent la partie car ils n&#8217;y parviennent pas √† atteindre la cible (√©gale ou inf√©rieure √† quatre). Les joueurs de groupe atteindront beaucoup plus souvent l&#8217;objectif de groupe le plus facile, leur faisant gagner des parts tr√®s r√©guli√®rement, m√™me s&#8217;ils n&#8217;atteignent pas l&#8217;objectif plus difficile de gagner la partie. De temps en temps, l&#8217;un des joueurs du groupe lancera les d√©s combin√©s √©gal ou inf√©rieur √† quatre, le joueur du groupe gagne une part et l&#8217;ensemble du groupe gagne la partie. Ensuite, les gains peuvent √™tre distribu√©s aux joueurs du groupe en fonction du nombre de parts que chacun a gagn√©. M√™me si l&#8217;objectif de huit ou moins n&#8217;√©tait pas gagnant, c&#8217;√©tait un moyen juste de mesurer les lancers de d√©s pour les joueurs, et cela produit parfois un lancer de quatre ou moins.</p>
</div>
<div class="paragraph data-line-895">
<p>De m√™me, un groupe de minage d√©finira une cible de groupe (plus √©lev√©e et plus facile) qui garantira qu&#8217;un mineur de groupe individuel peut trouver des hachages d&#8217;en-t√™te de bloc qui sont souvent √©gaux ou inf√©rieurs √† la cible du pool, gagnant ainsi des actions. De temps en temps, l&#8217;une de ces tentatives produira un hachage d&#8217;en-t√™te de bloc √©gal ou inf√©rieur √† la cible du r√©seau Bitcoin, ce qui en fait un bloc valide et l&#8217;ensemble du groupe gagne.</p>
</div>
<div class="sect4 data-line-897">
<h5 id="_groupes_g√©r√©es">Groupes g√©r√©es</h5>
<div class="paragraph data-line-899">
<p> La plupart des groupes de minage sont "g√©r√©s", ce qui signifie qu&#8217;une entreprise ou un individu g√®re un serveur de groupe. Le propri√©taire du serveur de groupe est appel√© <em>op√©rateur de pool</em> (ou <em>op√©rateur de groupe</em>), et il facture aux mineurs du groupe un pourcentage des gains.</p>
</div>
<div class="paragraph data-line-901">
<p>Le serveur de groupe ex√©cute un logiciel sp√©cialis√© et un protocole de minage en groupe qui coordonnent les activit√©s des mineurs en groupe. Le serveur de groupe est √©galement connect√© √† un ou plusieurs n≈ìuds Bitcoin complets et a un acc√®s direct √† une copie compl√®te de la base de donn√©es, c-√†-d la cha√Æne de blocs. Cela permet au serveur de groupe de valider les blocs et les transactions au nom des mineurs en groupe, les soulageant ainsi du fardeau d&#8217;ex√©cuter un n≈ìud complet. Pour les mineurs en groupe, il s&#8217;agit d&#8217;une consid√©ration importante, car un n≈ìud complet n√©cessite un ordinateur d√©di√© avec au moins 300 √† 350 Go de stockage persistant (disque) et au moins 2 √† 4 Go de m√©moire (RAM). De plus, le logiciel bitcoin ex√©cut√© sur le n≈ìud complet doit √™tre surveill√©, entretenu et mis √† jour fr√©quemment. Tout temps d&#8217;arr√™t caus√© par un manque d&#8217;entretien ou un manque de ressources nuira √† la rentabilit√© du mineur. Pour de nombreux mineurs, la possibilit√© d&#8217;exploiter sans ex√©cuter un n≈ìud complet est un autre grand avantage de rejoindre un groupe g√©r√©.</p>
</div>
<div class="paragraph data-line-903">
<p>Les mineurs en groupe se connectent au serveur de groupe √† l&#8217;aide d&#8217;un protocole de minage tel que Stratum (STM) ou GetBlockTemplate (GBT). Une norme plus ancienne appel√©e GetWork (GWK) est pour la plupart obsol√®te depuis fin 2012, car elle ne prend pas facilement en charge l&#8217;extraction √† des taux de hachage sup√©rieurs √† 4 GH/s. Les protocoles STM et GBT cr√©ent des blocs <em>mod√®les</em> qui contiennent un mod√®le d&#8217;en-t√™te de bloc candidat. Le serveur de groupe construit un bloc candidat en agr√©geant les transactions, en ajoutant une transaction coinbase (avec un espace nonce suppl√©mentaire), en calculant la racine de Merkle et en se liant au hachage de bloc pr√©c√©dent. L&#8217;en-t√™te du bloc candidat est ensuite envoy√© √† chacun des mineurs du groupe en tant que mod√®le. Chaque mineur du groupe exploite ensuite le mod√®le de bloc, √† une cible plus √©lev√©e (plus facile) que la cible du r√©seau Bitcoin, et renvoie tous les r√©sultats r√©ussis au serveur du groupe pour gagner des parts.</p>
</div>
</div>
<div class="sect4 data-line-905">
<h5 id="_groupe_de_minage_pair_√†_pair_p2pool">Groupe de minage pair √† pair (P2Pool)</h5>
<div class="paragraph data-line-907">
<p>Les groupes g√©r√©s cr√©ent la possibilit√© de tricherie par l&#8217;op√©rateur du groupe, qui pourrait diriger l&#8217;effort du groupe pour doubler les transactions ou invalider les blocs (voir <a href="#consensus_attacks">Attaques par consensus</a>). De plus, les serveurs de groupe centralis√©s repr√©sentent un point de d√©faillance unique. Si le serveur du groupe est en panne ou est ralenti par une attaque par d√©ni de service, les mineurs du groupe ne peuvent pas exploiter. En 2011, pour r√©soudre ces probl√®mes de centralisation, une nouvelle m√©thode de minage en groupe a √©t√© propos√©e et mise en place¬†: P2Pool, un pool de minage pair √† pair sans op√©rateur central.</p>
</div>
<div class="paragraph data-line-909">
<p>P2Pool fonctionne en d√©centralisant les fonctions du serveur de groupe, en impl√©mentant un syst√®me parall√®le de type cha√Æne de blocs appel√© <em>cha√Æne de partage</em>. Une cha√Æne de partage est une cha√Æne de blocs fonctionnant √† une difficult√© inf√©rieure √† la cha√Æne de blocs Bitcoin. La cha√Æne de partage permet aux mineurs en groupe de collaborer dans un groupe d√©centralis√© en extrayant des parts sur la cha√Æne de partage √† raison d&#8217;un bloc de partage toutes les 30 secondes. Chacun des blocs de la cha√Æne de partage enregistre une r√©compense de part proportionnelle pour les mineurs du groupe qui contribuent au travail, se reportant aux parts du bloc de partage pr√©c√©dent. Lorsque l&#8217;un des blocs de partage atteint √©galement l&#8217;objectif du r√©seau Bitcoin, il est propag√© et inclus dans la cha√Æne de blocs Bitcoin, r√©compensant tous les mineurs du groupe qui ont contribu√© √† toutes les parts qui ont pr√©c√©d√© le bloc de partage gagnant. Essentiellement, au lieu qu&#8217;un serveur de groupe garde une trace des actions et des r√©compenses des mineurs en groupe, la cha√Æne de partage permet √† tous les mineurs en groupe de suivre toutes les actions en utilisant un m√©canisme de consensus d√©centralis√© comme le m√©canisme de consensus de cha√Æne de blocs de Bitcoin.</p>
</div>
<div class="paragraph data-line-911">
<p>L&#8217;extraction de P2Pool est plus complexe que l&#8217;extraction de groupe car elle n√©cessite que les mineurs en groupe ex√©cutent un ordinateur d√©di√© avec suffisamment d&#8217;espace disque, de m√©moire et de bande passante Internet pour prendre en charge un n≈ìud Bitcoin complet et le logiciel de n≈ìud P2Pool. Les mineurs P2Pool connectent leur mat√©riel de minage √† leur n≈ìud P2Pool local, qui simule les fonctions d&#8217;un serveur de pool en envoyant des mod√®les de bloc au mat√©riel de minage. Sur P2Pool, les mineurs de pool individuels construisent leurs propres blocs candidats, agr√©geant les transactions un peu comme les mineurs en solo, mais exploitent ensuite en collaboration sur la cha√Æne de partage. P2Pool est une approche hybride qui pr√©sente l&#8217;avantage de paiements beaucoup plus granulaires que le minage en solo, mais sans donner trop de contr√¥le √† un op√©rateur de pool comme les groupes g√©r√©s.</p>
</div>
<div class="paragraph data-line-914">
<p>M√™me si P2Pool r√©duit la concentration du pouvoir par les op√©rateurs de groupes de minage, il est concevable qu&#8217;il soit vuln√©rable √† 51¬†% des attaques contre la cha√Æne de partage elle-m√™me. Une adoption beaucoup plus large de P2Pool ne r√©sout pas le probl√®me d&#8217;attaque de 51¬†% pour le bitcoin lui-m√™me. Au contraire, P2Pool rend le bitcoin plus robuste dans l&#8217;ensemble, dans le cadre d&#8217;un √©cosyst√®me minier diversifi√©.</p>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-917">
<h3 id="consensus_attacks">Attaques par consensus</h3>
<div class="paragraph data-line-919">
<p>Le m√©canisme de consensus de Bitcoin est, du moins th√©oriquement, vuln√©rable aux attaques des mineurs (ou les groupes) qui tentent d&#8217;utiliser leur pouvoir de hachage √† des fins malhonn√™tes ou destructrices. Comme nous l&#8217;avons vu, le m√©canisme de consensus d√©pend du fait qu&#8217;une majorit√© de mineurs agissent honn√™tement dans leur propre int√©r√™t. Cependant, si un mineur ou un groupe de mineurs peut atteindre une part importante de la puissance mini√®re, il peut attaquer le m√©canisme de consensus afin de perturber la s√©curit√© et la disponibilit√© du r√©seau Bitcoin.</p>
</div>
<div class="paragraph data-line-921">
<p>Il est important de noter que les attaques de consensus ne peuvent affecter que le consensus futur, ou au mieux, le pass√© le plus r√©cent (dizaines de blocs). Le registre de Bitcoin devient de plus en plus immuable au fil du temps. Alors qu&#8217;en th√©orie, une fourche peut √™tre r√©alis√© √† n&#8217;importe quelle profondeur, en pratique, la puissance de calcul n√©cessaire pour forcer une fourche tr√®s profonde est immense, rendant les anciens blocs pratiquement immuables. Les attaques par consensus n&#8217;affectent pas non plus la s√©curit√© des cl√©s priv√©es et de l&#8217;algorithme de signature (ECDSA). Une attaque par consensus ne peut pas voler des bitcoins, d√©penser des bitcoins sans signatures, rediriger des bitcoins ou autrement modifier des transactions pass√©es ou des enregistrements de propri√©t√©. Les attaques par consensus ne peuvent affecter que les blocs les plus r√©cents et provoquer des interruptions par d√©ni de service sur la cr√©ation de futurs blocs.</p>
</div>
<div class="paragraph data-line-923">
<p>Un sc√©nario d&#8217;attaque contre le m√©canisme de consensus est appel√© "l&#8217;attaque √† 51¬†%". Dans ce sc√©nario, un groupe de mineurs, contr√¥lant la majorit√© (51%) de la puissance de hachage totale du r√©seau, s&#8217;entend pour attaquer le bitcoin. Avec la capacit√© d&#8217;exploiter la majorit√© des blocs, les mineurs attaquants peuvent provoquer des "fourches" d√©lib√©r√©s dans la cha√Æne de blocs et doubler les transactions ou ex√©cuter des attaques par d√©ni de service contre des transactions ou des adresses sp√©cifiques. Une attaque fourche/double-d√©pense est l&#8217;endroit o√π l&#8217;attaquant provoque l&#8217;invalidation de blocs pr√©c√©demment confirm√©s en forgeant en dessous d&#8217;eux et en reconvergeant sur une cha√Æne alternative. Avec une puissance suffisante, un attaquant peut invalider six blocs ou plus √† la suite, provoquant l&#8217;invalidation de transactions consid√©r√©es comme immuables (six confirmations). Notez qu&#8217;une double d√©pense ne peut √™tre effectu√©e que sur les propres transactions de l&#8217;attaquant, pour lesquelles l&#8217;attaquant peut produire une signature valide. D√©penser deux fois ses propres transactions est rentable si, en invalidant une transaction, l&#8217;attaquant peut obtenir un paiement ou un produit d&#8217;√©change irr√©versible sans le payer.</p>
</div>
<div class="paragraph data-line-925">
<p>Examinons un exemple pratique d&#8217;une attaque √† 51 %. Dans le premier chapitre, nous avons examin√© une transaction entre Alice et Bob pour une tasse de caf√©. Bob, le propri√©taire du caf√©, est pr√™t √† accepter le paiement pour des tasses de caf√© sans attendre de confirmation (extraction en bloc), car le risque de double d√©pense pour une tasse de caf√© est faible par rapport √† la commodit√© d&#8217;un service client rapide . Ceci est similaire √† la pratique des caf√©s qui acceptent les paiements par carte de cr√©dit sans signature pour des montants inf√©rieurs √† 25 $, car le risque de r√©trofacturation par carte de cr√©dit est faible tandis que le co√ªt de retarder la transaction pour obtenir une signature est comparativement plus √©lev√©. En revanche, vendre un article plus cher pour du bitcoin pr√©sente le risque d&#8217;une attaque √† double d√©pense, o√π l&#8217;acheteur diffuse une transaction concurrente qui d√©pense les m√™mes intrants (UTXO) et annule le paiement au commer√ßant. Une attaque par double d√©pense peut se produire de deux mani√®res¬†: soit avant qu&#8217;une transaction ne soit confirm√©e, soit si l&#8217;attaquant profite d&#8217;une fourche de cha√Æne de blocs pour annuler plusieurs blocs. Une attaque √† 51¬†% permet aux attaquants de doubler leurs propres transactions dans la nouvelle cha√Æne, annulant ainsi la transaction correspondante dans l&#8217;ancienne cha√Æne.</p>
</div>
<div class="paragraph data-line-927">
<p>Dans notre exemple, l&#8217;attaquant malveillant Mallory se rend dans la galerie de Carol et ach√®te un magnifique triptyque repr√©sentant Satoshi Nakamoto en Prom√©th√©e. Carol vend les peintures "The Great Fire" pour 250 000¬†$ en bitcoins √† Mallory. Au lieu d&#8217;attendre six confirmations ou plus sur la transaction, Carol emballe et remet les peintures √† Mallory apr√®s une seule confirmation. Mallory travaille avec un complice, Paul, qui exploite un grand groupe minier, et le complice lance une attaque √† 51¬†% d√®s que la transaction de Mallory est incluse dans un bloc. Paul ordonne au groupe minier de reminer la m√™me hauteur de bloc que le bloc contenant la transaction de Mallory, en rempla√ßant le paiement de Mallory √† Carol par une transaction qui double la m√™me entr√©e que le paiement de Mallory. La transaction √† double d√©pense consomme le m√™me UTXO et le rembourse au portefeuille de Mallory, au lieu de le payer √† Carol, permettant essentiellement √† Mallory de conserver le bitcoin. Paul dirige ensuite le groupe de minage pour exploiter un bloc suppl√©mentaire, de mani√®re √† rendre la cha√Æne contenant la transaction √† double d√©pense plus longue que la cha√Æne d&#8217;origine (provoquant une bifurcation sous le bloc contenant la transaction de Mallory). Lorsque la fourche de la cha√Æne de blocs se r√©sout en faveur de la nouvelle cha√Æne (plus longue), la transaction √† double d√©pense remplace le paiement initial √† Carol. Carol manque maintenant les trois peintures et n&#8217;a pas non plus de paiement en bitcoin. Tout au long de cette activit√©, les participants au groupe de minage de Paul pourraient parfaitement ignorer la tentative de double d√©pense, car ils minent avec des mineurs automatis√©s et ne peuvent pas surveiller chaque transaction ou chaque bloc.</p>
</div>
<div class="paragraph data-line-929">
<p>Pour se prot√©ger contre ce type d&#8217;attaque, un commer√ßant vendant des articles de grande valeur doit attendre au moins six confirmations avant remettre le produit √† l&#8217;acheteur. Alternativement, le commer√ßant doit utiliser un compte multisignature √† garantie bloqu√©, attendant √† nouveau plusieurs confirmations apr√®s le financement du compte √† garantie bloqu√©. Plus le nombre de confirmations s&#8217;√©coule, plus il devient difficile d&#8217;invalider une transaction avec une attaque √† 51¬†%. Pour les articles de grande valeur, le paiement par bitcoin sera toujours pratique et efficace m√™me si l&#8217;acheteur doit attendre 24 heures pour la livraison, ce qui correspondrait √† environ 144 confirmations.</p>
</div>
<div class="paragraph data-line-931">
<p>En plus d&#8217;une attaque √† double d√©pense, l&#8217;autre sc√©nario d&#8217;une attaque par consensus consiste √† refuser le service √† des participants Bitcoin sp√©cifiques (adresses Bitcoin sp√©cifiques). Un attaquant disposant de la majorit√© de la puissance mini√®re peut simplement ignorer des transactions sp√©cifiques. S&#8217;ils sont inclus dans un bloc min√© par un autre mineur, l&#8217;attaquant peut d√©lib√©r√©ment bifurquer et r√©miner ce bloc, en excluant √† nouveau les transactions sp√©cifiques. Ce type d&#8217;attaque peut entra√Æner un d√©ni de service prolong√© contre une adresse sp√©cifique ou un ensemble d&#8217;adresses aussi longtemps que l&#8217;attaquant contr√¥le la majorit√© de la puissance de minage.</p>
</div>
<div class="paragraph data-line-933">
<p>Malgr√© son nom, le sc√©nario d&#8217;attaque √† 51¬†% ne n√©cessite pas r√©ellement 51¬†% de la puissance de hachage. En fait, une telle attaque peut √™tre tent√©e avec un pourcentage plus faible de la puissance de hachage. Le seuil de 51¬†% est simplement le niveau auquel une telle attaque est presque garantie de r√©ussir. Une attaque consensuelle est essentiellement un bras de fer pour le bloc suivant et le groupe "le plus fort" a plus de chances de gagner. Avec moins de puissance de hachage, la probabilit√© de succ√®s est r√©duite, car d&#8217;autres mineurs contr√¥lent la g√©n√©ration de certains blocs avec leur puissance de minage "honn√™te". Une fa√ßon de voir les choses est que plus un attaquant a de puissance de hachage, plus la fourche qu&#8217;il peut d√©lib√©r√©ment cr√©er est long, plus il peut invalider de blocs dans le pass√© r√©cent ou plus il peut contr√¥ler de blocs dans le futur. Des groupes de recherche en s√©curit√© ont utilis√© la mod√©lisation statistique pour affirmer que divers types d&#8217;attaques par consensus sont possibles avec aussi peu que 30¬†% de la puissance de hachage.</p>
</div>
<div class="paragraph data-line-935">
<p>L&#8217;augmentation massive de la puissance de hachage totale a sans doute rendu le bitcoin insensible aux attaques d&#8217;un seul mineur. Il n&#8217;y a aucun moyen pour un mineur solo de contr√¥ler plus qu&#8217;un petit pourcentage de la puissance mini√®re totale. Cependant, la centralisation du contr√¥le caus√©e par les groupes de minage a introduit le risque d&#8217;attaques √† but lucratif par un op√©rateur de groupe de minage. L&#8217;op√©rateur d&#8217;un groupe g√©r√© contr√¥le la construction des blocs candidats et contr√¥le √©galement les transactions incluses. Cela donne √† l&#8217;op√©rateur du groupe le pouvoir d&#8217;exclure des transactions ou d&#8217;introduire des transactions √† double d√©pense. Si un tel abus de pouvoir est fait de mani√®re limit√©e et subtile, un op√©rateur de groupe pourrait √©ventuellement profiter d&#8217;une attaque par consensus sans se faire remarquer.</p>
</div>
<div class="paragraph data-line-937">
<p>Cependant, tous les attaquants ne seront pas motiv√©s par le profit. Un sc√©nario d&#8217;attaque potentiel est celui o√π un attaquant a l&#8217;intention de perturber le r√©seau Bitcoin sans avoir la possibilit√© de profiter d&#8217;une telle perturbation. Une attaque malveillante visant √† paralyser le bitcoin n√©cessiterait d&#8217;√©normes investissements et une planification secr√®te, mais pourrait √©ventuellement √™tre lanc√©e par un attaquant bien financ√©, tr√®s probablement parrain√© par l&#8217;√âtat. Alternativement, un attaquant bien financ√© pourrait attaquer le consensus de bitcoin en amassant simultan√©ment du mat√©riel de minage, en compromettant les op√©rateurs de groupe et en attaquant d&#8217;autres groupes par d√©ni de service. Tous ces sc√©narios sont th√©oriquement possibles, mais de plus en plus impraticables √† mesure que la puissance de hachage globale du r√©seau Bitcoin continue de cro√Ætre de fa√ßon exponentielle.</p>
</div>
<div class="paragraph data-line-939">
<p>Sans aucun doute, une attaque s√©rieuse du consensus √©roderait la confiance dans le bitcoin √† court terme, provoquant √©ventuellement une baisse significative des prix. Cependant, le r√©seau et les logiciels Bitcoin √©voluent constamment, de sorte que les attaques par consensus se heurteraient √† des contre-mesures imm√©diates de la part de la communaut√© bitcoin, rendant le bitcoin plus robuste.</p>
</div>
</div>
<div class="sect2 data-line-942">
<h3 id="consensus_changes">Modification des r√®gles de consensus</h3>
<div class="paragraph data-line-944">
<p>Les r√®gles de consensus d√©terminent la validit√© des transactions et des blocs. Ces r√®gles constituent la base de la collaboration entre tous les n≈ìuds Bitcoin et sont responsables de la convergence de toutes les perspectives locales en une seule cha√Æne de blocs coh√©rente sur l&#8217;ensemble du r√©seau.</p>
</div>
<div class="paragraph data-line-946">
<p>Alors que les r√®gles de consensus sont invariables √† court terme et doivent √™tre coh√©rentes √† travers tous les n≈ìuds, elles ne sont pas invariables √† long terme. Afin d&#8217;√©voluer et de d√©velopper le syst√®me Bitcoin, les r√®gles doivent changer de temps en temps pour s&#8217;adapter aux nouvelles fonctionnalit√©s, am√©liorations ou corrections de bogues. Contrairement au d√©veloppement de logiciels traditionnels, cependant, les mises √† niveau vers un syst√®me de consensus sont beaucoup plus difficiles et n√©cessitent une coordination entre tous les participants.</p>
</div>
<div class="sect3 data-line-950">
<h4 id="hard_forks">Embranchements divergents</h4>
<div class="paragraph data-line-951">
<p>Dans <a href="#forks">Fourches de cha√Æne de blocs</a> nous avons examin√© comment le r√©seau Bitcoin peut bri√®vement diverger, avec deux parties du r√©seau suivant deux branches diff√©rentes de la cha√Æne de blocs pendant une courte p√©riode. Nous avons vu comment ce processus se produit naturellement, dans le cadre du fonctionnement normal du r√©seau et comment le r√©seau reconverge sur une cha√Æne de blocs commune apr√®s le minage d&#8217;un ou plusieurs blocs.</p>
</div>
<div class="paragraph data-line-953">
<p>Il existe un autre sc√©nario dans lequel le r√©seau peut diverger en deux cha√Ænes suivantes¬†: un changement dans les r√®gles de consensus. Ce type de fourche ou embranchement est appel√© <em>embranchement divergent</em> (<em>hard fork</em>), car apr√®s l&#8217;embranchement ou la fourche, le r√©seau ne reconverge pas sur une seule cha√Æne. Au lieu de cela, les deux cha√Ænes √©voluent ind√©pendamment. Les embranchements divergents se produisent lorsqu&#8217;une partie du r√©seau fonctionne selon un ensemble de r√®gles de consensus diff√©rent du reste du r√©seau. Cela peut se produire √† cause d&#8217;un bogue ou √† cause d&#8217;un changement d√©lib√©r√© dans l&#8217;impl√©mentation des r√®gles de consensus.</p>
</div>
<div class="paragraph data-line-955">
<p>Les embranchements divergents peuvent √™tre utilis√©s pour modifier les r√®gles du consensus, mais ils n√©cessitent une coordination entre tous les participants au syst√®me. Tous les n≈ìuds qui ne se mettent pas √† niveau vers les nouvelles r√®gles de consensus ne peuvent pas participer au m√©canisme de consensus et sont forc√©s √† une cha√Æne distincte au moment de l&#8217;embranchement divergent. Ainsi, un changement introduit par un embranchement divergent peut √™tre consid√©r√© comme non ¬´ compatible en aval ¬ª, dans la mesure o√π les syst√®mes non mis √† niveau ne peuvent pas traiter les nouvelles r√®gles de consensus apr√®s l&#8217;√©v√©nement d&#8217;embranchement divergent.</p>
</div>
<div class="paragraph data-line-957">
<p>Examinons les m√©canismes d&#8217;un embranchement divergent avec un exemple sp√©cifique.</p>
</div>
<div class="paragraph data-line-959">
<p><a href="#blockchainwithforks">Une cha√Æne de blocs avec des fourches</a> montre une cha√Æne de blocs avec deux fourches. √Ä la hauteur de bloc 4, une fourche √† un bloc se produit. C&#8217;est le type de fourche spontan√© que nous avons vu dans <a href="#forks">Fourches de cha√Æne de blocs</a>. Avec le minage du bloc 5, le r√©seau reconverge sur une cha√Æne et l&#8217;embranchement est r√©solu.</p>
</div>
<div id="blockchainwithforks" class="imageblock data-line-963">
<div class="content">
<img src="images/mbc2_1009.png" alt="Une cha√Æne de blocs avec des fourches">
</div>
<div class="title">Figure 71. Une cha√Æne de blocs avec des fourches</div>
</div>
<div class="paragraph data-line-965">
<p>Plus tard, cependant, √† la hauteur de bloc 6, une bifurcation divergente se produit. Supposons qu&#8217;une nouvelle impl√©mentation du client soit publi√©e avec un changement dans les r√®gles de consensus. √Ä partir de la hauteur de bloc 7, les mineurs ex√©cutant cette nouvelle impl√©mentation accepteront un nouveau type de signature num√©rique, appelons-le une signature "Smores", qui n&#8217;est pas bas√©e sur ECDSA. Imm√©diatement apr√®s, un n≈ìud ex√©cutant la nouvelle impl√©mentation cr√©e une transaction qui contient une signature Smores et un mineur avec le logiciel mis √† jour mine le bloc 7b contenant cette transaction.</p>
</div>
<div class="paragraph data-line-967">
<p>Tout n≈ìud ou mineur qui n&#8217;a pas mis √† jour le logiciel pour valider les signatures Smores est d√©sormais incapable de traiter le bloc 7b. De leur point de vue, la transaction qui contenait une signature Smores et le bloc 7b qui contenait cette transaction sont invalides, car ils les √©valuent sur la base des anciennes r√®gles de consensus. Ces n≈ìuds rejetteront la transaction et le bloc et ne les propageront pas. Tous les mineurs qui utilisent les anciennes r√®gles n&#8217;accepteront pas le bloc 7b et continueront √† exploiter un bloc candidat dont le parent est le bloc 6. En fait, les mineurs utilisant les anciennes r√®gles peuvent m√™me ne pas recevoir le bloc 7b si tous les n≈ìuds auxquels ils sont connect√©s sont ob√©issant √©galement aux anciennes r√®gles et donc ne propageant pas le bloc. √Ä terme, ils pourront exploiter le bloc 7a, qui est valide selon les anciennes r√®gles et ne contient aucune transaction avec des signatures Smores.</p>
</div>
<div class="paragraph data-line-969">
<p>Les deux cha√Ænes continuent de diverger √† partir de ce point. Les mineurs de la cha√Æne "b" continueront d&#8217;accepter et d&#8217;exploiter les transactions contenant des signatures Smores, tandis que les mineurs de la cha√Æne "a" continueront d&#8217;ignorer ces transactions. M√™me si le bloc 8b ne contient aucune transaction sign√©e Smores, les mineurs de la cha√Æne "a" ne peuvent pas le traiter. Pour eux, il semble √™tre un bloc orphelin, car son parent "7b" n&#8217;est pas reconnu comme un bloc valide.</p>
</div>
</div>
<div class="sect3 data-line-971">
<h4 id="_embranchements_divergents_logiciel_r√©seau_exploitation_mini√®re_et_cha√Æne">Embranchements divergents¬†: logiciel, r√©seau, exploitation mini√®re et cha√Æne</h4>
<div class="paragraph data-line-973">
<p>Pour les d√©veloppeurs de logiciels, le terme "fourche" a une autre signification, ajoutant de la confusion au terme "fourche divergente". Dans les logiciels √† source libre, une fourche se produit lorsqu&#8217;un groupe de d√©veloppeurs choisit de suivre une feuille de route logicielle diff√©rente et d√©marre une impl√©mentation concurrente d&#8217;un projet √† source libre. Nous avons d√©j√† discut√© de deux circonstances qui conduiront √† un embranchement divergent en Bitcoin¬†: un bogue dans les r√®gles de consensus et une modification d√©lib√©r√©e des r√®gles de consensus. Dans le cas d&#8217;une modification d√©lib√©r√©e des r√®gles de consensus, une fourche logicielle pr√©c√®de l&#8217;embranchement divergent. Cependant, pour que ce type d&#8217;embranchement divergent se produise, une nouvelle impl√©mentation logicielle des r√®gles de consensus doit √™tre d√©velopp√©e, adopt√©e et lanc√©e.</p>
</div>
<div class="paragraph data-line-975">
<p>Des exemples de fourches logicielles qui ont tent√© de modifier les r√®gles de consensus incluent Bitcoin XT, Bitcoin Classic et, plus r√©cemment, Bitcoin Unlimited. Cependant, aucun de ces fourches logiciels n&#8217;a abouti √† un embranchement divergent. Bien qu&#8217;une fourche logicielle soit une condition pr√©alable n√©cessaire, il n&#8217;est pas suffisant en soi pour qu&#8217;un embranchement divergent se produise. Pour qu&#8217;un embranchement divergent se produise, l&#8217;impl√©mentation concurrente doit √™tre adopt√©e et les nouvelles r√®gles activ√©es, par les mineurs, les portefeuilles et les n≈ìuds interm√©diaires. A l&#8217;inverse, il existe de nombreuses impl√©mentations alternatives de Bitcoin Core, et m√™me des fourches logiciels, qui ne changent pas les r√®gles de consensus, et sauf par bogue, peuvent coexister sur le r√©seau et interagir sans provoquer d&#8217;embranchement divergent.</p>
</div>
<div class="paragraph data-line-977">
<p>Les r√®gles de consensus peuvent diff√©rer de mani√®re √©vidente et explicite, dans la validation des transactions ou des blocs. Les r√®gles peuvent √©galement diff√©rer de mani√®re plus subtile, dans la mise en ≈ìuvre des r√®gles de consensus telles qu&#8217;elles s&#8217;appliquent aux scripts bitcoin ou aux primitives cryptographiques telles que les signatures num√©riques. Enfin, les r√®gles de consensus peuvent diff√©rer de mani√®re impr√©vue en raison des contraintes de consensus implicites impos√©es par les limitations du syst√®me ou les d√©tails de mise en ≈ìuvre. Un exemple de ce dernier a √©t√© vu dans l&#8217;embranchement divergent impr√©vu lors de la mise √† niveau de Bitcoin Core 0.7 vers 0.8, qui a √©t√© caus√© par une limitation de l&#8217;impl√©mentation de Berkeley DB utilis√©e pour stocker les blocs.</p>
</div>
<div class="paragraph data-line-979">
<p>Conceptuellement, nous pouvons consid√©rer qu&#8217;un embranchement divergent se d√©veloppe en quatre √©tapes¬†: une fourche logiciel, une fourche du r√©seau, une fourche de minage et une fourche de cha√Æne.</p>
</div>
<div class="paragraph data-line-981">
<p>Le processus commence lorsqu&#8217;une impl√©mentation alternative du client, avec des r√®gles de consensus modifi√©es, est cr√©√©e par les d√©veloppeurs.</p>
</div>
<div class="paragraph data-line-983">
<p>Lorsque cette impl√©mentation fourch√©e est d√©ploy√©e dans le r√©seau, un certain pourcentage de mineurs, d&#8217;utilisateurs de portefeuille et de n≈ìuds interm√©diaires peuvent adopter et ex√©cuter cette impl√©mentation. Une fourche r√©sultante d√©pendra de l&#8217;application ou non des nouvelles r√®gles de consensus aux blocs, aux transactions ou √† tout autre aspect du syst√®me. Si les nouvelles r√®gles de consensus concernent les transactions, un portefeuille cr√©ant une transaction selon les nouvelles r√®gles peut pr√©cipiter une fourche r√©seau, suivi d&#8217;un embranchement divergent lorsque la transaction est extraite dans un bloc. Si les nouvelles r√®gles concernent les blocs, le processus d&#8217;embranchement divergent commencera lorsqu&#8217;un bloc sera min√© selon les nouvelles r√®gles.</p>
</div>
<div class="paragraph data-line-985">
<p>Tout d&#8217;abord, le r√©seau bifurquera. Les n≈ìuds bas√©s sur l&#8217;impl√©mentation d&#8217;origine des r√®gles de consensus rejetteront toutes les transactions et tous les blocs cr√©√©s selon les nouvelles r√®gles. De plus, les n≈ìuds qui suivent les r√®gles de consensus d&#8217;origine seront temporairement bannis et d√©connect√©s de tous les n≈ìuds qui leur envoient ces transactions et blocs invalides. En cons√©quence, le r√©seau va se partitionner en deux¬†: les anciens n≈ìuds ne resteront connect√©s qu&#8217;aux anciens n≈ìuds et les nouveaux n≈ìuds ne seront connect√©s qu&#8217;aux nouveaux n≈ìuds. Une transaction ou un bloc unique bas√© sur les nouvelles r√®gles se r√©percutera sur le r√©seau et entra√Ænera la partition en deux r√©seaux.</p>
</div>
<div class="paragraph data-line-987">
<p>Une fois qu&#8217;un mineur utilisant les nouvelles r√®gles exploite un bloc, la puissance et la cha√Æne de minage bifurqueront √©galement. Les nouveaux mineurs exploiteront le nouveau bloc, tandis que les anciens mineurs exploiteront une cha√Æne distincte bas√©e sur les anciennes r√®gles. Le r√©seau partitionn√© fera en sorte que les mineurs op√©rant selon des r√®gles de consensus distinctes ne recevront probablement pas les blocs les uns des autres, car ils sont connect√©s √† deux r√©seaux distincts.</p>
</div>
</div>
<div class="sect3 data-line-989">
<h4 id="_mineurs_divergents_et_difficult√©">Mineurs divergents et difficult√©</h4>
<div class="paragraph data-line-991">
<p>Alors que les mineurs divergent pour exploiter deux cha√Ænes diff√©rentes, la puissance de hachage est r√©partie entre les cha√Ænes. La puissance mini√®re peut √™tre r√©partie dans n&#8217;importe quelle proportion entre les deux cha√Ænes. Les nouvelles r√®gles ne peuvent √™tre suivies que par une minorit√©, ou par la grande majorit√© de la puissance mini√®re.</p>
</div>
<div class="paragraph data-line-993">
<p>Supposons, par exemple, une r√©partition de 80¬†% √† 20 %, la majorit√© de la puissance mini√®re utilisant les nouvelles r√®gles de consensus. Supposons √©galement que la fourche se produise imm√©diatement apr√®s une p√©riode de reciblage.</p>
</div>
<div class="paragraph data-line-995">
<p>Les deux cha√Ænes h√©riteraient chacune de la difficult√© de la p√©riode de reciblage. Les nouvelles r√®gles consensuelles auraient 80¬†% de la puissance mini√®re pr√©c√©demment disponible qui leur serait engag√©e. Du point de vue de cette cha√Æne, la puissance mini√®re a subitement recul√© de 20¬†% par rapport √† la p√©riode pr√©c√©dente. Des blocs seront trouv√©s en moyenne toutes les 12,5 minutes, ce qui repr√©sente la baisse de 20¬†% de la puissance mini√®re disponible pour prolonger cette cha√Æne. Ce taux d&#8217;√©mission de blocs se poursuivra (sauf modification de la puissance de hachage) jusqu&#8217;√† ce que les blocs de 2016 soient extraits, ce qui prendra environ 25 200 minutes (√† 12,5 minutes par bloc), soit 17,5 jours. Apr√®s 17,5 jours, un reciblage se produira et la difficult√© s&#8217;ajustera (r√©duite de 20%) pour produire √† nouveau des blocs de 10 minutes, en fonction de la quantit√© r√©duite de puissance de hachage dans cette cha√Æne.</p>
</div>
<div class="paragraph data-line-997">
<p>La cha√Æne minoritaire, minant selon les anciennes r√®gles avec seulement 20¬†% de la puissance de hachage, sera confront√©e √† une t√¢che beaucoup plus difficile. Sur cette cha√Æne, les blocs seront d√©sormais min√©s toutes les 50 minutes en moyenne. La difficult√© ne sera pas ajust√©e pour les blocs de 2016, qui prendront 100 800 minutes, soit environ 10 semaines √† miner. En supposant une capacit√© fixe par bloc, cela se traduira √©galement par une r√©duction de la capacit√© de transaction par un facteur de 5, car il y a moins de blocs par heure disponibles pour enregistrer les transactions.</p>
</div>
</div>
<div class="sect3 data-line-999">
<h4 id="_embranchements_divergents_litigieux">Embranchements divergents litigieux</h4>
<div class="paragraph data-line-1001">
<p>C&#8217;est l&#8217;aube du d√©veloppement de logiciels consensuels. Tout comme le d√©veloppement √† source libre a chang√© √† la fois les m√©thodes et les produits des logiciels et a cr√©√© de nouvelles m√©thodologies, de nouveaux outils et de nouvelles communaut√©s dans son sillage, le d√©veloppement de logiciels consensuels repr√©sente √©galement une nouvelle fronti√®re en informatique. Des d√©bats, des exp√©riences et des tribulations de la feuille de route de d√©veloppement du bitcoin, nous verrons √©merger de nouveaux outils, pratiques, m√©thodologies et communaut√©s de d√©veloppement.</p>
</div>
<div class="paragraph data-line-1003">
<p>Les fourches dures sont consid√©r√©es comme risqu√©es car elles obligent une minorit√© √† se mettre √† niveau ou √† rester sur une cha√Æne minoritaire. Le risque de scinder l&#8217;ensemble du syst√®me en deux syst√®mes concurrents est consid√©r√© par beaucoup comme un risque inacceptable. En cons√©quence, de nombreux d√©veloppeurs h√©sitent √† utiliser le m√©canisme d&#8217;embranchement divergent pour mettre en ≈ìuvre des mises √† niveau des r√®gles de consensus, √† moins qu&#8217;il n&#8217;y ait un soutien quasi unanime de l&#8217;ensemble du r√©seau. Toutes les propositions d&#8217;embranchement divergent qui ne b√©n√©ficient pas d&#8217;un soutien quasi unanime sont consid√©r√©es comme trop "controvers√©es" √† tenter sans risquer une partition du syst√®me.</p>
</div>
<div class="paragraph data-line-1005">
<p>La question des embranchements divergents est tr√®s controvers√©e dans la communaut√© du d√©veloppement de Bitcoin, en particulier en ce qui concerne toute modification propos√©e aux r√®gles de consensus contr√¥lant la limite de taille de bloc maximale. Certains d√©veloppeurs sont oppos√©s √† toute forme d&#8217;embranchement divergent, le consid√©rant comme trop risqu√©. D&#8217;autres consid√®rent le m√©canisme d&#8217;embranchement divergent comme un outil essentiel pour mettre √† niveau les r√®gles de consensus d&#8217;une mani√®re qui √©vite la "dette technique" et offre une rupture nette avec le pass√©. Enfin, certains d√©veloppeurs voient les embranchements divergents comme un m√©canisme qui devrait √™tre utilis√© rarement, avec beaucoup de planification pr√©alable et uniquement sous un consensus quasi unanime.</p>
</div>
<div class="paragraph data-line-1007">
<p>Nous avons d√©j√† vu l&#8217;√©mergence de nouvelles m√©thodologies pour faire face aux risques d&#8217;embranchements divergents. Dans la section suivante, nous examinerons les embranchements convergents et les m√©thodes BIP-34 et BIP-9 pour la signalisation et l&#8217;activation des modifications de consensus.</p>
</div>
</div>
<div class="sect3 data-line-1009">
<h4 id="_embranchements_convergents">Embranchements convergents</h4>
<div class="paragraph data-line-1011">
<p>Tous les changements de r√®gles de consensus ne provoquent pas un embranchement divergent. Seuls les changements de consensus qui sont incompatibles en aval provoquent un embranchement ou fourche. Si la modification est impl√©ment√©e de telle mani√®re qu&#8217;un client non mis √† niveau voit toujours la transaction ou le bloc comme valide selon les r√®gles pr√©c√©dentes, la modification peut se produire sans fourche.</p>
</div>
<div class="paragraph data-line-1013">
<p>Le terme <em>embranchement convergent</em> (<em>soft fork</em>) a √©t√© introduit pour distinguer cette m√©thode de mise √† niveau d&#8217;un "embranchement divergent" (hard fork). En pratique, un embranchement convergent n&#8217;est pas du tout un embranchement ou une fourche. Un embranchement convergent est une modification compatible avec les r√®gles de consensus qui permet aux clients non mis √† niveau de continuer √† fonctionner en consensus avec les nouvelles r√®gles.</p>
</div>
<div class="paragraph data-line-1015">
<p>Un aspect des embranchements convergents qui n&#8217;est pas imm√©diatement √©vident est que les mises √† niveau d&#8217;embranchement convergent ne peuvent √™tre utilis√©es que pour restreindre les r√®gles de consensus, pas pour les √©tendre. Afin d&#8217;√™tre compatibles en aval, les transactions et les blocs cr√©√©s selon les nouvelles r√®gles doivent √©galement √™tre valides selon les anciennes r√®gles, mais pas l&#8217;inverse. Les nouvelles r√®gles ne peuvent que limiter ce qui est valide; sinon, ils d√©clencheront un embranchement divergent s&#8217;ils sont rejet√©s selon les anciennes r√®gles.</p>
</div>
<div class="paragraph data-line-1017">
<p>Les embranchements convergents peuvent √™tre impl√©ment√©s de plusieurs fa√ßons - le terme ne sp√©cifie pas une m√©thode particuli√®re, mais plut√¥t un ensemble de m√©thodes qui ont toutes une chose en commun¬†: elles ne n√©cessitent pas la mise √† niveau de tous les n≈ìuds ou ne forcent pas les n≈ìuds non mis √† niveau hors de consensus.</p>
</div>
<div class="sect4 data-line-1019">
<h5 id="_embranchements_convergents_red√©finissant_les_opcodes_nop">Embranchements convergents red√©finissant les opcodes NOP</h5>
<div class="paragraph data-line-1021">
<p>Un certain nombre de embranchements convergents ont √©t√© impl√©ment√©s dans bitcoin, sur la base de la r√©interpr√©tation d&#8217;opcodes NOP. Bitcoin Script avait dix opcodes r√©serv√©s pour une utilisation future, NOP1 √† NOP10. Selon les r√®gles de consensus, la pr√©sence de ces opcodes dans un script est interpr√©t√©e comme un op√©rateur nul, ce qui signifie qu&#8217;ils n&#8217;ont aucun effet. L&#8217;ex√©cution continue apr√®s l&#8217;opcode NOP comme s&#8217;il n&#8217;√©tait pas l√†.</p>
</div>
<div class="paragraph data-line-1023">
<p>Un embranchement convergent peut donc modifier la s√©mantique d&#8217;un code NOP pour lui donner un nouveau sens. Par exemple, BIP-65 (<code>CHECKLOCKTIMEVERIFY</code>) a r√©interpr√©t√© l&#8217;opcode NOP2. Les clients impl√©mentant BIP-65 interpr√®tent NOP2 comme <code>OP_CHECKLOCKTIMEVERIFY</code> et imposent une r√®gle de consensus de verrouillage absolu sur UTXO qui contient cet opcode dans leurs scripts de verrouillage. Ce changement est un embranchement convergent car une transaction valide sous BIP-65 est √©galement valide sur tout client qui n&#8217;impl√©mente pas (ignore) BIP-65. Pour les anciens clients, le script contient un code NOP, qui est ignor√©.</p>
</div>
</div>
<div class="sect4 data-line-1025">
<h5 id="_autres_fa√ßons_de_mettre_√†_niveau_lembranchement_convergent">Autres fa√ßons de mettre √† niveau l&#8217;embranchement convergent</h5>
<div class="paragraph data-line-1027">
<p>La r√©interpr√©tation des opcodes NOP √©tait √† la fois pr√©vue et un m√©canisme √©vident pour les mises √† niveau consensuelles. R√©cemment, cependant, un autre m√©canisme d&#8217;embranchement convergent a √©t√© introduit qui ne repose pas sur les opcodes NOP pour un type tr√®s sp√©cifique de changement de consensus. Ceci est examin√© plus en d√©tail dans <a href="#segwit">T√©moin s√©par√©</a>. Segwit est une modification architecturale de la structure d&#8217;une transaction, qui d√©place le script de d√©verrouillage (t√©moin) de l&#8217;int√©rieur de la transaction vers une structure de donn√©es externe (en la s√©parant). Segwit a √©t√© initialement envisag√© comme une mise √† niveau de embranchement divergent, car il modifiait une structure fondamentale (transaction). En novembre 2015, un d√©veloppeur travaillant sur Bitcoin Core a propos√© un m√©canisme par lequel segwit pourrait √™tre introduit en tant que embranchement convergent. Le m√©canisme utilis√© pour cela est une modification du script de verrouillage d&#8217;UTXO cr√©√© selon les r√®gles segwit, de sorte que les clients non mis √† niveau voient le script de verrouillage comme √©changeable avec n&#8217;importe quel script de d√©verrouillage. En cons√©quence, segwit peut √™tre introduit sans n√©cessiter que chaque n≈ìud soit mis √† niveau ou s√©par√© de la cha√Æne¬†: un embranchement convergent.</p>
</div>
<div class="paragraph data-line-1029">
<p>Il est probable qu&#8217;il existe d&#8217;autres m√©canismes, encore √† d√©couvrir, par lesquels les mises √† niveau peuvent √™tre effectu√©es de mani√®re compatible avec les versions ult√©rieures en tant qu&#8217;embranchement convergent.</p>
</div>
</div>
</div>
<div class="sect3 data-line-1031">
<h4 id="_critiques_dembranchements_convergents">Critiques d&#8217;embranchements convergents</h4>
<div class="paragraph data-line-1033">
<p>Les embranchements convergents bas√©s sur les opcodes NOP sont relativement peu controvers√©s. Les opcodes NOP ont √©t√© plac√©s dans Bitcoin Script dans le but explicite de permettre des mises √† niveau non perturbatrices.</p>
</div>
<div class="paragraph data-line-1035">
<p>Cependant, de nombreux d√©veloppeurs craignent que d&#8217;autres m√©thodes de mises √† niveau d&#8217;embranchements convergents ne fassent des compromis inacceptables. Les critiques courantes des changements d&#8217;embranchement convergent incluent:</p>
</div>
<div class="dlist data-line-1037">
<dl>
<dt class="hdlist1">Dette technique</dt>
<dd>
<p>√âtant donn√© que les embranchements convergents sont plus complexes techniquement qu&#8217;une mise √† niveau de embranchements divergents, ils introduisent la <em>dette technique</em>, un terme qui fait r√©f√©rence √† l&#8217;augmentation du co√ªt futur de la maintenance du code en raison des compromis de conception effectu√©s dans le pass√©. La complexit√© du code augmente √† son tour la probabilit√© de bogues et de failles de s√©curit√©.</p>
</dd>
<dt class="hdlist1">Assouplissement de la validation</dt>
<dd>
<p>les clients non mis √† niveau voient les transactions comme valides, sans √©valuer les r√®gles de consensus modifi√©es. En effet, les clients non mis √† niveau ne valident pas en utilisant la gamme compl√®te des r√®gles de consensus, car ils sont aveugles aux nouvelles r√®gles. Cela s&#8217;applique aux mises √† niveau bas√©es sur NOP, ainsi qu&#8217;aux autres mises √† niveau d&#8217;embranchements convergents.</p>
</dd>
<dt class="hdlist1">Mises √† niveau irr√©versibles</dt>
<dd>
<p>√âtant donn√© que les embranchements convergents cr√©ent des transactions avec des contraintes de consensus suppl√©mentaires, elles deviennent des mises √† niveau irr√©versibles dans la pratique. Si une mise √† niveau d&#8217;embranchement convergent devait √™tre annul√©e apr√®s avoir √©t√© activ√©e, toute transaction cr√©√©e selon les nouvelles r√®gles pourrait entra√Æner une perte de fonds selon les anciennes r√®gles. Par exemple, si une transaction CLTV est √©valu√©e selon les anciennes r√®gles, il n&#8217;y a pas de contrainte de timelock et elle peut √™tre d√©pens√©e √† tout moment. Par cons√©quent, les critiques soutiennent qu&#8217;un embranchement convergent d√©faillant qui devait √™tre annul√© √† cause d&#8217;un bogue entra√Ænerait presque certainement une perte de fonds.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2 data-line-1044">
<h3 id="softforksignaling">Signalisation d&#8217;embranchement convergent avec la version du bloc</h3>
<div class="paragraph data-line-1046">
<p>Puisque les embranchements convergents permettent aux clients non mis √† jour de continuer √† fonctionner dans le cadre du consensus, le m√©canisme pour ¬´¬†activer¬†¬ª un embranchement convergent consiste √† signaler que les mineurs sont pr√™ts¬†: une majorit√© de mineurs doit convenir qu&#8217;ils sont pr√™ts et dispos√©s √† appliquer les nouvelles r√®gles consensuelles. Pour coordonner leurs actions, il existe un m√©canisme de signalisation qui leur permet de montrer leur soutien √† un changement de r√®gle consensuel. Ce m√©canisme a √©t√© introduit avec l&#8217;activation de BIP-34 en mars 2013 et remplac√© par l&#8217;activation de BIP-9 en juillet 2016.</p>
</div>
<div class="sect3 data-line-1048">
<h4 id="_signalisation_et_activation_bip_34">Signalisation et activation BIP-34</h4>
<div class="paragraph data-line-1050">
<p> La premi√®re impl√©mentation, dans BIP-34, utilisait le champ de version de bloc pour permettre aux mineurs de signaler qu&#8217;ils √©taient pr√™ts pour un changement de r√®gle de consensus sp√©cifique. Avant le BIP-34, la version du bloc √©tait d√©finie par la valeur "1" par <em>convention</em> non appliqu√©e par <em>consensus</em>.</p>
</div>
<div class="paragraph data-line-1052">
<p>BIP-34 a d√©fini un changement de r√®gle de consensus qui exigeait que le champ de donn√©es coinbase d&#8217;une entr√©e de transaction coinbase contienne la hauteur du bloc. Avant le BIP-34, les donn√©es coinbase pouvaient contenir toutes les donn√©es arbitraires que les mineurs choisissaient d&#8217;inclure. Apr√®s l&#8217;activation de BIP-34, les blocs valides devaient contenir une hauteur de bloc sp√©cifique au d√©but des donn√©es coinbase et √™tre identifi√©s par un num√©ro de version sup√©rieur ou √©gal √† "2".</p>
</div>
<div class="paragraph data-line-1054">
<p>Pour signaler le changement et l&#8217;activation de BIP-34, les mineurs ont d√©fini la version du bloc √† "2" au lieu de "1". Cela n&#8217;a pas imm√©diatement rendu les blocs de la version "1" invalides. Une fois activ√©s, les blocs de la version "1" deviendraient invalides et tous les blocs de la version "2" devraient contenir la hauteur du bloc dans la coinbase pour √™tre valides.</p>
</div>
<div class="paragraph data-line-1056">
<p>BIP-34 a d√©fini un m√©canisme d&#8217;activation en deux √©tapes, bas√© sur une fen√™tre glissante de 1000 blocs. Un mineur signalerait sa pr√©paration individuelle pour le BIP-34 en construisant des blocs avec "2" comme num√©ro de version. √Ä proprement parler, ces blocs n&#8217;avaient pas encore √† se conformer √† la nouvelle r√®gle de consensus consistant √† inclure la hauteur de bloc dans la transaction coinbase car la r√®gle de consensus n&#8217;avait pas encore √©t√© activ√©e. Les r√®gles de consensus activ√©es en deux √©tapes :</p>
</div>
<div class="ulist data-line-1058">
<ul>
<li class="data-line-1058">
<p>Si 75¬†% (750 des 1000 blocs les plus r√©cents) sont marqu√©s avec la version "2", alors les blocs de la version "2" doivent contenir la hauteur du bloc dans la transaction coinbase ou ils sont rejet√©s comme invalides. Les blocs de version "1" sont toujours accept√©s par le r√©seau et n&#8217;ont pas besoin de contenir de hauteur de bloc. Les anciennes et les nouvelles r√®gles de consensus coexistent pendant cette p√©riode.</p>
</li>
<li class="data-line-1060">
<p>Lorsque 95¬†% (950 des 1¬†000¬†blocs les plus r√©cents) sont de version¬†"2", les blocs de version¬†"1" ne sont plus consid√©r√©s comme valides. Les blocs de la version "2" ne sont valides que s&#8217;ils contiennent la hauteur de bloc dans le coinbase (selon le seuil pr√©c√©dent). Par la suite, tous les blocs doivent respecter les nouvelles r√®gles de consensus et tous les blocs valides doivent contenir la hauteur de bloc dans la transaction coinbase.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-1062">
<p>Apr√®s une signalisation et une activation r√©ussies selon les r√®gles BIP-34, ce m√©canisme a √©t√© utilis√© deux fois de plus pour activer les embranchements convergents¬†:</p>
</div>
<div class="ulist data-line-1064">
<ul>
<li class="data-line-1064">
<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0066.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0066.mediawiki">BIP-66</a> Le codage DER strict des signatures a √©t√© activ√© par une signalisation de style BIP-34 avec une version de bloc "3" et invalidant la version "2" des blocs.</p>
</li>
<li class="data-line-1066">
<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP-65</a> <code>CHECKLOCKTIMEVERIFY</code> a √©t√© activ√© par la signalisation de style BIP-34 avec une version de bloc "4" et invalidant la version "3" des blocs.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-1068">
<p>Apr√®s l&#8217;activation de BIP-65, le m√©canisme de signalisation et d&#8217;activation de BIP-34 a √©t√© retir√© et remplac√© par le m√©canisme de signalisation BIP-9 d√©crit ci-apr√®s.</p>
</div>
<div class="paragraph data-line-1070">
<p>La norme est d√©finie dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki">BIP-34 (Block v2, Height in Coinbase)</a>.</p>
</div>
</div>
<div class="sect3 data-line-1072">
<h4 id="_signalisation_et_activation_bip_9">Signalisation et activation BIP-9</h4>
<div class="paragraph data-line-1074">
<p> Le m√©canisme utilis√© par BIP-34, BIP-66 et BIP-65 a r√©ussi √† activer trois embranchements convergents. Cependant, il a √©t√© remplac√© car il pr√©sentait plusieurs limitations¬†:</p>
</div>
<div class="ulist data-line-1076">
<ul>
<li class="data-line-1076">
<p>En utilisant la valeur enti√®re de la version du bloc, un seul embranchement convergent pouvait √™tre activ√© √† la fois, il fallait donc une coordination entre les propositions d&#8217;embranchements convergents et un accord sur leur hi√©rarchisation et leur s√©quencement.</p>
</li>
<li class="data-line-1078">
<p>De plus, √©tant donn√© que la version de bloc √©tait incr√©ment√©e, le m√©canisme n&#8217;offrait pas de moyen simple de rejeter une modification et d&#8217;en proposer une autre. Si d&#8217;anciens clients √©taient toujours en cours d&#8217;ex√©cution, ils pourraient confondre la signalisation d&#8217;une nouvelle modification avec la signalisation de la modification pr√©c√©demment rejet√©e.</p>
</li>
<li class="data-line-1080">
<p>Chaque nouveau changement r√©duit irr√©vocablement les versions de blocs disponibles pour les changements futurs.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-1082">
<p>Le BIP-9 a √©t√© propos√© pour surmonter ces d√©fis et am√©liorer le rythme et la facilit√© de mise en ≈ìuvre des changements futurs.</p>
</div>
<div class="paragraph data-line-1084">
<p>BIP-9 interpr√®te la version de bloc comme un champ de bits au lieu d&#8217;un entier. √âtant donn√© que la version de bloc √©tait √† l&#8217;origine utilis√©e comme entier, versions 1 √† 4, seuls 29 bits restent disponibles pour √™tre utilis√©s comme champ de bits. Cela laisse 29 bits qui peuvent √™tre utilis√©s pour signaler ind√©pendamment et simultan√©ment la disponibilit√© sur 29 propositions diff√©rentes.</p>
</div>
<div class="paragraph data-line-1086">
<p>BIP-9 fixe √©galement un temps maximum pour la signalisation et l&#8217;activation. De cette fa√ßon, les mineurs n&#8217;ont pas besoin de signaler ind√©finiment. Si une proposition n&#8217;est pas activ√©e dans le d√©lai <code>TIMEOUT</code> (d√©fini dans la proposition), la proposition est consid√©r√©e comme rejet√©e. La proposition peut √™tre soumise √† nouveau pour signalisation avec un bit diff√©rent, renouvelant la p√©riode d&#8217;activation.</p>
</div>
<div class="paragraph data-line-1088">
<p>De plus, apr√®s que le <code>TIMEOUT</code> est pass√© et qu&#8217;une fonctionnalit√© a √©t√© activ√©e ou rejet√©e, le bit de signalisation peut √™tre r√©utilis√© pour une autre fonctionnalit√© sans confusion. Ainsi, jusqu&#8217;√† 29 changements peuvent √™tre signal√©s en parall√®le et apr√®s <code>TIMEOUT</code> les bits peuvent √™tre "recycl√©s" pour proposer de nouveaux changements.</p>
</div>
<div class="admonitionblock note data-line-1091">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-1092">
<p>Alors que les bits de signalisation peuvent √™tre r√©utilis√©s ou recycl√©s, tant que la p√©riode de vote ne se chevauche pas, les auteurs du BIP-9 recommandent que les bits ne soient r√©utilis√©s que lorsque cela est n√©cessaire¬†; un comportement inattendu peut se produire en raison de bogues dans des logiciels plus anciens. En bref, nous ne devrions pas nous attendre √† voir une r√©utilisation tant que les 29 bits n&#8217;auront pas √©t√© utilis√©s une fois.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-1095">
<p>Les modifications propos√©es sont identifi√©es par une structure de donn√©es contenant les champs suivants¬†:</p>
</div>
<div class="dlist data-line-1097">
<dl>
<dt class="hdlist1">name</dt>
<dd>
<p>Une br√®ve description utilis√©e pour distinguer les propositions. Le plus souvent, le BIP d√©crivant la proposition, comme "bipN", o√π N est le num√©ro du BIP.</p>
</dd>
<dt class="hdlist1">bit</dt>
<dd>
<p>0 √† 28, le bit dans la version de bloc que les mineurs utilisent pour signaler l&#8217;approbation de cette proposition.</p>
</dd>
<dt class="hdlist1">starttime</dt>
<dd>
<p>Le temps (bas√© sur le temps pass√© m√©dian, ou MTP) auquel la signalisation commence apr√®s lequel la valeur du bit est interpr√©t√©e comme signalant la pr√©paration de la proposition.</p>
</dd>
<dt class="hdlist1">endtime</dt>
<dd>
<p>Le temps (bas√© sur MTP) apr√®s lequel le changement est consid√©r√© comme rejet√© s&#8217;il n&#8217;a pas atteint le seuil d&#8217;activation.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-1105">
<p>Contrairement √† BIP-34, BIP-9 compte la signalisation d&#8217;activation dans des intervalles entiers en fonction de la p√©riode de reciblage de difficult√© de 2016 blocs. Pour chaque p√©riode de reciblage, si la somme des blocs signalant une proposition d√©passe 95¬†% (1¬†916 sur 2016), la proposition sera activ√©e une p√©riode de reciblage plus tard.</p>
</div>
<div class="paragraph data-line-1107">
<p>BIP-9 propose un diagramme d&#8217;√©tat de proposition pour illustrer les diff√©rentes √©tapes et transitions d&#8217;une proposition, comme indiqu√© dans <a href="#bip9states">BIP-9 diagramme de transition d&#8217;√©tat</a>.</p>
</div>
<div class="paragraph data-line-1109">
<p>Les propositions commencent dans l&#8217;√©tat <code>DEFINED</code>, une fois que leurs param√®tres sont connus (d√©finis) dans le logiciel bitcoin. Pour les blocs avec MTP apr√®s l&#8217;heure de d√©but, l&#8217;√©tat de la proposition passe √† <code>STARTED</code>. Si le seuil de vote est d√©pass√© dans une p√©riode de reciblage et que le d√©lai d&#8217;attente n&#8217;a pas √©t√© d√©pass√©, l&#8217;√©tat de la proposition passe √† <code>LOCKED_IN</code>. Une p√©riode de reciblage plus tard, la proposition devient <code>ACTIVE</code>. Les propositions restent perp√©tuellement dans l&#8217;√©tat <code>ACTIVE</code> une fois qu&#8217;elles atteignent cet √©tat. Si le d√©lai d&#8217;attente s&#8217;est √©coul√© avant que le seuil de vote n&#8217;ait √©t√© atteint, l&#8217;√©tat de la proposition passe √† <code>FAILED</code>, indiquant une proposition rejet√©e. Les propositions <code>FAILED</code> restent perp√©tuellement dans cet √©tat.</p>
</div>
<div id="bip9states" class="imageblock data-line-1113">
<div class="content">
<img src="images/mbc2_1010.png" alt="Diagramme de transition d&#8217;√©tat de la proposition BIP-9">
</div>
<div class="title">Figure 72. BIP-9 diagramme de transition d&#8217;√©tat</div>
</div>
<div class="paragraph data-line-1115">
<p>BIP-9 a d&#8217;abord √©t√© impl√©ment√© pour l&#8217;activation de <code>CHECKSEQUENCEVERIFY</code> et des BIP associ√©s (68, 112, 113). La proposition nomm√©e "csv" a √©t√© activ√©e avec succ√®s en juillet 2016.</p>
</div>
<div class="paragraph data-line-1117">
<p>La norme est d√©finie dans <a href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki">BIP-9 (Version bits with timeout and delay)</a>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-1119">
<h3 id="_d√©veloppement_de_logiciel_de_consensus">D√©veloppement de logiciel de consensus</h3>
<div class="paragraph data-line-1121">
<p>Le logiciel de consensus continue d&#8217;√©voluer et il y a beaucoup de discussions sur les divers m√©canismes pour changer le r√®gles consensuelles. De par sa nature m√™me, le bitcoin place la barre tr√®s haute en mati√®re de coordination et de consensus pour les changements. En tant que syst√®me d√©centralis√©, il n&#8217;a pas d'"autorit√©" qui puisse imposer sa volont√© aux participants du r√©seau. Le pouvoir est r√©parti entre plusieurs groupes tels que les mineurs, les d√©veloppeurs principaux, les d√©veloppeurs de portefeuilles, les √©changes, les commer√ßants et les utilisateurs finaux. Les d√©cisions ne peuvent √™tre prises unilat√©ralement par aucun de ces groupes. Par exemple, alors que les mineurs peuvent th√©oriquement changer les r√®gles √† la majorit√© simple (51%), ils sont contraints par le consentement des autres circonscriptions. S&#8217;ils agissent unilat√©ralement, le reste des participants peut simplement refuser de les suivre, gardant l&#8217;activit√© √©conomique sur une cha√Æne minoritaire. Sans activit√© √©conomique (transactions, marchands, portefeuilles, √©changes), les mineurs exploiteront une pi√®ce sans valeur avec des blocs vides. Cette diffusion du pouvoir signifie que tous les participants doivent se coordonner, sinon aucun changement ne peut √™tre apport√©. Le statu quo est l&#8217;√©tat stable de ce syst√®me avec seulement quelques changements possibles s&#8217;il y a un fort consensus √† une tr√®s large majorit√©. Le seuil de 95¬†% pour les embranchements convergents refl√®te cette r√©alit√©.</p>
</div>
<div class="paragraph data-line-1123">
<p>Il est important de reconna√Ætre qu&#8217;il n&#8217;y a pas de solution parfaite pour le d√©veloppement d&#8217;un consensus. Les embranchements divergents et les embranchements convergents impliquent des compromis. Pour certains types de changements, les embranchements convergents peuvent √™tre un meilleur choix ; pour d&#8217;autres, les embranchements divergents peuvent √™tre un meilleur choix. Il n&#8217;y a pas de choix parfait; les deux comportent des risques. La seule caract√©ristique constante du d√©veloppement de logiciels consensuels est que le changement est difficile et que le consensus oblige √† faire des compromis.</p>
</div>
<div class="paragraph data-line-27">
<p>Certains y voient une faiblesse des syst√®mes de consensus. Avec le temps, vous finirez peut-√™tre par le voir comme moi, comme la plus grande force du syst√®me.</p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="ch11">S√©curit√© de Bitcoin</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-4">
<p>S√©curiser le bitcoin est un d√©fi car le bitcoin n&#8217;est pas une r√©f√©rence abstraite √† la valeur, comme le solde d&#8217;un compte bancaire. Bitcoin ressemble beaucoup √† de l&#8217;argent num√©rique ou √† de l&#8217;or. Vous avez probablement entendu l&#8217;expression, "La possession est les neuf dixi√®mes de la loi." Eh bien, en bitcoin, la possession correspond aux dix dixi√®mes de la loi. La possession des cl√©s pour d√©verrouiller le bitcoin √©quivaut √† la possession d&#8217;esp√®ces ou d&#8217;un morceau de m√©tal pr√©cieux. Vous pouvez le perdre, l&#8217;√©garer, le faire voler ou donner accidentellement le mauvais montant √† quelqu&#8217;un. Dans chacun de ces cas, l&#8217;usager n&#8217;a aucun recours, comme s&#8217;il d√©posait de l&#8217;argent sur un trottoir public.</p>
</div>
<div class="paragraph data-line-6">
<p>Cependant, le bitcoin a des capacit√©s que l&#8217;argent, l&#8217;or et les comptes bancaires n&#8217;ont pas. Un portefeuille bitcoin, contenant vos cl√©s, peut √™tre sauvegard√© comme n&#8217;importe quel fichier. Il peut √™tre stock√© en plusieurs exemplaires, m√™me imprim√© sur papier pour une copie papier. Vous ne pouvez pas "sauvegarder" de l&#8217;argent, de l&#8217;or ou des comptes bancaires. Le bitcoin est suffisamment diff√©rent de tout ce qui a pr√©c√©d√© pour que nous devions √©galement penser √† la s√©curit√© du bitcoin d&#8217;une mani√®re nouvelle.</p>
</div>
<div class="sect2 data-line-8">
<h3 id="_principes_de_s√©curit√©">Principes de s√©curit√©</h3>
<div class="paragraph data-line-10">
<p>Le principe fondamental du bitcoin est la d√©centralisation et il a des implications importantes pour la s√©curit√©. Un mod√®le centralis√©, tel qu&#8217;une banque traditionnelle ou un r√©seau de paiement, d√©pend du contr√¥le d&#8217;acc√®s et de la v√©rification pour garder les mauvais acteurs hors du syst√®me. En comparaison, un syst√®me d√©centralis√© comme Bitcoin pousse la responsabilit√© et le contr√¥le aux utilisateurs. √âtant donn√© que la s√©curit√© du r√©seau est bas√©e sur la preuve de travail et non sur le contr√¥le d&#8217;acc√®s, le r√©seau peut √™tre ouvert et aucun cryptage n&#8217;est requis pour le trafic bitcoin.</p>
</div>
<div class="paragraph data-line-12">
<p>Sur un r√©seau de paiement traditionnel, tel qu&#8217;un syst√®me de carte de cr√©dit, le paiement est ouvert car il contient l&#8217;identifiant priv√© de l&#8217;utilisateur (le num√©ro de carte de cr√©dit). Apr√®s le d√©bit initial, toute personne ayant acc√®s √† l&#8217;identifiant peut "extraire" des fonds et facturer le propri√©taire encore et encore. Ainsi, le r√©seau de paiement doit √™tre s√©curis√© de bout en bout avec un cryptage et doit garantir qu&#8217;aucun espion ou interm√©diaire ne puisse compromettre le trafic de paiement, en transit ou lorsqu&#8217;il est stock√© (au repos). Si un acteur malveillant acc√®de au syst√®me, il peut compromettre les transactions en cours <em>et</em> les jetons de paiement qui peuvent √™tre utilis√©s pour cr√©er de nouvelles transactions. Pire encore, lorsque les donn√©es des clients sont compromises, les clients sont expos√©s au vol d&#8217;identit√© et doivent prendre des mesures pour emp√™cher l&#8217;utilisation frauduleuse des comptes compromis.</p>
</div>
<div class="paragraph data-line-14">
<p>Bitcoin est radicalement diff√©rent. Une transaction bitcoin n&#8217;autorise qu&#8217;une valeur sp√©cifique √† un destinataire sp√©cifique et ne peut √™tre falsifi√©e ou modifi√©e. Il ne r√©v√®le aucune information priv√©e, telle que l&#8217;identit√© des parties, et ne peut √™tre utilis√© pour autoriser des paiements suppl√©mentaires. Par cons√©quent, un r√©seau de paiement bitcoin n&#8217;a pas besoin d&#8217;√™tre crypt√© ou prot√©g√© contre les √©coutes clandestines. En fait, vous pouvez diffuser des transactions en bitcoins sur un canal public ouvert, tel qu&#8217;un WiFi ou un Bluetooth non s√©curis√©, sans perte de s√©curit√©.</p>
</div>
<div class="paragraph data-line-16">
<p>Le mod√®le de s√©curit√© d√©centralis√© de Bitcoin donne beaucoup de pouvoir aux utilisateurs. Ce pouvoir s&#8217;accompagne de la responsabilit√© de maintenir le secret des cl√©s. Pour la plupart des utilisateurs, ce n&#8217;est pas facile √† faire, en particulier sur les appareils informatiques √† usage g√©n√©ral tels que les smartphones ou les ordinateurs portables connect√©s √† Internet. Bien que le mod√®le d√©centralis√© de Bitcoin emp√™che le type de compromis de masse observ√© avec les cartes de cr√©dit, de nombreux utilisateurs ne sont pas en mesure de s√©curiser correctement leurs cl√©s et se font pirater, un par un.</p>
</div>
<div class="sect3 data-line-19">
<h4 id="_d√©velopper_des_syst√®mes_bitcoin_en_toute_s√©curit√©">D√©velopper des syst√®mes Bitcoin en toute s√©curit√©</h4>
<div class="paragraph data-line-21">
<p>Le principe le plus important pour les d√©veloppeurs de bitcoins est la d√©centralisation. La plupart des d√©veloppeurs connaissent les mod√®les de s√©curit√© centralis√©s et pourraient √™tre tent√©s d&#8217;appliquer ces mod√®les √† leurs applications bitcoin, avec des r√©sultats d√©sastreux.</p>
</div>
<div class="paragraph data-line-23">
<p>La s√©curit√© de Bitcoin repose sur un contr√¥le d√©centralis√© des cl√©s et sur une validation ind√©pendante des transactions par les mineurs. Si vous souhaitez tirer parti de la s√©curit√© du bitcoin, vous devez vous assurer que vous restez dans le mod√®le de s√©curit√© du bitcoin. En termes simples¬†: ne retirez pas le contr√¥le des cl√©s aux utilisateurs et ne retirez pas les transactions de la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-25">
<p>Par exemple, de nombreux premiers √©changes de bitcoins ont concentr√© tous les fonds des utilisateurs dans un seul portefeuille "chaud" avec des cl√©s stock√©es sur un seul serveur. Une telle conception supprime le contr√¥le des utilisateurs et centralise le contr√¥le des cl√©s dans un syst√®me unique. De nombreux syst√®mes de ce type ont √©t√© pirat√©s, avec des cons√©quences d√©sastreuses pour leurs clients.</p>
</div>
<div class="paragraph data-line-27">
<p>Une autre erreur courante consiste √† retirer les transactions "hors cha√Æne de blocs" dans un effort malavis√© pour r√©duire les frais de transaction ou acc√©l√©rer le traitement des transactions. Un syst√®me "hors cha√Æne de blocs" enregistrera les transactions sur un registre interne centralis√© et ne les synchronisera qu&#8217;occasionnellement avec la cha√Æne de blocs Bitcoin. Cette pratique, encore une fois, remplace la s√©curit√© du bitcoin d√©centralis√©e par une approche propri√©taire et centralis√©e. Lorsque les transactions sont hors cha√Æne de blocs, des registres centralis√©s mal s√©curis√©s peuvent √™tre falsifi√©s, d√©tournant des fonds et √©puisant les r√©serves, sans que l&#8217;on s&#8217;en aper√ßoive.</p>
</div>
<div class="paragraph data-line-29">
<p>√Ä moins que vous ne soyez pr√™t √† investir massivement dans la s√©curit√© op√©rationnelle, plusieurs couches de contr√¥le d&#8217;acc√®s et des audits (comme le font les banques traditionnelles), vous devez r√©fl√©chir tr√®s attentivement avant de retirer des fonds du contexte de s√©curit√© d√©centralis√© de Bitcoin. M√™me si vous disposez des fonds et de la discipline n√©cessaires pour mettre en ≈ìuvre un mod√®le de s√©curit√© robuste, une telle conception ne fait que reproduire le mod√®le fragile des r√©seaux financiers traditionnels, en proie au vol d&#8217;identit√©, √† la corruption et au d√©tournement de fonds. Pour tirer parti du mod√®le de s√©curit√© d√©centralis√© unique de Bitcoin, vous devez √©viter la tentation d&#8217;architectures centralis√©es qui pourraient vous sembler famili√®res mais qui finissent par renverser la s√©curit√© de Bitcoin.</p>
</div>
</div>
<div class="sect3 data-line-31">
<h4 id="_la_racine_de_la_confiance">La racine de la confiance</h4>
<div class="paragraph data-line-33">
<p>L&#8217;architecture de s√©curit√© traditionnelle est bas√©e sur un concept appel√© <em>racine de confiance</em>, qui est un noyau de confiance utilis√© comme base pour la s√©curit√© de l&#8217;ensemble du syst√®me ou de l&#8217;application. L&#8217;architecture de s√©curit√© est d√©velopp√©e autour de la racine de la confiance sous la forme d&#8217;une s√©rie de cercles concentriques, comme des couches dans un oignon, √©tendant la confiance vers l&#8217;ext√©rieur depuis le centre. Chaque couche s&#8217;appuie sur la couche interne la plus fiable √† l&#8217;aide de contr√¥les d&#8217;acc√®s, de signatures num√©riques, de cryptage et d&#8217;autres primitives de s√©curit√©. √Ä mesure que les syst√®mes logiciels deviennent plus complexes, ils sont plus susceptibles de contenir des bogues, ce qui les rend vuln√©rables aux compromis de s√©curit√©. Par cons√©quent, plus un syst√®me logiciel devient complexe, plus il est difficile √† s√©curiser. Le concept de racine de confiance garantit que la plus grande partie de la confiance est plac√©e dans la partie la moins complexe du syst√®me, et donc la moins vuln√©rable, tandis que des logiciels plus complexes sont superpos√©s autour d&#8217;elle. Cette architecture de s√©curit√© est r√©p√©t√©e √† diff√©rentes √©chelles, √©tablissant d&#8217;abord une racine de confiance dans le mat√©riel d&#8217;un syst√®me unique, puis √©tendant cette racine de confiance √† travers le syst√®me d&#8217;exploitation jusqu&#8217;aux services syst√®me de niveau sup√©rieur, et enfin sur de nombreux serveurs superpos√©s en cercles concentriques de diminution de la confiance.</p>
</div>
<div class="paragraph data-line-35">
<p>L&#8217;architecture de s√©curit√© Bitcoin est diff√©rente. En bitcoin, le syst√®me de consensus cr√©e un grand livre public de confiance qui est compl√®tement d√©centralis√©. Une cha√Æne de blocs correctement valid√©e utilise le bloc de gen&#8217;se comme racine de confiance, construisant une cha√Æne de confiance jusqu&#8217;au bloc actuel. Les syst√®mes Bitcoin peuvent et doivent utiliser la cha√Æne de blocs comme racine de confiance. Lors de la conception d&#8217;une application bitcoin complexe compos√©e de services sur de nombreux syst√®mes diff√©rents, vous devez examiner attentivement l&#8217;architecture de s√©curit√© afin de d√©terminer o√π la confiance est plac√©e. En fin de compte, la seule chose √† laquelle il faut explicitement faire confiance est une cha√Æne de blocs enti√®rement valid√©e. Si votre application accorde explicitement ou implicitement sa confiance √† autre chose qu&#8217;√† la cha√Æne de blocs, cela devrait √™tre une source de pr√©occupation car elle introduit une vuln√©rabilit√©. Une bonne m√©thode pour √©valuer l&#8217;architecture de s√©curit√© de votre application consiste √† consid√©rer chaque composant individuel et √† √©valuer un sc√©nario hypoth√©tique o√π ce composant est compl√®tement compromis et sous le contr√¥le d&#8217;un acteur malveillant. Prenez tour √† tour chaque composant de votre application et √©valuez les impacts sur la s√©curit√© globale si ce composant est compromis. Si votre application n&#8217;est plus s√©curis√©e lorsque des composants sont compromis, cela montre que vous avez mal plac√© la confiance dans ces composants. Une application bitcoin sans vuln√©rabilit√©s ne devrait √™tre vuln√©rable qu&#8217;√† une compromission du m√©canisme de consensus bitcoin, ce qui signifie que sa racine de confiance est bas√©e sur la partie la plus solide de l&#8217;architecture de s√©curit√© bitcoin.</p>
</div>
<div class="paragraph data-line-37">
<p>Les nombreux exemples d&#8217;√©changes de bitcoins pirat√©s servent √† souligner ce point, car leur architecture et leur conception de s√©curit√© √©chouent m√™me sous l&#8217;examen le plus occasionnel. Ces impl√©mentations centralis√©es avaient explicitement investi la confiance dans de nombreux composants en dehors de la cha√Æne de blocs Bitcoin, tels que les portefeuilles actifs, les bases de donn√©es de grand livre centralis√©es, les cl√©s de chiffrement vuln√©rables et les sch√©mas similaires.</p>
</div>
</div>
</div>
<div class="sect2 data-line-40">
<h3 id="_meilleures_pratiques_de_s√©curit√©_des_utilisateurs">Meilleures pratiques de s√©curit√© des utilisateurs</h3>
<div class="paragraph data-line-42">
<p>Les humains ont utilis√© des contr√¥les de s√©curit√© physique depuis des milliers d&#8217;ann√©es. En comparaison, notre exp√©rience en mati√®re de s√©curit√© num√©rique a moins de 50 ans. Les syst√®mes d&#8217;exploitation modernes √† usage g√©n√©ral ne sont pas tr√®s s√©curis√©s et ne sont pas particuli√®rement adapt√©s au stockage de l&#8217;argent num√©rique. Nos ordinateurs sont constamment expos√©s √† des menaces externes via des connexions Internet permanentes. Ils ex√©cutent des milliers de composants logiciels de centaines d&#8217;auteurs, souvent avec un acc√®s illimit√© aux fichiers de l&#8217;utilisateur. Un seul logiciel malveillant, parmi les milliers install√©s sur votre ordinateur, peut compromettre votre clavier et vos fichiers, en volant tout bitcoin stock√© dans les applications de portefeuille. Le niveau de maintenance informatique requis pour maintenir un ordinateur exempt de virus et de chevaux de Troie d√©passe le niveau de comp√©tence de tous, sauf d&#8217;une infime minorit√© d&#8217;utilisateurs d&#8217;ordinateurs.</p>
</div>
<div class="paragraph data-line-44">
<p>Malgr√© des d√©cennies de recherche et d&#8217;avanc√©es en mati√®re de s√©curit√© de l&#8217;information, les actifs num√©riques sont toujours terriblement vuln√©rables face √† un adversaire d√©termin√©. M√™me les syst√®mes les plus prot√©g√©s et les plus restreints, dans les soci√©t√©s de services financiers, les agences de renseignement et les sous-traitants de la d√©fense, sont fr√©quemment pirat√©s. Bitcoin cr√©e des actifs num√©riques qui ont une valeur intrins√®que et peuvent √™tre vol√©s et d√©tourn√©s vers de nouveaux propri√©taires instantan√©ment et irr√©vocablement. Cela cr√©e une incitation massive pour les pirates. Jusqu&#8217;√† pr√©sent, les pirates devaient convertir des informations d&#8217;identit√© ou des jetons de compte, tels que des cartes de cr√©dit et des comptes bancaires, en valeur apr√®s les avoir compromis. Malgr√© la difficult√© de cl√¥turer et de blanchir les informations financi√®res, nous avons vu des vols sans cesse croissants. Bitcoin intensifie ce probl√®me car il n&#8217;a pas besoin d&#8217;√™tre cl√¥tur√© ou blanchi; c&#8217;est la valeur intrins√®que d&#8217;un actif num√©rique.</p>
</div>
<div class="paragraph data-line-46">
<p>Heureusement, le bitcoin cr√©e √©galement les incitations √† am√©liorer la s√©curit√© informatique. Alors qu&#8217;auparavant le risque de compromission informatique √©tait vague et indirect, le bitcoin rend ces risques clairs et √©vidents. La d√©tention de bitcoins sur un ordinateur sert √† concentrer l&#8217;esprit de l&#8217;utilisateur sur la n√©cessit√© d&#8217;am√©liorer la s√©curit√© informatique. En cons√©quence directe de la prolif√©ration et de l&#8217;adoption accrue du bitcoin et d&#8217;autres monnaies num√©riques, nous avons assist√© √† une escalade des techniques de piratage et des solutions de s√©curit√©. En termes simples, les pirates ont d√©sormais une cible tr√®s juteuse et les utilisateurs ont une incitation claire √† se d√©fendre.</p>
</div>
<div class="paragraph data-line-48">
<p>Au cours des trois derni√®res ann√©es, en cons√©quence directe de l&#8217;adoption du bitcoin, nous avons assist√© √† d&#8217;√©normes innovations dans le domaine de la s√©curit√© de l&#8217;information sous la forme de cryptage mat√©riel, de stockage de cl√©s et de portefeuilles mat√©riels, de technologie multisignature et de s√©questre num√©rique. Dans les sections suivantes, nous examinerons diverses meilleures pratiques pour la s√©curit√© pratique des utilisateurs.</p>
</div>
<div class="sect3 data-line-50">
<h4 id="_stockage_physique_des_bitcoins">Stockage physique des bitcoins</h4>
<div class="paragraph data-line-52">
<p>Parce que la plupart des utilisateurs sont beaucoup plus √† l&#8217;aise avec la s√©curit√© physique qu&#8217;avec la s√©curit√© des informations, une m√©thode tr√®s efficace pour prot√©ger les bitcoins consiste √† les convertir sous forme physique. Les cl√©s Bitcoin ne sont rien de plus que de longs chiffres. Cela signifie qu&#8217;ils peuvent √™tre stock√©s sous une forme physique, telle qu&#8217;imprim√©s sur du papier ou grav√©s sur une pi√®ce de m√©tal. La s√©curisation des cl√©s devient alors aussi simple que la s√©curisation physique de la copie imprim√©e des cl√©s bitcoin. Un ensemble de cl√©s bitcoin imprim√©es sur papier s&#8217;appelle un "portefeuille papier" et de nombreux outils gratuits peuvent √™tre utilis√©s pour les cr√©er. Personnellement, je conserve la grande majorit√© de mes bitcoins (99¬†% ou plus) stock√©s sur des portefeuilles en papier, crypt√©s avec BIP-38, avec plusieurs copies enferm√©es dans des coffres-forts.  Garder le bitcoin hors ligne est appel√© <em>stockage √† froid</em> (<em>cold storage</em>) et c&#8217;est l&#8217;une des techniques de s√©curit√© les plus efficaces. Un syst√®me de stockage √† froid est un syst√®me dans lequel les cl√©s sont g√©n√©r√©es sur un syst√®me hors ligne (jamais connect√© √† Internet) et stock√©es hors ligne, soit sur papier, soit sur un support num√©rique, comme une cl√© USB.</p>
</div>
</div>
<div class="sect3 data-line-54">
<h4 id="_portefeuilles_mat√©riels">Portefeuilles mat√©riels</h4>
<div class="paragraph data-line-56">
<p>√Ä long terme, la s√©curit√© des bitcoins prendra de plus en plus la forme de portefeuilles mat√©riels inviolables. Contrairement √† un smartphone ou √† un ordinateur de bureau, un portefeuille mat√©riel bitcoin n&#8217;a qu&#8217;un seul objectif¬†: conserver les bitcoins en toute s√©curit√©. Sans logiciel √† usage g√©n√©ral √† compromettre et avec des interfaces limit√©es, les portefeuilles mat√©riels peuvent offrir un niveau de s√©curit√© presque infaillible aux utilisateurs non experts. Je m&#8217;attends √† voir les portefeuilles mat√©riels devenir la m√©thode pr√©dominante de stockage de bitcoins. Pour un exemple d&#8217;un tel portefeuille mat√©riel, voir le <a href="https://trezor.io/" data-href="https://trezor.io/">Trezor</a>.</p>
</div>
</div>
<div class="sect3 data-line-58">
<h4 id="_√©quilibrer_les_risques">√âquilibrer les risques</h4>
<div class="paragraph data-line-60">
<p>Bien que la plupart des utilisateurs soient √† juste titre pr√©occup√©s par le vol de bitcoins, le risque est encore plus grand. Les fichiers de donn√©es se perdent tout le temps. S&#8217;ils contiennent du bitcoin, la perte est beaucoup plus douloureuse. Dans le but de s√©curiser leurs portefeuilles bitcoin, les utilisateurs doivent faire tr√®s attention √† ne pas aller trop loin et finir par perdre le bitcoin. En juillet 2011, un projet bien connu de sensibilisation et d&#8217;√©ducation au bitcoin a perdu pr√®s de 7 000 bitcoins. Dans leur effort pour pr√©venir le vol, les propri√©taires avaient mis en place une s√©rie complexe de sauvegardes crypt√©es. En fin de compte, ils ont accidentellement perdu les cl√©s de cryptage, rendant les sauvegardes sans valeur et perdant une fortune. Comme cacher de l&#8217;argent en l&#8217;enterrant dans le d√©sert, si vous s√©curisez trop bien votre bitcoin, vous ne pourrez peut-√™tre plus le retrouver.</p>
</div>
</div>
<div class="sect3 data-line-62">
<h4 id="_risque_de_diversification">Risque de diversification</h4>
<div class="paragraph data-line-64">
<p>Porteriez-vous toute votre valeur nette en esp√®ces dans votre portefeuille¬†? La plupart des gens consid√©reraient cela comme imprudent, mais les utilisateurs de bitcoins conservent souvent tous leurs bitcoins dans un seul portefeuille. Au lieu de cela, les utilisateurs devraient r√©partir le risque entre plusieurs portefeuilles bitcoin diversifi√©s. Les utilisateurs prudents ne conserveront qu&#8217;une petite fraction, peut-√™tre moins de 5%, de leur bitcoin dans un portefeuille en ligne ou mobile comme "monnaie de poche". Le reste doit √™tre r√©parti entre quelques m√©canismes de stockage diff√©rents, tels qu&#8217;un portefeuille de bureau et hors ligne (stockage √† froid).</p>
</div>
</div>
<div class="sect3 data-line-66">
<h4 id="_multisig_et_gouvernance">Multisig et gouvernance</h4>
<div class="paragraph data-line-68">
<p>Chaque fois qu&#8217;une entreprise ou un particulier stocke de grandes quantit√©s de bitcoins, il doit envisager d&#8217;utiliser une adresse Bitcoin multisignature. Les adresses multisignatures s√©curisent les fonds en exigeant un nombre minimum de signatures pour effectuer un paiement. Les cl√©s de signature doivent √™tre stock√©es dans un certain nombre d&#8217;endroits diff√©rents et sous le contr√¥le de diff√©rentes personnes. Dans un environnement d&#8217;entreprise, par exemple, les cl√©s doivent √™tre g√©n√©r√©es de mani√®re ind√©pendante et d√©tenues par plusieurs dirigeants de l&#8217;entreprise, afin de garantir qu&#8217;aucune personne ne puisse compromettre les fonds. Les adresses multisignatures peuvent √©galement offrir une redondance, o√π une seule personne d√©tient plusieurs cl√©s qui sont stock√©es √† diff√©rents endroits.</p>
</div>
</div>
<div class="sect3 data-line-70">
<h4 id="_capacit√©_de_survie">Capacit√© de survie</h4>
<div class="paragraph data-line-72">
<p>Une consid√©ration de s√©curit√© importante souvent n√©glig√©e est la disponibilit√©, en particulier dans un contexte d&#8217;incapacit√© ou de d√©c√®s du d√©tenteur de la cl√©. Les utilisateurs de Bitcoin sont invit√©s √† utiliser des mots de passe complexes et √† garder leurs cl√©s s√©curis√©es et priv√©es, sans les partager avec qui que ce soit. Malheureusement, cette pratique rend presque impossible pour la famille de l&#8217;utilisateur de r√©cup√©rer des fonds si l&#8217;utilisateur n&#8217;est pas disponible pour les d√©bloquer. Dans la plupart des cas, en fait, les familles des utilisateurs de bitcoins pourraient ignorer compl√®tement l&#8217;existence des fonds en bitcoins.</p>
</div>
<div class="paragraph data-line-74">
<p>Si vous avez beaucoup de bitcoins, vous devriez envisager de partager les d√©tails d&#8217;acc√®s avec un parent ou un avocat de confiance. Un r√©gime de survie plus complexe peut √™tre mis en place avec un acc√®s multi-signatures et une planification successorale par l&#8217;interm√©diaire d&#8217;un avocat sp√©cialis√© en tant qu'"ex√©cuteur d&#8217;actifs num√©riques".</p>
</div>
</div>
</div>
<div class="sect2 data-line-76">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph data-line-29">
<p>Bitcoin est une technologie compl√®tement nouvelle, sans pr√©c√©dent et complexe. Au fil du temps, nous d√©velopperons de meilleurs outils et pratiques de s√©curit√© plus faciles √† utiliser par des non-experts. Pour l&#8217;instant, les utilisateurs de bitcoin peuvent utiliser de nombreux conseils discut√©s ici pour profiter d&#8217;une exp√©rience bitcoin s√©curis√©e et sans probl√®me.</p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-2">
<h2 id="ch12">Applications pour les cha√Ænes de blocs</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-4">
<p>Appuyons-nous maintenant sur notre compr√©hension du bitcoin en le consid√©rant comme une <em>plate-forme d&#8217;application</em>. De nos jours, de nombreuses personnes utilisent le terme "cha√Æne de blocs" ou "cha√Æne de blocs" pour d√©signer toute plate-forme d&#8217;application qui partage les principes de conception du bitcoin. Le terme est souvent mal utilis√© et appliqu√© √† de nombreuses choses qui ne fournissent pas les principales fonctionnalit√©s fournies par la cha√Æne de blocs de Bitcoin.</p>
</div>
<div class="paragraph data-line-6">
<p>Dans ce chapitre, nous examinerons les fonctionnalit√©s offertes par la cha√Æne de blocs Bitcoin, en tant que plate-forme d&#8217;application. Nous consid√©rerons les <em>primitives</em> de construction d&#8217;applications, qui forment les blocs de construction de toute application cha√Æne de blocs. Nous examinerons plusieurs applications importantes qui utilisent ces primitives, telles que les canaux de paiement (√©tat) et les canaux de paiement rout√©s (Lightning Network).</p>
</div>
<div class="sect2 data-line-8">
<h3 id="_pr√©sentation_4">Pr√©sentation</h3>
<div class="paragraph data-line-10">
<p>Le syst√®me Bitcoin a √©t√© con√ßu comme un syst√®me de monnaie et de paiement d√©centralis√©. Cependant, la plupart de ses fonctionnalit√©s sont d√©riv√©es de constructions de niveau beaucoup plus bas qui peuvent √™tre utilis√©es pour des applications beaucoup plus larges. Bitcoin n&#8217;a pas √©t√© construit avec des composants tels que des comptes, des utilisateurs, des soldes et des paiements. Au lieu de cela, il utilise un langage de script transactionnel avec des fonctions cryptographiques de bas niveau, comme nous l&#8217;avons vu dans <a href="#transactions">Op√©rations</a>. Tout comme les concepts de niveau sup√©rieur des comptes, des soldes et des paiements peuvent √™tre d√©riv√©s de ces primitives de base, il en va de m√™me pour de nombreuses autres applications complexes. Ainsi, la cha√Æne de blocs Bitcoin peut devenir une plate-forme applicative offrant des services de confiance aux applications, tels que les contrats intelligents, d√©passant de loin l&#8217;objectif initial de la monnaie num√©rique et des paiements.</p>
</div>
</div>
<div class="sect2 data-line-12">
<h3 id="_structures_de_base_les_primitives">Structures de base (les primitives)</h3>
<div class="paragraph data-line-14">
<p>Lorsqu&#8217;il fonctionne correctement et sur le long terme, le syst√®me Bitcoin offre certaines garanties, qui peuvent servir de structures de base pour cr√©er des applications. Ceux-ci inclus:</p>
</div>
<div class="dlist data-line-16">
<dl>
<dt class="hdlist1">Pas de double d√©pense</dt>
<dd>
<p>La garantie la plus fondamentale de l&#8217;algorithme de consensus d√©centralis√© de Bitcoin garantit qu&#8217;aucun UTXO ne peut √™tre d√©pens√© deux fois.</p>
</dd>
<dt class="hdlist1">Immuabilit√©</dt>
<dd>
<p>Une fois qu&#8217;une transaction est enregistr√©e dans la cha√Æne de blocs et que suffisamment de travail a √©t√© ajout√© avec les blocs suivants, les donn√©es de la transaction deviennent immuables. L&#8217;immuabilit√© est garantie par l&#8217;√©nergie, car la r√©√©criture de la cha√Æne de blocs n√©cessite une d√©pense d&#8217;√©nergie pour produire une preuve de travail. L&#8217;√©nergie requise et donc le degr√© d&#8217;immuabilit√© augmentent avec la quantit√© de travail engag√© au-dessus du bloc contenant une transaction.</p>
</dd>
<dt class="hdlist1">Neutralit√©</dt>
<dd>
<p>Le r√©seau Bitcoin d√©centralis√© propage des transactions valides quelle que soit l&#8217;origine ou le contenu de ces transactions. Cela signifie que n&#8217;importe qui peut cr√©er une transaction valide avec des frais suffisants et √™tre s√ªr qu&#8217;il sera en mesure de transmettre cette transaction et de l&#8217;inclure dans la cha√Æne de blocs √† tout moment.</p>
</dd>
<dt class="hdlist1">Horodatage s√©curis√©</dt>
<dd>
<p>Les r√®gles de consensus rejettent tout bloc dont l&#8217;horodatage est trop √©loign√© dans le pass√© ou dans le futur. Cela garantit que les horodatages sur les blocs sont fiables. L&#8217;horodatage sur un bloc implique une garantie non d√©pens√©e avant pour les entr√©es de toutes les transactions incluses.</p>
</dd>
<dt class="hdlist1">Autorisation</dt>
<dd>
<p>Les signatures num√©riques, valid√©es dans un r√©seau d√©centralis√©, offrent des garanties d&#8217;autorisation. Les scripts qui contiennent une exigence de signature num√©rique ne peuvent √™tre ex√©cut√©s sans l&#8217;autorisation du d√©tenteur de la cl√© priv√©e impliqu√©e dans le script.</p>
</dd>
<dt class="hdlist1">Auditabilit√©</dt>
<dd>
<p>Toutes les transactions sont publiques et peuvent √™tre audit√©es. Toutes les transactions et tous les blocs sont li√©s dans une cha√Æne ininterrompue jusqu&#8217;au bloc de gen√®se.</p>
</dd>
<dt class="hdlist1">Comptabilit√©</dt>
<dd>
<p>Dans toute transaction (√† l&#8217;exception de la transaction coinbase), la valeur des entr√©es est √©gale √† la valeur des sorties plus les frais. Il n&#8217;est pas possible de cr√©er ou de d√©truire de la valeur bitcoin dans une transaction. Les sorties ne peuvent pas d√©passer les entr√©es.</p>
</dd>
<dt class="hdlist1">Non-expiration</dt>
<dd>
<p>Une transaction valide n&#8217;expire pas. S&#8217;il est valable aujourd&#8217;hui, il le sera dans un avenir proche, tant que les intrants ne seront pas d√©pens√©s et que les r√®gles de consensus ne changeront pas.</p>
</dd>
<dt class="hdlist1">Int√©grit√©</dt>
<dd>
<p>Une transaction bitcoin sign√©e avec <code>SIGHASH_ALL</code> ou des parties d&#8217;une transaction sign√©e par un autre type <code>SIGHASH</code> ne peuvent pas √™tre modifi√©es sans invalider la signature, invalidant ainsi la transaction elle-m√™me.</p>
</dd>
<dt class="hdlist1">Atomicit√© des transactions</dt>
<dd>
<p>Les transactions Bitcoin sont atomiques. Ils sont valides et confirm√©s (min√©s) ou non. Les transactions partielles ne peuvent pas √™tre extraites et il n&#8217;y a pas d&#8217;√©tat interm√©diaire pour une transaction. √Ä tout moment, une transaction est min√©e ou non.</p>
</dd>
<dt class="hdlist1">Unit√©s de valeur discr√®tes (indivisibles)</dt>
<dd>
<p>Les sorties de transaction sont des unit√©s de valeur discr√®tes et indivisibles. Elles peuvent √™tre d√©pens√©s ou non d√©pens√©s, en totalit√©. Elles ne peuvent pas √™tre divis√©s ou partiellement d√©pens√©s.</p>
</dd>
<dt class="hdlist1">Quorum de contr√¥le</dt>
<dd>
<p>les contraintes de multisignature dans les scripts imposent un quorum d&#8217;autorisation, pr√©d√©fini dans le sch√©ma de multisignature. L&#8217;exigence M-de-N est appliqu√©e par les r√®gles de consensus.</p>
</dd>
<dt class="hdlist1">Verrou temporel</dt>
<dd>
<p>Toute clause de script contenant un verrou temporel relatif ou absolu ne peut √™tre ex√©cut√©e qu&#8217;apr√®s que son √¢ge d√©passe le temps sp√©cifi√©.</p>
</dd>
<dt class="hdlist1">R√©plication</dt>
<dd>
<p>Le stockage d√©centralis√© de la cha√Æne de blocs garantit que lorsqu&#8217;une transaction est extraite, apr√®s des confirmations suffisantes, elle est r√©pliqu√©e sur le r√©seau et devient durable et r√©sistante aux coupures de courant, aux pertes de donn√©es, etc.</p>
</dd>
<dt class="hdlist1">Protection contre la falsification</dt>
<dd>
<p>Une transaction ne peut d√©penser que des sorties existantes et valid√©es. Il n&#8217;est pas possible de cr√©er ou de contrefaire de la valeur.</p>
</dd>
<dt class="hdlist1">Coh√©rence</dt>
<dd>
<p>En l&#8217;absence de partitions de mineurs, les blocs enregistr√©s dans la cha√Æne de blocs sont sujets √† une r√©organisation ou √† un d√©saccord avec une probabilit√© d√©croissante de mani√®re exponentielle, en fonction de la profondeur √† laquelle ils sont enregistr√©s. Une fois profond√©ment enregistr√©s, le calcul et l&#8217;√©nergie n√©cessaires pour changer rendent le changement pratiquement irr√©alisable.</p>
</dd>
<dt class="hdlist1">Enregistrement de l&#8217;√©tat externe</dt>
<dd>
<p>Une transaction peut valider une valeur de donn√©es, via <code>OP_RETURN</code>, repr√©sentant une transition d&#8217;√©tat dans une machine √† √©tats externe.</p>
</dd>
<dt class="hdlist1">√âmission pr√©visible</dt>
<dd>
<p>Moins de 21 millions de bitcoins seront √©mis, √† un rythme pr√©visible.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-52">
<p>La liste des blocs de construction (ou structures de base) n&#8217;est pas compl√®te et d&#8217;autres sont ajout√©es √† chaque nouvelle fonctionnalit√© introduite dans le bitcoin.</p>
</div>
</div>
<div class="sect2 data-line-54">
<h3 id="_applications_√†_partir_des_structures_de_base">Applications √† partir des structures de base</h3>
<div class="paragraph data-line-56">
<p>Les structures de base propos√©s par bitcoin sont des √©l√©ments d&#8217;une plateforme de confiance qui peuvent √™tre utilis√©s pour composer des applications. Voici quelques exemples d&#8217;applications qui existent aujourd&#8217;hui et les blocs de construction qu&#8217;elles utilisent¬†:</p>
</div>
<div class="dlist data-line-58">
<dl>
<dt class="hdlist1">Preuve d&#8217;existence (notaire num√©rique)</dt>
<dd>
<p>Immuabilit√© ` Horodatage ` Durabilit√©. Une empreinte num√©rique peut √™tre valid√©e avec une transaction dans la cha√Æne de blocs, prouvant qu&#8217;un document existait (horodatage) au moment o√π il a √©t√© enregistr√©. L&#8217;empreinte digitale ne pourra pas √™tre modifi√©e ex-post-facto (Immutabilit√©) et la preuve sera conserv√©e de fa√ßon permanente (Durabilit√©).</p>
</dd>
<dt class="hdlist1">Kickstarter (Lighthouse)</dt>
<dd>
<p>Coh√©rence ` Atomicit√© ` Int√©grit√©. Si vous signez une entr√©e et la sortie (int√©grit√©) d&#8217;une transaction de collecte de fonds, d&#8217;autres peuvent contribuer √† la collecte de fonds mais elle ne peut pas √™tre d√©pens√©e (atomicit√©) tant que l&#8217;objectif (valeur de sortie) n&#8217;est pas financ√© (coh√©rence).</p>
</dd>
<dt class="hdlist1">Canaux de paiement</dt>
<dd>
<p>Quorum de contr√¥le ` Verrou temporel ` Pas de double d√©pense ` Non-expiration ` R√©sistance √† la censure + Autorisation. Un multisig 2-of-2 (Quorum) avec un verrou temporel (Verrou temporel) utilis√© comme transaction de "r√®glement" d&#8217;un canal de paiement peut √™tre d√©tenu (Non-expiration) et d√©pens√© √† tout moment (R√©sistance √† la censure) par l&#8217;une ou l&#8217;autre des parties (Autorisation). Les deux parties peuvent alors cr√©er des transactions d&#8217;engagement qui doublent (Pas de double d√©pense) le r√®glement sur un verrou temporel plus court (Verrou temporel).</p>
</dd>
</dl>
</div>
</div>
<div class="sect2 data-line-64">
<h3 id="_counterparty">Counterparty</h3>
<div class="paragraph data-line-66">
<p>Conterparty est une couche de protocole construite au-dessus de bitcoin. Le protocole Counterparty offre la possibilit√© de cr√©er et d&#8217;√©changer des actifs virtuels et des jetons. De plus, Counterparty propose un √©change d√©centralis√© d&#8217;actifs. Conterparty met √©galement en ≈ìuvre des contrats intelligents, bas√©s sur la machine virtuelle Ethereum (EVM).</p>
</div>
<div class="paragraph data-line-68">
<p>Conterparty int√®gre des m√©tadonn√©es dans les transactions bitcoin, en utilisant l&#8217;opcode <code>OP_RETURN</code> ou des adresses multisignatures 1 sur N qui encodent les m√©tadonn√©es √† la place des cl√©s publiques. En utilisant ces m√©canismes, Counterparty impl√©mente une couche de protocole encod√©e dans les transactions bitcoin. La couche de protocole suppl√©mentaire peut √™tre interpr√©t√©e par des applications compatibles avec Conterparty, telles que les portefeuilles et les explorateurs de cha√Ænes de blocs, ou toute application construite √† l&#8217;aide des biblioth√®ques de Conterparty.</p>
</div>
<div class="paragraph data-line-70">
<p>Conterparty peut √™tre utilis√©e comme plate-forme pour d&#8217;autres applications et services, √† leur tour. Par exemple, Tokenly est une plate-forme construite sur Counterparty qui permet aux cr√©ateurs de contenu, aux artistes et aux entreprises d&#8217;√©mettre des jetons qui expriment la propri√©t√© num√©rique et peuvent √™tre utilis√©s pour louer, acc√©der, √©changer ou acheter du contenu, des produits et des services. D&#8217;autres applications tirant parti de Counterparty incluent des jeux (Spells of Genesis) et des projets de grille informatique (Folding Coin).</p>
</div>
<div class="paragraph data-line-72">
<p>Plus de d√©tails sur Counterparty peuvent √™tre trouv√©s sur <a href="https://counterparty.io" class="undefined" data-href="https://counterparty.io">https://counterparty.io</a>. Le projet √† source libre est disponible sur <a href="https://github.com/CounterpartyXCP" class="undefined" data-href="https://github.com/CounterpartyXCP">https://github.com/CounterpartyXCP</a>.</p>
</div>
</div>
<div class="sect2 data-line-75">
<h3 id="state_channels">Canaux de paiement et canaux d&#8217;√©tat</h3>
<div class="paragraph data-line-77">
<p><em>Les canaux de paiement</em> sont un m√©canisme sans confiance pour √©changer des bitcoins transactions entre deux parties, en dehors de la cha√Æne de blocs Bitcoin. Ces transactions, qui seraient valides si elles √©taient r√©gl√©es sur la cha√Æne de blocs Bitcoin, sont plut√¥t d√©tenues hors cha√Æne, agissant comme des <em>billets √† ordre</em> pour un √©ventuel r√®glement par lots. √âtant donn√© que les transactions ne sont pas r√©gl√©es, elles peuvent √™tre √©chang√©es sans la latence de r√®glement habituelle, ce qui permet un d√©bit de transaction extr√™mement √©lev√©, une latence faible (inf√©rieure √† la milliseconde) et une granularit√© fine (niveau satoshi).</p>
</div>
<div class="paragraph data-line-79">
<p>En fait, le terme <em>canal</em> est une m√©taphore. Les canaux d&#8217;√©tat sont des constructions virtuelles repr√©sent√©es par l&#8217;√©change d&#8217;√©tat entre deux parties, en dehors de la cha√Æne de blocs. Il n&#8217;y a pas de "canaux" en soi et le m√©canisme de transport de donn√©es sous-jacent n&#8217;est pas le canal. Nous utilisons le terme canal pour repr√©senter la relation et l&#8217;√©tat partag√© entre deux parties, en dehors de la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-81">
<p>Pour expliquer davantage ce concept, pensez √† un flux TCP. Du point de vue des protocoles de niveau sup√©rieur, il s&#8217;agit d&#8217;une "interface de connexion" connectant deux applications sur Internet. Mais si vous regardez le trafic r√©seau, un flux TCP n&#8217;est qu&#8217;un canal virtuel sur des paquets IP. Chaque extr√©mit√© du flux TCP s√©quence et assemble les paquets IP pour cr√©er l&#8217;illusion d&#8217;un flux d&#8217;octets. En dessous, ce sont tous les paquets d√©connect√©s. De m√™me, un canal de paiement n&#8217;est qu&#8217;une s√©rie de transactions. S&#8217;ils sont correctement s√©quenc√©s et connect√©s, ils cr√©ent des obligations remboursables auxquelles vous pouvez faire confiance m√™me si vous ne faites pas confiance √† l&#8217;autre c√¥t√© du canal.</p>
</div>
<div class="paragraph data-line-83">
<p>Dans cette section, nous examinerons diff√©rentes formes de canaux de paiement. Premi√®rement, nous examinerons les m√©canismes utilis√©s pour construire un canal de paiement unidirectionnel (unidirectionnel) pour un service de micropaiement mesur√©, tel que le streaming vid√©o. Ensuite, nous d√©velopperons ce m√©canisme et introduirons des canaux de paiement bidirectionnels. Enfin, nous verrons comment des canaux bidirectionnels peuvent √™tre connect√©s de bout en bout pour former des canaux multisauts dans un r√©seau rout√©, d&#8217;abord propos√© sous le nom de <em>Lightning Network</em>.</p>
</div>
<div class="paragraph data-line-85">
<p>Les canaux de paiement font partie du concept plus large d&#8217;un <em>canal d&#8217;√©tat</em>, qui repr√©sente une alt√©ration d&#8217;√©tat hors cha√Æne, s√©curis√©e par un √©ventuel r√®glement dans une cha√Æne de blocs. Un canal de paiement est un canal d&#8217;√©tat o√π l&#8217;√©tat modifi√© est le solde d&#8217;une monnaie virtuelle.</p>
</div>
<div class="sect3 data-line-87">
<h4 id="_canaux_d√©tat_concepts_de_base_et_terminologie">Canaux d&#8217;√©tat, concepts de base et terminologie</h4>
<div class="paragraph data-line-89">
<p>Un canal d&#8217;√©tat est √©tabli entre deux parties, par le biais d&#8217;une transaction qui verrouille un √©tat partag√© sur la cha√Æne de blocs. C&#8217;est ce qu&#8217;on appelle la <em>transaction de financement</em> ou <em>transaction d&#8217;ancrage</em>. Cette transaction unique doit √™tre transmise au r√©seau et exploit√©e pour √©tablir le canal. Dans l&#8217;exemple d&#8217;un canal de paiement, l&#8217;√©tat bloqu√© est le solde initial (en devise) du canal.</p>
</div>
<div class="paragraph data-line-91">
<p>Les deux parties √©changent alors des transactions sign√©es, appel√©es <em>transactions d&#8217;engagement</em>, qui modifient l&#8217;√©tat initial. Ces transactions sont des transactions valides dans la mesure o√π elles <em>pourraient</em> √™tre soumises pour r√®glement par l&#8217;une ou l&#8217;autre des parties, mais sont plut√¥t d√©tenues hors cha√Æne par chaque partie en attendant la fermeture du canal. Les mises √† jour d&#8217;√©tat peuvent √™tre cr√©√©es aussi rapidement que chaque partie peut cr√©er, signer et transmettre une transaction √† l&#8217;autre partie. En pratique, cela signifie que des milliers de transactions par seconde peuvent √™tre √©chang√©es.</p>
</div>
<div class="paragraph data-line-93">
<p>Lors de l&#8217;√©change de transactions d&#8217;engagement, les deux parties invalident √©galement les √©tats pr√©c√©dents, de sorte que la transaction d&#8217;engagement la plus r√©cente est toujours la seule qui puisse √™tre rembours√©e. Cela emp√™che l&#8217;une ou l&#8217;autre des parties de tricher en fermant unilat√©ralement le canal avec un √©tat ant√©rieur expir√© qui lui est plus favorable que l&#8217;√©tat actuel. Nous examinerons les diff√©rents m√©canismes qui peuvent √™tre utilis√©s pour invalider l&#8217;√©tat ant√©rieur dans la suite de ce chapitre.</p>
</div>
<div class="paragraph data-line-95">
<p>Enfin, le canal peut √™tre ferm√© soit de mani√®re coop√©rative, en soumettant une <em>transaction de r√®glement</em> finale √† la cha√Æne de blocs, soit unilat√©ralement, par l&#8217;une ou l&#8217;autre des parties soumettant la derni√®re transaction d&#8217;engagement √† la cha√Æne de blocs. Une option de fermeture unilat√©rale est n√©cessaire au cas o√π l&#8217;une des parties se d√©connecte de mani√®re inattendue. La transaction de r√®glement repr√©sente l&#8217;√©tat final du canal et est r√©gl√©e sur la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-97">
<p>Pendant toute la dur√©e de vie de la cha√Æne, seules deux transactions doivent √™tre soumises pour minage sur la cha√Æne de blocs¬†: les transactions de financement et de r√®glement. Entre ces deux √©tats, les deux parties peuvent √©changer un nombre illimit√© de transactions d&#8217;engagement qui ne sont jamais vues par personne d&#8217;autre, ni soumises √† la cha√Æne de blocs.</p>
</div>
<div class="paragraph data-line-99">
<p><a href="#payment_channel">Un canal de paiement entre Bob et Alice, montrant les transactions de financement, d&#8217;engagement et de r√®glement</a> illustre un canal de paiement entre Bob et Alice, montrant les transactions de financement, d&#8217;engagement et de r√®glement.</p>
</div>
<div id="payment_channel" class="imageblock data-line-103">
<div class="content">
<img src="images/mbc2_1201.png" alt="Un canal de paiement entre Bob et Alice, montrant les transactions de financement, d&#8217;engagement et de r√®glement">
</div>
<div class="title">Figure 73. Un canal de paiement entre Bob et Alice, montrant les transactions de financement, d&#8217;engagement et de r√®glement</div>
</div>
</div>
<div class="sect3 data-line-105">
<h4 id="_exemple_de_canal_de_paiement_simple">Exemple de canal de paiement simple</h4>
<div class="paragraph data-line-107">
<p>Pour expliquer les canaux d&#8217;√©tat, nous commen√ßons par un exemple tr√®s simple. Nous d√©montrons un canal √† sens unique, ce qui signifie que la valeur ne circule que dans une seule direction. Nous partirons √©galement de l&#8217;hypoth√®se na√Øve que personne n&#8217;essaie de tricher, pour garder les choses simples. Une fois que nous aurons expliqu√© l&#8217;id√©e de base du canal, nous examinerons ce qu&#8217;il faut pour le rendre sans confiance afin qu&#8217;aucune des parties ne puisse tricher, m√™me si elle essaie de le faire.</p>
</div>
<div class="paragraph data-line-109">
<p>Pour cet exemple, nous supposerons deux participants¬†: Emma et Fabian. Fabian propose un service de diffusion vid√©o en continu factur√© √† la seconde via un canal de micropaiement. Fabian facture 0,01 millibit (0,00001 BTC) par seconde de vid√©o, ce qui √©quivaut √† 36 millibits (0,036 BTC) par heure de vid√©o. Emma est une utilisatrice qui ach√®te ce service de diffusion vid√©o en continu aupr√®s de Fabian. <a href="#emma_fabian_streaming_video">Emma ach√®te la vid√©o en continu de Fabian avec un canal de paiement, payant pour chaque seconde de vid√©o</a> montre Emma achetant le service de diffusion vid√©o en continu de Fabian en utilisant un canal de paiement.</p>
</div>
<div id="emma_fabian_streaming_video" class="imageblock data-line-113">
<div class="content">
<img src="images/mbc2_1202.png" alt="Emma ach√®te la diffusion vid√©o en continu de Fabian avec un canal de paiement, payant pour chaque seconde de vid√©o">
</div>
<div class="title">Figure 74. Emma ach√®te la vid√©o en continu de Fabian avec un canal de paiement, payant pour chaque seconde de vid√©o</div>
</div>
<div class="paragraph data-line-115">
<p>Dans cet exemple, Fabian et Emma utilisent un logiciel sp√©cial qui g√®re √† la fois le canal de paiement et la diffusion vid√©o en continu. Emma ex√©cute le logiciel dans son navigateur, Fabian l&#8217;ex√©cute sur un serveur. Le logiciel inclut les fonctionnalit√©s de base du portefeuille bitcoin et peut cr√©er et signer des transactions bitcoin. Le concept et le terme "canal de paiement" sont compl√®tement cach√©s aux utilisateurs. Ce qu&#8217;ils voient, c&#8217;est une vid√©o pay√©e √† la seconde.</p>
</div>
<div class="paragraph data-line-117">
<p>Pour mettre en place le canal de paiement, Emma et Fabian √©tablissent une adresse multisignature 2 sur 2, chacun d&#8217;eux d√©tenant l&#8217;une des cl√©s. Du point de vue d&#8217;Emma, le logiciel de son navigateur pr√©sente un code QR avec une adresse P2SH (commen√ßant par "3") et lui demande de soumettre un "d√©p√¥t" pour jusqu&#8217;√† 1 heure de vid√©o. L&#8217;adresse est alors financ√©e par Emma. La transaction d&#8217;Emma, payant √† l&#8217;adresse multisignature, est la transaction de financement ou d&#8217;ancrage pour le canal de paiement.</p>
</div>
<div class="paragraph data-line-119">
<p>Pour cet exemple, disons qu&#8217;Emma finance la cha√Æne avec 36 millibits (0,036 BTC). Cela permettra √† Emma de consommer <em>jusqu&#8217;√†</em> 1 heure de diffusion vid√©o en continu. La transaction de financement dans ce cas fixe le montant maximum qui peut √™tre transmis dans ce canal, en d√©finissant la <em>capacit√© du canal</em>.</p>
</div>
<div class="paragraph data-line-121">
<p>La transaction de financement consomme une ou plusieurs entr√©es du portefeuille d&#8217;Emma, approvisionnant les fonds. Il cr√©e une sortie d&#8217;une valeur de 36 millibits pay√©e √† l&#8217;adresse multisignature 2 sur 2 contr√¥l√©e conjointement entre Emma et Fabian. Il peut avoir des sorties suppl√©mentaires pour revenir au portefeuille d&#8217;Emma.</p>
</div>
<div class="paragraph data-line-123">
<p>Une fois la transaction de financement confirm√©e, Emma peut commencer √† diffuser la vid√©o. Le logiciel d&#8217;Emma cr√©e et signe une transaction d&#8217;engagement qui modifie le solde du canal pour cr√©diter 0,01 millibit √† l&#8217;adresse de Fabian et rembourser 35,99 millibits √† Emma. La transaction sign√©e par Emma consomme la sortie de 36 millibits cr√©√©e par la transaction de financement et cr√©e deux sorties¬†: une pour son remboursement, l&#8217;autre pour le paiement de Fabian. La transaction n&#8217;est que partiellement sign√©e - elle n√©cessite deux signatures (2 sur 2), mais n&#8217;a que la signature d&#8217;Emma. Lorsque le serveur de Fabian re√ßoit cette transaction, il ajoute la deuxi√®me signature (pour l&#8217;entr√©e 2 sur 2) et la renvoie √† Emma avec 1 seconde de vid√©o. D√©sormais, les deux parties ont une transaction d&#8217;engagement enti√®rement sign√©e que l&#8217;une ou l&#8217;autre peut racheter, repr√©sentant le solde √† jour correct du canal. Aucune des parties ne diffuse cette transaction sur le r√©seau.</p>
</div>
<div class="paragraph data-line-125">
<p>Au tour suivant, le logiciel d&#8217;Emma cr√©e et signe une autre transaction d&#8217;engagement (engagement #2) qui consomme la <em>m√™me</em> sortie 2 sur 2 de la transaction de financement. La seconde transaction d&#8217;engagement alloue une sortie de 0,02 millibits √† l&#8217;adresse de Fabian et une sortie de 35,98 millibits √† l&#8217;adresse d&#8217;Emma. Cette nouvelle transaction est le paiement de deux secondes cumul√©es de vid√©o. Le logiciel de Fabian signe et renvoie la deuxi√®me transaction d&#8217;engagement, ainsi qu&#8217;une autre seconde de vid√©o.</p>
</div>
<div class="paragraph data-line-127">
<p>De cette mani√®re, le logiciel d&#8217;Emma continue d&#8217;envoyer des transactions d&#8217;engagement au serveur de Fabian en √©change de diffusion vid√©o en continu. Le solde de la cha√Æne s&#8217;accumule progressivement en faveur de Fabian, car Emma consomme plus de secondes de vid√©o. Disons qu&#8217;Emma regarde 600 secondes (10 minutes) de vid√©o, cr√©ant et signant 600 transactions d&#8217;engagement. La derni√®re transaction d&#8217;engagement (#600) aura deux sorties, divisant le solde de la cha√Æne, 6 millibits pour Fabian et 30 millibits pour Emma.</p>
</div>
<div class="paragraph data-line-129">
<p>Enfin, Emma s√©lectionne "Stop" pour arr√™ter le streaming vid√©o. Fabian ou Emma peuvent maintenant transmettre la transaction d&#8217;√©tat finale pour r√®glement. Cette derni√®re transaction est la <em>transaction de r√®glement</em> et paie Fabian pour toute la vid√©o consomm√©e par Emma, remboursant le reste de la transaction de financement √† Emma.</p>
</div>
<div class="paragraph data-line-131">
<p><a href="#video_payment_channel">Le canal de paiement d&#8217;Emma avec Fabian, montrant les transactions d&#8217;engagement qui mettent √† jour le solde du canal</a> montre le canal entre Emma et Fabian et les transactions d&#8217;engagement qui mettent √† jour le solde du canal.</p>
</div>
<div class="paragraph data-line-133">
<p>Au final, seules deux transactions sont enregistr√©es sur la cha√Æne de bocs¬†: la transaction de financement qui √©tablit le canal et une transaction de r√®glement qui r√©partit correctement le solde final entre les deux participants.</p>
</div>
<div id="video_payment_channel" class="imageblock data-line-137">
<div class="content">
<img src="images/mbc2_1203.png" alt="Le canal de paiement d&#8217;Emma avec Fabian, montrant les transactions d&#8217;engagement qui mettent √† jour le solde du canal">
</div>
<div class="title">Figure 75. Le canal de paiement d&#8217;Emma avec Fabian, montrant les transactions d&#8217;engagement qui mettent √† jour le solde du canal</div>
</div>
</div>
<div class="sect3 data-line-139">
<h4 id="_cr√©er_des_canaux_sans_confiance">Cr√©er des canaux sans confiance</h4>
<div class="paragraph data-line-141">
<p>Le canal que nous venons de d√©crire fonctionne, mais seulement si les deux parties coop√®rent, sans √©chec ni tentative de tricherie. Examinons certains des sc√©narios qui cassent ce canal et voyons ce qui est n√©cessaire pour les r√©parer¬†:</p>
</div>
<div class="ulist data-line-143">
<ul>
<li class="data-line-143">
<p>Une fois la transaction de financement effectu√©e, Emma a besoin de la signature de Fabian pour r√©cup√©rer l&#8217;argent. Si Fabian dispara√Æt, les fonds d&#8217;Emma sont enferm√©s dans un 2 sur 2 et effectivement perdus. Ce canal, tel que construit, entra√Æne une perte de fonds si l&#8217;une des parties se d√©connecte avant qu&#8217;il y ait au moins une transaction d&#8217;engagement sign√©e par les deux parties.</p>
</li>
<li class="data-line-145">
<p>Pendant que le canal est en cours d&#8217;ex√©cution, Emma peut prendre n&#8217;importe laquelle des transactions d&#8217;engagement que Fabian a contresign√©es et en transmettre une √† la cha√Æne de blocs. Pourquoi payer 600 secondes de vid√©o, si elle peut transmettre la transaction d&#8217;engagement #1 et ne payer que 1 seconde de vid√©o¬†? La cha√Æne √©choue car Emma peut tricher en diffusant un engagement pr√©alable qui est en sa faveur.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-147">
<p>Ces deux probl√®mes peuvent √™tre r√©solus avec des verrous temporels. Voyons comment nous pourrions utiliser des verrous temporels au niveau des transactions (<code>nLocktime</code>).</p>
</div>
<div class="paragraph data-line-149">
<p>Emma ne peut pas risquer de financer un multisig 2 sur 2 √† moins qu&#8217;elle n&#8217;ait un remboursement garanti. Pour r√©soudre ce probl√®me, Emma construit les transactions de financement et de remboursement en m√™me temps. Elle signe la transaction de financement mais ne la transmet √† personne. Emma transmet uniquement la transaction de remboursement √† Fabian et obtient sa signature.</p>
</div>
<div class="paragraph data-line-151">
<p>La transaction de remboursement agit comme la premi√®re transaction d&#8217;engagement et son verrou temporel √©tablit la limite sup√©rieure pour la dur√©e de vie du canal. Dans ce cas, Emma pourrait d√©finir le <code>nLocktime</code> sur 30 jours ou 4320 blocs dans le futur. Toutes les transactions d&#8217;engagement ult√©rieures doivent avoir un verrou temporel plus court, afin qu&#8217;elles puissent √™tre rembours√©es avant la transaction de remboursement.</p>
</div>
<div class="paragraph data-line-153">
<p>Maintenant qu&#8217;Emma a une transaction de remboursement enti√®rement sign√©e, elle peut transmettre en toute confiance la transaction de financement sign√©e en sachant qu&#8217;elle pourra √©ventuellement, apr√®s l&#8217;expiration du d√©lai, racheter la transaction de remboursement m√™me si Fabian dispara√Æt.</p>
</div>
<div class="paragraph data-line-155">
<p>Chaque transaction d&#8217;engagement que les parties √©changent pendant la dur√©e de vie du canal sera verrouill√©e dans le futur. Mais le d√©lai sera l√©g√®rement plus court pour chaque engagement afin que l&#8217;engagement le plus r√©cent puisse √™tre rembours√© avant l&#8217;engagement pr√©c√©dent qu&#8217;il invalide. En raison de nLockTime, aucune des parties ne peut propager avec succ√®s l&#8217;une des transactions d&#8217;engagement jusqu&#8217;√† l&#8217;expiration de leur verrouillage temporel. Si tout va bien, ils coop√©reront et fermeront le canal gracieusement avec une transaction de r√®glement, rendant inutile la transmission d&#8217;une transaction d&#8217;engagement interm√©diaire. Sinon, la transaction d&#8217;engagement la plus r√©cente peut √™tre propag√©e pour r√©gler le compte et invalider toutes les transactions d&#8217;engagement pr√©c√©dentes.</p>
</div>
<div class="paragraph data-line-157">
<p>Par exemple, si la transaction d&#8217;engagement #1 est verrouill√©e dans le temps sur 4320 blocs √† l&#8217;avenir, alors la transaction d&#8217;engagement #2 est verrouill√©e dans le temps sur 4319 blocs dans le futur. La transaction d&#8217;engagement #600 peut √™tre d√©pens√©e 600 blocs avant que la transaction d&#8217;engagement #1 ne devienne valide.</p>
</div>
<div class="paragraph data-line-159">
<p><a href="#timelocked_commitments">Chaque engagement fixe un d√©lai plus court, ce qui lui permet d&#8217;√™tre d√©pens√© avant que les engagements pr√©c√©dents ne deviennent valides</a> montre chaque transaction d&#8217;engagement d√©finissant un verrou temporel plus court, lui permettant d&#8217;√™tre d√©pens√© avant que les engagements pr√©c√©dents ne deviennent valides.</p>
</div>
<div id="timelocked_commitments" class="imageblock data-line-163">
<div class="content">
<img src="images/mbc2_1204.png" alt="Chaque engagement fixe un d√©lai plus court, ce qui lui permet d&#8217;√™tre d√©pens√© avant que les engagements pr√©c√©dents ne deviennent valides">
</div>
<div class="title">Figure 76. Chaque engagement fixe un d√©lai plus court, ce qui lui permet d&#8217;√™tre d√©pens√© avant que les engagements pr√©c√©dents ne deviennent valides</div>
</div>
<div class="paragraph data-line-165">
<p>Chaque transaction d&#8217;engagement ult√©rieure doit avoir un verrou temporel plus court afin qu&#8217;elle puisse √™tre diffus√©e avant ses pr√©d√©cesseurs et avant la transaction de remboursement. La possibilit√© de diffuser un engagement plus t√¥t garantit qu&#8217;il sera en mesure de d√©penser la sortie de financement et d&#8217;emp√™cher toute autre transaction d&#8217;engagement d&#8217;√™tre rembours√©e en d√©pensant la sortie. Les garanties offertes par la cha√Æne de blocs Bitcoin, emp√™chant les doubles d√©penses et appliquant des verrous temporels, permettent effectivement √† chaque transaction d&#8217;engagement d&#8217;invalider ses pr√©d√©cesseurs.</p>
</div>
<div class="paragraph data-line-167">
<p>Les canaux d&#8217;√©tat utilisent des verrous temporels pour appliquer des contrats intelligents dans une dimension temporelle. Dans cet exemple, nous avons vu comment la dimension temporelle garantit que la transaction d&#8217;engagement la plus r√©cente devient valide avant tout engagement ant√©rieur. Ainsi, la transaction d&#8217;engagement la plus r√©cente peut √™tre transmise, d√©pensant les entr√©es et invalidant les transactions d&#8217;engagement pr√©c√©dentes. L&#8217;application de contrats intelligents avec des d√©lais absolus prot√®ge contre la tricherie par l&#8217;une des parties. Cette impl√©mentation n&#8217;a besoin de rien de plus que des verrous temporels absolus au niveau de la transaction (<code>nLocktime</code>). Ensuite, nous verrons comment les verrous temporels au niveau du script, <code>CHECKLOCKTIMEVERIFY</code> et <code>CHECKSEQUENCEVERIFY</code>, peuvent √™tre utilis√©s pour construire des canaux d&#8217;√©tat plus flexibles, utiles et sophistiqu√©s.</p>
</div>
<div class="paragraph data-line-169">
<p>La premi√®re forme de canal de paiement unidirectionnel a √©t√© pr√©sent√©e sous la forme d&#8217;un prototype d&#8217;application de streaming vid√©o en 2015 par une √©quipe de d√©veloppeurs argentins.</p>
</div>
<div class="paragraph data-line-171">
<p>Les verrous temporels ne sont pas le seul moyen d&#8217;invalider les transactions d&#8217;engagement ant√©rieures. Dans les sections suivantes, nous verrons comment une cl√© de r√©vocation peut √™tre utilis√©e pour obtenir le m√™me r√©sultat. Les verrous temporels sont efficaces mais ils ont deux inconv√©nients distincts. En √©tablissant un verrou temporel maximal lors de la premi√®re ouverture du canal, ils limitent la dur√©e de vie du canal. Pire, ils obligent les impl√©mentations de canaux √† trouver un √©quilibre entre autoriser des canaux √† longue dur√©e de vie et obliger l&#8217;un des participants √† attendre tr√®s longtemps un remboursement en cas de fermeture pr√©matur√©e. Par exemple, si vous autorisez le canal √† rester ouvert pendant 30 jours, en r√©glant le d√©lai de remboursement sur 30 jours, si l&#8217;une des parties dispara√Æt imm√©diatement, l&#8217;autre partie doit attendre 30 jours pour un remboursement. Plus le point final est √©loign√©, plus le remboursement est √©loign√©.</p>
</div>
<div class="paragraph data-line-173">
<p>Le deuxi√®me probl√®me est que puisque chaque transaction d&#8217;engagement ult√©rieure doit d√©cr√©menter le verrouillage temporel, il existe une limite explicite sur le nombre de transactions d&#8217;engagement qui peuvent √™tre √©chang√©es entre les parties. Par exemple, un canal de 30¬†jours, d√©finissant un verrouillage temporel de 4320 blocs dans le futur, ne peut accepter que 4320 transactions d&#8217;engagement interm√©diaires avant de devoir √™tre cl√¥tur√©. Il y a un danger √† d√©finir l&#8217;intervalle de transaction d&#8217;engagement de verrouillage de temps √† 1 bloc. En d√©finissant l&#8217;intervalle de verrouillage entre les transactions d&#8217;engagement sur 1 bloc, un d√©veloppeur cr√©e une charge tr√®s lourde pour les participants au canal qui doivent √™tre vigilants, rester en ligne et regarder, et √™tre pr√™ts √† transmettre la bonne transaction d&#8217;engagement √† tout moment.</p>
</div>
<div class="paragraph data-line-175">
<p>Maintenant que nous comprenons comment les verrous temporels peuvent √™tre utilis√©s pour invalider des engagements ant√©rieurs, nous pouvons voir la diff√©rence entre fermer le canal de mani√®re coop√©rative et le fermer unilat√©ralement en diffusant une transaction d&#8217;engagement. Toutes les transactions d&#8217;engagement sont verrouill√©es dans le temps, par cons√©quent, la diffusion d&#8217;une transaction d&#8217;engagement impliquera toujours d&#8217;attendre jusqu&#8217;√† ce que le verrouillage ait expir√©. Mais si les deux parties s&#8217;entendent sur le solde final et savent qu&#8217;elles d√©tiennent toutes les deux des transactions d&#8217;engagement qui feront √©ventuellement de ce solde une r√©alit√©, elles peuvent construire une transaction de r√®glement sans verrou temporel repr√©sentant ce m√™me solde. Dans une cl√¥ture coop√©rative, l&#8217;une ou l&#8217;autre des parties prend la transaction d&#8217;engagement la plus r√©cente et construit une transaction de r√®glement qui est identique √† tous points de vue, sauf qu&#8217;elle omet le verrou temporel. Les deux parties peuvent signer cette transaction de r√®glement en sachant qu&#8217;il n&#8217;y a aucun moyen de tricher et d&#8217;obtenir un solde plus favorable. En signant et en transmettant de mani√®re coop√©rative la transaction de r√®glement, ils peuvent fermer le canal et racheter leur solde imm√©diatement. Dans le pire des cas, l&#8217;une des parties peut √™tre mesquine, refuser de coop√©rer et forcer l&#8217;autre partie √† conclure unilat√©ralement la transaction d&#8217;engagement la plus r√©cente. Mais s&#8217;ils le font, ils doivent aussi attendre leurs fonds.</p>
</div>
</div>
<div class="sect3 data-line-177">
<h4 id="_engagements_r√©vocables_asym√©triques">Engagements r√©vocables asym√©triques</h4>
<div class="paragraph data-line-179">
<p>Une meilleure fa√ßon de g√©rer les √©tats d&#8217;engagement ant√©rieurs est de les r√©voquer explicitement. Cependant, ce n&#8217;est pas facile √† r√©aliser. Une caract√©ristique cl√© du bitcoin est qu&#8217;une fois qu&#8217;une transaction est valide, elle reste valide et n&#8217;expire pas. La seule fa√ßon d&#8217;annuler une transaction est de doubler ses entr√©es avec une autre transaction avant qu&#8217;elle ne soit min√©e. C&#8217;est pourquoi nous avons utilis√© des verrous temporels dans l&#8217;exemple de canal de paiement simple ci-dessus pour nous assurer que les engagements les plus r√©cents pourraient √™tre d√©pens√©s avant que les engagements plus anciens ne soient valides. Cependant, l&#8217;encha√Ænement des engagements dans le temps cr√©e un certain nombre de contraintes qui rendent les canaux de paiement difficiles √† utiliser.</p>
</div>
<div class="paragraph data-line-181">
<p>M√™me si une transaction ne peut pas √™tre annul√©e, elle peut √™tre construite de mani√®re √† rendre son utilisation ind√©sirable. Pour ce faire, nous donnons √† chaque partie une <em>cl√© de r√©vocation</em> qui peut √™tre utilis√©e pour punir l&#8217;autre partie si elle essaie de tricher. Ce m√©canisme de r√©vocation des op√©rations d&#8217;engagement pr√©alable a √©t√© initialement propos√© dans le cadre du Lightning Network.</p>
</div>
<div class="paragraph data-line-183">
<p>Pour expliquer les cl√©s de r√©vocation, nous allons construire un canal de paiement plus complexe entre deux √©changes g√©r√©s par Hitesh et Irene. Hitesh et Irene g√®rent respectivement des √©changes de bitcoins en Inde et aux √âtats-Unis. Les clients de l&#8217;√©change indien d&#8217;Hitesh envoient souvent des paiements aux clients de l&#8217;√©change am√©ricain d&#8217;Irene et vice versa. Actuellement, ces transactions se produisent sur la cha√Æne de blocs Bitcoin, mais cela signifie payer des frais et attendre plusieurs blocs pour les confirmations. La mise en place d&#8217;un canal de paiement entre les bourses r√©duira consid√©rablement les co√ªts et acc√©l√©rera le flux des transactions.</p>
</div>
<div class="paragraph data-line-185">
<p>Hitesh et Irene d√©marrent le canal en construisant en collaboration une transaction de financement, chacun finan√ßant la cha√Æne avec 5 bitcoins.
Le solde initial est de 5 bitcoins pour Hitesh et de 5 bitcoins pour Irene. La transaction de financement verrouille l&#8217;√©tat du canal dans un multisig 2 sur 2, comme dans l&#8217;exemple d&#8217;un canal simple.</p>
</div>
<div class="paragraph data-line-188">
<p>La transaction de financement peut avoir une ou plusieurs entr√©es de Hitesh (ajoutant jusqu&#8217;√† 5 bitcoins ou plus) et une ou plusieurs entr√©es d&#8217;Irene (ajoutant jusqu&#8217;√† 5 bitcoins ou plus). Les entr√©es doivent l√©g√®rement d√©passer la capacit√© du canal afin de couvrir les frais de transaction. La transaction a une sortie qui verrouille les 10 bitcoins au total sur une adresse multisig 2 sur 2 contr√¥l√©e √† la fois par Hitesh et Irene. La transaction de financement peut √©galement avoir une ou plusieurs sorties rendant la monnaie √† Hitesh et Irene si leurs entr√©es ont d√©pass√© leur contribution de canal pr√©vue. Il s&#8217;agit d&#8217;une transaction unique avec des entr√©es offertes et sign√©es par deux parties. Il doit √™tre construit en collaboration et sign√© par chaque partie avant d&#8217;√™tre transmis.</p>
</div>
<div class="paragraph data-line-190">
<p>Maintenant, au lieu de cr√©er une transaction d&#8217;engagement unique que les deux parties signent, Hitesh et Irene cr√©ent deux transactions d&#8217;engagement diff√©rentes qui sont <em>asym√©triques</em>.</p>
</div>
<div class="paragraph data-line-192">
<p>Hitesh a une transaction d&#8217;engagement avec deux sorties. La premi√®re sortie paie √† Irene les 5 bitcoins qui lui sont dus <em>imm√©diatement</em>. La deuxi√®me sortie paie √† Hitesh les 5 bitcoins qui lui sont dus, mais seulement apr√®s un verrou temporel de 1000 blocs. Les sorties de transaction ressemblent √† ceci¬†:</p>
</div>
<div class="listingblock data-line-194">
<div class="content">
<pre>Input: 2-of-2 funding output, signed by Irene

Output 0 &lt;5 bitcoin&gt;:
    &lt;Irene's Public Key&gt; CHECKSIG

Output 1 &lt;5 bitcoin&gt;:
    &lt;1000 blocks&gt;
    CHECKSEQUENCEVERIFY
    DROP
    &lt;Hitesh's Public Key&gt; CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-207">
<p>Ir√®ne a une transaction d&#8217;engagement diff√©rente avec deux sorties. La premi√®re sortie paie √† Hitesh les 5 bitcoins qui lui sont dus imm√©diatement. La deuxi√®me sortie paie √† Irene les 5 bitcoins qui lui sont dus mais seulement apr√®s un verrou temporel de 1000 blocs. La transaction d&#8217;engagement qu&#8217;Irene d√©tient (sign√©e par Hitesh) ressemble √† ceci¬†:</p>
</div>
<div class="listingblock data-line-209">
<div class="content">
<pre>Input: 2-of-2 funding output, signed by Hitesh

Output 0 &lt;5 bitcoin&gt;:
    &lt;Hitesh's Public Key&gt; CHECKSIG

Output 1 &lt;5 bitcoin&gt;:
    &lt;1000 blocks&gt;
    CHECKSEQUENCEVERIFY
    DROP
    &lt;Irene's Public Key&gt; CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-222">
<p>De cette fa√ßon, chaque partie a une transaction d&#8217;engagement, d√©pensant la sortie de financement 2 sur 2. Cette entr√©e est sign√©e par l'<em>autre</em> partie. √Ä tout moment, la partie d√©tenant la transaction peut √©galement signer (remplir le 2 sur 2) et diffuser. Cependant, s&#8217;ils diffusent la transaction d&#8217;engagement, il paie imm√©diatement l&#8217;autre partie alors qu&#8217;elle doit attendre l&#8217;expiration d&#8217;un verrou temporel. En imposant un d√©lai au remboursement de l&#8217;une des sorties, nous d√©savantageons l√©g√®rement chaque partie lorsqu&#8217;elle choisit de diffuser unilat√©ralement une op√©ration d&#8217;engagement. Mais un d√©lai ne suffit pas √† lui seul √† encourager une conduite √©quitable.</p>
</div>
<div class="paragraph data-line-224">
<p><a href="#asymmetric_commitments">Deux op√©rations d&#8217;engagement asym√©triques avec paiement diff√©r√© pour le titulaire de l&#8217;op√©ration</a> montre deux op√©rations d&#8217;engagement asym√©triques, o√π la sortie payant le titulaire de l&#8217;engagement est retard√©e.</p>
</div>
<div id="asymmetric_commitments" class="imageblock data-line-228">
<div class="content">
<img src="images/mbc2_1205.png" alt="Deux op√©rations d&#8217;engagement asym√©triques avec retard de paiement pour le porteur de l&#8217;op√©ration">
</div>
<div class="title">Figure 77. Deux op√©rations d&#8217;engagement asym√©triques avec paiement diff√©r√© pour le titulaire de l&#8217;op√©ration</div>
</div>
<div class="paragraph data-line-230">
<p>Nous introduisons maintenant le dernier √©l√©ment de ce sch√©ma¬†: une cl√© de r√©vocation qui emp√™che un tricheur de diffuser un engagement expir√©. La cl√© de r√©vocation permet √† la partie l√©s√©e de sanctionner le tricheur en pr√©levant tout le solde de la cha√Æne.</p>
</div>
<div class="paragraph data-line-232">
<p>La cl√© de r√©vocation est compos√©e de deux secrets, chacun g√©n√©r√© ind√©pendamment par chaque participant du canal. Il est similaire √† un multisig 2 sur 2, mais construit √† l&#8217;aide de l&#8217;arithm√©tique de la courbe elliptique, de sorte que les deux parties connaissent la cl√© publique de r√©vocation mais que chaque partie ne conna√Æt que la moiti√© de la cl√© secr√®te de r√©vocation.</p>
</div>
<div class="paragraph data-line-234">
<p>√Ä chaque tour, les deux parties r√©v√®lent leur moiti√© du secret de r√©vocation √† l&#8217;autre partie, donnant ainsi √† l&#8217;autre partie (qui a maintenant les deux moiti√©s) les moyens de r√©clamer la sortie de p√©nalit√© si cette transaction r√©voqu√©e est jamais diffus√©e.</p>
</div>
<div class="paragraph data-line-236">
<p>Chacune des transactions d&#8217;engagement a une sortie "retard√©e". Le script de rachat pour cette sortie permet √† une partie de la racheter apr√®s 1000 blocs, <em>ou</em> √† l&#8217;autre partie de la racheter si elle a une cl√© de r√©vocation, p√©nalisant la transmission d&#8217;un engagement r√©voqu√©.</p>
</div>
<div class="paragraph data-line-238">
<p>Ainsi, lorsque Hitesh cr√©e une transaction d&#8217;engagement pour Irene √† signer, il rend la deuxi√®me sortie payable √† lui-m√™me apr√®s 1000 blocs, ou √† la cl√© publique de r√©vocation (dont il ne conna√Æt que la moiti√© du secret). Hitesh construit cette transaction. Il ne r√©v√©lera sa moiti√© du secret de r√©vocation √† Ir√®ne que lorsqu&#8217;il sera pr√™t √† passer √† un nouvel √©tat de canal et qu&#8217;il voudra r√©voquer cet engagement.</p>
</div>
<div class="paragraph data-line-240">
<p>Le script de la deuxi√®me sortie ressemble √† ceci¬†:</p>
</div>
<div class="listingblock data-line-242">
<div class="content">
<pre>Output 0 &lt;5 bitcoin&gt;:
    &lt;Irene's Public Key&gt; CHECKSIG

Output 1 &lt;5 bitcoin&gt;:
IF
# Sortie de p√©nalit√© de r√©vocation
    &lt;Revocation Public Key&gt;
ELSE
    &lt;1000 blocks&gt;
    CHECKSEQUENCEVERIFY
    DROP
    &lt;Hitesh's Public Key&gt;
ENDIF
CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-259">
<p>Ir√®ne peut signer cette transaction en toute confiance, car si elle est transmise, elle lui paiera imm√©diatement ce qui lui est d√ª. Hitesh d√©tient la transaction, mais sait que s&#8217;il la transmet dans une fermeture de canal unilat√©rale, il devra attendre 1000 blocs pour √™tre pay√©.</p>
</div>
<div class="paragraph data-line-261">
<p>Lorsque le canal passe √† l&#8217;√©tat suivant, Hitesh doit <em>r√©voquer</em> cette transaction d&#8217;engagement avant qu&#8217;Irene n&#8217;accepte de signer la prochaine transaction d&#8217;engagement. Pour cela, il lui suffit d&#8217;envoyer sa moiti√© de <em>cl√© de r√©vocation</em> √† Ir√®ne. Une fois qu&#8217;Irene a les deux moiti√©s de la cl√© secr√®te de r√©vocation pour cet engagement, elle peut signer le prochain engagement en toute confiance. Elle sait que si Hitesh essaie de tricher en publiant l&#8217;engagement pr√©c√©dent, elle peut utiliser la cl√© de r√©vocation pour racheter la sortie retard√©e de Hitesh. <em>Si Hitesh triche, Irene obtient les DEUX sorties</em>. Pendant ce temps, Hitesh n&#8217;a que la moiti√© du secret de r√©vocation pour cette cl√© publique de r√©vocation et ne peut pas racheter la sortie avant 1000 blocs. Irene pourra racheter la sortie et punir Hitesh avant que les 1000 blocs ne se soient √©coul√©s.</p>
</div>
<div class="paragraph data-line-263">
<p>Le protocole de r√©vocation est bilat√©ral, ce qui signifie qu&#8217;√† chaque tour, √† mesure que l&#8217;√©tat du canal est avanc√©, les deux parties √©changent de nouveaux engagements, √©changent des secrets de r√©vocation pour les engagements pr√©c√©dents et signent les nouvelles transactions d&#8217;engagement de l&#8217;autre. Au fur et √† mesure qu&#8217;ils acceptent un nouvel √©tat, ils rendent l&#8217;√©tat ant√©rieur inutilisable, en se donnant mutuellement les secrets de r√©vocation n√©cessaires pour sanctionner toute tricherie.</p>
</div>
<div class="paragraph data-line-265">
<p>Regardons un exemple de la fa√ßon dont cela fonctionne. L&#8217;un des clients d&#8217;Irene souhaite envoyer 2 bitcoins √† l&#8217;un des clients de Hitesh. Pour transmettre 2 bitcoins √† travers le canal, Hitesh et Irene doivent faire avancer l&#8217;√©tat du canal pour refl√©ter le nouvel √©quilibre. Ils s&#8217;engageront dans un nouvel √©tat (√©tat num√©ro 2) o√π les 10 bitcoins de la cha√Æne sont divis√©s, 7 bitcoins pour Hitesh et 3 bitcoins pour Irene. Pour faire progresser l&#8217;√©tat du canal, ils cr√©eront chacun de nouvelles transactions d&#8217;engagement refl√©tant le nouveau solde du canal.</p>
</div>
<div class="paragraph data-line-267">
<p>Comme auparavant, ces transactions d&#8217;engagement sont asym√©triques de sorte que la transaction d&#8217;engagement que chaque partie d√©tient les oblige √† attendre si ils la remboursent. Surtout, avant de signer de nouvelles transactions d&#8217;engagement, ils doivent d&#8217;abord √©changer des cl√©s de r√©vocation pour invalider l&#8217;engagement pr√©c√©dent. Dans ce cas particulier, les int√©r√™ts de Hitesh sont align√©s sur l&#8217;√©tat r√©el de la cha√Æne et il n&#8217;a donc aucune raison de diffuser un √©tat ant√©rieur. Cependant, pour Irene, l&#8217;√©tat num√©ro 1 lui laisse un solde plus √©lev√© que l&#8217;√©tat 2. Quand Irene donne √† Hitesh la cl√© de r√©vocation pour sa transaction d&#8217;engagement pr√©c√©dente (√©tat num√©ro 1), elle r√©voque effectivement sa capacit√© √† tirer profit de la r√©gression du canal vers un pr√©c√©dent. √©tat parce qu&#8217;avec la cl√© de r√©vocation, Hitesh peut racheter sans d√©lai les deux sorties de la transaction d&#8217;engagement pr√©c√©dente. Cela signifie que si Irene diffuse l&#8217;√©tat ant√©rieur, Hitesh peut exercer son droit de prendre toutes les sorties.</p>
</div>
<div class="paragraph data-line-269">
<p>Il est important de noter que la r√©vocation ne se produit pas automatiquement. Alors que Hitesh a la capacit√© de punir Irene pour avoir trich√©, il doit surveiller la cha√Æne de blocs avec diligence pour d√©tecter des signes de tricherie. S&#8217;il voit une diffusion d&#8217;une transaction d&#8217;engagement pr√©alable, il dispose de 1000 blocs pour agir et utiliser la cl√© de r√©vocation pour contrecarrer la tricherie d&#8217;Ir√®ne et la punir en prenant la totalit√© du solde, les 10 bitcoins.</p>
</div>
<div class="paragraph data-line-271">
<p>Les engagements r√©vocables asym√©triques avec blocages temporels relatifs (<code>CSV</code>) sont une bien meilleure fa√ßon de mettre en ≈ìuvre les canaux de paiement et une innovation tr√®s importante dans cette technologie. Avec cette construction, le canal peut rester ouvert ind√©finiment et peut avoir des milliards de transactions d&#8217;engagement interm√©diaires. Dans les impl√©mentations prototypes de Lightning Network, l&#8217;√©tat d&#8217;engagement est identifi√© par un index de 48 bits, permettant plus de 281¬†000 milliards (2,8 x 10<sup>14</sup>) de transitions d&#8217;√©tat dans n&#8217;importe quel canal¬†!</p>
</div>
</div>
<div class="sect3 data-line-273">
<h4 id="_contrats_de_verrouillage_du_temps_de_hachage_htlc">Contrats de verrouillage du temps de hachage (HTLC)</h4>
<div class="paragraph data-line-275">
<p>Les canaux de paiement peuvent √™tre encore √©tendus avec un type sp√©cial de contrat intelligent qui permet aux participants d&#8217;engager des fonds dans un secret remboursable, avec un d√©lai d&#8217;expiration. Cette fonctionnalit√© est appel√©e <em>contrats de verrouillage du temps de hachage</em> (<em>Hash Time Lock Contract</em>), ou <em>HTLC</em>, et est utilis√©e √† la fois dans les canaux de paiement bidirectionnels et rout√©s.</p>
</div>
<div class="paragraph data-line-277">
<p>Expliquons d&#8217;abord la partie "hachage" du HTLC. Pour cr√©er un HTLC, le destinataire pr√©vu du paiement cr√©era d&#8217;abord un <code>R</code> secret. Ils calculent ensuite le hash de ce secret <code>H</code>¬†:</p>
</div>
<div class="listingblock data-line-279">
<div class="content">
<pre>H = Hachage(R)</pre>
</div>
</div>
<div class="paragraph data-line-283">
<p>Cela produit un hachage <code>H</code> qui peut √™tre inclus dans le script de verrouillage d&#8217;une sortie. Celui qui conna√Æt le secret peut l&#8217;utiliser pour racheter la sortie. Le secret <code>R</code> est √©galement appel√© <em>pr√©image</em> pour la fonction de hachage. La pr√©image est simplement la donn√©e utilis√©e comme entr√©e dans une fonction de hachage.</p>
</div>
<div class="paragraph data-line-285">
<p>La deuxi√®me partie d&#8217;un HTLC est le composant "verrou temporel". Si le secret n&#8217;est pas r√©v√©l√©, le payeur du HTLC peut obtenir un "remboursement" apr√®s un certain temps. Ceci est r√©alis√© avec un verrouillage temporel absolu √† l&#8217;aide de <code>CHECKLOCKTIMEVERIFY</code>.</p>
</div>
<div class="paragraph data-line-287">
<p>Le script impl√©mentant un HTLC pourrait ressembler √† ceci¬†:</p>
</div>
<div class="listingblock data-line-289">
<div class="content">
<pre>IF
# Paiement si vous avez le secret R
    HASH160 &lt;H&gt; EQUALVERIFY
ELSE
# Remboursement apr√®s expiration du d√©lai.
    &lt;locktime&gt; CHECKLOCKTIMEVERIFY DROP
    &lt;Payer Public Key&gt; CHECKSIG
ENDIF</pre>
</div>
</div>
<div class="paragraph data-line-300">
<p>Toute personne connaissant le secret <code>R</code>, qui, lorsqu&#8217;il est hach√©, est √©gal √† <code>H</code>, peut racheter cette sortie en exer√ßant la premi√®re clause du flux <code>IF</code>.</p>
</div>
<div class="paragraph data-line-302">
<p>Si le secret n&#8217;est pas r√©v√©l√© et que le HTLC est r√©clam√©, apr√®s un certain nombre de blocages, le payeur peut demander un remboursement en utilisant la deuxi√®me clause du flux <code>IF</code>.</p>
</div>
<div class="paragraph data-line-304">
<p>Il s&#8217;agit d&#8217;une impl√©mentation de base d&#8217;un HTLC. Ce type de HTLC peut √™tre √©chang√© par <em>toute personne</em> qui a le secret <code>R</code>. Un HTLC peut prendre de nombreuses formes diff√©rentes avec de l√©g√®res variations dans le script. Par exemple, l&#8217;ajout d&#8217;un op√©rateur <code>CHECKSIG</code> et d&#8217;une cl√© publique dans la premi√®re clause limite le rachat du hachage √† un destinataire nomm√©, qui doit √©galement conna√Ætre le secret <code>R</code>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-307">
<h3 id="lightning_network">Canaux de paiement rout√©s (Lightning Network)</h3>
<div class="paragraph data-line-309">
<p> Le Lightning Network est un r√©seau rout√© propos√© de canaux de paiement bidirectionnels connect√©s de bout en bout. Un tel r√©seau peut permettre √† n&#8217;importe quel participant d&#8217;acheminer un paiement d&#8217;un canal √† l&#8217;autre sans faire confiance √† aucun des interm√©diaires. Le Lightning Network √©tait <a href="https://lightning.network/lightning-network-paper.pdf" data-href="https://lightning.network/lightning-network-paper.pdf">d√©crit pour la premi√®re fois par Joseph Poon et Thadeus Dryja en f√©vrier 2015</a>, s&#8217;appuyant sur le concept de canaux de paiement tel que propos√© et √©labor√© par de nombreux autres.</p>
</div>
<div class="paragraph data-line-311">
<p>Le "Lightning Network" fait r√©f√©rence √† une conception sp√©cifique pour un r√©seau de canaux de paiement rout√©s, qui a maintenant √©t√© mis en ≈ìuvre par au moins cinq √©quipes de sources libres diff√©rentes. Les impl√©mentations ind√©pendantes sont coordonn√©es par un ensemble de normes d&#8217;interop√©rabilit√© d√©crites dans le <a href="https://bit.ly/2rBHeoL" data-href="https://bit.ly/2rBHeoL">document <em>Basics of Lightning Technology (BOLT)</em></a>.</p>
</div>
<div class="paragraph data-line-313">
<p>Des impl√©mentations prototypes du Lightning Network ont √©t√© publi√©es par plusieurs √©quipes.</p>
</div>
<div class="paragraph data-line-315">
<p>Le Lightning Network est une possibilit√© de mise en place de canaux de paiement rout√©s. Il existe plusieurs autres conceptions qui visent √† atteindre des objectifs similaires, telles que Teechan et Tumblebit.</p>
</div>
<div class="sect3 data-line-317">
<h4 id="_exemple_de_r√©seau_lightning_de_base">Exemple de r√©seau Lightning de base</h4>
<div class="paragraph data-line-319">
<p> Voyons comment cela fonctionne.</p>
</div>
<div class="paragraph data-line-321">
<p>Dans cet exemple, nous avons cinq participants¬†: Alice, Bob, Carol, Diana et Eric. Ces cinq participants ont ouvert des canaux de paiement entre eux, par paires. Alice a un canal de paiement avec Bob. Bob est connect√© √† Carol, Carol √† Diana et Diana √† Eric. Pour simplifier, supposons que chaque cha√Æne est financ√©e avec 2 bitcoins par chaque participant, pour une capacit√© totale de 4 bitcoins dans chaque cha√Æne.</p>
</div>
<div class="paragraph data-line-323">
<p><a href="#lightning_network_fig">Une s√©rie de canaux de paiement bidirectionnels li√©s pour former un r√©seau Lightning qui peut acheminer un paiement d&#8217;Alice √† Eric</a> montre cinq participants dans un Lightning Network, connect√©s par des canaux de paiement bidirectionnels qui peuvent √™tre li√©s pour effectuer un paiement d&#8217;Alice √† Eric (<a href="#lightning_network">Canaux de paiement rout√©s (Lightning Network)</a>).</p>
</div>
<div id="lightning_network_fig" class="imageblock data-line-327">
<div class="content">
<img src="images/mbc2_1206.png" alt="Une s√©rie de canaux de paiement bidirectionnels li√©s pour former un Lightning Network">
</div>
<div class="title">Figure 78. Une s√©rie de canaux de paiement bidirectionnels li√©s pour former un r√©seau Lightning qui peut acheminer un paiement d&#8217;Alice √† Eric</div>
</div>
<div class="paragraph data-line-329">
<p>Alice veut payer Eric 1 bitcoin. Cependant, Alice n&#8217;est pas connect√©e √† Eric par un canal de paiement. La cr√©ation d&#8217;un canal de paiement n√©cessite une transaction de financement, qui doit √™tre engag√©e dans la cha√Æne de blocs Bitcoin. Alice ne veut pas ouvrir un nouveau canal de paiement et engager davantage de ses fonds. Y a-t-il un moyen de payer Eric, indirectement ?</p>
</div>
<div class="paragraph data-line-331">
<p><a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> montre le processus √©tape par √©tape d&#8217;acheminement d&#8217;un paiement d&#8217;Alice √† Eric, √† travers une s√©rie d&#8217;engagements HTLC sur les canaux de paiement reliant les participants.</p>
</div>
<div id="ln_payment_process" class="imageblock data-line-335">
<div class="content">
<img src="images/mbc2_1207.png" alt="Acheminement des paiements √©tape par √©tape via un r√©seau Lightning">
</div>
<div class="title">Figure 79. Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</div>
</div>
<div class="paragraph data-line-337">
<p>Alice ex√©cute un n≈ìud Lightning Network (LN) qui assure le suivi de son canal de paiement vers Bob et a la capacit√© de d√©couvrir des itin√©raires entre les canaux de paiement. Le n≈ìud LN d&#8217;Alice a √©galement la capacit√© de se connecter via Internet au n≈ìud LN d&#8217;Eric. Le n≈ìud LN d&#8217;Eric cr√©e un <code>R</code> secret √† l&#8217;aide d&#8217;un g√©n√©rateur de nombres al√©atoires. Le n≈ìud d&#8217;Eric ne r√©v√®le ce secret √† personne. Au lieu de cela, le n≈ìud d&#8217;Eric calcule un hachage <code>H</code> du secret <code>R</code> et transmet ce hachage au n≈ìud d&#8217;Alice (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 1).</p>
</div>
<div class="paragraph data-line-339">
<p>Maintenant, le n≈ìud LN d&#8217;Alice construit une route entre le n≈ìud LN d&#8217;Alice et le n≈ìud LN d&#8217;Eric. L&#8217;algorithme de routage utilis√© sera examin√© plus en d√©tail plus tard, mais pour l&#8217;instant supposons que le n≈ìud d&#8217;Alice puisse trouver une route efficace.</p>
</div>
<div class="paragraph data-line-341">
<p>Le n≈ìud d&#8217;Alice construit alors un HTLC, payable au hash <code>H</code>, avec un d√©lai de remboursement de 10 blocs (bloc actuel + 10), pour un montant de 1,003 bitcoin (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 2). Le suppl√©ment de 0,003 sera utilis√© pour compenser les n≈ìuds interm√©diaires pour leur participation √† cette voie de paiement. Alice offre ce HTLC √† Bob, d√©duisant 1,003 bitcoin de son solde de canal avec Bob et l&#8217;engageant sur le HTLC. Le HTLC a la signification suivante¬†: <em>"Alice engage 1,003 de son solde de canal √† payer √† Bob si Bob conna√Æt le secret, ou rembours√© sur le solde d&#8217;Alice si 10¬†blocs s&#8217;√©coulent."</em> Le solde de canal entre Alice et Bob est maintenant exprim√© par des transactions d&#8217;engagement avec trois sorties¬†: solde de 2 bitcoins √† Bob, solde de 0,997 bitcoin √† Alice, 1,003 bitcoin engag√© dans le HTLC d&#8217;Alice. Le solde d&#8217;Alice est r√©duit du montant engag√© dans le HTLC.</p>
</div>
<div class="paragraph data-line-343">
<p>Bob s&#8217;est maintenant engag√© √† ce que s&#8217;il parvient √† obtenir le secret ` R ` dans les 10 prochains blocs, il puisse r√©clamer les 1,003 verrouill√©s par Alice. Avec cet engagement en main, le n≈ìud de Bob construit un HTLC sur son canal de paiement avec Carol. Le HTLC de Bob engage 1,002 bitcoin dans le hachage <code>H</code> pendant 9 blocs, que Carol peut √©changer si elle a le secret <code>R</code> (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 3). Bob sait que si Carol peut r√©clamer son HTLC, elle doit produire <code>R</code>. Si Bob a ` R ` dans neuf blocs, il peut l&#8217;utiliser pour lui r√©clamer le HTLC d&#8217;Alice. Il gagne √©galement 0,001 bitcoin pour avoir engag√© le solde de son canal pendant neuf blocs. Si Carol n&#8217;est pas en mesure de r√©clamer son HTLC et qu&#8217;il ne peut pas r√©clamer le HTLC d&#8217;Alice, tout revient aux soldes de canal pr√©c√©dents et personne n&#8217;est √† perte. L&#8217;√©quilibre des canaux entre Bob et Carol est maintenant¬†: 2 pour Carol, 0,998 pour Bob, 1,002 commis par Bob pour le HTLC.</p>
</div>
<div class="paragraph data-line-345">
<p>Carol s&#8217;est maintenant engag√©e √† ce que si elle obtient <code>R</code> dans les neuf prochains blocs, elle puisse r√©clamer 1,002 bitcoin verrouill√© par Bob. Elle peut d√©sormais s&#8217;engager sur HTLC sur sa cha√Æne avec Diana. Elle engage un HTLC de 1.001 bitcoin au hachage <code>H</code>, pour huit blocs, que Diana peut racheter si elle a le secret <code>R</code> (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 4). Du point de vue de Carol, si cela fonctionne, elle est plus riche de 0,001 bitcoin et si ce n&#8217;est pas le cas, elle ne perd rien. Son HTLC √† Diana n&#8217;est viable que si <code>R</code> est r√©v√©l√©, auquel cas elle peut r√©clamer le HTLC √† Bob. L&#8217;√©quilibre des canaux entre Carol et Diana est d√©sormais¬†: 2 pour Diana, 0,999 pour Carol, 1,001 commis par Carol pour le HTLC.</p>
</div>
<div class="paragraph data-line-347">
<p>Enfin, Diana peut proposer un HTLC √† Eric, engageant 1 bitcoin pour sept blocs √† hacher <code>H</code> (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 5). L&#8217;√©quilibre des canaux entre Diana et Eric est maintenant¬†: 2 √† Eric, 1 √† Diana, 1 commis par Diana au HTLC.</p>
</div>
<div class="paragraph data-line-349">
<p>Cependant, √† ce saut dans la route, Eric <em>a</em> le secret <code>R</code>. Il peut donc pr√©tendre au HTLC propos√© par Diana. Il envoie <code>R</code> √† Diana et r√©clame le 1 bitcoin, l&#8217;ajoutant au solde de son canal (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 6). L&#8217;√©quilibre des canaux est maintenant¬†: 1 pour Diana, 3 pour Eric.</p>
</div>
<div class="paragraph data-line-351">
<p>Maintenant, Diana a un <code>R</code> secret. Par cons√©quent, elle peut d√©sormais r√©clamer le HTLC √† Carol. Diana transmet <code>R</code> √† Carol et ajoute le bitcoin 1.001 au solde de son canal (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 7). Maintenant, l&#8217;√©quilibre des canaux entre Carol et Diana est¬†: 0,999 pour Carol, 3,001 pour Diana. Diana a "gagn√©" 0,001 pour sa participation √† cette voie de paiement.</p>
</div>
<div class="paragraph data-line-353">
<p>En revenant sur le parcours, le secret <code>R</code> permet √† chaque participant de r√©clamer les HTLC restants. Carol r√©clame 1,002 √† Bob, fixant le solde sur leur cha√Æne √†¬†: 0,998 √† Bob, 3,002 √† Carol (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 8). Enfin, Bob revendique le HTLC d&#8217;Alice (voir <a href="#ln_payment_process">Acheminement des paiements √©tape par √©tape via un r√©seau Lightning</a> √©tape 9). Leur solde de canaux est mis √† jour comme suit¬†: 0,997 pour Alice, 3,003 pour Bob.</p>
</div>
<div class="paragraph data-line-355">
<p>Alice a pay√© Eric 1 bitcoin sans ouvrir de cha√Æne √† Eric. Aucune des parties interm√©diaires de la voie de paiement n&#8217;avait √† se faire confiance. Pour l&#8217;engagement √† court terme de leurs fonds dans le canal, ils peuvent gagner une petite commission, le seul risque √©tant un l√©ger retard de remboursement si le canal √©tait ferm√© ou si le paiement achemin√© √©chouait.</p>
</div>
</div>
<div class="sect3 data-line-357">
<h4 id="_transport_et_routage_du_lightning_network">Transport et routage du Lightning Network</h4>
<div class="paragraph data-line-359">
<p>Toutes les communications entre les n≈ìuds LN sont crypt√©es point √† point. De plus, les n≈ìuds ont une cl√© publique √† long terme qu&#8217;ils utilisent comme identifiant et pour s&#8217;authentifier les uns les autres.</p>
</div>
<div class="paragraph data-line-361">
<p>Chaque fois qu&#8217;un n≈ìud souhaite envoyer un paiement √† un autre n≈ìud, il doit d&#8217;abord construire un <em>chemin</em> √† travers le r√©seau en connectant des canaux de paiement avec une capacit√© suffisante. Les n≈ìuds annoncent les informations de routage, y compris les canaux qu&#8217;ils ont ouverts, la capacit√© de chaque canal et les frais qu&#8217;ils facturent pour acheminer les paiements. Les informations de routage peuvent √™tre partag√©es de diverses mani√®res et diff√©rents protocoles de routage sont susceptibles d&#8217;√©merger √† mesure que la technologie Lightning Network progresse. Certaines impl√©mentations de Lightning Network utilisent le protocole IRC comme m√©canisme pratique permettant aux n≈ìuds d&#8217;annoncer les informations de routage. Une autre impl√©mentation de la d√©couverte de route utilise un mod√®le P2P o√π les n≈ìuds propagent les annonces de canal √† leurs pairs, dans un mod√®le d'"inondation", similaire √† la fa√ßon dont bitcoin propage les transactions. Les plans futurs incluent une proposition appel√©e <a href="https://bit.ly/2r5TACm" data-href="https://bit.ly/2r5TACm">Flare</a>, qui est un mod√®le de routage hybride avec des "quartiers" de n≈ìuds locaux et des n≈ìuds de balise √† plus longue port√©e.</p>
</div>
<div class="paragraph data-line-363">
<p>Dans notre exemple pr√©c√©dent, le n≈ìud d&#8217;Alice utilise l&#8217;un de ces m√©canismes de d√©couverte de route pour trouver un ou plusieurs chemins reliant son n≈ìud au n≈ìud d&#8217;Eric. Une fois que le n≈ìud d&#8217;Alice a construit un chemin, elle initialisera ce chemin √† travers le r√©seau, en propageant une s√©rie d&#8217;instructions crypt√©es et imbriqu√©es pour connecter chacun des canaux de paiement adjacents.</p>
</div>
<div class="paragraph data-line-365">
<p>Il est important de noter que ce chemin n&#8217;est connu que du n≈ìud d&#8217;Alice. Tous les autres participants de la route de paiement ne voient que les n≈ìuds adjacents. Du point de vue de Carol, cela ressemble √† un paiement de Bob √† Diana. Carol ne sait pas que Bob transmet en fait un paiement d&#8217;Alice. Elle ne sait pas non plus que Diana transmettra un paiement √† Eric.</p>
</div>
<div class="paragraph data-line-367">
<p>Il s&#8217;agit d&#8217;une fonctionnalit√© essentielle du Lightning Network, car elle garantit la confidentialit√© des paiements et rend tr√®s difficile l&#8217;application de la surveillance, de la censure ou des listes noires. Mais comment Alice √©tablit-elle ce chemin de paiement, sans rien r√©v√©ler aux n≈ìuds interm√©diaires ?</p>
</div>
<div class="paragraph data-line-369">
<p>Le Lightning Network impl√©mente un protocole de routage en oignon bas√© sur un sch√©ma appel√© <a href="https://bit.ly/2q6ZDrP" data-href="https://bit.ly/2q6ZDrP">Sphinx</a>. Ce protocole de routage garantit qu&#8217;un exp√©diteur de paiement peut construire et communiquer un chemin √† travers le Lightning Network tel que¬†:</p>
</div>
<div class="ulist data-line-371">
<ul>
<li class="data-line-371">
<p>Les n≈ìuds interm√©diaires peuvent v√©rifier et d√©crypter leur portion d&#8217;informations de route et trouver le saut suivant.</p>
</li>
<li class="data-line-373">
<p>√Ä part les sauts pr√©c√©dents et suivants, ils ne peuvent pas en savoir plus sur les autres n≈ìuds faisant partie du chemin.</p>
</li>
<li class="data-line-375">
<p>Ils ne peuvent pas identifier la longueur du chemin de paiement, ni leur propre position dans ce chemin.</p>
</li>
<li class="data-line-377">
<p>Chaque partie du chemin est crypt√©e de telle mani√®re qu&#8217;un attaquant au niveau du r√©seau ne peut pas associer les paquets de diff√©rentes parties du chemin les uns aux autres.</p>
</li>
<li class="data-line-379">
<p>Contrairement √† Tor (un protocole d&#8217;anonymisation rout√© par couches d&#8217;oignon sur Internet), il n&#8217;y a pas de "n≈ìuds de sortie" qui peuvent √™tre plac√©s sous surveillance. Les paiements n&#8217;ont pas besoin d&#8217;√™tre transmis √† la cha√Æne de blocs Bitcoin ; les n≈ìuds mettent simplement √† jour les soldes des canaux.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-381">
<p>En utilisant ce protocole rout√© en couches d&#8217;oignon, Alice enveloppe chaque √©l√©ment du chemin dans une couche de cryptage, en commen√ßant par la fin et en remontant. Elle crypte un message √† Eric avec la cl√© publique d&#8217;Eric. Ce message est envelopp√© dans un message crypt√© pour Diana, identifiant Eric comme le prochain destinataire. Le message √† Diana est envelopp√© dans un message crypt√© avec la cl√© publique de Carol et identifiant Diana comme le prochain destinataire. Le message √† Carol est crypt√© avec la cl√© de Bob. Ainsi, Alice a construit cet "oignon" multicouche chiffr√© de messages. Elle l&#8217;envoie √† Bob, qui ne peut que d√©chiffrer et d√©baller la couche externe. √Ä l&#8217;int√©rieur, Bob trouve un message adress√© √† Carol qu&#8217;il peut transmettre √† Carol mais ne peut pas se d√©chiffrer. En suivant le chemin, les messages sont transf√©r√©s, d√©crypt√©s, transf√©r√©s, etc., jusqu&#8217;√† Eric. Chaque participant ne conna√Æt que le n≈ìud pr√©c√©dent et suivant dans chaque saut.</p>
</div>
<div class="paragraph data-line-383">
<p>Chaque √©l√©ment du chemin contient des informations sur le HTLC qui doivent √™tre √©tendues au saut suivant, le montant qui est envoy√©, les frais √† inclure et l&#8217;expiration du temps de verrouillage CLTV (en blocs) du HTLC. Au fur et √† mesure que les informations de route se propagent, les n≈ìuds effectuent des engagements HTLC jusqu&#8217;au saut suivant.</p>
</div>
<div class="paragraph data-line-385">
<p>√Ä ce stade, vous vous demandez peut-√™tre comment il est possible que les n≈ìuds ne connaissent pas la longueur du chemin et leur position dans ce chemin. Apr√®s tout, ils re√ßoivent un message et le transmettent au saut suivant. Ne devient-il pas plus court, leur permettant de d√©duire la taille du chemin et leur position ? Pour √©viter cela, le chemin est toujours fix√© √† 20 sauts et rempli de donn√©es al√©atoires. Chaque n≈ìud voit le saut suivant et un message chiffr√© de longueur fixe √† transmettre. Seul le destinataire final voit qu&#8217;il n&#8217;y a pas de saut suivant. Pour tout le monde, il semble qu&#8217;il y ait toujours 20 sauts de plus √† faire.</p>
</div>
</div>
<div class="sect3 data-line-387">
<h4 id="_avantages_du_lightning_network">Avantages du Lightning Network</h4>
<div class="paragraph data-line-389">
<p>Un Lightning Network est une technologie de routage de deuxi√®me couche. Il peut √™tre appliqu√© √† toute cha√Æne de blocs prenant en charge certaines fonctionnalit√©s de base, telles que les transactions multisignatures, les verrous temporels et les contrats intelligents de base.</p>
</div>
<div class="paragraph data-line-391">
<p>Si un r√©seau Lightning est superpos√© au r√©seau Bitcoin, le r√©seau Bitcoin peut b√©n√©ficier d&#8217;une augmentation significative de la capacit√©, de la confidentialit√©, de la granularit√© et de la vitesse, sans sacrifier les principes de fonctionnement sans confiance sans interm√©diaires¬†:</p>
</div>
<div class="dlist data-line-393">
<dl>
<dt class="hdlist1">Confidentialit√©</dt>
<dd>
<p>Les paiements Lightning Network sont beaucoup plus priv√©s que les paiements sur la cha√Æne de blocs Bitcoin, car ils ne sont pas publics. Bien que les participants √† une route puissent voir les paiements se propager sur leurs canaux, ils ne connaissent ni l&#8217;exp√©diteur ni le destinataire.</p>
</dd>
<dt class="hdlist1">Fongibilit√©</dt>
<dd>
<p>Un Lightning Network rend beaucoup plus difficile l&#8217;application de la surveillance et des listes noires sur le bitcoin, augmentant la fongibilit√© de la monnaie.</p>
</dd>
<dt class="hdlist1">Vitesse</dt>
<dd>
<p>Les transactions Bitcoin utilisant Lightning Network sont r√©gl√©es en millisecondes, plut√¥t qu&#8217;en minutes, car les HTLC sont effac√©s sans valider les transactions dans un bloc.</p>
</dd>
<dt class="hdlist1">Granularit√©</dt>
<dd>
<p>Un r√©seau Lightning peut permettre des paiements au moins aussi petits que la limite de "poussi√®re" de bitcoin, peut-√™tre m√™me plus petite. Certaines propositions permettent des incr√©ments subsatoshi.</p>
</dd>
<dt class="hdlist1">Capacit√©</dt>
<dd>
<p>Un Lightning Network augmente la capacit√© du syst√®me Bitcoin de plusieurs ordres de grandeur. Il n&#8217;y a pas de limite sup√©rieure pratique au nombre de paiements par seconde pouvant √™tre achemin√©s sur un r√©seau Lightning, car cela d√©pend uniquement de la capacit√© et de la vitesse de chaque n≈ìud.</p>
</dd>
<dt class="hdlist1">Fonctionnement sans confiance</dt>
<dd>
<p>Un r√©seau Lightning utilise des transactions bitcoin entre des n≈ìuds qui fonctionnent comme des pairs sans se faire confiance. Ainsi, un Lightning Network pr√©serve les principes du syst√®me Bitcoin, tout en √©largissant consid√©rablement ses param√®tres de fonctionnement.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-405">
<p>Bien s√ªr, comme mentionn√© pr√©c√©demment, le protocole Lightning Network n&#8217;est pas le seul moyen de mettre en ≈ìuvre des canaux de paiement rout√©s. D&#8217;autres syst√®mes propos√©s incluent Tumblebit et Teechan. √Ä l&#8217;heure actuelle, cependant, le Lightning Network a d√©j√† √©t√© d√©ploy√© sur testnet. Plusieurs √©quipes diff√©rentes ont d√©velopp√© des impl√©mentations concurrentes de LN et travaillent √† une norme d&#8217;interop√©rabilit√© commune (appel√©e BOLT). Il est probable que Lightning Network sera le premier r√©seau de canaux de paiement rout√©s √† √™tre d√©ploy√© en production.</p>
</div>
</div>
</div>
<div class="sect2 data-line-407">
<h3 id="_conclusion_2">Conclusion</h3>
<div class="paragraph data-line-31">
<p>Nous n&#8217;avons examin√© que quelques-unes des applications √©mergentes qui peuvent √™tre construites en utilisant la cha√Æne de blocs Bitcoin comme plate-forme de confiance. Ces applications √©largissent la port√©e du bitcoin au-del√† des paiements et au-del√† des instruments financiers, pour englober de nombreuses autres applications o√π la confiance est essentielle. En d√©centralisant la base de confiance, la cha√Æne de blocs Bitcoin est une plate-forme qui engendrera de nombreuses applications r√©volutionnaires dans une grande vari√©t√© d&#8217;industries.</p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-3">
<h2 id="satoshi_whitepaper">Appendix A: Le livre blanc Bitcoin de Satoshi Nakamoto</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="admonitionblock note data-line-6">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-7">
<p>Ceci est le livre blanc original, reproduit dans son int√©gralit√© exactement tel qu&#8217;il a √©t√© publi√© par Satoshi Nakamoto en octobre 2008 et traduit (par assistance informatique) par Serafim Dos Santos en 2022 pour l&#8217;√©dition ouverte de <em>Ma√Ætriser Bitcoin</em> (voir version originale <em>Mastering Bitcoin</em>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2 data-line-10">
<h3 id="_bitcoin_un_syst√®me_de_paiement_√©lectronique_pair_√†_pair">Bitcoin - Un syst√®me de paiement √©lectronique pair √† pair</h3>
<div class="paragraph data-line-12">
<p>Satoshi Nakamoto</p>
</div>
<div class="paragraph data-line-14">
<p><em>satoshin@gmx.com</em></p>
</div>
<div class="paragraph data-line-16">
<p><a href="https://bitcoin.org/en/" class="orm:hideurl"><em>www.bitcoin.org</em></a></p>
</div>
<div class="paragraph data-line-18">
<p><strong>R√©sum√©.</strong> Une version purement pair √† pair de la monnaie √©lectronique permettrait d&#8217;envoyer des paiements en ligne directement d&#8217;une partie √† une autre sans passer par une institution financi√®re. Les signatures num√©riques fournissent une partie de la solution, mais les principaux avantages sont perdus si un tiers de confiance est toujours requis pour √©viter les doubles d√©penses. Nous proposons une solution au probl√®me de la double d√©pense en utilisant un r√©seau pair √† pair. Le r√©seau horodate les transactions en les hachant dans une cha√Æne continue de preuves de travail (proof-of-work) bas√©es sur le hachage, formant un enregistrement qui ne peut pas √™tre modifi√© sans refaire la preuve de travail. La cha√Æne la plus longue sert non seulement de preuve de la s√©quence d&#8217;√©v√©nements observ√©s, mais aussi de preuve qu&#8217;elle provient du plus grand bassin de puissance CPU. Tant que la majorit√© de la puissance du processeur est contr√¥l√©e par des n≈ìuds qui ne coop√®rent pas pour attaquer le r√©seau, ils g√©n√©reront la plus longue cha√Æne et devanceront les attaquants. Le r√©seau lui-m√™me n√©cessite une structure minimale. Les messages sont diffus√©s dans la mesure du possible, et les n≈ìuds peuvent quitter et rejoindre le r√©seau √† volont√©, acceptant la plus longue cha√Æne de preuve de travail comme preuve de ce qui s&#8217;est pass√© pendant leur absence.</p>
</div>
<div class="sect3 data-line-20">
<h4 id="_introduction">Introduction</h4>
<div class="paragraph data-line-21">
<p>Le commerce sur Internet en est venu √† s&#8217;appuyer presque exclusivement sur des institutions financi√®res servant de tiers de confiance pour traiter les paiements √©lectroniques. Bien que le syst√®me fonctionne assez bien pour la plupart des transactions, il souffre toujours des faiblesses inh√©rentes au mod√®le bas√© sur la confiance. Les transactions totalement irr√©versibles ne sont pas vraiment possibles, car les institutions financi√®res ne peuvent √©viter la m√©diation des diff√©rends. Le co√ªt de la m√©diation augmente les co√ªts de transaction, limitant la taille pratique minimale des transactions et supprimant la possibilit√© de petites transactions occasionnelles, et il y a un co√ªt plus important dans la perte de capacit√© √† effectuer des paiements irr√©versibles pour des services irr√©versibles. Avec la possibilit√© d&#8217;inversion, le besoin de confiance se r√©pand. Les commer√ßants doivent se m√©fier de leurs clients et les harceler pour obtenir plus d&#8217;informations qu&#8217;ils n&#8217;en auraient autrement besoin. Un certain pourcentage de fraude est accept√© comme in√©vitable. Ces co√ªts et incertitudes de paiement peuvent √™tre √©vit√©s en personne en utilisant de la monnaie physique, mais aucun m√©canisme n&#8217;existe pour effectuer des paiements via un canal de communication sans une partie de confiance.</p>
</div>
<div class="paragraph data-line-23">
<p>Ce qu&#8217;il faut, c&#8217;est un syst√®me de paiement √©lectronique bas√© sur la preuve cryptographique au lieu de la confiance, permettant √† deux parties consentantes d&#8217;effectuer des transactions directement l&#8217;une avec l&#8217;autre sans avoir besoin d&#8217;un tiers de confiance. Les transactions impossibles √† annuler sur le plan informatique prot√©geraient les vendeurs contre la fraude, et des m√©canismes de s√©questre de routine pourraient facilement √™tre mis en ≈ìuvre pour prot√©ger les acheteurs. Dans cet article, nous proposons une solution au probl√®me de la double d√©pense en utilisant un serveur d&#8217;horodatage distribu√© pair √† pair pour g√©n√©rer une preuve informatique de l&#8217;ordre chronologique des transactions. Le syst√®me est s√©curis√© tant que les n≈ìuds honn√™tes contr√¥lent collectivement plus de puissance CPU que n&#8217;importe quel groupe coop√©rant de n≈ìuds attaquants.</p>
</div>
</div>
<div class="sect3 data-line-25">
<h4 id="_transactions">Transactions</h4>
<div class="paragraph data-line-26">
<p>Nous d√©finissons une pi√®ce √©lectronique (ou unit√© de cryptomonnaie) comme une cha√Æne de signatures num√©riques. Chaque propri√©taire transf√®re la pi√®ce au suivant en signant num√©riquement un r√©sultat de hachage de la transaction pr√©c√©dente et la cl√© publique du propri√©taire suivant et en les ajoutant √† la fin de la pi√®ce. Un b√©n√©ficiaire peut v√©rifier les signatures pour v√©rifier la cha√Æne de propri√©t√©.</p>
</div>
<div class="imageblock data-line-28">
<div class="content">
<img src="images/mbc2_abin01.png" alt="Transactions">
</div>
</div>
<div class="paragraph data-line-30">
<p>Le probl√®me est bien s√ªr que le b√©n√©ficiaire ne peut pas v√©rifier que l&#8217;un des propri√©taires n&#8217;a pas d√©pens√© deux fois la pi√®ce. Une solution courante consiste √† introduire une autorit√© centrale de confiance, ou "maison ou h√¥tel de la monnaie", qui v√©rifie chaque transaction pour les doubles d√©penses. Apr√®s chaque transaction, la pi√®ce doit √™tre retourn√©e √† l&#8217;h√¥tel de la monnaie pour √©mettre une nouvelle pi√®ce, et seules les pi√®ces √©mises directement par l&#8217;h√¥tel de la monnaie sont r√©put√©es ne pas √™tre d√©pens√©es en double. Le probl√®me avec cette solution est que le sort de l&#8217;ensemble du syst√®me mon√©taire d√©pend de la soci√©t√© qui g√®re la monnaie, chaque transaction devant passer par elle, tout comme une banque.</p>
</div>
<div class="paragraph data-line-32">
<p>Nous avons besoin d&#8217;un moyen pour que le b√©n√©ficiaire sache que les propri√©taires pr√©c√©dents n&#8217;ont sign√© aucune transaction ant√©rieure. Pour nos besoins, la premi√®re transaction est celle qui compte, donc nous ne nous soucions pas des tentatives ult√©rieures de doubler les d√©penses. La seule fa√ßon de confirmer l&#8217;absence d&#8217;une transaction est d&#8217;√™tre au courant de toutes les transactions. Dans le mod√®le bas√© sur la monnaie, la monnaie √©tait au courant de toutes les transactions et d√©cidait laquelle arrivait en premier. Pour y parvenir sans partie de confiance, les transactions doivent √™tre annonc√©es publiquement [1], et nous avons besoin d&#8217;un syst√®me permettant aux participants de s&#8217;entendre sur un historique unique de l&#8217;ordre dans lequel elles ont √©t√© re√ßues. Le b√©n√©ficiaire doit avoir la preuve qu&#8217;au moment de chaque transaction, la majorit√© des n≈ìuds ont convenu qu&#8217;il s&#8217;agissait du premier re√ßu.</p>
</div>
</div>
<div class="sect3 data-line-34">
<h4 id="_serveur_dhorodatage">Serveur d&#8217;horodatage</h4>
<div class="paragraph data-line-35">
<p>La solution que nous proposons commence par un serveur d&#8217;horodatage. Un serveur d&#8217;horodatage fonctionne en prenant un hachage d&#8217;un bloc d&#8217;√©l√©ments √† horodater et en publiant largement le hachage, comme dans un journal ou une publication Usenet [2-5]. L&#8217;horodatage prouve que les donn√©es doivent avoir exist√© √† l&#8217;√©poque, √©videmment, pour entrer dans le hachage. Chaque horodatage inclut l&#8217;horodatage pr√©c√©dent dans son hachage, formant une cha√Æne o√π chaque horodatage suppl√©mentaire renforce ceux qui le pr√©c√®dent.</p>
</div>
<div class="imageblock data-line-37">
<div class="content">
<img src="images/mbc2_abin02.png" alt="serveur d&#8217;horodatage">
</div>
</div>
</div>
<div class="sect3 data-line-39">
<h4 id="_proof_of_work_ou_preuve_de_travail">Proof-of-Work (ou Preuve de travail)</h4>
<div class="paragraph data-line-40">
<p>Pour impl√©menter un serveur d&#8217;horodatage distribu√© sur une base pair √† pair, nous devrons utiliser un syst√®me de preuve de travail similaire √† Hashcash d&#8217;Adam Back [6], plut√¥t que des articles de journaux ou Usenet. La preuve de travail implique la recherche d&#8217;une valeur qui, lorsqu&#8217;elle est hach√©e, comme avec SHA-256, le hachage commence par un certain nombre de bits z√©ro. Le travail moyen requis est exponentiel dans le nombre de bits z√©ro requis et peut √™tre v√©rifi√© en ex√©cutant un seul hachage. Pour notre r√©seau d&#8217;horodatage, nous impl√©mentons la preuve de travail en incr√©mentant un nonce dans le bloc jusqu&#8217;√† ce qu&#8217;une valeur soit trouv√©e qui donne au hachage du bloc les bits z√©ro requis. Une fois que l&#8217;effort CPU a √©t√© d√©pens√© pour satisfaire la preuve de travail, le bloc ne peut pas √™tre modifi√© sans refaire le travail. Comme les blocs ult√©rieurs sont encha√Æn√©s apr√®s celui-ci, le travail de modification du bloc comprendrait la refonte de tous les blocs apr√®s celui-ci.</p>
</div>
<div class="imageblock data-line-42">
<div class="content">
<img src="images/mbc2_abin03.png" alt="preuve de travail">
</div>
</div>
<div class="paragraph data-line-44">
<p>La preuve de travail r√©sout √©galement le probl√®me de la d√©termination de la repr√©sentation dans la prise de d√©cision √† la majorit√©. Si la majorit√© √©tait bas√©e sur une adresse IP, un vote, elle pourrait √™tre renvers√©e par toute personne capable d&#8217;allouer de nombreuses adresses IP. La preuve de travail est essentiellement un processeur, un vote. La d√©cision majoritaire est repr√©sent√©e par la cha√Æne la plus longue, qui a investi le plus grand effort de preuve de travail. Si la majorit√© de la puissance du processeur est contr√¥l√©e par des n≈ìuds honn√™tes, la cha√Æne honn√™te se d√©veloppera le plus rapidement et d√©passera toutes les cha√Ænes concurrentes. Pour modifier un bloc pass√©, un attaquant devrait refaire la preuve de travail du bloc et de tous les blocs qui le suivent, puis rattraper et d√©passer le travail des n≈ìuds honn√™tes. Nous montrerons plus tard que la probabilit√© qu&#8217;une attaque plus lente rattrape le syst√®me, diminue de mani√®re exponentielle √† mesure que des blocs ult√©rieurs sont ajout√©s.</p>
</div>
<div class="paragraph data-line-46">
<p>Pour compenser l&#8217;augmentation de la vitesse mat√©rielle et l&#8217;int√©r√™t variable pour l&#8217;ex√©cution des n≈ìuds au fil du temps, la difficult√© de la preuve de travail est d√©termin√©e par une moyenne mobile ciblant un nombre moyen de blocs par heure. S&#8217;ils sont g√©n√©r√©s trop rapidement, la difficult√© augmente.</p>
</div>
</div>
<div class="sect3 data-line-48">
<h4 id="_r√©seau">R√©seau</h4>
<div class="paragraph data-line-50">
<p>Les √©tapes pour ex√©cuter le r√©seau sont les suivantes¬†:</p>
</div>
<div class="olist arabic data-line-52">
<ol class="arabic">
<li class="data-line-52">
<p>Les nouvelles transactions sont diffus√©es √† tous les n≈ìuds.</p>
</li>
<li class="data-line-53">
<p>Chaque n≈ìud collecte les nouvelles transactions dans un bloc.</p>
</li>
<li class="data-line-54">
<p>Chaque n≈ìud travaille √† trouver une preuve de travail difficile pour son bloc.</p>
</li>
<li class="data-line-55">
<p>Lorsqu&#8217;un n≈ìud trouve une preuve de travail, il diffuse le bloc √† tous les n≈ìuds.</p>
</li>
<li class="data-line-56">
<p>Les n≈ìuds n&#8217;acceptent le bloc que si toutes les transactions qu&#8217;il contient sont valides et non d√©j√† d√©pens√©es.</p>
</li>
<li class="data-line-57">
<p>Les n≈ìuds expriment leur acceptation du bloc en travaillant √† la cr√©ation du bloc suivant dans la cha√Æne, en utilisant le hachage du bloc accept√© comme hachage pr√©c√©dent.</p>
</li>
</ol>
</div>
<div class="paragraph data-line-59">
<p>Les n≈ìuds consid√®rent toujours que la cha√Æne la plus longue est la bonne et continueront √† travailler pour l&#8217;√©tendre. Si deux n≈ìuds diffusent simultan√©ment des versions diff√©rentes du bloc suivant, certains n≈ìuds peuvent recevoir l&#8217;un ou l&#8217;autre en premier. Dans ce cas, ils travaillent sur la premi√®re branche qu&#8217;ils ont re√ßue, mais conservent l&#8217;autre branche au cas o√π elle deviendrait plus longue. L&#8217;√©galit√© sera rompue lorsque la prochaine preuve de travail sera trouv√©e et qu&#8217;une branche s&#8217;allongera¬†; les n≈ìuds qui travaillaient sur l&#8217;autre branche passeront alors √† la plus longue.</p>
</div>
<div class="paragraph data-line-61">
<p>Les diffusions de nouvelles transactions n&#8217;ont pas n√©cessairement besoin d&#8217;atteindre tous les n≈ìuds. Tant qu&#8217;ils atteignent de nombreux n≈ìuds, ils entreront dans un bloc avant longtemps. Les diffusions en bloc sont √©galement tol√©rantes aux messages abandonn√©s. Si un n≈ìud ne re√ßoit pas de bloc, il le demandera lorsqu&#8217;il recevra le bloc suivant et r√©alisera qu&#8217;il en a manqu√© un.</p>
</div>
</div>
<div class="sect3 data-line-63">
<h4 id="_incitatif">Incitatif</h4>
<div class="paragraph data-line-64">
<p>Par convention, la premi√®re transaction d&#8217;un bloc est une transaction sp√©ciale qui d√©marre une nouvelle pi√®ce appartenant au cr√©ateur du bloc. Cela ajoute une incitation pour les n≈ìuds √† prendre en charge le r√©seau et fournit un moyen de distribuer initialement les pi√®ces en circulation, car il n&#8217;y a pas d&#8217;autorit√© centrale pour les √©mettre. L&#8217;ajout r√©gulier d&#8217;une quantit√© constante de nouvelles pi√®ces est analogue aux mineurs d&#8217;or qui d√©pensent des ressources pour ajouter de l&#8217;or √† la circulation. Dans notre cas, c&#8217;est le temps CPU et l&#8217;√©lectricit√© qui sont d√©pens√©s.</p>
</div>
<div class="paragraph data-line-66">
<p>L&#8217;incitation peut √©galement √™tre financ√©e par des frais de transaction. Si la valeur de sortie d&#8217;une transaction est inf√©rieure √† sa valeur d&#8217;entr√©e, la diff√©rence est une commission de transaction qui s&#8217;ajoute √† la valeur incitative du bloc contenant la transaction. Une fois qu&#8217;un nombre pr√©d√©termin√© de pi√®ces est entr√© en circulation, l&#8217;incitation peut passer enti√®rement aux frais de transaction et √™tre totalement exempte d&#8217;inflation.</p>
</div>
<div class="paragraph data-line-68">
<p>L&#8217;incitation peut aider √† encourager les n≈ìuds √† rester honn√™tes. Si un attaquant cupide est capable d&#8217;assembler plus de puissance CPU que tous les n≈ìuds honn√™tes, il devrait choisir entre l&#8217;utiliser pour frauder les gens en volant leur paiements, ou l&#8217;utiliser pour g√©n√©rer de nouvelles pi√®ces. Il devrait trouver plus avantageux de jouer selon les r√®gles que de saper le syst√®me et la validit√© de sa propre richesse. De telles r√®gles le favorise avec plus de nouvelles pi√®ces plus que tout les n≈ìuds r√©unis.</p>
</div>
</div>
<div class="sect3 data-line-70">
<h4 id="_r√©cup√©ration_despace_disque">R√©cup√©ration d&#8217;espace disque</h4>
<p>Une fois que la derni√®re transaction d'une pi√®ce est enterr√©e sous suffisamment de blocs, les transactions pass√©es avant peuvent √™tre supprim√©es pour √©conomiser de l'espace disque. Pour faciliter cela sans casser le hachage du bloc, les transactions sont hach√©es dans un arbre Merkle <a href="#ref_seven">[7]</a> <a href="#ref_two">[2]</a> <a href="#ref_five">[5]</a> , avec seulement la racine incluse dans le hachage du bloc. Les vieux blocs peuvent ensuite √™tre compact√©s en √©crasant les branches de l'arbre. Les hachages int√©rieurs n'ont pas besoin d'√™tre stock√©s.</p>
<div class="imageblock data-line-76">
<div class="content">
<img src="images/mbc2_abin04.png" alt="disque">
</div>
</div>
<div class="paragraph data-line-78">
<p>Un en-t√™te de bloc sans transactions serait d&#8217;environ 80 octets. Si nous supposons que les blocs sont g√©n√©r√©s toutes les 10 minutes, <code>80 octets * 6 * 24 * 365 = 4,2 Mo</code> par an. Avec des syst√®mes informatiques se vendant g√©n√©ralement avec 2 Go de RAM √† partir de 2008 et la loi de Moore pr√©disant une croissance actuelle de 1,2 Go par an, le stockage ne devrait pas √™tre un probl√®me m√™me si les en-t√™tes de bloc doivent √™tre conserv√©s en m√©moire.</p>
</div>
</div>
<div class="sect3 data-line-80">
<h4 id="_v√©rification_de_paiement_simplifi√©e">V√©rification de paiement simplifi√©e</h4>
<div class="paragraph data-line-81">
<p>Il est possible de v√©rifier les paiements sans ex√©cuter un n≈ìud de r√©seau complet. Un utilisateur n&#8217;a besoin que de conserver une copie des en-t√™tes de bloc de la cha√Æne de preuve de travail la plus longue, qu&#8217;il peut obtenir en interrogeant les n≈ìuds du r√©seau jusqu&#8217;√† ce qu&#8217;il soit convaincu qu&#8217;il a la cha√Æne la plus longue, et d&#8217;obtenir la branche Merkle reliant la transaction au bloc dont il est horodat√©. Il ne peut pas v√©rifier la transaction par lui-m√™me, mais en la liant √† un endroit de la cha√Æne, il peut voir qu&#8217;un n≈ìud du r√©seau l&#8217;a accept√©e, et les blocs ajout√©s apr√®s confirment que le r√©seau l&#8217;a accept√©e aussi.</p>
</div>
<div class="imageblock data-line-83">
<div class="content">
<img src="images/mbc2_abin05.png" alt="spv">
</div>
</div>
<div class="paragraph data-line-85">
<p>Ainsi, la v√©rification est fiable tant que des n≈ìuds honn√™tes contr√¥lent le r√©seau, mais est plus vuln√©rable si le r√©seau est ma√Ætris√© par un attaquant. Alors que les n≈ìuds du r√©seau peuvent v√©rifier les transactions par eux-m√™mes, la m√©thode simplifi√©e peut √™tre tromp√©e par les transactions fabriqu√©es par un attaquant, tant que l&#8217;attaquant peut continuer √† ma√Ætriser le r√©seau. Une strat√©gie de protection contre cela consisterait √† accepter les alertes des n≈ìuds du r√©seau lorsqu&#8217;ils d√©tectent un bloc invalide, incitant le logiciel de l&#8217;utilisateur √† t√©l√©charger le bloc complet et les transactions alert√©es pour confirmer l&#8217;incoh√©rence. Les entreprises qui re√ßoivent des paiements fr√©quents voudront probablement toujours ex√©cuter leurs propres n≈ìuds pour une s√©curit√© plus ind√©pendante et une v√©rification plus rapide.</p>
</div>
</div>
<div class="sect3 data-line-87">
<h4 id="_combiner_et_diviser_la_valeur">Combiner et diviser la valeur</h4>
<div class="paragraph data-line-88">
<p>Bien qu&#8217;il soit possible de g√©rer les pi√®ces individuellement, il serait difficile d&#8217;effectuer une transaction distincte pour chaque centime d&#8217;un transfert. Pour permettre √† la valeur d&#8217;√™tre fractionn√©e et combin√©e, les transactions contiennent plusieurs entr√©es et sorties. Normalement, il y aura soit une seule entr√©e provenant d&#8217;une transaction pr√©c√©dente plus importante, soit plusieurs entr√©es combinant des montants plus petits, et au plus deux sorties¬†¬†: une pour le paiement et une renvoyant la monnaie, le cas √©ch√©ant, √† l&#8217;exp√©diteur.</p>
</div>
<div class="imageblock data-line-90">
<div class="content">
<img src="images/mbc2_abin06.png" alt="s√©parateur de combinaison">
</div>
</div>
<div class="paragraph data-line-92">
<p>Il convient de noter que la diffusion, o√π une transaction d√©pend de plusieurs transactions, et ces transactions d√©pendent de beaucoup d&#8217;autres, n&#8217;est pas un probl√®me ici. Il n&#8217;est jamais n√©cessaire d&#8217;extraire une copie autonome compl√®te de l&#8217;historique d&#8217;une transaction.</p>
</div>
</div>
<div class="sect3 data-line-94">
<h4 id="_confidentialit√©">Confidentialit√©</h4>
<div class="paragraph data-line-95">
<p>Le mod√®le bancaire traditionnel atteint un niveau de confidentialit√© en limitant l&#8217;acc√®s aux informations des parties concern√©es et au tierce partie de confiance. La n√©cessit√© d&#8217;annoncer publiquement toutes les transactions exclut cette m√©thode, mais la confidentialit√© peut toujours √™tre pr√©serv√©e en interrompant le flux d&#8217;informations √† un autre endroit¬†¬†: en gardant les cl√©s publiques anonymes. Le public peut voir que quelqu&#8217;un envoie un montant √† quelqu&#8217;un d&#8217;autre, mais sans information liant la transaction √† qui que ce soit. Ceci est similaire au niveau d&#8217;information publi√© par les bourses, o√π l&#8217;heure et la taille des transactions individuelles, la "bande", sont rendues publiques, mais sans dire qui √©taient les parties.</p>
</div>
<div class="imageblock data-line-97">
<div class="content">
<img src="images/mbc2_abin07.png" alt="vie priv√©e">
</div>
</div>
<div class="paragraph data-line-99">
<p>En tant que pare-feu suppl√©mentaire, une nouvelle paire de cl√©s doit √™tre utilis√©e pour chaque transaction afin d&#8217;√©viter qu&#8217;elles ne soient li√©es √† un propri√©taire commun. Certains liens sont encore in√©vitables avec les transactions multi-entr√©es, qui r√©v√®lent n√©cessairement que leurs entr√©es appartenaient au m√™me propri√©taire. Le risque est que si le propri√©taire d&#8217;une cl√© est r√©v√©l√©, la liaison pourrait r√©v√©ler d&#8217;autres transactions ayant appartenu au m√™me propri√©taire.</p>
</div>
</div>
<div class="sect3 data-line-101">
<h4 id="_calculs">Calculs</h4>
<div class="paragraph data-line-102">
<p>Nous consid√©rons le sc√©nario d&#8217;un attaquant essayant de g√©n√©rer une cha√Æne alternative plus rapidement que la cha√Æne honn√™te. M√™me si cela est accompli, cela n&#8217;ouvre pas le syst√®me √† des changements arbitraires, comme cr√©er de la valeur √† partir de rien ou prendre de l&#8217;argent qui n&#8217;a jamais appartenu √† l&#8217;attaquant. Les n≈ìuds n&#8217;accepteront pas une transaction invalide comme paiement, et les n≈ìuds honn√™tes n&#8217;accepteront jamais un bloc les contenant. Un attaquant ne peut essayer de modifier qu&#8217;une de ses propres transactions pour r√©cup√©rer l&#8217;argent qu&#8217;il a r√©cemment d√©pens√©.</p>
</div>
<div class="paragraph data-line-104">
<p>La course entre la cha√Æne honn√™te et une cha√Æne attaquante peut √™tre caract√©ris√©e comme une marche al√©atoire binomiale. L&#8217;√©v√©nement de succ√®s est la cha√Æne honn√™te prolong√©e d&#8217;un bloc, augmentant son avance de +1, et l&#8217;√©v√©nement d&#8217;√©chec est la cha√Æne de l&#8217;attaquant prolong√©e d&#8217;un bloc, r√©duisant l&#8217;√©cart de -1.</p>
</div>
<p>La probabilit√© qu'un attaquant rattrape un d√©ficit donn√© est analogue √† un probl√®me de la ruine du joueur (Gambler's Ruin). Supposons qu'un joueur avec un cr√©dit illimit√© commence avec un d√©ficit et joue potentiellement un nombre infini d'essais pour essayer d'atteindre le seuil de rentabilit√©. Nous pouvons calculer la probabilit√© qu'il atteigne jamais le seuil de rentabilit√©, ou qu'un attaquant rattrape jamais la cha√Æne honn√™te, comme suit <a href="#ref_eight">[8]</a>:</p>
<div class="paragraph data-line-110">
<p>p = probabilit√© qu&#8217;un n≈ìud honn√™te trouve le bloc suivant</p>
</div>
<div class="paragraph data-line-112">
<p>q = probabilit√© que l&#8217;attaquant trouve le bloc suivant</p>
</div>
<div class="paragraph data-line-114">
<p>q<sub>z</sub> = probabilit√© que l&#8217;attaquant rattrape jamais z blocs derri√®re</p>
</div>
<div class="imageblock data-line-116">
<div class="content">
<img src="images/mbc2_abin08.png" alt="eq1">
</div>
</div>
<div class="paragraph data-line-118">
<p>√âtant donn√© notre hypoth√®se que p &gt; q, la probabilit√© chute de fa√ßon exponentielle √† mesure que le nombre de blocs que l&#8217;attaquant doit rattraper augmente. Avec les chances contre lui, s&#8217;il n&#8217;a pas un coup de chance deavant d√®s le d√©but, ses chances deviennent infiniment petites √† mesure qu&#8217;il prend du retard.</p>
</div>
<div class="paragraph data-line-120">
<p>Nous consid√©rons maintenant combien de temps le destinataire d&#8217;une nouvelle transaction doit attendre avant d&#8217;√™tre suffisamment certain que l&#8217;exp√©diteur ne peut pas modifier la transaction. Nous supposons que l&#8217;exp√©diteur est un attaquant qui veut faire croire au destinataire qu&#8217;il l&#8217;a pay√© pendant un certain temps, puis le changer pour se rembourser apr√®s un certain temps. Le destinataire sera alert√© lorsque cela se produira, mais l&#8217;exp√©diteur esp√®re qu&#8217;il sera trop tard.</p>
</div>
<div class="paragraph data-line-122">
<p>Le r√©cepteur g√©n√®re une nouvelle paire de cl√©s et donne la cl√© publique √† l&#8217;exp√©diteur peu de temps avant la signature. Cela √©vite √† l&#8217;exp√©diteur de pr√©parer une cha√Æne de blocs √† l&#8217;avance en y travaillant continuellement jusqu&#8217;√† ce qu&#8217;il ait la chance d&#8217;aller assez loin, puis d&#8217;ex√©cuter la transaction √† ce moment-l√†. Une fois la transaction envoy√©e, l&#8217;exp√©diteur malhonn√™te commence √† travailler en secret sur une cha√Æne parall√®le contenant une version alternative de sa transaction.</p>
</div>
<div class="paragraph data-line-124">
<p>Le destinataire attend que la transaction ait √©t√© ajout√©e √† un bloc et que z blocs aient √©t√© li√©s apr√®s celle-ci. Il ne conna√Æt pas la progression exacte de l&#8217;attaquant, mais en supposant que les blocs honn√™tes ont pris le temps moyen attendu par bloc, la progression potentielle de l&#8217;attaquant sera une distribution de Poisson avec une valeur attendue¬†:</p>
</div>
<div class="imageblock data-line-126">
<div class="content">
<img src="images/mbc2_abin09.png" alt="eq2">
</div>
</div>
<div class="paragraph data-line-128">
<p>Pour obtenir la probabilit√© que l&#8217;attaquant puisse encore rattraper maintenant, nous multiplions la densit√© de Poisson pour chaque quantit√© de progr√®s qu&#8217;il aurait pu faire par la probabilit√© qu&#8217;il puisse rattraper √† partir de ce point¬†:</p>
</div>
<div class="imageblock data-line-130">
<div class="content">
<img src="images/mbc2_abin10.png" alt="eq3">
</div>
</div>
<div class="paragraph data-line-132">
<p>R√©organiser pour √©viter de faire la somme de la queue infinie de la distribution&#8230;&#8203;</p>
</div>
<div class="imageblock data-line-134">
<div class="content">
<img src="images/mbc2_abin11.png" alt="eq4">
</div>
</div>
<div class="paragraph data-line-136">
<p>Conversion en code C&#8230;&#8203;</p>
</div>
<div class="listingblock data-line-139">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">#include &lt;math.h&gt;
double AttackerSuccessProbability(double q, int z)
{
    double p = 1.0 - q;
    double lambda = z * (q / p);
    double sum = 1.0;
    int i, k;
    for (k = 0; k &lt;= z; k++)
    {
        double poisson = exp(-lambda);
        for (i = 1; i &lt;= k; i++)
            poisson *= lambda / i;
        sum -= poisson * (1 - pow(q / p, z - k));
    }
    return sum;
}</code></pre>
</div>
</div>
<div class="paragraph data-line-158">
<p>En ex√©cutant certains r√©sultats, nous pouvons voir la probabilit√© chuter de fa√ßon exponentielle avec z.</p>
</div>
<div class="listingblock data-line-159">
<div class="content">
<pre>q=0.1
z=0 P=1.0000000
z=1 P=0.2045873
z=2 P=0.0509779
z=3 P=0.0131722
z=4 P=0.0034552
z=5 P=0.0009137
z=6 P=0.0002428
z=7 P=0.0000647
z=8 P=0.0000173
z=9 P=0.0000046
z=10 P=0.0000012</pre>
</div>
</div>
<div class="listingblock data-line-173">
<div class="content">
<pre>q=0.3
z=0 P=1.0000000
z=5 P=0.1773523
z=10 P=0.0416605
z=15 P=0.0101008
z=20 P=0.0024804
z=25 P=0.0006132
z=30 P=0.0001522
z=35 P=0.0000379
z=40 P=0.0000095
z=45 P=0.0000024
z=50 P=0.0000006</pre>
</div>
</div>
<div class="paragraph data-line-187">
<p>R√©solution pour P inf√©rieur √† 0,1¬†%&#8230;&#8203;</p>
</div>
<div class="listingblock data-line-188">
<div class="content">
<pre>P &lt; 0.001
q=0.10 z=5
q=0.15 z=8
q=0.20 z=11
q=0.25 z=15
q=0.30 z=24
q=0.35 z=41
q=0.40 z=89
q=0.45 z=340</pre>
</div>
</div>
</div>
<div class="sect3 data-line-200">
<h4 id="_conclusion_3">Conclusion</h4>
<div class="paragraph data-line-201">
<p>Nous avons propos√© un syst√®me de transactions √©lectroniques sans reposer sur la confiance. Nous avons commenc√© avec le cadre habituel des pi√®ces fabriqu√©es √† partir de signatures num√©riques, qui offre un fort contr√¥le de propri√©t√©, mais qui est incomplet sans un moyen d&#8217;√©viter les doubles d√©penses. Pour r√©soudre ce probl√®me, nous avons propos√© un r√©seau pair √† pair utilisant la preuve de travail pour enregistrer un historique public des transactions qui devient rapidement impossible √† modifier par un attaquant si des n≈ìuds honn√™tes contr√¥lent la majorit√© de la puissance du processeur. Le r√©seau est robuste dans sa simplicit√© non structur√©e. Les n≈ìuds fonctionnent tous en m√™me temps avec peu de coordination. Ils n&#8217;ont pas besoin d&#8217;√™tre identifi√©s, car les messages ne sont pas achemin√©s vers un endroit particulier et ne doivent √™tre livr√©s que dans la mesure du possible. Les n≈ìuds peuvent quitter et rejoindre le r√©seau √† volont√©, acceptant la cha√Æne de preuve de travail comme preuve de ce qui s&#8217;est pass√© pendant leur absence. Ils votent avec leur puissance CPU, exprimant leur acceptation des blocs valides en travaillant √† les √©tendre et rejetant les blocs invalides en refusant de travailler dessus. Toutes les r√®gles et incitations n√©cessaires peuvent √™tre appliqu√©es avec ce m√©canisme de consensus.</p>
</div>
</div>
<div class="sect3 data-line-203">
<h4 id="_r√©f√©rences">R√©f√©rences</h4>
<p>
<span id="ref_one">[1]</span> W. Dai, "b-money," <a href="http://www.weidai.com/bmoney.txt"><em>http://www.weidai.com/bmoney.txt</em></a>, 1998.
</p>
<p>
<span id="ref_two">[2]</span> H. Massias, X.S. Avila, and J.-J. Quisquater, "Design of a secure timestamping service with minimal trust requirements," In 20th Symposium on Information Theory in the Benelux, May 1999.
</p>
<p>
<span id="ref_three">[3]</span> S. Haber, W.S. Stornetta, "How to time-stamp a digital document," In Journal of Cryptology, vol 3, no 2, pages 99-111, 1991.
</p>

<p>
<span id="ref_four">[4]</span> D. Bayer, S. Haber, W.S. Stornetta, "Improving the efficiency and reliability of digital time-stamping," In Sequences II¬†: Methods in Communication, Security and Computer Science, pages 329-334, 1993.
</p>

<p>
<span id="ref_five">[5]</span> S. Haber, W.S. Stornetta, "Secure names for bit-strings," In Proceedings of the 4th ACM Conference on Computer and Communications Security, pages 28-35, April 1997.
</p>

<p>
<span id="ref_six">[6]</span> A. Back, "Hashcash - a denial of service counter-measure," <a href="http://www.hashcash.org/papers/hashcash.pdf"><em>http://www.hashcash.org/papers/hashcash.pdf</em></a>, 2002.
</p>

<p>
<span id="ref_seven">[7]</span> R.C. Merkle, "Protocols for public key cryptosystems," In Proc. 1980 Symposium on Security and Privacy, IEEE Computer Society, pages 122-133, April 1980.
</p>

<p>
<span id="ref_eight">[8]</span> W. Feller, "An introduction to probability theory and its applications," 1957.
</p>
</div>
</div>
<div class="sect2 data-line-236">
<h3 id="_licence">Licence</h3>
<div class="paragraph data-line-238">
<p>Ce livre blanc a √©t√© publi√© en octobre 2008 par Satoshi Nakamoto. Il a ensuite √©t√© (2009) ajout√© comme documentation de support au logiciel bitcoin, qui porte la m√™me licence MIT. Il a √©t√© reproduit dans ce livre, sans modification autre que la mise en forme, selon les termes de la licence MIT¬†:</p>
</div>
<div class="paragraph data-line-240">
<p>The MIT License (MIT)
Copyright (c) 2008 Satoshi Nakamoto</p>
</div>
<div class="paragraph data-line-243">
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
</div>
<div class="paragraph data-line-245">
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
</div>
<div class="paragraph data-line-33">
<p>THE SOFTWARE IS PROVIDED "AS IS," WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-3">
<h2 id="tx_script_ops">Appendix B: Op√©rateurs, constantes et symboles du langage de script de transaction</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="admonitionblock note data-line-6">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-7">
<p>Tableaux et descriptions provenant de <a href="https://en.bitcoin.it/wiki/Script" class="undefined" data-href="https://en.bitcoin.it/wiki/Script">https://en.bitcoin.it/wiki/Script</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-10">
<p><a href="#tx_script_ops_table_pushdata">Pousser la valeur sur la pile</a> affiche les op√©rateurs pour pousser les valeurs sur la pile.</p>
</div>
<table id="tx_script_ops_table_pushdata" class="tableblock frame-all grid-all stretch data-line-15">
<caption class="title">Table 30. Pousser la valeur sur la pile</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_0 ou OP_FALSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un tableau vide est pouss√© sur la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 √† 75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01 √† 0x4b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Poussez les N octets suivants sur la pile, o√π N est compris entre 1 et 75 octets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_PUSHDATA1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">L&#8217;octet de script suivant contient N, poussez les N octets suivants sur la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_PUSHDATA2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Les deux octets de script suivants contiennent N, poussez les N octets suivants sur la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_PUSHDATA4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Les quatre octets de script suivants contiennent N, poussez les N octets suivants sur la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_1NEGATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4f</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Poussez la valeur "‚Äì1" sur la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_RESERVED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interruption - Transaction non valide √† moins qu&#8217;elle ne se trouve dans une clause OP_IF non ex√©cut√©e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_1 ou OP_TRUE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x51</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Poussez la valeur "1" sur la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_2 √† OP_16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x52 √† 0x60</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pour OP_N, poussez la valeur "N" sur la pile, par exemple, OP_2 pousse "2"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph pagebreak-before data-line-29">
<p><a href="#tx_script_ops_table_control">Contr√¥le de flux conditionnel</a> affiche les op√©rateurs de contr√¥le de flux conditionnel.</p>
</div>
<table id="tx_script_ops_table_control" class="tableblock frame-all grid-all stretch data-line-34">
<caption class="title">Table 31. Contr√¥le de flux conditionnel</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NOP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ne fais rien</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_VER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x62</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrompt la transaction non valide √† moins qu&#8217;elle ne se trouve dans une clause OP_IF non ex√©cut√©e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_IF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x63</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ex√©cute les instructions suivantes si le haut de la pile n&#8217;est pas 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NOTIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ex√©cute les instructions suivantes si le haut de la pile est 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_VERIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x65</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrompt la transaction invalide</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_VERNOTIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x66</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrompt la transaction invalide</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_ELSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ex√©cuter uniquement si les instructions pr√©c√©dentes n&#8217;ont pas √©t√© ex√©cut√©es</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_ENDIF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x68</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminer le bloc OP_IF, OP_NOTIF, OP_ELSE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_VERIFY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x69</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V√©rifie le haut de la pile, arr√™te et invalide la transaction si elle n&#8217;est pas VRAIE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_RETURN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arr√™te et invalide la transaction</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-48">
<p><a href="#tx_script_ops_table_timelock">Op√©rations de verrou temporel</a> affiche les op√©rateurs utilis√©s pour les verrous temporels.</p>
</div>
<table id="tx_script_ops_table_timelock" class="tableblock frame-all grid-all stretch data-line-53">
<caption class="title">Table 32. Op√©rations de verrou temporel</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKLOCKTIMEVERIFY (pr√©c√©demment OP_NOP2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xb1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marque la transaction comme non valide si l&#8217;√©l√©ment sup√©rieur de la pile est sup√©rieur au champ nLockTime de la transaction, sinon l&#8217;√©valuation du script continue comme si un OP_NOP avait √©t√© ex√©cut√©. La transaction est √©galement invalide si 1. la pile est vide ; ou 2. l&#8217;√©l√©ment de la pile sup√©rieure est n√©gatif ; ou 3. l&#8217;√©l√©ment de la pile sup√©rieure est sup√©rieur ou √©gal √† 500000000 alors que le champ nLockTime de la transaction est inf√©rieur √† 500000000, ou vice versa¬†; ou 4. le champ nSequence de l&#8217;entr√©e est √©gal √† 0xffffffff. La s√©mantique pr√©cise est d√©crite dans la BIP-65</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKSEQUENCEVERIFY (pr√©c√©demment OP_NOP3)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xb2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marque la transaction comme non valide si le temps de verrouillage relatif de l&#8217;entr√©e (appliqu√© par BIP 0068 avec nSequence) n&#8217;est pas √©gal ou sup√©rieur √† la valeur de l&#8217;√©l√©ment de la pile sup√©rieure. La s√©mantique pr√©cise est d√©crite dans BIP-112</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-59">
<p><a href="#tx_script_ops_table_stack">Op√©rations de pile</a> montre les op√©rateurs utilis√©s pour manipuler la pile.</p>
</div>
<table id="tx_script_ops_table_stack" class="tableblock frame-all grid-all stretch data-line-64">
<caption class="title">Table 33. Op√©rations de pile</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_TOALTSTACK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extrait l&#8217;√©l√©ment sup√©rieur de la pile et le pousse vers une autre pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_FROMALTSTACK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extrait l&#8217;√©l√©ment sup√©rieur de la pile alternative et le pousse pour empiler</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_2DROP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extrait top deux √©l√©ments de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_2DUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dupliquer les deux √©l√©ments du haut de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_3DUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6f</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dupliquer les trois premiers √©l√©ments de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_2OVER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x70</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copie les troisi√®me et quatri√®me √©l√©ments de la pile vers le haut</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_2ROT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x71</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©place les cinqui√®me et sixi√®me √©l√©ments de la pile vers le haut</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_2SWAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x72</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">√âchange les deux paires d&#8217;objets dans la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_IFDUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x73</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplique l&#8217;√©l√©ment du haut de la pile s&#8217;il n&#8217;est pas 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_DEPTH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x74</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compte les √©l√©ments sur la pile et pousse le d√©compte r√©sultant</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_DROP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extrait l&#8217;√©l√©ment du haut de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_DUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x76</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplique l&#8217;√©l√©ment sup√©rieur de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x77</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extrait le deuxi√®me √©l√©ment de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_OVER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x78</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copie le deuxi√®me √©l√©ment de la pile et le pousse vers le haut</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_PICK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x79</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extrait la valeur N du haut, puis copie le Ni√®me √©l√©ment en haut de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_ROLL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extrait la valeur N du haut, puis d√©placer le Ni√®me √©l√©ment vers le haut de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_ROT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alterne les trois premiers √©l√©ments de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_SWAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">√âchange les deux premiers √©l√©ments de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_TUCK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copie l&#8217;√©l√©ment sup√©rieur et l&#8217;ins√®re entre l&#8217;√©l√©ment sup√©rieur et le deuxi√®me √©l√©ment</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-87">
<p><a href="#tx_script_ops_table_splice">Op√©rations d&#8217;√©pissure de cha√Ænes de caract√®re</a> affiche les op√©rateurs de cha√Æne.</p>
</div>
<table id="tx_script_ops_table_splice" class="tableblock frame-all grid-all stretch data-line-92">
<caption class="title">Table 34. Op√©rations d&#8217;√©pissure de cha√Ænes de caract√®re</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_CAT</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (concat√®ne les deux premiers √©l√©ments)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_SUBSTR</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7f</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (renvoie la sous-cha√Æne)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_LEFT</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (renvoie la sous-cha√Æne gauche)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_RIGHT</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x81</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (renvoie la sous-cha√Æne droite)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_SIZE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculer la longueur de la cha√Æne de l&#8217;√©l√©ment sup√©rieur et pousser le r√©sultat</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-101">
<p><a href="#tx_script_ops_table_binmath">Arithm√©tique binaire et conditionnelles</a> affiche les op√©rateurs logiques arithm√©tiques et bool√©ens binaires.</p>
</div>
<table id="tx_script_ops_table_binmath" class="tableblock frame-all grid-all stretch data-line-106">
<caption class="title">Table 35. Arithm√©tique binaire et conditionnelles</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_INVERT</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x83</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (Inverser les bits de l&#8217;√©l√©ment sup√©rieur)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_AND</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x84</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (bool√©en ET des deux premiers √©l√©ments)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_OR</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x85</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (OU bool√©en des deux √©l√©ments sup√©rieurs)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_XOR</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (XOR bool√©en des deux principaux √©l√©ments)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_EQUAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x87</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pousse TRUE (1) si les deux premiers √©l√©ments sont exactement √©gaux, pousse FALSE (0) sinon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_EQUALVERIFY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x88</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identique √† OP_EQUAL, mais ex√©cute OP_VERIFY apr√®s pour arr√™ter si ce n&#8217;est pas TRUE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_RESERVED1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x89</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interruption - Transaction non valide √† moins qu&#8217;elle ne se trouve dans une clause OP_IF non ex√©cut√©e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_RESERVED2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interruption - Transaction non valide √† moins qu&#8217;elle ne se trouve dans une clause OP_IF non ex√©cut√©e</p></td>
</tr>
</tbody>
</table>
<div class="paragraph pagebreak-before data-line-119">
<p><a href="#tx_script_ops_table_numbers">Op√©rateurs num√©riques</a> affiche les op√©rateurs num√©riques (arithm√©tiques).</p>
</div>
<table id="tx_script_ops_table_numbers" class="tableblock frame-all grid-all stretch data-line-124">
<caption class="title">Table 36. Op√©rateurs num√©riques</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_1ADD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ajouter 1 √† l&#8217;√©l√©ment au dessus de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_1SUB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Soustraire 1 de l&#8217;√©l√©ment au dessus de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_2MUL</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (multiplier l&#8217;√©l√©ment au dessus de la pile par 2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_2DIV</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (diviser l&#8217;√©l√©ment au dessus de la pile par 2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NEGATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8f</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inverse le signe de l&#8217;√©l√©ment au dessus de la pile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_ABS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x90</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change le signe de l&#8217;√©l√©ment au dessus de la pile en positif</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x91</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retourne l&#8217;√©l√©ment du dessus si l&#8217;√©l√©ment est 0 ou 1 bool√©en, sinon retourne 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_0NOTEQUAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x92</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Si l&#8217;√©l√©ment sup√©rieur est 0, renvoie 0, sinon renvoie 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_ADD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x93</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort les deux √©l√©ments au dessus de la pile, les additionnes et pousse le r√©sultat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_SUB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x94</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort les deux √©l√©ments au dessus de la pile, soustrait le premier du second et pousse le r√©sultat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_MUL</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x95</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (multiplie les deux premiers √©l√©ments)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_DIV</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x96</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (divise le deuxi√®me √©l√©ment par le premier √©l√©ment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_MOD</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x97</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (le reste divise le deuxi√®me √©l√©ment par le premier √©l√©ment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_LSHIFT</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x98</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (d√©cale le deuxi√®me √©l√©ment vers la gauche du nombre de bits du premier √©l√©ment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>OP_RSHIFT</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x99</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D√©sactiv√© (d√©cale le deuxi√®me √©l√©ment vers la droite du nombre de bits du premier √©l√©ment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_BOLAND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ET bool√©en des deux premiers √©l√©ments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_BOOLOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OU bool√©en des deux premiers √©l√©ments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NUMEQUAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie TRUE si les deux premiers √©l√©ments sont des nombres √©gaux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NUMEQUALVERIFY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identique √† NUMEQUAL, puis OP_VERIFY pour arr√™ter si ce n&#8217;est pas TRUE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NUMNOTEQUAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie TRUE si les deux premiers √©l√©ments ne sont pas des nombres √©gaux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_LESSTHAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9f</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie TRUE si le deuxi√®me √©l√©ment est inf√©rieur √† l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_GREATERTHAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie TRUE si le deuxi√®me √©l√©ment est sup√©rieur √† l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_LESSTHANOREQUAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie TRUE si le deuxi√®me √©l√©ment est inf√©rieur ou √©gal √† l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_GREATERTHANOREQUAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie TRUE si le deuxi√®me √©l√©ment est sup√©rieur ou √©gal √† l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_MIN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie le plus petit des deux premiers √©l√©ments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_MAX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie le plus grand des deux premiers √©l√©ments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_WITHIN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie TRUE si le troisi√®me √©l√©ment est compris entre le deuxi√®me √©l√©ment (ou √©gal) et le premier √©l√©ment</p></td>
</tr>
</tbody>
</table>
<div class="paragraph pagebreak-before data-line-156">
<p><a href="#tx_script_ops_table_crypto">Op√©rations cryptographiques et de hachage</a> affiche les op√©rateurs de fonction cryptographique.</p>
</div>
<table id="tx_script_ops_table_crypto" class="tableblock frame-all grid-all stretch data-line-161">
<caption class="title">Table 37. Op√©rations cryptographiques et de hachage</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_RIPEMD160</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoye le hachage RIPEMD160 de l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_SHA1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie le hachage SHA1 de l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_SHA256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie le hachage SHA256 de l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_HASH160</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xa9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie le hachage RIPEMD160(SHA256(x)) de l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_HASH256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xaa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Renvoie le hachage SHA256(SHA256(x)) de l&#8217;√©l√©ment sup√©rieur</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CODESEPARATOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marque le d√©but des donn√©es v√©rifi√©es par signature</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKSIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort une cl√© publique et une signature et valide la signature pour les donn√©es hach√©es de la transaction, renvoie TRUE si cela correspond</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKSIGNVERIFY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identique √† CHECKSIG, puis OP_VERIFY pour arr√™ter si ce n&#8217;est pas TRUE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKMULTISIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xae</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ex√©cute CHECKSIG pour chaque paire de signature et de cl√© publique fournie. Tous doivent correspondre. Un bogue dans la mise en ≈ìuvre affiche une valeur suppl√©mentaire, pr√©fix√©e par OP_0 comme solution de contournement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKMULTISIGVERIFY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xaf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identique √† CHECKMULTISIG, puis OP_VERIFY pour arr√™ter si ce n&#8217;est pas TRUE</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-175">
<p><a href="#tx_script_ops_table_nop">Non op√©rateurs</a> affiche les symboles non op√©rateur.</p>
</div>
<table id="tx_script_ops_table_nop" class="tableblock frame-all grid-all stretch data-line-180">
<caption class="title">Table 38. Non op√©rateurs</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_NOP1 √† OP_NOP10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xb0 √† 0xb9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ne fait rien, ignor√©</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-186">
<p><a href="#tx_script_ops_table_internal">Codes OP r√©serv√©s √† un usage interne par l&#8217;analyseur</a> affiche les codes op√©rateur r√©serv√©s √† l&#8217;analyseur de script interne.</p>
</div>
<table id="tx_script_ops_table_internal" class="tableblock frame-all grid-all stretch data-line-191">
<caption class="title">Table 39. Codes OP r√©serv√©s √† un usage interne par l&#8217;analyseur</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Valeur (hex)</th>
<th class="tableblock halign-left valign-top">La description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_SMALLDATA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repr√©sente un petit champ de donn√©es</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_SMALLINTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xfa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repr√©sente un petit champ de donn√©es entier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_PUBKEYS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xfb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repr√©sente les champs de cl√© publique</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_PUBKEYHASH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xfd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repr√©sente un champ de hachage de cl√© publique</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_PUBKEY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xfe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repr√©sente un champ de cl√© publique</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_INVALIDOPCODE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repr√©sente tout code OP non attribu√© actuellement</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1 data-line-3">
<h2 id="appdxbitcoinimpproposals">Appendix C: Bitcoin Improvement Proposals (ou Propositions d&#8217;am√©lioration du Bitcoin)</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-5">
<p>Les Bitcoin Improvement Proposals (ou Propositions d&#8217;am√©lioration du Bitcoin) sont des documents de conception fournissant des informations √† la communaut√© bitcoin ou d√©crivant une nouvelle fonctionnalit√© pour bitcoin ou ses processus ou son environnement.</p>
</div>
<div class="paragraph data-line-7">
<p>Conform√©ment √† BIP-01 <em>BIP Purpose and Guidelines</em>, il existe trois types de BIP¬†:</p>
</div>
<div class="dlist data-line-9">
<dl>
<dt class="hdlist1"><em>Standard</em> BIP</dt>
<dd>
<p>D√©crit tout changement qui affecte la plupart ou toutes les impl√©mentations de bitcoin, comme un changement du protocole r√©seau, un changement des r√®gles de validit√© de bloc ou de transaction, ou tout changement ou ajout qui affecte l&#8217;interop√©rabilit√© des applications utilisant bitcoin.</p>
</dd>
<dt class="hdlist1"><em>Informational</em> BIP</dt>
<dd>
<p>D√©crit un probl√®me de conception de bitcoin, ou fournit des directives g√©n√©rales ou des informations √† la communaut√© bitcoin, mais ne propose pas de nouvelle fonctionnalit√©. Les BIP informationnels ne repr√©sentent pas n√©cessairement un consensus ou une recommandation de la communaut√© bitcoin, de sorte que les utilisateurs et les impl√©menteurs peuvent ignorer les BIP informationnels ou suivre leurs conseils.</p>
</dd>
<dt class="hdlist1"><em>Process</em> BIP</dt>
<dd>
<p>D√©crit un processus bitcoin ou propose une modification (ou un √©v√©nement dans) un processus. Les BIP de processus ressemblent aux BIP standard mais s&#8217;appliquent √† des domaines autres que le protocole Bitcoin lui-m√™me. Ils pourraient proposer une impl√©mentation, mais pas √† la base de code de Bitcoin¬†; elles n√©cessitent souvent un consensus communautaire ; et contrairement aux BIP informatifs, ils sont plus que des recommandations, et les utilisateurs ne sont g√©n√©ralement pas libres de les ignorer. Les exemples incluent les proc√©dures, les directives, les modifications du processus de prise de d√©cision et les modifications des outils ou de l&#8217;environnement utilis√©s dans le d√©veloppement de Bitcoin. Tout m√©ta-BIP est √©galement consid√©r√© comme un processus BIP.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-13">
<p>Les BIP sont enregistr√©s dans un r√©f√©rentiel versionn√© sur GitHub¬†: <a href="https://github.com/bitcoin/bips" data-href="https://github.com/bitcoin/bips">https://github.com/bitcoin/bips</a>. <a href="#table_d-1">Liste des BIPs</a> montre un instantan√© des BIP en avril 2017. Consultez le r√©f√©rentiel faisant autorit√© pour obtenir des informations √† jour sur les BIP existants et leur contenu.</p>
</div>
<table id="table_d-1" class="tableblock frame-all grid-all stretch data-line-18">
<caption class="title">Table 40. Liste des BIPs</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">BIP#</th>
<th class="tableblock halign-left valign-top">Titre</th>
<th class="tableblock halign-left valign-top">Propri√©taire</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Statut</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-1"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0001.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0001.mediawiki">BIP-1</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIP Purpose and Guidelines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amir Taaki</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remplac√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-2"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0002.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0002.mediawiki">BIP-2</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIP process, revised</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Actif</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-8"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0008.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0008.mediawiki">BIP-8</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version bits with guaranteed lock-in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shaolin Fry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-9"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki">BIP-9</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version bits with timeout and delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pieter Wuille, Peter Todd, Greg Maxwell, Rusty Russell</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-10"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0010.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0010.mediawiki">BIP-10</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multi-Sig Transaction Distribution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alan Reiner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retir√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-11"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0011.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0011.mediawiki">BIP-11</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M-of-N Standard Transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-12"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0012.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0012.mediawiki">BIP-12</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_EVAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retir√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-13"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0013.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0013.mediawiki">BIP-13</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address Format for pay-to-script-hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-14"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0014.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0014.mediawiki">BIP-14</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protocol Version and User Agent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amir Taaki, Patrick Strateman</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-15"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0015.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0015.mediawiki">BIP-15</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amir Taaki</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diff√©r√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-16"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0016.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0016.mediawiki">BIP-16</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pay to Script Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-17"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0017.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0017.mediawiki">BIP-17</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKHASHVERIFY (CHV)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retir√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-18"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0018.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0018.mediawiki">BIP-18</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hashScriptCheck</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-19"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0019.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0019.mediawiki">BIP-19</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M-of-N Standard Transactions (Low SigOp)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-20"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0020.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0020.mediawiki">BIP-20</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI Scheme</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remplac√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-21"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0021.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0021.mediawiki">BIP-21</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI Scheme</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nils Schneider, Matt Corallo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-22"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0022.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0022.mediawiki">BIP-22</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getblocktemplate - Fundamentals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-23"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0023.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0023.mediawiki">BIP-23</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getblocktemplate - Pooled Mining</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-30"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0030.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0030.mediawiki">BIP-30</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplicate transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-31"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0031.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0031.mediawiki">BIP-31</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pong message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mike Hearn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-32"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki">BIP-32</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hierarchical Deterministic Wallets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-33"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0033.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0033.mediawiki">BIP-33</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stratized Nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amir Taaki</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-34"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki">BIP-34</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Block v2, Height in Coinbase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-35"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0035.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0035.mediawiki">BIP-35</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mempool message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jeff Garzik</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-36"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0036.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0036.mediawiki">BIP-36</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom Services</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stefan Thomas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-37"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki">BIP-37</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection Bloom filtering</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mike Hearn, Matt Corallo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-39"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki">BIP-39</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mnemonic code for generating deterministic keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marek Palatinus, Pavol Rusnak, Aaron Voisine, Sean Bowe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-40"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0040.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0040.mediawiki">BIP-40</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stratum wire protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marek Palatinus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre BIP attribu√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-41"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0041.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0041.mediawiki">BIP-41</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stratum mining protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marek Palatinus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre BIP attribu√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-42"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0042.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0042.mediawiki">BIP-42</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A finite monetary supply for Bitcoin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-43"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki">BIP-43</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Purpose Field for Deterministic Wallets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marek Palatinus, Pavol Rusnak</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-44"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki">BIP-44</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multi-Account Hierarchy for Deterministic Wallets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marek Palatinus, Pavol Rusnak</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-45"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0045.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0045.mediawiki">BIP-45</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structure for Deterministic P2SH Multisignature Wallets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manuel Araoz, Ryan X. Charles, Matias Alejo Garcia</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-47"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0047.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0047.mediawiki">BIP-47</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusable Payment Codes for Hierarchical Deterministic Wallets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Justus Ranvier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-49"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0049.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0049.mediawiki">BIP-49</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Derivation scheme for P2WPKH-nested-in-P2SH based accounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daniel Weigl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-50"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0050.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0050.mediawiki">BIP-50</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">March 2013 Chain Fork Post-Mortem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-60"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0060.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0060.mediawiki">BIP-60</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed Length "version" Message (Relay-Transactions Field)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amir Taaki</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-61"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0061.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0061.mediawiki">BIP-61</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reject P2P message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-62"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0062.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0062.mediawiki">BIP-62</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dealing with malleability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retir√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-63"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0063.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0063.mediawiki">BIP-63</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stealth Addresses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Peter Todd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre BIP attribu√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-64"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0064.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0064.mediawiki">BIP-64</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getutxo message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mike Hearn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-65"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP-65</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OP_CHECKLOCKTIMEVERIFY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Peter Todd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-66"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0066.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0066.mediawiki">BIP-66</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strict DER signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-67"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0067.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0067.mediawiki">BIP-67</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deterministic Pay-to-script-hash multi-signature addresses through public key sorting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thomas Kerin, Jean-Pierre Rupp, Ruben de Vries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-68"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki">BIP-68</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative lock-time using consensus-enforced sequence numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark Friedenbach, BtcDrak, Nicolas Dorier, kinoshitajona</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-69"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0069.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0069.mediawiki">BIP-69</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lexicographical Indexing of Transaction Inputs and Outputs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kristov Atlas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-70"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki">BIP-70</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Payment Protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen, Mike Hearn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-71"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0071.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0071.mediawiki">BIP-71</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Payment Protocol MIME types</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-72"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0072.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0072.mediawiki">BIP-72</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bitcoin: uri extensions for Payment Protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-73"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0073.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0073.mediawiki">BIP-73</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use "Accept" header for response type negotiation with Payment Request URLs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stephen Pair</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-74"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0074.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0074.mediawiki">BIP-74</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow zero value OP_RETURN in Payment Protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Toby Padilla</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-75"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0075.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0075.mediawiki">BIP-75</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Out of Band Address Exchange using Payment Protocol Encryption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Justin Newton, Matt David, Aaron Voisine, James MacWhyte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-80"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0080.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0080.mediawiki">BIP-80</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hierarchy for Non-Colored Voting Pool Deterministic Multisig Wallets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Justus Ranvier, Jimmy Song</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diff√©r√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-81"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0081.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0081.mediawiki">BIP-81</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hierarchy for Colored Voting Pool Deterministic Multisig Wallets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Justus Ranvier, Jimmy Song</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diff√©r√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-83"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0083.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0083.mediawiki">BIP-83</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dynamic Hierarchical Deterministic Key Trees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eric Lombrozo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-90"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0090.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0090.mediawiki">BIP-90</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Buried Deployments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Suhas Daftuar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-99"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0099.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0099.mediawiki">BIP-99</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Motivation and deployment of consensus rule changes ([soft/hard]forks)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jorge Tim√≥n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-101"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0101.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0101.mediawiki">BIP-101</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Increase maximum block size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retir√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-102"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0102.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0102.mediawiki">BIP-102</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Block size increase to 2MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jeff Garzik</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-103"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0103.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0103.mediawiki">BIP-103</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Block size following technological growth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-104"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0104.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0104.mediawiki">BIP-104</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Block75' - Max block size like difficulty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">t.khan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-105"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0105.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0105.mediawiki">BIP-105</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consensus based block size retargeting algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BtcDrak</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-106"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0106.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0106.mediawiki">BIP-106</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dynamically Controlled Bitcoin Block Size Max Cap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upal Chakraborty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-107"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0107.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0107.mediawiki">BIP-107</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dynamic limit on the block size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Washington Y. Sanchez</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-109"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0109.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0109.mediawiki">BIP-109</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Two million byte size limit with sigop and sighash limits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gavin Andresen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rejet√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-111"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0111.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0111.mediawiki">BIP-111</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NODE_BLOOM service bit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Matt Corallo, Peter Todd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-112"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki">BIP-112</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECKSEQUENCEVERIFY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BtcDrak, Mark Friedenbach, Eric Lombrozo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-113"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki">BIP-113</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Median time-past as endpoint for lock-time calculations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thomas Kerin, Mark Friedenbach</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-114"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0114.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0114.mediawiki">BIP-114</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Merkelized Abstract Syntax Tree</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Johnson Lau</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-120"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0120.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0120.mediawiki">BIP-120</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Proof of Payment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kalle Rosenbaum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-121"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0121.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0121.mediawiki">BIP-121</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Proof of Payment URI scheme</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kalle Rosenbaum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-122"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0122.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0122.mediawiki">BIP-122</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI scheme for Blockchain references / exploration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marco Pontello</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-123"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0123.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0123.mediawiki">BIP-123</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIP Classification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eric Lombrozo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Actif</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-124"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0124.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0124.mediawiki">BIP-124</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hierarchical Deterministic Script Templates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eric Lombrozo, William Swanson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-125"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki">BIP-125</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Opt-in Full Replace-by-Fee Signaling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">David A. Harding, Peter Todd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-126"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0126.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0126.mediawiki">BIP-126</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Best Practices for Heterogeneous Input Script Transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kristov Atlas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-130"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0130.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0130.mediawiki">BIP-130</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sendheaders message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Suhas Daftuar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Propos√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-131"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0131.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0131.mediawiki">BIP-131</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Coalescing Transaction" Specification (wildcard inputs)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chris Priest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-132"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0132.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0132.mediawiki">BIP-132</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Committee-based BIP Acceptance Process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Andy Chase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retir√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-133"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0133.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0133.mediawiki">BIP-133</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">feefilter message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alex Morcos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-134"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0134.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0134.mediawiki">BIP-134</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flexible Transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tom Zander</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-140"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0140.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0140.mediawiki">BIP-140</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Normalized TXID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Christian Decker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-141"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki">BIP-141</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Segregated Witness (Consensus layer)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eric Lombrozo, Johnson Lau, Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-142"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0142.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0142.mediawiki">BIP-142</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address Format for Segregated Witness</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Johnson Lau</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diff√©r√©</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-143"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0143.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0143.mediawiki">BIP-143</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Signature Verification for Version 0 Witness Program</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Johnson Lau, Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-144"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki">BIP-144</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Segregated Witness (Peer Services)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eric Lombrozo, Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-145"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0145.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0145.mediawiki">BIP-145</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getblocktemplate Updates for Segregated Witness</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-146"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0146.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0146.mediawiki">BIP-146</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dealing with signature encoding malleability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Johnson Lau, Pieter Wuille</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-147"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki">BIP-147</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dealing with dummy stack element malleability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Johnson Lau</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-148"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0148.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0148.mediawiki">BIP-148</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory activation of segwit deployment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shaolin Fry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-150"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0150.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0150.mediawiki">BIP-150</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Peer Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jonas Schnelli</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-151"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki">BIP-151</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Peer-to-Peer Communication Encryption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jonas Schnelli</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-152"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki">BIP-152</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compact Block Relay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Matt Corallo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-171"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0171.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0171.mediawiki">BIP-171</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Currency/exchange rate information API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-180"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0180.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0180.mediawiki">BIP-180</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Block size/weight fraud proof</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Luke Dashjr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="bip-199"></a><a href="https://github.com/bitcoin/bips/blob/master/bip-0199.mediawiki" data-href="https://github.com/bitcoin/bips/blob/master/bip-0199.mediawiki">BIP-199</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hashed Time-Locked Contract transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sean Bowe, Daira Hopwood</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brouillon</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1 data-line-4">
<h2 id="appdx_bitcore">Appendix D: Bitcore</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-7">
<p>Bitcore est une suite d&#8217;outils fournis par BitPay. Son objectif est de fournir des outils faciles √† utiliser pour les d√©veloppeurs Bitcoin. Presque tout le code de Bitcore est √©crit en JavaScript. Il existe des modules √©crits sp√©cifiquement pour NodeJS. Enfin, le module "node" de Bitcore inclut le code C++ de Bitcoin Core. Veuillez consulter <a href="https://bitcore.io" class="undefined" data-href="https://bitcore.io">https://bitcore.io</a> pour plus d&#8217;informations.</p>
</div>
<div class="sect2 data-line-9">
<h3 id="_liste_des_fonctionnalit√©s_de_bitcore">Liste des fonctionnalit√©s de Bitcore</h3>
<div class="ulist data-line-11">
<ul>
<li class="data-line-11">
<p>N≈ìud complet Bitcoin (n≈ìud bitcore)</p>
</li>
<li class="data-line-12">
<p>Explorateur de blocs (aper√ßu)</p>
</li>
<li class="data-line-13">
<p>Utilitaires de bloc, de transaction et de portefeuille (bitcore-lib)</p>
</li>
<li class="data-line-14">
<p>Communiquer directement avec le r√©seau P2P de Bitcoin (bitcore-p2p)</p>
</li>
<li class="data-line-15">
<p>G√©n√©ration mn√©monique d&#8217;entropie de valeur d&#8217;amor√ßage (bitcore-mn√©monique)</p>
</li>
<li class="data-line-16">
<p>Protocole de paiement (bitcore-payment-protocol)</p>
</li>
<li class="data-line-17">
<p>V√©rification et signature des messages (bitcore-message)</p>
</li>
<li class="data-line-18">
<p>Sch√©ma de chiffrement int√©gr√© √† courbe elliptique (bitcore-ecies)</p>
</li>
<li class="data-line-19">
<p>Service de portefeuille (bitcore-wallet-service)</p>
</li>
<li class="data-line-20">
<p>Client de portefeuille (bitcore-wallet-client)</p>
</li>
<li class="data-line-21">
<p>Int√©gration des services directement avec Bitcoin Core (bitcore-node)</p>
</li>
</ul>
</div>
</div>
<div class="sect2 data-line-23">
<h3 id="_exemples_de_biblioth√®que_bitcore">Exemples de biblioth√®que Bitcore</h3>
<div class="sect3 data-line-25">
<h4 id="_pr√©requis">Pr√©requis</h4>
<div class="ulist data-line-27">
<ul>
<li class="data-line-27">
<p>NodeJS &gt;= 4.x</p>
</li>
</ul>
</div>
<div class="paragraph data-line-29">
<p>Si vous utilisez NodeJS et le n≈ìud REPL¬†:</p>
</div>
<div class="listingblock data-line-32">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ npm install -g bitcore-lib bitcore-p2p</code></pre>
</div>
</div>
</div>
<div class="sect3 data-line-36">
<h4 id="_exemples_de_portefeuille_utilisant_bitcore_lib">Exemples de portefeuille utilisant bitcore-lib</h4>
<div class="paragraph data-line-38">
<p>Cr√©ation d&#8217;une nouvelle adresse Bitcoin avec cl√© priv√©e associ√©e¬†:</p>
</div>
<div class="listingblock data-line-40">
<div class="content">
<pre>&gt; bitcore = require('bitcore-lib')
&gt; privateKey = new bitcore.PrivateKey()
&gt; address = privateKey.toAddress().toString()</pre>
</div>
</div>
<div class="paragraph data-line-46">
<p>Cr√©ation d&#8217;une cl√© priv√©e d√©terministe hi√©rarchique et d&#8217;une adresse¬†:</p>
</div>
<div class="listingblock data-line-48">
<div class="content">
<pre>&gt; hdPrivateKey = bitcore.HDPrivateKey()
&gt; hdPublicKey = bitcore.HDPublicKey(hdPrivateKey)
&gt; hdAddress = new bitcore.Address(hdPublicKey.publicKey).toString()</pre>
</div>
</div>
<div class="paragraph data-line-54">
<p>Cr√©ation et signature d&#8217;une transaction depuis un UTXO¬†:</p>
</div>
<div class="listingblock data-line-56">
<div class="content">
<pre>&gt; utxo = {
txId: txId, // identifiant de transaction contenant une sortie non d√©pens√©e
outputIndex: outputIndex, // index de sortie (par exemple 0)
  address: addressOfUtxo,
  script: bitcore.Script.buildPublicKeyHashOut(addressOfUtxo).toString(),
satoshis: satoshis // montant envoy√© √† l'adresse
}
&gt; fee = 3000 //d√©fini de mani√®re appropri√©e pour les conditions sur le r√©seau
&gt; tx = new bitcore.Transaction()
        .from(utxo)
        .to(address, 35000)
        .fee(fee)
        .enableRBF()
        .sign(privateKeyOfUtxo)</pre>
</div>
</div>
<div class="paragraph data-line-73">
<p>Remplacer la derni√®re transaction dans le mempool (replace-by-fee)¬†:</p>
</div>
<div class="listingblock data-line-75">
<div class="content">
<pre>&gt; rbfTx = new Transaction()
           .from(utxo)
           .to(address, 35000)
           .fee(fee*2)
           .enableRBF()
           .sign(privateKeyOfUtxo);
&gt; tx.serialize();
&gt; rbfTx.serialize();</pre>
</div>
</div>
<div class="paragraph data-line-86">
<p>Diffuser une transaction sur le r√©seau Bitcoin
(remarque¬†: ne diffusez que des transactions valides¬†; reportez-vous √† <a href="https://bitnodes.21.co/nodes" class="undefined" data-href="https://bitnodes.21.co/nodes">https://bitnodes.21.co/nodes</a> pour les h√¥tes homologues)¬†:</p>
</div>
<div class="olist arabic data-line-89">
<ol class="arabic">
<li class="data-line-89">
<p>Copiez le code ci-dessous dans un fichier appel√© <em>broadcast.js</em>.</p>
</li>
<li class="data-line-90">
<p>Les variables <code>tx</code> et <code>rbfTx</code> sont la sortie de <code>tx.serialize()</code> et rbfTx.serialize(), respectivement.</p>
</li>
<li class="data-line-91">
<p>Afin de remplacer par des frais, l&#8217;homologue doit prendre en charge l&#8217;option bitcoind <code>mempoolreplace</code> et la d√©finir sur 1.</p>
</li>
<li class="data-line-92">
<p>Ex√©cutez le n≈ìud de fichier <em>broadcast.js</em>¬†:</p>
</li>
</ol>
</div>
<div class="listingblock data-line-94">
<div class="content">
<pre>var p2p = require('bitcore-p2p');
var bitcore = require('bitcore-lib');
var tx = new bitcore.Transaction('output from serialize function');
var rbfTx = new bitcore.Transaction('output from serialize function');
var host = 'ip address'; //use valid peer listening on tcp 8333
var peer = new p2p.Peer({host: host});
var messages = new p2p.Messages();
peer.on('ready', function() {
  var txs = [messages.Transaction(tx), messages.Transaction(rbfTx)];
  var index = 0;
  var interval = setInterval(function() {
    peer.sendMessage(txs[index++]);
    console.log('tx: ' ` index ` ' sent');
    if (index === txs.length) {
      clearInterval(interval);
      console.log('disconnecting from peer: ' + host);
      peer.disconnect();
    }
  }, 2000);
});
peer.connect();</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-3">
<h2 id="appdx-pycoin">Appendix E: pycoin, ku et tx</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-6">
<p>La biblioth√®que Python <a href="https://github.com/richardkiss/pycoin" data-href="https://github.com/richardkiss/pycoin">pycoin</a>, initialement √©crite et maintenue par Richard Kiss, est une biblioth√®que bas√©e sur Python qui prend en charge la manipulation des cl√©s bitcoin et les transactions, m√™me en prenant en charge suffisamment le langage de script pour traiter correctement les transactions non standard.</p>
</div>
<div class="paragraph data-line-8">
<p>La biblioth√®que pycoin prend en charge Python 2 (2.7.x) et Python 3 (3.3 et versions ult√©rieures) et est livr√©e avec des utilitaires de ligne de commande pratiques, <code>ku</code> et tx.</p>
</div>
<div class="sect2 data-line-10">
<h3 id="_utilitaire_de_cl√©_ku">Utilitaire de cl√© (KU)</h3>
<div class="paragraph data-line-12">
<p>L&#8217;utilitaire de ligne de commande <code>ku</code> ("utilitaire de cl√©") est un utilitaire multi-usage pour manipuler les cl√©s. Il prend en charge les cl√©s BIP-32, le WIF et les adresses (bitcoin et alt coins). Voici quelques exemples.</p>
</div>
<div class="paragraph data-line-14">
<p>Cr√©ez une cl√© BIP-32 en utilisant les sources d&#8217;entropie par d√©faut de GPG et <em>/dev/random</em>¬†:</p>
</div>
<div class="listingblock data-line-17">
<div class="content">
<pre>$ ku create

input           : create
network         : Bitcoin
wallet key      : xprv9s21ZrQH143K3LU5ctPZTBnb9kTjA5Su9DcWHvXJemiJBsY7VqXUG7hipgdWaU
                    m2nhnzdvxJf5KJo9vjP2nABX65c5sFsWsV8oXcbpehtJi
public version  : xpub661MyMwAqRbcFpYYiuvZpKjKhnJDZYAkWSY76JvvD7FH4fsG3Nqiov2CfxzxY8
                    DGcpfT56AMFeo8M8KPkFMfLUtvwjwb6WPv8rY65L2q8Hz
tree depth      : 0
fingerprint     : 9d9c6092
parent f'print  : 00000000
child index     : 0
chain code      : 80574fb260edaa4905bc86c9a47d30c697c50047ed466c0d4a5167f6821e8f3c
private key     : yes
secret exponent : 112471538590155650688604752840386134637231974546906847202389294096567806844862
 hex            : f8a8a28b28a916e1043cc0aca52033a18a13cab1638d544006469bc171fddfbe
wif             : L5Z54xi6qJusQT42JHA44mfPVZGjyb4XBRWfxAzUWwRiGx1kV4sP
 uncompressed   : 5KhoEavGNNH4GHKoy2Ptu4KfdNp4r56L5B5un8FP6RZnbsz5Nmb
public pair x   : 76460638240546478364843397478278468101877117767873462127021560368290114016034
public pair y   : 59807879657469774102040120298272207730921291736633247737077406753676825777701
 x as hex       : a90b3008792432060fa04365941e09a8e4adf928bdbdb9dad41131274e379322
 y as hex       : 843a0f6ed9c0eb1962c74533795406914fe3f1957c5238951f4fe245a4fcd625
y parity        : odd
key pair as sec : 03a90b3008792432060fa04365941e09a8e4adf928bdbdb9dad41131274e379322
 uncompressed   : 04a90b3008792432060fa04365941e09a8e4adf928bdbdb9dad41131274e379322
                    843a0f6ed9c0eb1962c74533795406914fe3f1957c5238951f4fe245a4fcd625
hash160         : 9d9c609247174ae323acfc96c852753fe3c8819d
 uncompressed   : 8870d869800c9b91ce1eb460f4c60540f87c15d7
Bitcoin address : 1FNNRQ5fSv1wBi5gyfVBs2rkNheMGt86sp
 uncompressed   : 1DSS5isnH4FsVaLVjeVXewVSpfqktdiQAM</pre>
</div>
</div>
<div class="paragraph data-line-50">
<p>Cr√©ez une cl√© BIP-32 √† partir d&#8217;une phrase secr√®te¬†:</p>
</div>
<div class="admonitionblock warning data-line-53">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-54">
<p>La phrase secr√®te dans cet exemple est beaucoup trop facile √† deviner.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock data-line-57">
<div class="content">
<pre>$ ku P:foo

input           : P:foo
network         : Bitcoin
wallet key      : xprv9s21ZrQH143K31AgNK5pyVvW23gHnkBq2wh5aEk6g1s496M8ZMjxncCKZKgb5j
                    ZoY5eSJMJ2Vbyvi2hbmQnCuHBujZ2WXGTux1X2k9Krdtq
public version  : xpub661MyMwAqRbcFVF9ULcqLdsEa5WnCCugQAcgNd9iEMQ31tgH6u4DLQWoQayvtS
                    VYFvXz2vPPpbXE1qpjoUFidhjFj82pVShWu9curWmb2zy
tree depth      : 0
fingerprint     : 5d353a2e
parent f'print  : 00000000
child index     : 0
chain code      : 5eeb1023fd6dd1ae52a005ce0e73420821e1d90e08be980a85e9111fd7646bbc
private key     : yes
secret exponent : 65825730547097305716057160437970790220123864299761908948746835886007793998275
 hex            : 91880b0e3017ba586b735fe7d04f1790f3c46b818a2151fb2def5f14dd2fd9c3
wif             : L26c3H6jEPVSqAr1usXUp9qtQJw6NHgApq6Ls4ncyqtsvcq2MwKH
 uncompressed   : 5JvNzA5vXDoKYJdw8SwwLHxUxaWvn9mDea6k1vRPCX7KLUVWa7W
public pair x   : 81821982719381104061777349269130419024493616650993589394553404347774393168191
public pair y   : 58994218069605424278320703250689780154785099509277691723126325051200459038290
 x as hex       : b4e599dfa44555a4ed38bcfff0071d5af676a86abf123c5b4b4e8e67a0b0b13f
 y as hex       : 826d8b4d3010aea16ff4c1c1d3ae68541d9a04df54a2c48cc241c2983544de52
y parity        : even
key pair as sec : 02b4e599dfa44555a4ed38bcfff0071d5af676a86abf123c5b4b4e8e67a0b0b13f
 uncompressed   : 04b4e599dfa44555a4ed38bcfff0071d5af676a86abf123c5b4b4e8e67a0b0b13f
                    826d8b4d3010aea16ff4c1c1d3ae68541d9a04df54a2c48cc241c2983544de52
hash160         : 5d353a2ecdb262477172852d57a3f11de0c19286
 uncompressed   : e5bd3a7e6cb62b4c820e51200fb1c148d79e67da
Bitcoin address : 19Vqc8uLTfUonmxUEZac7fz1M5c5ZZbAii
 uncompressed   : 1MwkRkogzBRMehBntgcq2aJhXCXStJTXHT</pre>
</div>
</div>
<div class="paragraph data-line-91">
<p>Obtenir des informations au format JSON¬†:</p>
</div>
<div class="listingblock data-line-94">
<div class="content">
<pre>$ ku P:foo -P -j</pre>
</div>
</div>
<div class="listingblock data-line-98">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
   "y_parity": "even",
   "public_pair_y_hex": "826d8b4d3010aea16ff4c1c1d3ae68541d9a04df54a2c48cc241c2983544de52",
   "private_key": "no",
   "parent_fingerprint": "00000000",
   "tree_depth": "0",
   "network": "Bitcoin",
   "btc_address_uncompressed": "1MwkRkogzBRMehBntgcq2aJhXCXStJTXHT",
   "key_pair_as_sec_uncompressed": "04b4e599dfa44555a4ed38bcfff0071d5af676a86abf123c5b4b4e8e67a0b0b13f826d8b4d3010aea16ff4c1c1d3ae68541d9a04df54a2c48cc241c2983544de52",
   "public_pair_x_hex": "b4e599dfa44555a4ed38bcfff0071d5af676a86abf123c5b4b4e8e67a0b0b13f",
   "wallet_key": "xpub661MyMwAqRbcFVF9ULcqLdsEa5WnCCugQAcgNd9iEMQ31tgH6u4DLQWoQayvtSVYFvXz2vPPpbXE1qpjoUFidhjFj82pVShWu9curWmb2zy",
   "chain_code": "5eeb1023fd6dd1ae52a005ce0e73420821e1d90e08be980a85e9111fd7646bbc",
   "child_index": "0",
   "hash160_uncompressed": "e5bd3a7e6cb62b4c820e51200fb1c148d79e67da",
   "btc_address": "19Vqc8uLTfUonmxUEZac7fz1M5c5ZZbAii",
   "fingerprint": "5d353a2e",
   "hash160": "5d353a2ecdb262477172852d57a3f11de0c19286",
   "input": "P:foo",
   "public_pair_x": "81821982719381104061777349269130419024493616650993589394553404347774393168191",
   "public_pair_y": "58994218069605424278320703250689780154785099509277691723126325051200459038290",
   "key_pair_as_sec": "02b4e599dfa44555a4ed38bcfff0071d5af676a86abf123c5b4b4e8e67a0b0b13f"
}</code></pre>
</div>
</div>
<div class="paragraph data-line-123">
<p>Cl√© publique BIP32¬†:</p>
</div>
<div class="listingblock data-line-125">
<div class="content">
<pre>$ ku -w -P P:foo
xpub661MyMwAqRbcFVF9ULcqLdsEa5WnCCugQAcgNd9iEMQ31tgH6u4DLQWoQayvtSVYFvXz2vPPpbXE1qpjoUFidhjFj82pVShWu9curWmb2zy</pre>
</div>
</div>
<div class="paragraph data-line-130">
<p>G√©n√©rez une sous-cl√©¬†:</p>
</div>
<div class="listingblock data-line-132">
<div class="content">
<pre>$ ku -w -s3/2 P:foo
xprv9wTErTSkjVyJa1v4cUTFMFkWMe5eu8ErbQcs9xajnsUzCBT7ykHAwdrxvG3g3f6BFk7ms5hHBvmbdutNmyg6iogWKxx6mefEw4M8EroLgKj</pre>
</div>
</div>
<div class="paragraph data-line-137">
<p>Sous-cl√© renforc√©e¬†:</p>
</div>
<div class="listingblock data-line-139">
<div class="content">
<pre>$ ku -w -s3/2H P:foo
xprv9wTErTSu5AWGkDeUPmqBcbZWX1xq85ZNX9iQRQW9DXwygFp7iRGJo79dsVctcsCHsnZ3XU3DhsuaGZbDh8iDkBN45k67UKsJUXM1JfRCdn1</pre>
</div>
</div>
<div class="paragraph data-line-144">
<p>WIF:</p>
</div>
<div class="listingblock data-line-146">
<div class="content">
<pre>$ ku -W P:foo
L26c3H6jEPVSqAr1usXUp9qtQJw6NHgApq6Ls4ncyqtsvcq2MwKH</pre>
</div>
</div>
<div class="paragraph data-line-151">
<p>Adresse:</p>
</div>
<div class="listingblock data-line-154">
<div class="content">
<pre>$ ku -a P:foo
19Vqc8uLTfUonmxUEZac7fz1M5c5ZZbAii</pre>
</div>
</div>
<div class="paragraph data-line-161">
<p>G√©n√©rez un tas de sous-cl√©s¬†:</p>
</div>
<div class="listingblock data-line-164">
<div class="content">
<pre>$ ku P:foo -s 0/0-5 -w
xprv9xWkBDfyBXmZjBG9EiXBpy67KK72fphUp9utJokEBFtjsjiuKUUDF5V3TU8U8cDzytqYnSekc8bYuJS8G3bhXxKWB89Ggn2dzLcoJsuEdRK
xprv9xWkBDfyBXmZnzKf3bAGifK593gT7WJZPnYAmvc77gUQVej5QHckc5Adtwxa28ACmANi9XhCrRvtFqQcUxt8rUgFz3souMiDdWxJDZnQxzx
xprv9xWkBDfyBXmZqdXA8y4SWqfBdy71gSW9sjx9JpCiJEiBwSMQyRxan6srXUPBtj3PTxQFkZJAiwoUpmvtrxKZu4zfsnr3pqyy2vthpkwuoVq
xprv9xWkBDfyBXmZsA85GyWj9uYPyoQv826YAadKWMaaEosNrFBKgj2TqWuiWY3zuqxYGpHfv9cnGj5P7e8EskpzKL1Y8Gk9aX6QbryA5raK73p
xprv9xWkBDfyBXmZv2q3N66hhZ8DAcEnQDnXML1J62krJAcf7Xb1HJwuW2VMJQrCofY2jtFXdiEY8UsRNJfqK6DAdyZXoMvtaLHyWQx3FS4A9zw
xprv9xWkBDfyBXmZw4jEYXUHYc9fT25k9irP87n2RqfJ5bqbjKdT84Mm7Wtc2xmzFuKg7iYf7XFHKkSsaYKWKJbR54bnyAD9GzjUYbAYTtN4ruo</pre>
</div>
</div>
<div class="paragraph pagebreak-before data-line-175">
<p>G√©n√©rez les adresses correspondantes¬†:</p>
</div>
<div class="listingblock data-line-178">
<div class="content">
<pre>$ ku P:foo -s 0/0-5 -a
1MrjE78H1R1rqdFrmkjdHnPUdLCJALbv3x
1AnYyVEcuqeoVzH96zj1eYKwoWfwte2pxu
1GXr1kZfxE1FcK6ZRD5sqqqs5YfvuzA1Lb
116AXZc4bDVQrqmcinzu4aaPdrYqvuiBEK
1Cz2rTLjRM6pMnxPNrRKp9ZSvRtj5dDUML
1WstdwPnU6HEUPme1DQayN9nm6j7nDVEM</pre>
</div>
</div>
<div class="paragraph data-line-189">
<p>G√©n√©rez les WIF correspondants¬†:</p>
</div>
<div class="listingblock data-line-192">
<div class="content">
<pre>$ ku P:foo -s 0/0-5 -W
L5a4iE5k9gcJKGqX3FWmxzBYQc29PvZ6pgBaePLVqT5YByEnBomx
Kyjgne6GZwPGB6G6kJEhoPbmyjMP7D5d3zRbHVjwcq4iQXD9QqKQ
L4B3ygQxK6zH2NQGxLDee2H9v4Lvwg14cLJW7QwWPzCtKHdWMaQz
L2L2PZdorybUqkPjrmhem4Ax5EJvP7ijmxbNoQKnmTDMrqemY8UF
L2oD6vA4TUyqPF8QG4vhUFSgwCyuuvFZ3v8SKHYFDwkbM765Nrfd
KzChTbc3kZFxUSJ3Kt54cxsogeFAD9CCM4zGB22si8nfKcThQn8C</pre>
</div>
</div>
<div class="paragraph data-line-204">
<p>V√©rifiez que cela fonctionne en choisissant une cha√Æne BIP32 (celle correspondant √† la sous-cl√© 0/3) :</p>
</div>
<div class="listingblock data-line-208">
<div class="content">
<pre>$ ku -W xprv9xWkBDfyBXmZsA85GyWj9uYPyoQv826YAadKWMaaEosNrFBKgj2TqWuiWY3zuqxYGpHfv9cnGj5P7e8EskpzKL1Y8Gk9aX6QbryA5raK73p
L2L2PZdorybUqkPjrmhem4Ax5EJvP7ijmxbNoQKnmTDMrqemY8UF
$ ku -a xprv9xWkBDfyBXmZsA85GyWj9uYPyoQv826YAadKWMaaEosNrFBKgj2TqWuiWY3zuqxYGpHfv9cnGj5P7e8EskpzKL1Y8Gk9aX6QbryA5raK73p
116AXZc4bDVQrqmcinzu4aaPdrYqvuiBEK</pre>
</div>
</div>
<div class="paragraph data-line-216">
<p>Oui, √ßa a l&#8217;air familier.</p>
</div>
<div class="paragraph data-line-218">
<p>De l&#8217;exposant secret¬†:</p>
</div>
<div class="listingblock data-line-221">
<div class="content">
<pre>$ ku 1

input           : 1
network         : Bitcoin
secret exponent : 1
 hex            : 1
wif             : KwDiBf89QgGbjEhKnhXJuH7LrciVrZi3qYjgd9M7rFU73sVHnoWn
 uncompressed   : 5HpHagT65TZzG1PH3CSu63k8DbpvD8s5ip4nEB3kEsreAnchuDf
public pair x   : 55066263022277343669578718895168534326250603453777594175500187360389116729240
public pair y   : 32670510020758816978083085130507043184471273380659243275938904335757337482424
 x as hex       : 79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
 y as hex       : 483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8
y parity        : even
key pair as sec : 0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
 uncompressed   : 0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
                    483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8
hash160         : 751e76e8199196d454941c45d1b3a323f1433bd6
 uncompressed   : 91b24bf9f5288532960ac687abb035127b1d28a5
Bitcoin address : 1BgGZ9tcN4rm9KBzDn7KprQz87SZ26SAMH
 uncompressed   : 1EHNa6Q4Jz2uvNExL497mE43ikXhwF6kZm</pre>
</div>
</div>
<div class="paragraph data-line-245">
<p>Version Litecoin¬†:</p>
</div>
<div class="listingblock data-line-248">
<div class="content">
<pre>$ ku -nL 1

input            : 1
network          : Litecoin
secret exponent  : 1
 hex             : 1
wif              : T33ydQRKp4FCW5LCLLUB7deioUMoveiwekdwUwyfRDeGZm76aUjV
 uncompressed    : 6u823ozcyt2rjPH8Z2ErsSXJB5PPQwK7VVTwwN4mxLBFrao69XQ
public pair x    : 55066263022277343669578718895168534326250603453777594175500187360389116729240
public pair y    : 32670510020758816978083085130507043184471273380659243275938904335757337482424
 x as hex        : 79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
 y as hex        : 483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8
y parity         : even
key pair as sec  : 0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
 uncompressed    : 0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
                     483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8
hash160          : 751e76e8199196d454941c45d1b3a323f1433bd6
 uncompressed    : 91b24bf9f5288532960ac687abb035127b1d28a5
Litecoin address : LVuDpNCSSj6pQ7t9Pv6d6sUkLKoqDEVUnJ
 uncompressed    : LYWKqJhtPeGyBAw7WC8R3F7ovxtzAiubdM</pre>
</div>
</div>
<div class="paragraph data-line-272">
<p>Dogecoin WIF:</p>
</div>
<div class="listingblock data-line-275">
<div class="content">
<pre>$ ku -nD -W 1
QNcdLVw8fHkixm6NNyN6nVwxKek4u7qrioRbQmjxac5TVoTtZuot</pre>
</div>
</div>
<div class="paragraph data-line-281">
<p>Depuis la paire publique (sur Testnet)¬†:</p>
</div>
<div class="listingblock data-line-284">
<div class="content">
<pre>$ ku -nT 55066263022277343669578718895168534326250603453777594175500187360389116729240,even

input                   : 550662630222773436695787188951685343262506034537775941755001873603
                            89116729240,even
network                 : Bitcoin testnet
public pair x           : 55066263022277343669578718895168534326250603453777594175500187360389116729240
public pair y           : 32670510020758816978083085130507043184471273380659243275938904335757337482424
 x as hex               : 79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
 y as hex               : 483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8
y parity                : even
key pair as sec         : 0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
 uncompressed           : 0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798
                            483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8
hash160                 : 751e76e8199196d454941c45d1b3a323f1433bd6
 uncompressed           : 91b24bf9f5288532960ac687abb035127b1d28a5
Bitcoin testnet address : mrCDrCybB6J1vRfbwM5hemdJz73FwDBC8r
 uncompressed           : mtoKs9V381UAhUia3d7Vb9GNak8Qvmcsme</pre>
</div>
</div>
<div class="paragraph data-line-305">
<p>Depuis hash160¬†:</p>
</div>
<div class="listingblock data-line-308">
<div class="content">
<pre>$ ku 751e76e8199196d454941c45d1b3a323f1433bd6

input           : 751e76e8199196d454941c45d1b3a323f1433bd6
network         : Bitcoin
hash160         : 751e76e8199196d454941c45d1b3a323f1433bd6
Bitcoin address : 1BgGZ9tcN4rm9KBzDn7KprQz87SZ26SAMH</pre>
</div>
</div>
<div class="paragraph data-line-318">
<p>En tant qu&#8217;adresse Dogecoin¬†:</p>
</div>
<div class="listingblock data-line-321">
<div class="content">
<pre>$ ku -nD 751e76e8199196d454941c45d1b3a323f1433bd6

input            : 751e76e8199196d454941c45d1b3a323f1433bd6
network          : Dogecoin
hash160          : 751e76e8199196d454941c45d1b3a323f1433bd6
Dogecoin address : DFpN6QqFfUm3gKNaxN6tNcab1FArL9cZLE</pre>
</div>
</div>
<div class="sect3 data-line-330">
<h4 id="_utilitaire_de_transaction_tx">Utilitaire de transaction (TX)</h4>
<div class="paragraph data-line-332">
<p>
L&#8217;utilitaire de ligne de commande <code>tx</code> affichera les transactions sous une forme lisible par l&#8217;homme, r√©cup√©rera les transactions de base du cache de transactions de pycoin ou des services Web (blockchain.info, blockcypher.com, blockr.io et chain.so sont actuellement pris en charge), fusionnera les transactions , ajoutera ou supprimera des entr√©es ou des sorties et signera des transactions.</p>
</div>
<div class="paragraph data-line-335">
<p>Voici quelques exemples.</p>
</div>
<div class="paragraph data-line-338">
<p>Voir la fameuse transaction de "pizza":</p>
</div>
<div class="listingblock data-line-341">
<div class="content">
<pre>$ tx 49d2adb6e476fa46d8357babf78b1b501fd39e177ac7833124b3f67b17c40c2a
warning: consider setting environment variable PYCOIN_CACHE_DIR=~/.pycoin_cache to cache transactions fetched via web services
warning: no service providers found for get_tx; consider setting environment variable PYCOIN_BTC_PROVIDERS
usage: tx [-h] [-t TRANSACTION_VERSION] [-l LOCK_TIME] [-n NETWORK] [-a]
          [-i address] [-f path-to-private-keys] [-g GPG_ARGUMENT]
          [--remove-tx-in tx_in_index_to_delete]
          [--remove-tx-out tx_out_index_to_delete] [-F transaction-fee] [-u]
          [-b BITCOIND_URL] [-o path-to-output-file]
          argument [argument ...]
tx: error: can't find Tx with id 49d2adb6e476fa46d8357babf78b1b501fd39e177ac7833124b3f67b17c40c2a</pre>
</div>
</div>
<div class="paragraph data-line-355">
<p>Oups! Nous n&#8217;avons pas mis en place de services Web. Faisons cela maintenant¬†:</p>
</div>
<div class="listingblock data-line-359">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ PYCOIN_CACHE_DIR=~/.pycoin_cache
$ PYCOIN_BTC_PROVIDERS="block.io blockchain.info blockexplorer.com"
$ export PYCOIN_CACHE_DIR PYCOIN_BTC_PROVIDERS</code></pre>
</div>
</div>
<div class="paragraph data-line-366">
<p>Cela ne se fait pas automatiquement afin qu&#8217;un outil de ligne de commande ne divulgue pas d&#8217;informations potentiellement priv√©es sur les transactions qui vous int√©ressent sur un site Web tiers. Si vous ne vous en souciez pas, vous pouvez mettre ces lignes dans votre <em>.profile</em>.</p>
</div>
<div class="paragraph data-line-368">
<p>Essayons encore:</p>
</div>
<div class="listingblock data-line-370">
<div class="content">
<pre>$ tx 49d2adb6e476fa46d8357babf78b1b501fd39e177ac7833124b3f67b17c40c2a
Version:  1  tx hash 49d2adb6e476fa46d8357babf78b1b501fd39e177ac7833124b3f67b17c40c2a  159 bytes
TxIn count: 1; TxOut count: 1
Lock time: 0 (valid anytime)
Input:
  0:                          (unknown) from 1e133f7de73ac7d074e2746a3d6717dfc99ecaa8e9f9fade2cb8b0b20a5e0441:0
Output:
  0: 1CZDM6oTttND6WPdt3D6bydo7DYKzd9Qik receives 10000000.00000 mBTC
Total output 10000000.00000 mBTC
including unspents in hex dump since transaction not fully signed
010000000141045e0ab2b0b82cdefaf9e9a8ca9ec9df17673d6a74e274d0c73ae77d3f131e000000004a493046022100a7f26eda874931999c90f87f01ff1ffc76bcd058fe16137e0e63fdb6a35c2d78022100a61e9199238eb73f07c8f209504c84b80f03e30ed8169edd44f80ed17ddf451901ffffffff010010a5d4e80000001976a9147ec1003336542cae8bded8909cdd6b5e48ba0ab688ac00000000

** can't validate transaction as source transactions missing</pre>
</div>
</div>
<div class="paragraph data-line-386">
<p>La derni√®re ligne appara√Æt car pour valider les signatures des transactions, vous avez techniquement besoin des transactions sources. Ajoutons donc <code>-a</code> pour augmenter les transactions avec des informations sources¬†:</p>
</div>
<div class="listingblock data-line-388">
<div class="content">
<pre>$ tx -a 49d2adb6e476fa46d8357babf78b1b501fd39e177ac7833124b3f67b17c40c2a
warning: transaction fees recommendations casually calculated and estimates may be incorrect
warning: transaction fee lower than (casually calculated) expected value of 0.1 mBTC, transaction might not propagate
Version:  1  tx hash 49d2adb6e476fa46d8357babf78b1b501fd39e177ac7833124b3f67b17c40c2a  159 bytes
TxIn count: 1; TxOut count: 1
Lock time: 0 (valid anytime)
Input:
  0: 17WFx2GQZUmh6Up2NDNCEDk3deYomdNCfk from 1e133f7de73ac7d074e2746a3d6717dfc99ecaa8e9f9fade2cb8b0b20a5e0441:0 10000000.00000 mBTC  sig ok
Output:
  0: 1CZDM6oTttND6WPdt3D6bydo7DYKzd9Qik receives 10000000.00000 mBTC
Total input  10000000.00000 mBTC
Total output 10000000.00000 mBTC
Total fees        0.00000 mBTC

010000000141045e0ab2b0b82cdefaf9e9a8ca9ec9df17673d6a74e274d0c73ae77d3f131e000000004a493046022100a7f26eda874931999c90f87f01ff1ffc76bcd058fe16137e0e63fdb6a35c2d78022100a61e9199238eb73f07c8f209504c84b80f03e30ed8169edd44f80ed17ddf451901ffffffff010010a5d4e80000001976a9147ec1003336542cae8bded8909cdd6b5e48ba0ab688ac00000000

all incoming transaction values validated</pre>
</div>
</div>
<div class="paragraph data-line-408">
<p> Maintenant, regardons les sorties non d√©pens√©es pour une adresse sp√©cifique (UTXO). Dans le bloc #1, nous voyons une transaction coinbase vers 12c6DSiU4Rq3P4ZxziKxzrL5LmMBrzjrJX. Utilisons <code>fetch_unspent</code> pour trouver toutes les pi√®ces √† cette adresse¬†:</p>
</div>
<div class="listingblock data-line-410">
<div class="content">
<pre>$ fetch_unspent 12c6DSiU4Rq3P4ZxziKxzrL5LmMBrzjrJX
a3a6f902a51a2cbebede144e48a88c05e608c2cce28024041a5b9874013a1e2a/0/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/333000
cea36d008badf5c7866894b191d3239de9582d89b6b452b596f1f1b76347f8cb/31/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/10000
065ef6b1463f552f675622a5d1fd2c08d6324b4402049f68e767a719e2049e8d/86/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/10000
a66dddd42f9f2491d3c336ce5527d45cc5c2163aaed3158f81dc054447f447a2/0/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/10000
ffd901679de65d4398de90cefe68d2c3ef073c41f7e8dbec2fb5cd75fe71dfe7/0/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/100
d658ab87cc053b8dbcfd4aa2717fd23cc3edfe90ec75351fadd6a0f7993b461d/5/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/911
36ebe0ca3237002acb12e1474a3859bde0ac84b419ec4ae373e63363ebef731c/1/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/100000
fd87f9adebb17f4ebb1673da76ff48ad29e64b7afa02fda0f2c14e43d220fe24/0/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/1
dfdf0b375a987f17056e5e919ee6eadd87dad36c09c4016d4a03cea15e5c05e3/1/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/1337
cb2679bfd0a557b2dc0d8a6116822f3fcbe281ca3f3e18d3855aa7ea378fa373/0/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/1337
d6be34ccf6edddc3cf69842dce99fe503bf632ba2c2adb0f95c63f6706ae0c52/1/76a914119b098e2e980a229e139a9ed01a469e518e6f2688ac/2000000
    0e3e2357e806b6cdb1f70b54c3a3a17b6714ee1f0e68bebb44a74b1efd512098/0/410496b538e853519c726a2c91e61ec11600ae1390813a627c66fb8be7947be63c52da7589379515d4e0a604f8141781e62294721166bf621e73a82cbf2342c858eeac/5000000000</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-4">
<h2 id="appdx_bx">Appendix F: Commandes de l&#8217;explorateur Bitcoin (bx)</h2>
<div class="sectionbody">

<div style="margin:5% auto;">
    <a href="https://www.amazon.ca/dp/B09XRS3F2N" target="_newtab">
        <img src="../assets/MB2EO-SITE_AMAZON_BANNER-002.jpg" width="100%" alt="Banni√®re Amazon du livre Ma√Ætriser Ethereum" style="border-radius:10px;" />
    </a>
</div>
<div class="paragraph data-line-6">
<p>Bitcoin Explorer (bx) est un outil en ligne de commande qui offre une vari√©t√© de commandes pour la gestion des cl√©s et la construction de transactions. Il fait partie de la biblioth√®que Bitcoin libbitcoin.</p>
</div>
<div class="listingblock data-line-8">
<div class="content">
<pre>Usage: bx COMMAND [--help]

Info: The bx commands are:

address-decode
address-embed
address-encode
address-validate
base16-decode
base16-encode
base58-decode
base58-encode
base58check-decode
base58check-encode
base64-decode
base64-encode
bitcoin160
bitcoin256
btc-to-satoshi
ec-add
ec-add-secrets
ec-multiply
ec-multiply-secrets
ec-new
ec-to-address
ec-to-public
ec-to-wif
fetch-balance
fetch-header
fetch-height
fetch-history
fetch-stealth
fetch-tx
fetch-tx-index
hd-new
hd-private
hd-public
hd-to-address
hd-to-ec
hd-to-public
hd-to-wif
help
input-set
input-sign
input-validate
message-sign
message-validate
mnemonic-decode
mnemonic-encode
ripemd160
satoshi-to-btc
script-decode
script-encode
script-to-address
seed
send-tx
send-tx-node
send-tx-p2p
settings
sha160
sha256
sha512
stealth-decode
stealth-encode
stealth-public
stealth-secret
stealth-shared
tx-decode
tx-encode
uri-decode
uri-encode
validate-tx
watch-address
wif-to-ec
wif-to-public
wrap-decode
wrap-encode</pre>
</div>
</div>
<div class="paragraph data-line-88">
<p>Pour plus d&#8217;informations, consultez la <a href="https://github.com/libbitcoin/libbitcoin-explorer" data-href="https://github.com/libbitcoin/libbitcoin-explorer">page d&#8217;accueil Bitcoin Explorer</a> et <a href="https://github.com/libbitcoin/libbitcoin-explorer/wiki" data-href="https://github.com/libbitcoin/libbitcoin-explorer/wiki">guide d&#8217;usage Bitcoin Explorer</a>.</p>
</div>
<div class="sect2 data-line-90">
<h3 id="_exemples_dutilisation_de_la_commande_bx">Exemples d&#8217;utilisation de la commande bx</h3>
<div class="paragraph data-line-92">
<p>Regardons quelques exemples d&#8217;utilisation des commandes Bitcoin Explorer pour exp√©rimenter avec des cl√©s et des adresses.</p>
</div>
<div class="paragraph data-line-94">
<p>G√©n√©rez une "valeur d&#8217;amor√ßage" al√©atoire √† l&#8217;aide de la commande seed, qui utilise le g√©n√©rateur de nombres al√©atoires du syst√®me d&#8217;exploitation. Transmettez la valeur √† la commande <code>ec-new</code> pour g√©n√©rer une nouvelle cl√© priv√©e. Nous sauvegardons la sortie standard dans le fichier <em>private_key</em>¬†:</p>
</div>
<div class="listingblock data-line-96">
<div class="content">
<pre>$ bx seed | bx ec-new &gt; private_key
$ cat private_key
73096ed11ab9f1db6135857958ece7d73ea7c30862145bcc4bbc7649075de474</pre>
</div>
</div>
<div class="paragraph data-line-102">
<p>Maintenant, g√©n√©rez la cl√© publique √† partir de cette cl√© priv√©e √† l&#8217;aide de la commande ec-to-public. Nous passons le fichier <em>private_key</em> dans l&#8217;entr√©e standard et enregistrons la sortie standard de la commande dans un nouveau fichier <em>public_key</em> :</p>
</div>
<div class="listingblock data-line-104">
<div class="content">
<pre>$ bx ec-to-public &lt; private_key &gt; public_key
$ cat public_key
02fca46a6006a62dfdd2dbb2149359d0d97a04f430f12a7626dd409256c12be500</pre>
</div>
</div>
<div class="paragraph data-line-110">
<p>Nous pouvons reformater la <code>public_key</code> en tant qu&#8217;adresse √† l&#8217;aide de la commande ec-to-address. Nous passons le fichier <em>public_key</em> dans l&#8217;entr√©e standard¬†:</p>
</div>
<div class="listingblock data-line-112">
<div class="content">
<pre>$ bx ec-to-address &lt; public_key
17re1S4Q8ZHyCP8Kw7xQad1Lr6XUzWUnkG</pre>
</div>
</div>
<div class="paragraph data-line-117">
<p>Les cl√©s g√©n√©r√©es de cette mani√®re produisent un portefeuille non d√©terministe de type 0. Cela signifie que chaque cl√© est g√©n√©r√©e √† partir d&#8217;une valeur d&#8217;amor√ßage ind√©pendante. Les commandes de Bitcoin Explorer peuvent √©galement g√©n√©rer des cl√©s de mani√®re d√©terministe, conform√©ment au BIP-32. Dans ce cas, une cl√© "ma√Ætre" est cr√©√©e √† partir d&#8217;une valeur d&#8217;amor√ßage, puis √©tendue de mani√®re d√©terministe pour produire un arbre de sous-cl√©s, r√©sultant en un portefeuille d√©terministe de type 2.</p>
</div>
<div class="paragraph data-line-119">
<p>Tout d&#8217;abord, nous utilisons les commandes <code>seed</code> et <code>hd-new</code> pour g√©n√©rer une cl√© principale qui servira de base pour d√©river une hi√©rarchie de cl√©s¬†:</p>
</div>
<div class="listingblock data-line-121">
<div class="content">
<pre>$ bx seed &gt; seed
$ cat seed
eb68ee9f3df6bd4441a9feadec179ff1

$ bx hd-new &lt; seed &gt; master
$ cat master
xprv9s21ZrQH143K2BEhMYpNQoUvAgiEjArAVaZaCTgsaGe6LsAnwubeiTcDzd23mAoyizm9cApe51gNfLMkBqkYoWWMCRwzfuJk8RwF1SVEpAQ</pre>
</div>
</div>
<div class="paragraph data-line-131">
<p>Nous utilisons maintenant la commande <code>hd-private</code> pour g√©n√©rer une cl√© de "compte" renforc√©e et une s√©quence de deux cl√©s priv√©es au sein du compte¬†:</p>
</div>
<div class="listingblock data-line-133">
<div class="content">
<pre>$ bx hd-private --hard &lt; master &gt; account
$ cat account
xprv9vkDLt81dTKjwHB8fsVB5QK8cGnzveChzSrtCfvu3aMWvQaThp59ueufuyQ8Qi3qpjk4aKsbmbfxwcgS8PYbgoR2NWHeLyvg4DhoEE68A1n

$ bx hd-private --index 0 &lt; account
xprv9xHfb6w1vX9xgZyPNXVgAhPxSsEkeRcPHEUV5iJcVEsuUEACvR3NRY3fpGhcnBiDbvG4LgndirDsia1e9F3DWPkX7Tp1V1u97HKG1FJwUpU

$ bx hd-private --index 1 &lt; account
xprv9xHfb6w1vX9xjc8XbN4GN86jzNAZ6xHEqYxzbLB4fzHFd6VqCLPGRZFsdjsuMVERadbgDbziCRJru9n6tzEWrASVpEdrZrFidt1RDfn4yA3</pre>
</div>
</div>
<div class="paragraph data-line-145">
<p>Ensuite, nous utilisons la commande <code>hd-public</code> pour g√©n√©rer la s√©quence correspondante de deux cl√©s publiques¬†:</p>
</div>
<div class="listingblock data-line-147">
<div class="content">
<pre>$ bx hd-public --index 0 &lt; account
xpub6BH1zcTuktiFu43rUZ2gXqLgzu5F3tLEeTQ5t6iE3aQtM2VMTxMcyLN9fYHiGhGpQe9QQYmqL2eYPFJ3vezHz5wzaSW4FiGrseNDR4LKqTy

$ bx hd-public --index 1 &lt; account
xpub6BH1zcTuktiFx6CzhPbGjG3UYQ13WR16CmtbPiagEKpEVtpyjshWyMaMV1cn7nUPUkgQHPVXJVqsrA8xWbGQDhohEcDFTEYMvYzwRD7Juf8</pre>
</div>
</div>
<div class="paragraph data-line-155">
<p>Les cl√©s publiques peuvent √©galement √™tre d√©riv√©es de leurs cl√©s priv√©es correspondantes √† l&#8217;aide de la commande hd-to-public¬†:</p>
</div>
<div class="listingblock data-line-157">
<div class="content">
<pre>$ bx hd-private --index 0 &lt; account | bx hd-to-public
xpub6BH1zcTuktiFu43rUZ2gXqLgzu5F3tLEeTQ5t6iE3aQtM2VMTxMcyLN9fYHiGhGpQe9QQYmqL2eYPFJ3vezHz5wzaSW4FiGrseNDR4LKqTy

$ bx hd-private --index 1 &lt; account | bx hd-to-public
xpub6BH1zcTuktiFx6CzhPbGjG3UYQ13WR16CmtbPiagEKpEVtpyjshWyMaMV1cn7nUPUkgQHPVXJVqsrA8xWbGQDhohEcDFTEYMvYzwRD7Juf8</pre>
</div>
</div>
<div class="paragraph data-line-165">
<p>Nous pouvons g√©n√©rer un nombre pratiquement illimit√© de cl√©s dans une cha√Æne d√©terministe, toutes d√©riv√©es d&#8217;une seule valeur d&#8217;amor√ßage. Cette technique est utilis√©e dans de nombreuses applications de portefeuille pour g√©n√©rer des cl√©s qui peuvent √™tre sauvegard√©es et restaur√©es avec une seule valeur de d√©part. C&#8217;est plus facile que d&#8217;avoir √† sauvegarder le portefeuille avec toutes ses cl√©s g√©n√©r√©es de mani√®re al√©atoire √† chaque fois qu&#8217;une nouvelle cl√© est cr√©√©e.</p>
</div>
<div class="paragraph data-line-167">
<p>La valeur d&#8217;amor√ßage peut √™tre encod√©e √† l&#8217;aide de la commande mnemonic-encode¬†:</p>
</div>
<div class="listingblock data-line-169">
<div class="content">
<pre>$ bx hd-mnemonic &lt; seed &gt; words
adore repeat vision worst especially veil inch woman cast recall dwell appreciate</pre>
</div>
</div>
<div class="paragraph data-line-174">
<p>La valeur d&#8217;amor√ßage peut ensuite √™tre d√©cod√©e √† l&#8217;aide de la commande mnemonic-decode¬†:</p>
</div>
<div class="listingblock data-line-176">
<div class="content">
<pre>$ bx mnemonic-decode &lt; words
eb68ee9f3df6bd4441a9feadec179ff1</pre>
</div>
</div>
<div class="paragraph data-line-43">
<p>L&#8217;encodage mn√©monique peut faciliter l&#8217;enregistrement et m√™me la m√©morisation de la valeur d&#8217;amor√ßage.</p>
</div>
<div class="paragraph data-line-45">
<p>&lt;section data-type="index"/&gt;</p>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. "Bitcoin: A Peer-to-Peer Electronic Cash System," Satoshi Nakamoto (<a href="https://bitcoin.org/bitcoin.pdf" class="undefined" data-href="https://bitcoin.org/bitcoin.pdf">https://bitcoin.org/bitcoin.pdf</a>).
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-04-08 11:56:21 -0400
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>